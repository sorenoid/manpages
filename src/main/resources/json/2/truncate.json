{"name":"truncate","description":"truncate, ftruncate - truncate a file to a specified length","body":"\n\n<h1 align=\"center\">TRUNCATE</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">truncate,\nftruncate - truncate a file to a specified length</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;unistd.h&gt; <br>\n#include &lt;sys/types.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\ntruncate(const char *</b><i>path</i><b>, off_t</b>\n<i>length</i><b>); <br>\nint ftruncate(int</b> <i>fd</i><b>, off_t</b>\n<i>length</i><b>);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>truncate</b>():</p>\n\n\n<p style=\"margin-left:17%;\">_XOPEN_SOURCE&nbsp;&gt;=&nbsp;500\n<br>\n|| /* Since glibc 2.12: */\n_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;200809L <br>\n|| /* Glibc versions &lt;= 2.19: */ _BSD_SOURCE</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>ftruncate</b>():</p>\n\n\n<p style=\"margin-left:17%;\">_XOPEN_SOURCE&nbsp;&gt;=&nbsp;500\n<br>\n|| /* Since glibc 2.3.5: */\n_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;200112L <br>\n|| /* Glibc versions &lt;= 2.19: */ _BSD_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>truncate</b>() and <b>ftruncate</b>() functions cause the\nregular file named by <i>path</i> or referenced by <i>fd</i>\nto be truncated to a size of precisely <i>length</i>\nbytes.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the file\npreviously was larger than this size, the extra data is\nlost. If the file previously was shorter, it is extended,\nand the extended part reads as null bytes ('\\0').</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The file offset\nis not changed.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the size\nchanged, then the st_ctime and st_mtime fields\n(respectively, time of last status change and time of last\nmodification; see <a href=\"https://man.page/7/inode\">inode(7)</a>) for the file are updated,\nand the set-user-ID and set-group-ID mode bits may be\ncleared.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">With\n<b>ftruncate</b>(), the file must be open for writing; with\n<b>truncate</b>(), the file must be writable.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\nzero is returned. On error, -1 is returned, and <i>errno</i>\nis set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For\n<b>truncate</b>():</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EACCES</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Search permission is denied for a component of the path\nprefix, or the named file is not writable by the user. (See\nalso <a href=\"https://man.page/7/path_resolution\">path_resolution(7)</a>.)</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The argument <i>path</i> points outside the\nprocess&rsquo;s allocated address space.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EFBIG</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The argument <i>length</i> is larger than the maximum\nfile size. (XSI)</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINTR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>While blocked waiting to complete, the call was\ninterrupted by a signal handler; see <a href=\"https://man.page/2/fcntl\">fcntl(2)</a> and\n<a href=\"https://man.page/7/signal\">signal(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The argument <i>length</i> is negative or larger than\nthe maximum file size.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EIO</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>An I/O error occurred updating the inode.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EISDIR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The named file is a directory.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ELOOP</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Too many symbolic links were encountered in translating\nthe pathname.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENAMETOOLONG</b></p>\n\n<p style=\"margin-left:22%;\">A component of a pathname\nexceeded 255 characters, or an entire pathname exceeded 1023\ncharacters.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"46%\">\n\n\n<p>The named file does not exist.</p></td>\n<td width=\"32%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENOTDIR</b></p>\n\n<p style=\"margin-left:22%;\">A component of the path prefix\nis not a directory.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>EPERM</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>The underlying filesystem does not support extending a\nfile beyond its current size.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>EPERM</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>The operation was prevented by a file seal; see\n<a href=\"https://man.page/2/fcntl\">fcntl(2)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>EROFS</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>The named file resides on a read-only filesystem.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ETXTBSY</b></p>\n\n<p style=\"margin-left:22%;\">The file is an executable file\nthat is being executed.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For\n<b>ftruncate</b>() the same errors apply, but instead of\nthings that can be wrong with <i>path</i>, we now have\nthings that can be wrong with the file descriptor,\n<i>fd</i>:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>EBADF</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"52%\">\n\n\n<p><i>fd</i> is not a valid file descriptor.</p></td>\n<td width=\"26%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>EBADF</b> or\n<b>EINVAL</b></p>\n\n<p style=\"margin-left:22%;\"><i>fd</i> is not open for\nwriting.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>fd</i> does not reference a regular file or a POSIX\nshared memory object.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>EINVAL</b> or\n<b>EBADF</b></p>\n\n<p style=\"margin-left:22%;\">The file descriptor <i>fd</i>\nis not open for writing. POSIX permits, and portable\napplications should handle, either error for this case.\n(Linux produces <b>EINVAL</b>.)</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008, 4.4BSD, SVr4 (these calls first appeared in\n4.2BSD).</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>ftruncate</b>()\ncan also be used to set the size of a POSIX shared memory\nobject; see <a href=\"https://man.page/3/shm_open\">shm_open(3)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The details in\nDESCRIPTION are for XSI-compliant systems. For\nnon-XSI-compliant systems, the POSIX standard allows two\nbehaviors for <b>ftruncate</b>() when <i>length</i> exceeds\nthe file length (note that <b>truncate</b>() is not\nspecified at all in such an environment): either returning\nan error, or extending the file. Like most UNIX\nimplementations, Linux follows the XSI requirement when\ndealing with native filesystems. However, some nonnative\nfilesystems do not permit <b>truncate</b>() and\n<b>ftruncate</b>() to be used to extend a file beyond its\ncurrent length: a notable example on Linux is VFAT.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The original\nLinux <b>truncate</b>() and <b>ftruncate</b>() system calls\nwere not designed to handle large file offsets.\nConsequently, Linux 2.4 added <b>truncate64</b>() and\n<b>ftruncate64</b>() system calls that handle large files.\nHowever, these details can be ignored by applications using\nglibc, whose wrapper functions transparently employ the more\nrecent system calls where they are available.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On some 32-bit\narchitectures, the calling signature for these system calls\ndiffer, for the reasons described in <a href=\"https://man.page/2/syscall\">syscall(2)</a>.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">A header file\nbug in glibc 2.12 meant that the minimum value of\n<b>_POSIX_C_SOURCE</b> required to expose the declaration of\n<b>ftruncate</b>() was 200809L instead of 200112L. This has\nbeen fixed in later glibc versions.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/truncate\">truncate(1)</a>,\n<a href=\"https://man.page/2/open\">open(2)</a>, <a href=\"https://man.page/2/stat\">stat(2)</a>,\n<a href=\"https://man.page/7/path_resolution\">path_resolution(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}