{"name":"nanosleep","description":"nanosleep -\nhigh-resolution sleep","body":"\n\n<h1 align=\"center\">NANOSLEEP</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">nanosleep -\nhigh-resolution sleep</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;time.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nnanosleep(const struct timespec *</b><i>req</i><b>, struct\ntimespec *</b><i>rem</i><b>);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>nanosleep</b>():\n_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;199309L</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>nanosleep</b>()\nsuspends the execution of the calling thread until either at\nleast the time specified in <i>*req</i> has elapsed, or the\ndelivery of a signal that triggers the invocation of a\nhandler in the calling thread or that terminates the\nprocess.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the call is\ninterrupted by a signal handler, <b>nanosleep</b>() returns\n-1, sets <i>errno</i> to <b>EINTR</b>, and writes the\nremaining time into the structure pointed to by <i>rem</i>\nunless <i>rem</i> is NULL. The value of <i>*rem</i> can then\nbe used to call <b>nanosleep</b>() again and complete the\nspecified pause (but see NOTES).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The structure\n<i>timespec</i> is used to specify intervals of time with\nnanosecond precision. It is defined as follows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct timespec\n{ <br>\ntime_t tv_sec; /* seconds */ <br>\nlong tv_nsec; /* nanoseconds */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The value of\nthe nanoseconds field must be in the range 0 to\n999999999.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Compared to\n<a href=\"https://man.page/3/sleep\">sleep(3)</a> and <a href=\"https://man.page/3/usleep\">usleep(3)</a>, <b>nanosleep</b>() has\nthe following advantages: it provides a higher resolution\nfor specifying the sleep interval; POSIX.1 explicitly\nspecifies that it does not interact with signals; and it\nmakes the task of resuming a sleep that has been interrupted\nby a signal handler easier.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On successfully\nsleeping for the requested interval, <b>nanosleep</b>()\nreturns 0. If the call is interrupted by a signal handler or\nencounters an error, then it returns -1, with <i>errno</i>\nset to indicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Problem with copying information\nfrom user space.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINTR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The pause has been interrupted by a signal that was\ndelivered to the thread (see <a href=\"https://man.page/7/signal\">signal(7)</a>). The\nremaining sleep time has been written into <i>*rem</i> so\nthat the thread can easily call <b>nanosleep</b>() again and\ncontinue with the pause.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The value in the <i>tv_nsec</i> field was not in the\nrange 0 to 999999999 or <i>tv_sec</i> was negative.</p></td></tr>\n</table>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the interval\nspecified in <i>req</i> is not an exact multiple of the\ngranularity underlying clock (see <a href=\"https://man.page/7/time\">time(7)</a>), then the\ninterval will be rounded up to the next multiple.\nFurthermore, after the sleep completes, there may still be a\ndelay before the CPU becomes free to once again execute the\ncalling thread.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The fact that\n<b>nanosleep</b>() sleeps for a relative interval can be\nproblematic if the call is repeatedly restarted after being\ninterrupted by signals, since the time between the\ninterruptions and restarts of the call will lead to drift in\nthe time when the sleep finally completes. This problem can\nbe avoided by using <a href=\"https://man.page/2/clock_nanosleep\">clock_nanosleep(2)</a> with an\nabsolute time value.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1\nspecifies that <b>nanosleep</b>() should measure time\nagainst the <b>CLOCK_REALTIME</b> clock. However, Linux\nmeasures the time using the <b>CLOCK_MONOTONIC</b> clock.\nThis probably does not matter, since the POSIX.1\nspecification for <a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a> says that\ndiscontinuous changes in <b>CLOCK_REALTIME</b> should not\naffect <b>nanosleep</b>():</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Setting the\nvalue of the <b>CLOCK_REALTIME</b> clock via\n<a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a> shall have no effect on threads that\nare blocked waiting for a relative time service based upon\nthis clock, including the <b>nanosleep</b>() function; ...\nConsequently, these time services shall expire when the\nrequested relative interval elapses, independently of the\nnew or old value of the clock.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Old\nbehavior</b> <br>\nIn order to support applications requiring much more precise\npauses (e.g., in order to control some time-critical\nhardware), <b>nanosleep</b>() would handle pauses of up to 2\nmilliseconds by busy waiting with microsecond precision when\ncalled from a thread scheduled under a real-time policy like\n<b>SCHED_FIFO</b> or <b>SCHED_RR</b>. This special extension\nwas removed in kernel 2.5.39, and is thus not available in\nLinux 2.6.0 and later kernels.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">If a program\nthat catches signals and uses <b>nanosleep</b>() receives\nsignals at a very high rate, then scheduling delays and\nrounding errors in the kernel&rsquo;s calculation of the\nsleep interval and the returned <i>remain</i> value mean\nthat the <i>remain</i> value may steadily <i>increase</i> on\nsuccessive restarts of the <b>nanosleep</b>() call. To avoid\nsuch problems, use <a href=\"https://man.page/2/clock_nanosleep\">clock_nanosleep(2)</a> with the\n<b>TIMER_ABSTIME</b> flag to sleep to an absolute\ndeadline.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In Linux 2.4,\nif <b>nanosleep</b>() is stopped by a signal (e.g.,\n<b>SIGTSTP</b>), then the call fails with the error\n<b>EINTR</b> after the thread is resumed by a <b>SIGCONT</b>\nsignal. If the system call is subsequently restarted, then\nthe time that the thread spent in the stopped state is\n<i>not</i> counted against the sleep interval. This problem\nis fixed in Linux 2.6.0 and later kernels.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/clock_nanosleep\">clock_nanosleep(2)</a>,\n<a href=\"https://man.page/2/restart_syscall\">restart_syscall(2)</a>, <a href=\"https://man.page/2/sched_setscheduler\">sched_setscheduler(2)</a>,\n<a href=\"https://man.page/2/timer_create\">timer_create(2)</a>, <a href=\"https://man.page/3/sleep\">sleep(3)</a>, <a href=\"https://man.page/3/usleep\">usleep(3)</a>,\n<a href=\"https://man.page/7/time\">time(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}