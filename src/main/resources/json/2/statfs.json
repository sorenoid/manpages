{"name":"statfs","description":"statfs, fstatfs - get filesystem statistics","body":"\n\n<h1 align=\"center\">STATFS</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">statfs, fstatfs\n- get filesystem statistics</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;sys/vfs.h&gt;</b> /* or &lt;sys/statfs.h&gt; */</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nstatfs(const char *</b><i>path</i><b>, struct statfs\n*</b><i>buf</i><b>); <br>\nint fstatfs(int</b> <i>fd</i><b>, struct statfs\n*</b><i>buf</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>statfs</b>() system call returns information about a\nmounted filesystem. <i>path</i> is the pathname of any file\nwithin the mounted filesystem. <i>buf</i> is a pointer to a\n<i>statfs</i> structure defined approximately as\nfollows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct statfs {\n<br>\n__fsword_t f_type; /* Type of filesystem (see below) */ <br>\n__fsword_t f_bsize; /* Optimal transfer block size */ <br>\nfsblkcnt_t f_blocks; /* Total data blocks in filesystem */\n<br>\nfsblkcnt_t f_bfree; /* Free blocks in filesystem */ <br>\nfsblkcnt_t f_bavail; /* Free blocks available to <br>\nunprivileged user */ <br>\nfsfilcnt_t f_files; /* Total inodes in filesystem */ <br>\nfsfilcnt_t f_ffree; /* Free inodes in filesystem */ <br>\nfsid_t f_fsid; /* Filesystem ID */ <br>\n__fsword_t f_namelen; /* Maximum length of filenames */ <br>\n__fsword_t f_frsize; /* Fragment size (since Linux 2.6) */\n<br>\n__fsword_t f_flags; /* Mount flags of filesystem <br>\n(since Linux 2.6.36) */ <br>\n__fsword_t f_spare[xxx]; <br>\n/* Padding bytes reserved for future use */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The following\nfilesystem types may appear in <i>f_type</i>:</p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">ADFS_SUPER_MAGIC\n0xadf5 <br>\nAFFS_SUPER_MAGIC 0xadff <br>\nAFS_SUPER_MAGIC 0x5346414f <br>\nANON_INODE_FS_MAGIC 0x09041934 /* Anonymous inode FS (for\n<br>\npseudofiles that have no name; <br>\ne.g., epoll, signalfd, bpf) */ <br>\nAUTOFS_SUPER_MAGIC 0x0187 <br>\nBDEVFS_MAGIC 0x62646576 <br>\nBEFS_SUPER_MAGIC 0x42465331 <br>\nBFS_MAGIC 0x1badface <br>\nBINFMTFS_MAGIC 0x42494e4d <br>\nBPF_FS_MAGIC 0xcafe4a11 <br>\nBTRFS_SUPER_MAGIC 0x9123683e <br>\nBTRFS_TEST_MAGIC 0x73727279 <br>\nCGROUP_SUPER_MAGIC 0x27e0eb /* Cgroup pseudo FS */ <br>\nCGROUP2_SUPER_MAGIC 0x63677270 /* Cgroup v2 pseudo FS */\n<br>\nCIFS_MAGIC_NUMBER 0xff534d42 <br>\nCODA_SUPER_MAGIC 0x73757245 <br>\nCOH_SUPER_MAGIC 0x012ff7b7 <br>\nCRAMFS_MAGIC 0x28cd3d45 <br>\nDEBUGFS_MAGIC 0x64626720 <br>\nDEVFS_SUPER_MAGIC 0x1373 /* Linux 2.6.17 and earlier */ <br>\nDEVPTS_SUPER_MAGIC 0x1cd1 <br>\nECRYPTFS_SUPER_MAGIC 0xf15f <br>\nEFIVARFS_MAGIC 0xde5e81e4 <br>\nEFS_SUPER_MAGIC 0x00414a53 <br>\nEXT_SUPER_MAGIC 0x137d /* Linux 2.0 and earlier */ <br>\nEXT2_OLD_SUPER_MAGIC 0xef51 <br>\nEXT2_SUPER_MAGIC 0xef53 <br>\nEXT3_SUPER_MAGIC 0xef53 <br>\nEXT4_SUPER_MAGIC 0xef53 <br>\nF2FS_SUPER_MAGIC 0xf2f52010 <br>\nFUSE_SUPER_MAGIC 0x65735546 <br>\nFUTEXFS_SUPER_MAGIC 0xbad1dea /* Unused */ <br>\nHFS_SUPER_MAGIC 0x4244 <br>\nHOSTFS_SUPER_MAGIC 0x00c0ffee <br>\nHPFS_SUPER_MAGIC 0xf995e849 <br>\nHUGETLBFS_MAGIC 0x958458f6 <br>\nISOFS_SUPER_MAGIC 0x9660 <br>\nJFFS2_SUPER_MAGIC 0x72b6 <br>\nJFS_SUPER_MAGIC 0x3153464a <br>\nMINIX_SUPER_MAGIC 0x137f /* original minix FS */ <br>\nMINIX_SUPER_MAGIC2 0x138f /* 30 char minix FS */ <br>\nMINIX2_SUPER_MAGIC 0x2468 /* minix V2 FS */ <br>\nMINIX2_SUPER_MAGIC2 0x2478 /* minix V2 FS, 30 char names */\n<br>\nMINIX3_SUPER_MAGIC 0x4d5a /* minix V3 FS, 60 char names */\n<br>\nMQUEUE_MAGIC 0x19800202 /* POSIX message queue FS */ <br>\nMSDOS_SUPER_MAGIC 0x4d44 <br>\nMTD_INODE_FS_MAGIC 0x11307854 <br>\nNCP_SUPER_MAGIC 0x564c <br>\nNFS_SUPER_MAGIC 0x6969 <br>\nNILFS_SUPER_MAGIC 0x3434 <br>\nNSFS_MAGIC 0x6e736673 <br>\nNTFS_SB_MAGIC 0x5346544e <br>\nOCFS2_SUPER_MAGIC 0x7461636f <br>\nOPENPROM_SUPER_MAGIC 0x9fa1 <br>\nOVERLAYFS_SUPER_MAGIC 0x794c7630 <br>\nPIPEFS_MAGIC 0x50495045 <br>\nPROC_SUPER_MAGIC 0x9fa0 /* /proc FS */ <br>\nPSTOREFS_MAGIC 0x6165676c <br>\nQNX4_SUPER_MAGIC 0x002f <br>\nQNX6_SUPER_MAGIC 0x68191122 <br>\nRAMFS_MAGIC 0x858458f6 <br>\nREISERFS_SUPER_MAGIC 0x52654973 <br>\nROMFS_MAGIC 0x7275 <br>\nSECURITYFS_MAGIC 0x73636673 <br>\nSELINUX_MAGIC 0xf97cff8c <br>\nSMACK_MAGIC 0x43415d53 <br>\nSMB_SUPER_MAGIC 0x517b <br>\nSMB2_MAGIC_NUMBER 0xfe534d42 <br>\nSOCKFS_MAGIC 0x534f434b <br>\nSQUASHFS_MAGIC 0x73717368 <br>\nSYSFS_MAGIC 0x62656572 <br>\nSYSV2_SUPER_MAGIC 0x012ff7b6 <br>\nSYSV4_SUPER_MAGIC 0x012ff7b5 <br>\nTMPFS_MAGIC 0x01021994 <br>\nTRACEFS_MAGIC 0x74726163 <br>\nUDF_SUPER_MAGIC 0x15013346 <br>\nUFS_MAGIC 0x00011954 <br>\nUSBDEVICE_SUPER_MAGIC 0x9fa2 <br>\nV9FS_MAGIC 0x01021997 <br>\nVXFS_SUPER_MAGIC 0xa501fcf5 <br>\nXENFS_SUPER_MAGIC 0xabba1974 <br>\nXENIX_SUPER_MAGIC 0x012ff7b4 <br>\nXFS_SUPER_MAGIC 0x58465342 <br>\n_XIAFS_SUPER_MAGIC 0x012fd16d /* Linux 2.0 and earlier\n*/</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Most of these\nMAGIC constants are defined in\n<i>/usr/include/linux/magic.h</i>, and some are hardcoded in\nkernel sources.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>f_flags</i> field is a bit mask indicating mount options\nfor the filesystem. It contains zero or more of the\nfollowing bits: <b><br>\nST_MANDLOCK</b></p>\n\n<p style=\"margin-left:22%;\">Mandatory locking is permitted\non the filesystem (see <a href=\"https://man.page/2/fcntl\">fcntl(2)</a>).</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NOATIME</b></p>\n\n<p style=\"margin-left:22%;\">Do not update access times; see\n<a href=\"https://man.page/2/mount\">mount(2)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NODEV</b></p>\n\n<p style=\"margin-left:22%;\">Disallow access to device\nspecial files on this filesystem.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NODIRATIME</b></p>\n\n<p style=\"margin-left:22%;\">Do not update directory access\ntimes; see <a href=\"https://man.page/2/mount\">mount(2)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NOEXEC</b></p>\n\n<p style=\"margin-left:22%;\">Execution of programs is\ndisallowed on this filesystem.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NOSUID</b></p>\n\n<p style=\"margin-left:22%;\">The set-user-ID and\nset-group-ID bits are ignored by <a href=\"https://man.page/3/exec\">exec(3)</a> for\nexecutable files on this filesystem</p>\n\n<p style=\"margin-left:11%;\"><b>ST_RDONLY</b></p>\n\n<p style=\"margin-left:22%;\">This filesystem is mounted\nread-only.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_RELATIME</b></p>\n\n<p style=\"margin-left:22%;\">Update atime relative to\nmtime/ctime; see <a href=\"https://man.page/2/mount\">mount(2)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>ST_SYNCHRONOUS</b></p>\n\n<p style=\"margin-left:22%;\">Writes are synched to the\nfilesystem immediately (see the description of <b>O_SYNC</b>\nin <a href=\"https://man.page/2/open\">open(2)</a>).</p>\n\n<p style=\"margin-left:11%;\"><b>ST_NOSYMFOLLOW</b> (since\nLinux 5.10)</p>\n\n<p style=\"margin-left:22%;\">Symbolic links are not followed\nwhen resolving paths; see <a href=\"https://man.page/2/mount\">mount(2)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Nobody knows\nwhat <i>f_fsid</i> is supposed to contain (but see\nbelow).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Fields that are\nundefined for a particular filesystem are set to 0.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>fstatfs</b>()\nreturns the same information about an open file referenced\nby descriptor <i>fd</i>.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\nzero is returned. On error, -1 is returned, and <i>errno</i>\nis set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EACCES</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">(<b>statfs</b>()) Search\npermission is denied for a component of the path prefix of\n<i>path</i>. (See also <a href=\"https://man.page/7/path_resolution\">path_resolution(7)</a>.)</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EBADF</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>(<b>fstatfs</b>()) <i>fd</i> is not a valid open file\ndescriptor.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>buf</i> or <i>path</i> points to an invalid\naddress.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINTR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The call was interrupted by a signal; see\n<a href=\"https://man.page/7/signal\">signal(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EIO</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>An I/O error occurred while reading from the\nfilesystem.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ELOOP</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>(<b>statfs</b>()) Too many symbolic links were\nencountered in translating <i>path</i>.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENAMETOOLONG</b></p>\n\n<p style=\"margin-left:22%;\">(<b>statfs</b>()) <i>path</i>\nis too long.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>(<b>statfs</b>()) The file referred to by <i>path</i>\ndoes not exist.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOMEM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Insufficient kernel memory was available.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOSYS</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The filesystem does not support this call.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENOTDIR</b></p>\n\n<p style=\"margin-left:22%;\">(<b>statfs</b>()) A component\nof the path prefix of <i>path</i> is not a directory.</p>\n\n<p style=\"margin-left:11%;\"><b>EOVERFLOW</b></p>\n\n<p style=\"margin-left:22%;\">Some values were too large to\nbe represented in the returned struct.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Linux-specific.\nThe Linux <b>statfs</b>() was inspired by the 4.4BSD one\n(but they do not use the same structure).</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>__fsword_t</i> type used for various fields in the\n<i>statfs</i> structure definition is a glibc internal type,\nnot intended for public use. This leaves the programmer in a\nbit of a conundrum when trying to copy or compare these\nfields to local variables in a program. Using\n<i>unsigned&nbsp;int</i> for such variables suffices on most\nsystems.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The original\nLinux <b>statfs</b>() and <b>fstatfs</b>() system calls were\nnot designed with extremely large file sizes in mind.\nSubsequently, Linux 2.6 added new <b>statfs64</b>() and\n<b>fstatfs64</b>() system calls that employ a new structure,\n<i>statfs64</i>. The new structure contains the same fields\nas the original <i>statfs</i> structure, but the sizes of\nvarious fields are increased, to accommodate large file\nsizes. The glibc <b>statfs</b>() and <b>fstatfs</b>()\nwrapper functions transparently deal with the kernel\ndifferences.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Some systems\nhave only <i>&lt;sys/vfs.h&gt;</i>, other systems also have\n<i>&lt;sys/statfs.h&gt;</i>, where the former includes the\nlatter. So it seems including the former is the best\nchoice.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">LSB has\ndeprecated the library calls <b>statfs</b>() and\n<b>fstatfs</b>() and tells us to use <a href=\"https://man.page/2/statvfs\">statvfs(2)</a> and\n<a href=\"https://man.page/2/fstatvfs\">fstatvfs(2)</a> instead.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>The f_fsid\nfield</b> <br>\nSolaris, Irix and POSIX have a system call <a href=\"https://man.page/2/statvfs\">statvfs(2)</a>\nthat returns a <i>struct statvfs</i> (defined in\n<i>&lt;sys/statvfs.h&gt;</i>) containing an <i>unsigned long\nf_fsid</i>. Linux, SunOS, HP-UX, 4.4BSD have a system call\n<b>statfs</b>() that returns a <i>struct statfs</i> (defined\nin <i>&lt;sys/vfs.h&gt;</i>) containing a <i>fsid_t\nf_fsid</i>, where <i>fsid_t</i> is defined as <i>struct {\nint val[2]; }</i>. The same holds for FreeBSD, except that\nit uses the include file <i>&lt;sys/mount.h&gt;</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The general\nidea is that <i>f_fsid</i> contains some random stuff such\nthat the pair (<i>f_fsid</i>,<i>ino</i>) uniquely determines\na file. Some operating systems use (a variation on) the\ndevice number, or the device number combined with the\nfilesystem type. Several operating systems restrict giving\nout the <i>f_fsid</i> field to the superuser only (and zero\nit for unprivileged users), because this field is used in\nthe filehandle of the filesystem when NFS-exported, and\ngiving it out is a security concern.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Under some\noperating systems, the <i>fsid</i> can be used as the second\nargument to the <a href=\"https://man.page/2/sysfs\">sysfs(2)</a> system call.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">From Linux\n2.6.38 up to and including Linux 3.1, <b>fstatfs</b>()\nfailed with the error <b>ENOSYS</b> for file descriptors\ncreated by <a href=\"https://man.page/2/pipe\">pipe(2)</a>.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/stat\">stat(2)</a>,\n<a href=\"https://man.page/3/statvfs\">statvfs(3)</a>, <a href=\"https://man.page/7/path_resolution\">path_resolution(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}