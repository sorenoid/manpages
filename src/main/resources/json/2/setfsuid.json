{"name":"setfsuid","body":"\n\n<h1 align=\"center\">SETFSUID</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">setfsuid - set\nuser identity used for filesystem checks</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;sys/fsuid.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nsetfsuid(uid_t</b> <i>fsuid</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Linux, a\nprocess has both a filesystem user ID and an effective user\nID. The (Linux-specific) filesystem user ID is used for\npermissions checking when accessing filesystem objects,\nwhile the effective user ID is used for various other kinds\nof permissions checks (see <a href=\"https://man.page/7/credentials\">credentials(7)</a>).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Normally, the\nvalue of the process&rsquo;s filesystem user ID is the same\nas the value of its effective user ID. This is so, because\nwhenever a process&rsquo;s effective user ID is changed, the\nkernel also changes the filesystem user ID to be the same as\nthe new value of the effective user ID. A process can cause\nthe value of its filesystem user ID to diverge from its\neffective user ID by using <b>setfsuid</b>() to change its\nfilesystem user ID to the value given in <i>fsuid</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Explicit calls\nto <b>setfsuid</b>() and <a href=\"https://man.page/2/setfsgid\">setfsgid(2)</a> are (were)\nusually used only by programs such as the Linux NFS server\nthat need to change what user and group ID is used for file\naccess without a corresponding change in the real and\neffective user and group IDs. A change in the normal user\nIDs for a program such as the NFS server is (was) a security\nhole that can expose it to unwanted signals. (However, this\nissue is historical; see below.)</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>setfsuid</b>()\nwill succeed only if the caller is the superuser or if\n<i>fsuid</i> matches either the caller&rsquo;s real user ID,\neffective user ID, saved set-user-ID, or current filesystem\nuser ID.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On both success\nand failure, this call returns the previous filesystem user\nID of the caller.</p>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This system\ncall is present in Linux since version 1.2.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>setfsuid</b>()\nis Linux-specific and should not be used in programs\nintended to be portable.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">At the time\nwhen this system call was introduced, one process could send\na signal to another process with the same effective user ID.\nThis meant that if a privileged process changed its\neffective user ID for the purpose of file permission\nchecking, then it could become vulnerable to receiving\nsignals sent by another (unprivileged) process with the same\nuser ID. The filesystem user ID attribute was thus added to\nallow a process to change its user ID for the purposes of\nfile permission checking without at the same time becoming\nvulnerable to receiving unwanted signals. Since Linux 2.0,\nsignal permission handling is different (see\n<a href=\"https://man.page/2/kill\">kill(2)</a>), with the result that a process can change\nits effective user ID without being vulnerable to receiving\nsignals from unwanted processes. Thus, <b>setfsuid</b>() is\nnowadays unneeded and should be avoided in new applications\n(likewise for <a href=\"https://man.page/2/setfsgid\">setfsgid(2)</a>).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The original\nLinux <b>setfsuid</b>() system call supported only 16-bit\nuser IDs. Subsequently, Linux 2.4 added <b>setfsuid32</b>()\nsupporting 32-bit IDs. The glibc <b>setfsuid</b>() wrapper\nfunction transparently deals with the variation across\nkernel versions.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>C\nlibrary/kernel differences</b> <br>\nIn glibc 2.15 and earlier, when the wrapper for this system\ncall determines that the argument can&rsquo;t be passed to\nthe kernel without integer truncation (because the kernel is\nold and does not support 32-bit user IDs), it will return -1\nand set <i>errno</i> to <b>EINVAL</b> without attempting the\nsystem call.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">No error\nindications of any kind are returned to the caller, and the\nfact that both successful and unsuccessful calls return the\nsame value makes it impossible to directly determine whether\nthe call succeeded or failed. Instead, the caller must\nresort to looking at the return value from a further call\nsuch as <i>setfsuid(-1)</i> (which will always fail), in\norder to determine if a preceding call to <b>setfsuid</b>()\nchanged the filesystem user ID. At the very least,\n<b>EPERM</b> should be returned when the call fails (because\nthe caller lacks the <b>CAP_SETUID</b> capability).</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/kill\">kill(2)</a>,\n<a href=\"https://man.page/2/setfsgid\">setfsgid(2)</a>, <a href=\"https://man.page/7/capabilities\">capabilities(7)</a>,\n<a href=\"https://man.page/7/credentials\">credentials(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}