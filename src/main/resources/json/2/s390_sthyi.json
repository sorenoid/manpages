{"name":"s390_sthyi","description":"s390_sthyi -\nemulate STHYI instruction","body":"\n\n<h1 align=\"center\">S390_STHYI</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">s390_sthyi -\nemulate STHYI instruction</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;asm/unistd.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\ns390_sthyi(unsigned long</b> <i>function_code</i><b>, void\n*</b><i>resp_buffer</i><b>, <br>\nuint64_t *</b><i>return_code</i><b>, unsigned long</b>\n<i>flags</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>s390_sthyi</b>() system call emulates the STHYI (Store\nHypervisor Information) instruction. It provides hardware\nresource information for the machine and its virtualization\nlevels. This includes CPU type and capacity, as well as the\nmachine model and other metrics.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>function_code</i> argument indicates which function to\nperform. The following code(s) are supported:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>0</p></td>\n<td width=\"10%\"></td>\n<td width=\"78%\">\n\n\n<p>Return CP (Central Processor) and IFL (Integrated\nFacility for Linux) capacity information.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>resp_buffer</i> argument specifies the address of a\nresponse buffer. When the <i>function_code</i> is 0, the\nbuffer must be one page (4K) in size. If the system call\nreturns 0, the response buffer will be filled with CPU\ncapacity information. Otherwise, the response buffer&rsquo;s\ncontent is unchanged.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>return_code</i> argument stores the return code of the\nSTHYI instruction, using one of the following values:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">0</p></td>\n<td width=\"10%\"></td>\n<td width=\"40%\">\n\n\n<p style=\"margin-top: 1em\">Success.</p></td>\n<td width=\"38%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>4</p></td>\n<td width=\"10%\"></td>\n<td width=\"40%\">\n\n\n<p>Unsupported function code.</p></td>\n<td width=\"38%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For further\ndetails about <i>return_code</i>, <i>function_code</i>, and\n<i>resp_buffer</i>, see the reference given in NOTES.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument is provided to allow for future\nextensions and currently must be set to 0.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success\n(that is: emulation succeeded), the return value of\n<b>s390_sthyi</b>() matches the condition code of the STHYI\ninstructions, which is a value in the range [0..3]. A return\nvalue of 0 indicates that CPU capacity information is stored\nin <i>*resp_buffer</i>. A return value of 3 indicates\n&quot;unsupported function code&quot; and the content of\n<i>*resp_buffer</i> is unchanged. The return values 1 and 2\nare reserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On error, -1 is\nreturned, and <i>errno</i> is set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">The value specified in\n<i>resp_buffer</i> or <i>return_code</i> is not a valid\naddress.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The value specified in <i>flags</i> is nonzero.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOMEM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Allocating memory for handling the CPU capacity\ninformation failed.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>EOPNOTSUPP</b></p>\n\n<p style=\"margin-left:22%;\">The value specified in\n<i>function_code</i> is not valid.</p>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This system\ncall is available since Linux 4.15.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This\nLinux-specific system call is available only on the s390\narchitecture.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Glibc does not\nprovide a wrapper for this system call, use\n<a href=\"https://man.page/2/syscall\">syscall(2)</a> to call it.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For details of\nthe STHYI instruction, see\n<a href=\"https://www.ibm.com/support/knowledgecenter/SSB27U_6.3.0/com.ibm.zvm.v630.hcpb4/hcpb4sth.htm\">the\ndocumentation page</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When the system\ncall interface is used, the response buffer doesn&rsquo;t\nhave to fulfill alignment requirements described in the\nSTHYI instruction definition.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The kernel\ncaches the response (for up to one second, as of Linux\n4.16). Subsequent system call invocations may return the\ncached response.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/syscall\">syscall(2)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}