{"name":"msync","body":"\n\n<h1 align=\"center\">MSYNC</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">msync -\nsynchronize a file with a memory map</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;sys/mman.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nmsync(void *</b><i>addr</i><b>, size_t</b> <i>length</i><b>,\nint</b> <i>flags</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>msync</b>()\nflushes changes made to the in-core copy of a file that was\nmapped into memory using <a href=\"https://man.page/2/mmap\">mmap(2)</a> back to the\nfilesystem. Without use of this call, there is no guarantee\nthat changes are written back before <a href=\"https://man.page/2/munmap\">munmap(2)</a> is\ncalled. To be more precise, the part of the file that\ncorresponds to the memory area starting at <i>addr</i> and\nhaving length <i>length</i> is updated.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument should specify exactly one of\n<b>MS_ASYNC</b> and <b>MS_SYNC</b>, and may additionally\ninclude the <b>MS_INVALIDATE</b> bit. These bits have the\nfollowing meanings: <b><br>\nMS_ASYNC</b></p>\n\n<p style=\"margin-left:22%;\">Specifies that an update be\nscheduled, but the call returns immediately.</p>\n\n<p style=\"margin-left:11%;\"><b>MS_SYNC</b></p>\n\n<p style=\"margin-left:22%;\">Requests an update and waits\nfor it to complete.</p>\n\n<p style=\"margin-left:11%;\"><b>MS_INVALIDATE</b></p>\n\n<p style=\"margin-left:22%;\">Asks to invalidate other\nmappings of the same file (so that they can be updated with\nthe fresh values just written).</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\nzero is returned. On error, -1 is returned, and <i>errno</i>\nis set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EBUSY</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\"><b>MS_INVALIDATE</b> was\nspecified in <i>flags</i>, and a memory lock exists for the\nspecified address range.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>addr</i> is not a multiple of PAGESIZE; or any bit\nother than <b>MS_ASYNC</b> | <b>MS_INVALIDATE</b> |\n<b>MS_SYNC</b> is set in <i>flags</i>; or both\n<b>MS_SYNC</b> and <b>MS_ASYNC</b> are set in\n<i>flags</i>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOMEM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The indicated memory (or part of it) was not mapped.</p></td></tr>\n</table>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This call was\nintroduced in Linux 1.3.21, and then used <b>EFAULT</b>\ninstead of <b>ENOMEM</b>. In Linux 2.4.19, this was changed\nto the POSIX value <b>ENOMEM</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On POSIX\nsystems on which <b>msync</b>() is available, both\n<b>_POSIX_MAPPED_FILES</b> and <b>_POSIX_SYNCHRONIZED_IO</b>\nare defined in <i>&lt;unistd.h&gt;</i> to a value greater\nthan 0. (See also <a href=\"https://man.page/3/sysconf\">sysconf(3)</a>.)</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">According to\nPOSIX, either <b>MS_SYNC</b> or <b>MS_ASYNC</b> must be\nspecified in <i>flags</i>, and indeed failure to include one\nof these flags will cause <b>msync</b>() to fail on some\nsystems. However, Linux permits a call to <b>msync</b>()\nthat specifies neither of these flags, with semantics that\nare (currently) equivalent to specifying <b>MS_ASYNC</b>.\n(Since Linux 2.6.19, <b>MS_ASYNC</b> is in fact a no-op,\nsince the kernel properly tracks dirty pages and flushes\nthem to storage as necessary.) Notwithstanding the Linux\nbehavior, portable, future-proof applications should ensure\nthat they specify either <b>MS_SYNC</b> or <b>MS_ASYNC</b>\nin <i>flags</i>.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/mmap\">mmap(2)</a></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">B.O.\nGallmeister, POSIX.4, O&rsquo;Reilly, pp. 128&ndash;129 and\n389&ndash;391.</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}