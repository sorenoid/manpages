{"name":"lseek","description":"lseek - reposition read/write file offset","body":"\n\n<h1 align=\"center\">LSEEK</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">lseek -\nreposition read/write file offset</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;sys/types.h&gt; <br>\n#include &lt;unistd.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>off_t\nlseek(int</b> <i>fd</i><b>, off_t</b> <i>offset</i><b>,\nint</b> <i>whence</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>lseek</b>()\nrepositions the file offset of the open file description\nassociated with the file descriptor <i>fd</i> to the\nargument <i>offset</i> according to the directive\n<i>whence</i> as follows: <b><br>\nSEEK_SET</b></p>\n\n<p style=\"margin-left:22%;\">The file offset is set to\n<i>offset</i> bytes.</p>\n\n<p style=\"margin-left:11%;\"><b>SEEK_CUR</b></p>\n\n<p style=\"margin-left:22%;\">The file offset is set to its\ncurrent location plus <i>offset</i> bytes.</p>\n\n<p style=\"margin-left:11%;\"><b>SEEK_END</b></p>\n\n<p style=\"margin-left:22%;\">The file offset is set to the\nsize of the file plus <i>offset</i> bytes.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>lseek</b>()\nallows the file offset to be set beyond the end of the file\n(but this does not change the size of the file). If data is\nlater written at this point, subsequent reads of the data in\nthe gap (a &quot;hole&quot;) return null bytes ('\\0') until\ndata is actually written into the gap.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Seeking file\ndata and holes</b> <br>\nSince version 3.1, Linux supports the following additional\nvalues for <i>whence</i>: <b><br>\nSEEK_DATA</b></p>\n\n<p style=\"margin-left:22%;\">Adjust the file offset to the\nnext location in the file greater than or equal to\n<i>offset</i> containing data. If <i>offset</i> points to\ndata, then the file offset is set to <i>offset</i>.</p>\n\n<p style=\"margin-left:11%;\"><b>SEEK_HOLE</b></p>\n\n<p style=\"margin-left:22%;\">Adjust the file offset to the\nnext hole in the file greater than or equal to\n<i>offset</i>. If <i>offset</i> points into the middle of a\nhole, then the file offset is set to <i>offset</i>. If there\nis no hole past <i>offset</i>, then the file offset is\nadjusted to the end of the file (i.e., there is an implicit\nhole at the end of any file).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In both of the\nabove cases, <b>lseek</b>() fails if <i>offset</i> points\npast the end of the file.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">These\noperations allow applications to map holes in a sparsely\nallocated file. This can be useful for applications such as\nfile backup tools, which can save space when creating\nbackups and preserve holes, if they have a mechanism for\ndiscovering holes.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For the\npurposes of these operations, a hole is a sequence of zeros\nthat (normally) has not been allocated in the underlying\nfile storage. However, a filesystem is not obliged to report\nholes, so these operations are not a guaranteed mechanism\nfor mapping the storage space actually allocated to a file.\n(Furthermore, a sequence of zeros that actually has been\nwritten to the underlying storage may not be reported as a\nhole.) In the simplest implementation, a filesystem can\nsupport the operations by making <b>SEEK_HOLE</b> always\nreturn the offset of the end of the file, and making\n<b>SEEK_DATA</b> always return <i>offset</i> (i.e., even if\nthe location referred to by <i>offset</i> is a hole, it can\nbe considered to consist of data that is a sequence of\nzeros).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>_GNU_SOURCE</b> feature test macro must be defined in\norder to obtain the definitions of <b>SEEK_DATA</b> and\n<b>SEEK_HOLE</b> from <i>&lt;unistd.h&gt;</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>SEEK_HOLE</b> and <b>SEEK_DATA</b> operations are\nsupported for the following filesystems:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>Btrfs (since Linux 3.1)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>OCFS (since Linux 3.2)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>XFS (since Linux 3.5)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>ext4 (since Linux 3.8)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p><a href=\"https://man.page/5/tmpfs\">tmpfs(5)</a> (since Linux 3.8)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>NFS (since Linux 3.18)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>FUSE (since Linux 4.5)</p></td>\n<td width=\"45%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"40%\">\n\n\n<p>GFS2 (since Linux 4.15)</p></td>\n<td width=\"45%\">\n</td></tr>\n</table>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Upon successful\ncompletion, <b>lseek</b>() returns the resulting offset\nlocation as measured in bytes from the beginning of the\nfile. On error, the value <i>(off_t)&nbsp;-1</i> is returned\nand <i>errno</i> is set to indicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EBADF</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\"><i>fd</i> is not an open file\ndescriptor.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>whence</i> is not valid. Or: the resulting file\noffset would be negative, or beyond the end of a seekable\ndevice.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENXIO</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>whence</i> is <b>SEEK_DATA</b> or <b>SEEK_HOLE</b>,\nand <i>offset</i> is beyond the end of the file, or\n<i>whence</i> is <b>SEEK_DATA</b> and <i>offset</i> is\nwithin a hole at the end of the file.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>EOVERFLOW</b></p>\n\n<p style=\"margin-left:22%;\">The resulting file offset\ncannot be represented in an <i>off_t</i>.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ESPIPE</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"70%\">\n\n\n<p><i>fd</i> is associated with a pipe, socket, or\nFIFO.</p> </td>\n<td width=\"8%\">\n</td></tr>\n</table>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008, SVr4, 4.3BSD.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>SEEK_DATA</b>\nand <b>SEEK_HOLE</b> are nonstandard extensions also present\nin Solaris, FreeBSD, and DragonFly BSD; they are proposed\nfor inclusion in the next POSIX revision (Issue 8).</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">See\n<a href=\"https://man.page/2/open\">open(2)</a> for a discussion of the relationship between\nfile descriptors, open file descriptions, and files.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\n<b>O_APPEND</b> file status flag is set on the open file\ndescription, then a <a href=\"https://man.page/2/write\">write(2)</a> <i>always</i> moves the\nfile offset to the end of the file, regardless of the use of\n<b>lseek</b>().</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>off_t</i> data type is a signed integer data type\nspecified by POSIX.1.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Some devices\nare incapable of seeking and POSIX does not specify which\ndevices must support <b>lseek</b>().</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Linux, using\n<b>lseek</b>() on a terminal device fails with the error\n<b>ESPIPE</b>.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/dup\">dup(2)</a>,\n<a href=\"https://man.page/2/fallocate\">fallocate(2)</a>, <a href=\"https://man.page/2/fork\">fork(2)</a>, <a href=\"https://man.page/2/open\">open(2)</a>,\n<a href=\"https://man.page/3/fseek\">fseek(3)</a>, <a href=\"https://man.page/3/lseek64\">lseek64(3)</a>,\n<a href=\"https://man.page/3/posix_fallocate\">posix_fallocate(3)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}