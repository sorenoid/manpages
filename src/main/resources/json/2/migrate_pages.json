{"name":"migrate_pages","body":"\n\n<h1 align=\"center\">MIGRATE_PAGES</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">migrate_pages -\nmove all pages in a process to another set of nodes</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;numaif.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>long\nmigrate_pages(int</b> <i>pid</i><b>, unsigned long</b>\n<i>maxnode,</i> <b><br>\nconst unsigned long *</b><i>old_nodes,</i> <b><br>\nconst unsigned long *</b><i>new_nodes</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Link with\n<i>-lnuma</i>.</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>migrate_pages</b>()\nattempts to move all pages of the process <i>pid</i> that\nare in memory nodes <i>old_nodes</i> to the memory nodes in\n<i>new_nodes</i>. Pages not located in any node in\n<i>old_nodes</i> will not be migrated. As far as possible,\nthe kernel maintains the relative topology relationship\ninside <i>old_nodes</i> during the migration to\n<i>new_nodes</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>old_nodes</i> and <i>new_nodes</i> arguments are pointers\nto bit masks of node numbers, with up to <i>maxnode</i> bits\nin each mask. These masks are maintained as arrays of\nunsigned <i>long</i> integers (in the last <i>long</i>\ninteger, the bits beyond those specified by <i>maxnode</i>\nare ignored). The <i>maxnode</i> argument is the maximum\nnode number in the bit mask plus one (this is the same as in\n<a href=\"https://man.page/2/mbind\">mbind(2)</a>, but different from <a href=\"https://man.page/2/select\">select(2)</a>).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>pid</i>\nargument is the ID of the process whose pages are to be\nmoved. To move pages in another process, the caller must be\nprivileged (<b>CAP_SYS_NICE</b>) or the real or effective\nuser ID of the calling process must match the real or\nsaved-set user ID of the target process. If <i>pid</i> is 0,\nthen <b>migrate_pages</b>() moves pages of the calling\nprocess.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Pages shared\nwith another process will be moved only if the initiating\nprocess has the <b>CAP_SYS_NICE</b> privilege.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success\n<b>migrate_pages</b>() returns the number of pages that\ncould not be moved (i.e., a return of zero means that all\npages were successfully moved). On error, it returns -1, and\nsets <i>errno</i> to indicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Part or all of the memory range\nspecified by <i>old_nodes</i>/<i>new_nodes</i> and\n<i>maxnode</i> points outside your accessible address\nspace.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The value specified by <i>maxnode</i> exceeds a\nkernel-imposed limit. Or, <i>old_nodes</i> or\n<i>new_nodes</i> specifies one or more node IDs that are\ngreater than the maximum supported node ID. Or, none of the\nnode IDs specified by <i>new_nodes</i> are on-line and\nallowed by the process&rsquo;s current cpuset context, or\nnone of the specified nodes contain memory.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EPERM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Insufficient privilege (<b>CAP_SYS_NICE</b>) to move\npages of the process specified by <i>pid</i>, or\ninsufficient privilege (<b>CAP_SYS_NICE</b>) to access the\nspecified target nodes.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ESRCH</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>No process matching <i>pid</i> could be found.</p></td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>migrate_pages</b>() system call first appeared on Linux\nin version 2.6.16.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This system\ncall is Linux-specific.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For information\non library support, see <a href=\"https://man.page/7/numa\">numa(7)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Use\n<a href=\"https://man.page/2/get_mempolicy\">get_mempolicy(2)</a> with the <b>MPOL_F_MEMS_ALLOWED</b>\nflag to obtain the set of nodes that are allowed by the\ncalling process&rsquo;s cpuset. Note that this information\nis subject to change at any time by manual or automatic\nreconfiguration of the cpuset.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Use of\n<b>migrate_pages</b>() may result in pages whose location\n(node) violates the memory policy established for the\nspecified addresses (see <a href=\"https://man.page/2/mbind\">mbind(2)</a>) and/or the\nspecified process (see <a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>). That is,\nmemory policy does not constrain the destination nodes used\nby <b>migrate_pages</b>().</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>&lt;numaif.h&gt;</i> header is not included with glibc,\nbut requires installing <i>libnuma-devel</i> or a similar\npackage.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/get_mempolicy\">get_mempolicy(2)</a>,\n<a href=\"https://man.page/2/mbind\">mbind(2)</a>, <a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>, <a href=\"https://man.page/3/numa\">numa(3)</a>,\n<a href=\"https://man.page/5/numa_maps\">numa_maps(5)</a>, <a href=\"https://man.page/7/cpuset\">cpuset(7)</a>, <a href=\"https://man.page/7/numa\">numa(7)</a>,\n<b>migratepages</b>(8), <b>numastat</b>(8)</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Documentation/vm/page_migration.rst</i>\nin the Linux kernel source tree</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}