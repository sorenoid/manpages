{"name":"sched_setattr","description":"sched_setattr,\nsched_getattr - set and get scheduling policy and\nattributes","body":"\n\n<h1 align=\"center\">SCHED_SETATTR</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">sched_setattr,\nsched_getattr - set and get scheduling policy and\nattributes</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;sched.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nsched_setattr(pid_t</b> <i>pid</i><b>, struct sched_attr\n*</b><i>attr</i><b>, <br>\nunsigned int</b> <i>flags</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nsched_getattr(pid_t</b> <i>pid</i><b>, struct sched_attr\n*</b><i>attr</i><b>, <br>\nunsigned int</b> <i>size</i><b>, unsigned int</b>\n<i>flags</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>sched_setattr()</b>\n<br>\nThe <b>sched_setattr</b>() system call sets the scheduling\npolicy and associated attributes for the thread whose ID is\nspecified in <i>pid</i>. If <i>pid</i> equals zero, the\nscheduling policy and attributes of the calling thread will\nbe set.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Currently,\nLinux supports the following &quot;normal&quot; (i.e.,\nnon-real-time) scheduling policies as values that may be\nspecified in <i>policy</i>:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"17%\">\n\n\n<p><b>SCHED_OTHER</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"68%\">\n\n\n<p>the standard round-robin time-sharing policy;</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"17%\">\n\n\n<p><b>SCHED_BATCH</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"68%\">\n\n\n<p>for &quot;batch&quot; style execution of processes;\nand</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"17%\">\n\n\n<p><b>SCHED_IDLE</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"68%\">\n\n\n<p>for running <i>very</i> low priority background\njobs.</p> </td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Various\n&quot;real-time&quot; policies are also supported, for\nspecial time-critical applications that need precise control\nover the way in which runnable threads are selected for\nexecution. For the rules governing when a process may use\nthese policies, see <a href=\"https://man.page/7/sched\">sched(7)</a>. The real-time policies\nthat may be specified in <i>policy</i> are:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"15%\">\n\n\n<p style=\"margin-top: 1em\"><b>SCHED_FIFO</b></p></td>\n<td width=\"6%\"></td>\n<td width=\"51%\">\n\n\n<p style=\"margin-top: 1em\">a first-in, first-out policy;\nand</p> </td>\n<td width=\"17%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"15%\">\n\n\n<p><b>SCHED_RR</b></p></td>\n<td width=\"6%\"></td>\n<td width=\"51%\">\n\n\n<p>a round-robin policy.</p></td>\n<td width=\"17%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Linux also\nprovides the following policy: <b><br>\nSCHED_DEADLINE</b></p>\n\n<p style=\"margin-left:32%;\">a deadline scheduling policy;\nsee <a href=\"https://man.page/7/sched\">sched(7)</a> for details.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>attr</i>\nargument is a pointer to a structure that defines the new\nscheduling policy and attributes for the specified thread.\nThis structure has the following form:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct\nsched_attr { <br>\nu32 size; /* Size of this structure */ <br>\nu32 sched_policy; /* Policy (SCHED_*) */ <br>\nu64 sched_flags; /* Flags */ <br>\ns32 sched_nice; /* Nice value (SCHED_OTHER, <br>\nSCHED_BATCH) */ <br>\nu32 sched_priority; /* Static priority (SCHED_FIFO, <br>\nSCHED_RR) */ <br>\n/* Remaining fields are for SCHED_DEADLINE */ <br>\nu64 sched_runtime; <br>\nu64 sched_deadline; <br>\nu64 sched_period; <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The fields of\nthe <i>sched_attr</i> structure are as follows:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p><b>size</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"78%\">\n\n\n<p>This field should be set to the size of the structure in\nbytes, as in <i>sizeof(struct sched_attr)</i>. If the\nprovided structure is smaller than the kernel structure, any\nadditional fields are assumed to be &rsquo;0&rsquo;. If the\nprovided structure is larger than the kernel structure, the\nkernel verifies that all additional fields are 0; if they\nare not, <b>sched_setattr</b>() fails with the error\n<b>E2BIG</b> and updates <i>size</i> to contain the size of\nthe kernel structure.</p></td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">The above\nbehavior when the size of the user-space <i>sched_attr</i>\nstructure does not match the size of the kernel structure\nallows for future extensibility of the interface. Malformed\napplications that pass oversize structures won&rsquo;t break\nin the future if the size of the kernel <i>sched_attr</i>\nstructure is increased. In the future, it could also allow\napplications that know about a larger user-space\n<i>sched_attr</i> structure to determine whether they are\nrunning on an older kernel that does not support the larger\nstructure.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_policy</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the\nscheduling policy, as one of the <b>SCHED_*</b> values\nlisted above.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_flags</i></p>\n\n<p style=\"margin-left:22%;\">This field contains zero or\nmore of the following flags that are ORed together to\ncontrol scheduling behavior: <b><br>\nSCHED_FLAG_RESET_ON_FORK</b></p>\n\n<p style=\"margin-left:32%;\">Children created by\n<a href=\"https://man.page/2/fork\">fork(2)</a> do not inherit privileged scheduling\npolicies. See <a href=\"https://man.page/7/sched\">sched(7)</a> for details.</p>\n\n<p style=\"margin-left:22%;\"><b>SCHED_FLAG_RECLAIM</b>\n(since Linux 4.13)</p>\n\n<p style=\"margin-left:32%;\">This flag allows a\n<b>SCHED_DEADLINE</b> thread to reclaim bandwidth unused by\nother real-time threads.</p>\n\n<p style=\"margin-left:22%;\"><b>SCHED_FLAG_DL_OVERRUN</b>\n(since Linux 4.16)</p>\n\n<p style=\"margin-left:32%;\">This flag allows an application\nto get informed about run-time overruns in\n<b>SCHED_DEADLINE</b> threads. Such overruns may be caused\nby (for example) coarse execution time accounting or\nincorrect parameter assignment. Notification takes the form\nof a <b>SIGXCPU</b> signal which is generated on each\noverrun.</p>\n\n<p style=\"margin-left:32%; margin-top: 1em\">This\n<b>SIGXCPU</b> signal is <i>process-directed</i> (see\n<a href=\"https://man.page/7/signal\">signal(7)</a>) rather than thread-directed. This is\nprobably a bug. On the one hand, <b>sched_setattr</b>() is\nbeing used to set a per-thread attribute. On the other hand,\nif the process-directed signal is delivered to a thread\ninside the process other than the one that had a run-time\noverrun, the application has no way of knowing which thread\noverran.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_nice</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the nice\nvalue to be set when specifying <i>sched_policy</i> as\n<b>SCHED_OTHER</b> or <b>SCHED_BATCH</b>. The nice value is\na number in the range -20 (high priority) to +19 (low\npriority); see <a href=\"https://man.page/7/sched\">sched(7)</a>.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_priority</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the static\npriority to be set when specifying <i>sched_policy</i> as\n<b>SCHED_FIFO</b> or <b>SCHED_RR</b>. The allowed range of\npriorities for these policies can be determined using\n<a href=\"https://man.page/2/sched_get_priority_min\">sched_get_priority_min(2)</a> and\n<a href=\"https://man.page/2/sched_get_priority_max\">sched_get_priority_max(2)</a>. For other policies, this\nfield must be specified as 0.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_runtime</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the\n&quot;Runtime&quot; parameter for deadline scheduling. The\nvalue is expressed in nanoseconds. This field, and the next\ntwo fields, are used only for <b>SCHED_DEADLINE</b>\nscheduling; for further details, see <a href=\"https://man.page/7/sched\">sched(7)</a>.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_deadline</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the\n&quot;Deadline&quot; parameter for deadline scheduling. The\nvalue is expressed in nanoseconds.</p>\n\n<p style=\"margin-left:11%;\"><i>sched_period</i></p>\n\n<p style=\"margin-left:22%;\">This field specifies the\n&quot;Period&quot; parameter for deadline scheduling. The\nvalue is expressed in nanoseconds.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument is provided to allow for future\nextensions to the interface; in the current implementation\nit must be specified as 0.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>sched_getattr()</b>\n<br>\nThe <b>sched_getattr</b>() system call fetches the\nscheduling policy and the associated attributes for the\nthread whose ID is specified in <i>pid</i>. If <i>pid</i>\nequals zero, the scheduling policy and attributes of the\ncalling thread will be retrieved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>size</i>\nargument should be set to the size of the <i>sched_attr</i>\nstructure as known to user space. The value must be at least\nas large as the size of the initially published\n<i>sched_attr</i> structure, or the call fails with the\nerror <b>EINVAL</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The retrieved\nscheduling attributes are placed in the fields of the\n<i>sched_attr</i> structure pointed to by <i>attr</i>. The\nkernel sets <i>attr.size</i> to the size of its\n<i>sched_attr</i> structure.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\ncaller-provided <i>attr</i> buffer is larger than the\nkernel&rsquo;s <i>sched_attr</i> structure, the additional\nbytes in the user-space structure are not touched. If the\ncaller-provided structure is smaller than the kernel\n<i>sched_attr</i> structure, the kernel will silently not\nreturn any values which would be stored outside the provided\nspace. As with <b>sched_setattr</b>(), these semantics allow\nfor future extensibility of the interface.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument is provided to allow for future\nextensions to the interface; in the current implementation\nit must be specified as 0.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\n<b>sched_setattr</b>() and <b>sched_getattr</b>() return 0.\nOn error, -1 is returned, and <i>errno</i> is set to\nindicate the cause of the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>sched_getattr</b>()\nand <b>sched_setattr</b>() can both fail for the following\nreasons:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>attr</i> is NULL; or <i>pid</i> is negative; or\n<i>flags</i> is not zero.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ESRCH</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The thread whose ID is <i>pid</i> could not be\nfound.</p> </td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In addition,\n<b>sched_getattr</b>() can fail for the following\nreasons:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>E2BIG</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">The buffer specified by\n<i>size</i> and <i>attr</i> is too small.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>size</i> is invalid; that is, it is smaller than the\ninitial version of the <i>sched_attr</i> structure (48\nbytes) or larger than the system page size.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In addition,\n<b>sched_setattr</b>() can fail for the following\nreasons:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>E2BIG</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">The buffer specified by\n<i>size</i> and <i>attr</i> is larger than the kernel\nstructure, and one or more of the excess bytes is\nnonzero.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EBUSY</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><b>SCHED_DEADLINE</b> admission control failure, see\n<a href=\"https://man.page/7/sched\">sched(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>attr.sched_policy</i> is not one of the recognized\npolicies; <i>attr.sched_flags</i> contains a flag other than\n<b>SCHED_FLAG_RESET_ON_FORK</b>; or\n<i>attr.sched_priority</i> is invalid; or\n<i>attr.sched_policy</i> is <b>SCHED_DEADLINE</b> and the\ndeadline scheduling parameters in <i>attr</i> are\ninvalid.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EPERM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The caller does not have appropriate privileges.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EPERM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The CPU affinity mask of the thread specified by\n<i>pid</i> does not include all CPUs in the system (see\n<a href=\"https://man.page/2/sched_setaffinity\">sched_setaffinity(2)</a>).</p> </td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These system\ncalls first appeared in Linux 3.14.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These system\ncalls are nonstandard Linux extensions.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>sched_setattr</b>()\nprovides a superset of the functionality of\n<a href=\"https://man.page/2/sched_setscheduler\">sched_setscheduler(2)</a>, <a href=\"https://man.page/2/sched_setparam\">sched_setparam(2)</a>,\n<a href=\"https://man.page/2/nice\">nice(2)</a>, and (other than the ability to set the\npriority of all processes belonging to a specified user or\nall processes in a specified group) <a href=\"https://man.page/2/setpriority\">setpriority(2)</a>.\nAnalogously, <b>sched_getattr</b>() provides a superset of\nthe functionality of <a href=\"https://man.page/2/sched_getscheduler\">sched_getscheduler(2)</a>,\n<a href=\"https://man.page/2/sched_getparam\">sched_getparam(2)</a>, and (partially)\n<a href=\"https://man.page/2/getpriority\">getpriority(2)</a>.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">In Linux\nversions up to 3.15, <b>sched_setattr</b>() failed with the\nerror <b>EFAULT</b> instead of <b>E2BIG</b> for the case\ndescribed in ERRORS.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In Linux\nversions up to 5.3, <b>sched_getattr</b>() failed with the\nerror <b>EFBIG</b> if the in-kernel <i>sched_attr</i>\nstructure was larger than the <i>size</i> passed by user\nspace.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/chrt\">chrt(1)</a>,\n<a href=\"https://man.page/2/nice\">nice(2)</a>, <a href=\"https://man.page/2/sched_get_priority_max\">sched_get_priority_max(2)</a>,\n<a href=\"https://man.page/2/sched_get_priority_min\">sched_get_priority_min(2)</a>,\n<a href=\"https://man.page/2/sched_getaffinity\">sched_getaffinity(2)</a>, <a href=\"https://man.page/2/sched_getparam\">sched_getparam(2)</a>,\n<a href=\"https://man.page/2/sched_getscheduler\">sched_getscheduler(2)</a>,\n<a href=\"https://man.page/2/sched_rr_get_interval\">sched_rr_get_interval(2)</a>,\n<a href=\"https://man.page/2/sched_setaffinity\">sched_setaffinity(2)</a>, <a href=\"https://man.page/2/sched_setparam\">sched_setparam(2)</a>,\n<a href=\"https://man.page/2/sched_setscheduler\">sched_setscheduler(2)</a>, <a href=\"https://man.page/2/sched_yield\">sched_yield(2)</a>,\n<a href=\"https://man.page/2/setpriority\">setpriority(2)</a>, <a href=\"https://man.page/3/pthread_getschedparam\">pthread_getschedparam(3)</a>,\n<a href=\"https://man.page/3/pthread_setschedparam\">pthread_setschedparam(3)</a>,\n<a href=\"https://man.page/3/pthread_setschedprio\">pthread_setschedprio(3)</a>, <a href=\"https://man.page/7/capabilities\">capabilities(7)</a>,\n<a href=\"https://man.page/7/cpuset\">cpuset(7)</a>, <a href=\"https://man.page/7/sched\">sched(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}