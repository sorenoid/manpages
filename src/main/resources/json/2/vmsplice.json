{"name":"vmsplice","description":"vmsplice - splice user pages to/from a pipe","body":"\n\n<h1 align=\"center\">VMSPLICE</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">vmsplice -\nsplice user pages to/from a pipe</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#define\n_GNU_SOURCE</b> /* See feature_test_macros(7) */ <b><br>\n#include &lt;fcntl.h&gt; <br>\n#include &lt;sys/uio.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>ssize_t\nvmsplice(int</b> <i>fd</i><b>, const struct iovec\n*</b><i>iov</i><b>, <br>\nunsigned long</b> <i>nr_segs</i><b>, unsigned int</b>\n<i>flags</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>fd</i> is\nopened for writing, the <b>vmsplice</b>() system call maps\n<i>nr_segs</i> ranges of user memory described by <i>iov</i>\ninto a pipe. If <i>fd</i> is opened for reading, the\n<b>vmsplice</b>() system call fills <i>nr_segs</i> ranges of\nuser memory described by <i>iov</i> from a pipe. The file\ndescriptor <i>fd</i> must refer to a pipe.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The pointer\n<i>iov</i> points to an array of <i>iovec</i> structures as\ndefined in <i>&lt;sys/uio.h&gt;</i>:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct iovec {\n<br>\nvoid *iov_base; /* Starting address */ <br>\nsize_t iov_len; /* Number of bytes */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument is a bit mask that is composed by\nORing together zero or more of the following values: <b><br>\nSPLICE_F_MOVE</b></p>\n\n<p style=\"margin-left:22%;\">Unused for <b>vmsplice</b>();\nsee <a href=\"https://man.page/2/splice\">splice(2)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>SPLICE_F_NONBLOCK</b></p>\n\n<p style=\"margin-left:22%;\">Do not block on I/O; see\n<a href=\"https://man.page/2/splice\">splice(2)</a> for further details.</p>\n\n<p style=\"margin-left:11%;\"><b>SPLICE_F_MORE</b></p>\n\n<p style=\"margin-left:22%;\">Currently has no effect for\n<b>vmsplice</b>(), but may be implemented in the future; see\n<a href=\"https://man.page/2/splice\">splice(2)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>SPLICE_F_GIFT</b></p>\n\n<p style=\"margin-left:22%;\">The user pages are a gift to\nthe kernel. The application may not modify this memory ever,\notherwise the page cache and on-disk data may differ.\nGifting pages to the kernel means that a subsequent\n<a href=\"https://man.page/2/splice\">splice(2)</a> <b>SPLICE_F_MOVE</b> can successfully move\nthe pages; if this flag is not specified, then a subsequent\n<a href=\"https://man.page/2/splice\">splice(2)</a> <b>SPLICE_F_MOVE</b> must copy the pages.\nData must also be properly page aligned, both in memory and\nlength.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Upon successful\ncompletion, <b>vmsplice</b>() returns the number of bytes\ntransferred to the pipe. On error, <b>vmsplice</b>() returns\n-1 and <i>errno</i> is set to indicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EAGAIN</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\"><b>SPLICE_F_NONBLOCK</b> was\nspecified in <i>flags</i>, and the operation would\nblock.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EBADF</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>fd</i> either not valid, or doesn&rsquo;t refer to a\npipe.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>nr_segs</i> is greater than <b>IOV_MAX</b>; or memory\nnot aligned if <b>SPLICE_F_GIFT</b> set.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOMEM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Out of memory.</p></td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>vmsplice</b>() system call first appeared in Linux\n2.6.17; library support was added to glibc in version\n2.5.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This system\ncall is Linux-specific.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>vmsplice</b>()\nfollows the other vectorized read/write type functions when\nit comes to limitations on the number of segments being\npassed in. This limit is <b>IOV_MAX</b> as defined in\n<i>&lt;limits.h&gt;</i>. Currently, this limit is 1024.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>vmsplice</b>()\nreally supports true splicing only from user memory to a\npipe. In the opposite direction, it actually just copies the\ndata to userspace. But this makes the interface nice and\nsymmetric and enables people to build on <b>vmsplice</b>()\nwith room for future improvement in performance.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/splice\">splice(2)</a>,\n<a href=\"https://man.page/2/tee\">tee(2)</a>, <a href=\"https://man.page/7/pipe\">pipe(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}