{"name":"clock_nanosleep","body":"\n\n<h1 align=\"center\">CLOCK_NANOSLEEP</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">clock_nanosleep\n- high-resolution sleep with specifiable clock</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;time.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nclock_nanosleep(clockid_t</b> <i>clockid</i><b>, int</b>\n<i>flags</i><b>, <br>\nconst struct timespec *</b><i>request</i><b>, <br>\nstruct timespec *</b><i>remain</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Link with\n<i>-lrt</i> (only for glibc versions before 2.17).</p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>clock_nanosleep</b>():</p>\n\n\n<p style=\"margin-left:17%;\">_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;200112L</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Like\n<a href=\"https://man.page/2/nanosleep\">nanosleep(2)</a>, <b>clock_nanosleep</b>() allows the\ncalling thread to sleep for an interval specified with\nnanosecond precision. It differs in allowing the caller to\nselect the clock against which the sleep interval is to be\nmeasured, and in allowing the sleep interval to be specified\nas either an absolute or a relative value.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The time values\npassed to and returned by this call are specified using\n<i>timespec</i> structures, defined as follows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct timespec\n{ <br>\ntime_t tv_sec; /* seconds */ <br>\nlong tv_nsec; /* nanoseconds [0 .. 999999999] */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>clockid</i> argument specifies the clock against which\nthe sleep interval is to be measured. This argument can have\none of the following values: <b><br>\nCLOCK_REALTIME</b></p>\n\n<p style=\"margin-left:22%;\">A settable system-wide\nreal-time clock.</p>\n\n<p style=\"margin-left:11%;\"><b>CLOCK_TAI</b> (since Linux\n3.10)</p>\n\n<p style=\"margin-left:22%;\">A system-wide clock derived\nfrom wall-clock time but ignoring leap seconds.</p>\n\n<p style=\"margin-left:11%;\"><b>CLOCK_MONOTONIC</b></p>\n\n<p style=\"margin-left:22%;\">A nonsettable, monotonically\nincreasing clock that measures time since some unspecified\npoint in the past that does not change after system\nstartup.</p>\n\n<p style=\"margin-left:11%;\"><b>CLOCK_BOOTIME</b> (since\nLinux 2.6.39)</p>\n\n<p style=\"margin-left:22%;\">Identical to\n<b>CLOCK_MONOTONIC</b>, except that it also includes any\ntime that the system is suspended.</p>\n\n\n<p style=\"margin-left:11%;\"><b>CLOCK_PROCESS_CPUTIME_ID</b></p>\n\n<p style=\"margin-left:22%;\">A settable per-process clock\nthat measures CPU time consumed by all threads in the\nprocess.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">See\n<a href=\"https://man.page/2/clock_getres\">clock_getres(2)</a> for further details on these clocks.\nIn addition, the CPU clock IDs returned by\n<a href=\"https://man.page/3/clock_getcpuclockid\">clock_getcpuclockid(3)</a> and\n<a href=\"https://man.page/3/pthread_getcpuclockid\">pthread_getcpuclockid(3)</a> can also be passed in\n<i>clockid</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nis 0, then the value specified in <i>request</i> is\ninterpreted as an interval relative to the current value of\nthe clock specified by <i>clockid</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nis <b>TIMER_ABSTIME</b>, then <i>request</i> is interpreted\nas an absolute time as measured by the clock,\n<i>clockid</i>. If <i>request</i> is less than or equal to\nthe current value of the clock, then\n<b>clock_nanosleep</b>() returns immediately without\nsuspending the calling thread.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>clock_nanosleep</b>()\nsuspends the execution of the calling thread until either at\nleast the time specified by <i>request</i> has elapsed, or a\nsignal is delivered that causes a signal handler to be\ncalled or that terminates the process.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the call is\ninterrupted by a signal handler, <b>clock_nanosleep</b>()\nfails with the error <b>EINTR</b>. In addition, if\n<i>remain</i> is not NULL, and <i>flags</i> was not\n<b>TIMER_ABSTIME</b>, it returns the remaining unslept time\nin <i>remain</i>. This value can then be used to call\n<b>clock_nanosleep</b>() again and complete a (relative)\nsleep.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On successfully\nsleeping for the requested interval,\n<b>clock_nanosleep</b>() returns 0. If the call is\ninterrupted by a signal handler or encounters an error, then\nit returns one of the positive error number listed in\nERRORS.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\"><i>request</i> or <i>remain</i>\nspecified an invalid address.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINTR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The sleep was interrupted by a signal handler; see\n<a href=\"https://man.page/7/signal\">signal(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The value in the <i>tv_nsec</i> field was not in the\nrange 0 to 999999999 or <i>tv_sec</i> was negative.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>clockid</i> was invalid.\n(<b>CLOCK_THREAD_CPUTIME_ID</b> is not a permitted value for\n<i>clockid</i>.)</p> </td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENOTSUP</b></p>\n\n<p style=\"margin-left:22%;\">The kernel does not support\nsleeping against this <i>clockid</i>.</p>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>clock_nanosleep</b>() system call first appeared in Linux\n2.6. Support is available in glibc since version 2.1.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the interval\nspecified in <i>request</i> is not an exact multiple of the\ngranularity underlying clock (see <a href=\"https://man.page/7/time\">time(7)</a>), then the\ninterval will be rounded up to the next multiple.\nFurthermore, after the sleep completes, there may still be a\ndelay before the CPU becomes free to once again execute the\ncalling thread.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Using an\nabsolute timer is useful for preventing timer drift problems\nof the type described in <a href=\"https://man.page/2/nanosleep\">nanosleep(2)</a>. (Such problems\nare exacerbated in programs that try to restart a relative\nsleep that is repeatedly interrupted by signals.) To perform\na relative sleep that avoids these problems, call\n<a href=\"https://man.page/2/clock_gettime\">clock_gettime(2)</a> for the desired clock, add the\ndesired interval to the returned time value, and then call\n<b>clock_nanosleep</b>() with the <b>TIMER_ABSTIME</b>\nflag.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>clock_nanosleep</b>()\nis never restarted after being interrupted by a signal\nhandler, regardless of the use of the <a href=\"https://man.page/2/sigaction\">sigaction(2)</a>\n<b>SA_RESTART</b> flag.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>remain</i> argument is unused, and unnecessary, when\n<i>flags</i> is <b>TIMER_ABSTIME</b>. (An absolute sleep can\nbe restarted using the same <i>request</i> argument.)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1\nspecifies that <b>clock_nanosleep</b>() has no effect on\nsignals dispositions or the signal mask.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1\nspecifies that after changing the value of the\n<b>CLOCK_REALTIME</b> clock via <a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a>, the\nnew clock value shall be used to determine the time at which\na thread blocked on an absolute <b>clock_nanosleep</b>()\nwill wake up; if the new clock value falls past the end of\nthe sleep interval, then the <b>clock_nanosleep</b>() call\nwill return immediately.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1\nspecifies that changing the value of the\n<b>CLOCK_REALTIME</b> clock via <a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a>\nshall have no effect on a thread that is blocked on a\nrelative <b>clock_nanosleep</b>().</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/clock_getres\">clock_getres(2)</a>,\n<a href=\"https://man.page/2/nanosleep\">nanosleep(2)</a>, <a href=\"https://man.page/2/restart_syscall\">restart_syscall(2)</a>,\n<a href=\"https://man.page/2/timer_create\">timer_create(2)</a>, <a href=\"https://man.page/3/sleep\">sleep(3)</a>, <a href=\"https://man.page/3/usleep\">usleep(3)</a>,\n<a href=\"https://man.page/7/time\">time(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}