{"name":"execveat","description":"execveat - execute program relative to a directory file descriptor","body":"\n\n<h1 align=\"center\">EXECVEAT</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">execveat -\nexecute program relative to a directory file descriptor</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;unistd.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nexecveat(int</b> <i>dirfd</i><b>, const char\n*</b><i>pathname</i><b>, <br>\nchar *const</b> <i>argv</i><b>[], char *const</b>\n<i>envp</i><b>[], <br>\nint</b> <i>flags</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>execveat</b>() system call executes the program referred\nto by the combination of <i>dirfd</i> and <i>pathname</i>.\nIt operates in exactly the same way as <a href=\"https://man.page/2/execve\">execve(2)</a>,\nexcept for the differences described in this manual\npage.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the pathname\ngiven in <i>pathname</i> is relative, then it is interpreted\nrelative to the directory referred to by the file descriptor\n<i>dirfd</i> (rather than relative to the current working\ndirectory of the calling process, as is done by\n<a href=\"https://man.page/2/execve\">execve(2)</a> for a relative pathname).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If\n<i>pathname</i> is relative and <i>dirfd</i> is the special\nvalue <b>AT_FDCWD</b>, then <i>pathname</i> is interpreted\nrelative to the current working directory of the calling\nprocess (like <a href=\"https://man.page/2/execve\">execve(2)</a>).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If\n<i>pathname</i> is absolute, then <i>dirfd</i> is\nignored.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If\n<i>pathname</i> is an empty string and the\n<b>AT_EMPTY_PATH</b> flag is specified, then the file\ndescriptor <i>dirfd</i> specifies the file to be executed\n(i.e., <i>dirfd</i> refers to an executable file, rather\nthan a directory).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>flags</i> argument is a bit mask that can include zero or\nmore of the following flags: <b><br>\nAT_EMPTY_PATH</b></p>\n\n<p style=\"margin-left:22%;\">If <i>pathname</i> is an empty\nstring, operate on the file referred to by <i>dirfd</i>\n(which may have been obtained using the <a href=\"https://man.page/2/open\">open(2)</a>\n<b>O_PATH</b> flag).</p>\n\n<p style=\"margin-left:11%;\"><b>AT_SYMLINK_NOFOLLOW</b></p>\n\n<p style=\"margin-left:22%;\">If the file identified by\n<i>dirfd</i> and a non-NULL <i>pathname</i> is a symbolic\nlink, then the call fails with the error <b>ELOOP</b>.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\n<b>execveat</b>() does not return. On error, -1 is returned,\nand <i>errno</i> is set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The same errors\nthat occur for <a href=\"https://man.page/2/execve\">execve(2)</a> can also occur for\n<b>execveat</b>(). The following additional errors can occur\nfor <b>execveat</b>():</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EBADF</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>dirfd</i> is not a valid file descriptor.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Invalid flag specified in <i>flags</i>.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ELOOP</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>flags</i> includes <b>AT_SYMLINK_NOFOLLOW</b> and the\nfile identified by <i>dirfd</i> and a non-NULL\n<i>pathname</i> is a symbolic link.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The program identified by <i>dirfd</i> and\n<i>pathname</i> requires the use of an interpreter program\n(such as a script starting with &quot;#!&quot;), but the\nfile descriptor <i>dirfd</i> was opened with the\n<b>O_CLOEXEC</b> flag, with the result that the program file\nis inaccessible to the launched interpreter. See BUGS.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENOTDIR</b></p>\n\n<p style=\"margin-left:22%;\"><i>pathname</i> is relative and\n<i>dirfd</i> is a file descriptor referring to a file other\nthan a directory.</p>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>execveat</b>()\nwas added to Linux in kernel 3.19. GNU C library support is\npending.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>execveat</b>() system call is Linux-specific.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">In addition to\nthe reasons explained in <a href=\"https://man.page/2/openat\">openat(2)</a>, the\n<b>execveat</b>() system call is also needed to allow\n<a href=\"https://man.page/3/fexecve\">fexecve(3)</a> to be implemented on systems that do not\nhave the <i>/proc</i> filesystem mounted.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When asked to\nexecute a script file, the <i>argv[0]</i> that is passed to\nthe script interpreter is a string of the form\n<i>/dev/fd/N</i> or <i>/dev/fd/N/P</i>, where <i>N</i> is\nthe number of the file descriptor passed via the\n<i>dirfd</i> argument. A string of the first form occurs\nwhen <b>AT_EMPTY_PATH</b> is employed. A string of the\nsecond form occurs when the script is specified via both\n<i>dirfd</i> and <i>pathname</i>; in this case, <i>P</i> is\nthe value given in <i>pathname</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For the same\nreasons described in <a href=\"https://man.page/3/fexecve\">fexecve(3)</a>, the natural idiom\nwhen using <b>execveat</b>() is to set the close-on-exec\nflag on <i>dirfd</i>. (But see BUGS.)</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>ENOENT</b> error described above means that it is not\npossible to set the close-on-exec flag on the file\ndescriptor given to a call of the form:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">execveat(fd,\n&quot;&quot;, argv, envp, AT_EMPTY_PATH);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">However, the\ninability to set the close-on-exec flag means that a file\ndescriptor referring to the script leaks through to the\nscript itself. As well as wasting a file descriptor, this\nleakage can lead to file-descriptor exhaustion in scenarios\nwhere scripts recursively employ <b>execveat</b>().</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/execve\">execve(2)</a>,\n<a href=\"https://man.page/2/openat\">openat(2)</a>, <a href=\"https://man.page/3/fexecve\">fexecve(3)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}