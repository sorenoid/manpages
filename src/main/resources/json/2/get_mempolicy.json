{"name":"get_mempolicy","description":"get_mempolicy - retrieve NUMA memory policy for a thread","body":"\n\n<h1 align=\"center\">GET_MEMPOLICY</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">get_mempolicy -\nretrieve NUMA memory policy for a thread</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;numaif.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>long\nget_mempolicy(int *</b><i>mode</i><b>, unsigned long\n*</b><i>nodemask</i><b>, <br>\nunsigned long</b> <i>maxnode</i><b>, void\n*</b><i>addr</i><b>, <br>\nunsigned long</b> <i>flags</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Link with\n<i>-lnuma</i>.</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>get_mempolicy</b>()\nretrieves the NUMA policy of the calling thread or of a\nmemory address, depending on the setting of\n<i>flags</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A NUMA machine\nhas different memory controllers with different distances to\nspecific CPUs. The memory policy defines from which node\nmemory is allocated for the thread.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nis specified as 0, then information about the calling\nthread&rsquo;s default policy (as set by\n<a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>) is returned, in the buffers pointed\nto by <i>mode</i> and <i>nodemask</i>. The value returned in\nthese arguments may be used to restore the thread&rsquo;s\npolicy to its state at the time of the call to\n<b>get_mempolicy</b>() using <a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>. When\n<i>flags</i> is 0, <i>addr</i> must be specified as\nNULL.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nspecifies <b>MPOL_F_MEMS_ALLOWED</b> (available since Linux\n2.6.24), the <i>mode</i> argument is ignored and the set of\nnodes (memories) that the thread is allowed to specify in\nsubsequent calls to <a href=\"https://man.page/2/mbind\">mbind(2)</a> or\n<a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a> (in the absence of any <i>mode\nflags</i>) is returned in <i>nodemask</i>. It is not\npermitted to combine <b>MPOL_F_MEMS_ALLOWED</b> with either\n<b>MPOL_F_ADDR</b> or <b>MPOL_F_NODE</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nspecifies <b>MPOL_F_ADDR</b>, then information is returned\nabout the policy governing the memory address given in\n<i>addr</i>. This policy may be different from the\nthread&rsquo;s default policy if <a href=\"https://man.page/2/mbind\">mbind(2)</a> or one of\nthe helper functions described in <a href=\"https://man.page/3/numa\">numa(3)</a> has been\nused to establish a policy for the memory range containing\n<i>addr</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\n<i>mode</i> argument is not NULL, then\n<b>get_mempolicy</b>() will store the policy mode and any\noptional <i>mode flags</i> of the requested NUMA policy in\nthe location pointed to by this argument. If <i>nodemask</i>\nis not NULL, then the nodemask associated with the policy\nwill be stored in the location pointed to by this argument.\n<i>maxnode</i> specifies the number of node IDs that can be\nstored into <i>nodemask</i>&mdash;that is, the maximum node\nID plus one. The value specified by <i>maxnode</i> is always\nrounded to a multiple of\n<i>sizeof(unsigned&nbsp;long)*8</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nspecifies both <b>MPOL_F_NODE</b> and <b>MPOL_F_ADDR</b>,\n<b>get_mempolicy</b>() will return the node ID of the node\non which the address <i>addr</i> is allocated into the\nlocation pointed to by <i>mode</i>. If no page has yet been\nallocated for the specified address, <b>get_mempolicy</b>()\nwill allocate a page as if the thread had performed a read\n(load) access to that address, and return the ID of the node\nwhere that page was allocated.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>flags</i>\nspecifies <b>MPOL_F_NODE</b>, but not <b>MPOL_F_ADDR</b>,\nand the thread&rsquo;s current policy is\n<b>MPOL_INTERLEAVE</b>, then <b>get_mempolicy</b>() will\nreturn in the location pointed to by a non-NULL <i>mode</i>\nargument, the node ID of the next node that will be used for\ninterleaving of internal kernel pages allocated on behalf of\nthe thread. These allocations include pages for\nmemory-mapped files in process memory ranges mapped using\nthe <a href=\"https://man.page/2/mmap\">mmap(2)</a> call with the <b>MAP_PRIVATE</b> flag for\nread accesses, and in memory ranges mapped with the\n<b>MAP_SHARED</b> flag for all accesses.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Other flag\nvalues are reserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an overview\nof the possible policies see <a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\n<b>get_mempolicy</b>() returns 0; on error, -1 is returned\nand <i>errno</i> is set to indicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EFAULT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Part of all of the memory range\nspecified by <i>nodemask</i> and <i>maxnode</i> points\noutside your accessible address space.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The value specified by <i>maxnode</i> is less than the\nnumber of node IDs supported by the system. Or <i>flags</i>\nspecified values other than <b>MPOL_F_NODE</b> or\n<b>MPOL_F_ADDR</b>; or <i>flags</i> specified\n<b>MPOL_F_ADDR</b> and <i>addr</i> is NULL, or <i>flags</i>\ndid not specify <b>MPOL_F_ADDR</b> and <i>addr</i> is not\nNULL. Or, <i>flags</i> specified <b>MPOL_F_NODE</b> but not\n<b>MPOL_F_ADDR</b> and the current thread policy is not\n<b>MPOL_INTERLEAVE</b>. Or, <i>flags</i> specified\n<b>MPOL_F_MEMS_ALLOWED</b> with either <b>MPOL_F_ADDR</b> or\n<b>MPOL_F_NODE</b>. (And there are other <b>EINVAL</b>\ncases.)</p> </td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>get_mempolicy</b>() system call was added to the Linux\nkernel in version 2.6.7.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This system\ncall is Linux-specific.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For information\non library support, see <a href=\"https://man.page/7/numa\">numa(7)</a>.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/getcpu\">getcpu(2)</a>,\n<a href=\"https://man.page/2/mbind\">mbind(2)</a>, <a href=\"https://man.page/2/mmap\">mmap(2)</a>, <a href=\"https://man.page/2/set_mempolicy\">set_mempolicy(2)</a>,\n<a href=\"https://man.page/3/numa\">numa(3)</a>, <a href=\"https://man.page/7/numa\">numa(7)</a>, <b>numactl</b>(8)</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":2}