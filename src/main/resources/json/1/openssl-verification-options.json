{"name":"openssl-verification-options","description":"openssl-verification-options - generic X.509 certificate verification options","body":"\n\n<h1 align=\"center\">OPENSSL-VERIFICATION-OPTIONS</h1>\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl-verification-options\n- generic X.509 certificate verification options</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl</b>\n<i>command</i> [ <i>options</i> ... ] [ <i>parameters</i>\n... ]</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">There are many\nsituations where X.509 certificates are verified within the\nOpenSSL libraries and in various OpenSSL commands.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Certificate\nverification is implemented by <a href=\"https://man.page/3/X509_verify_cert\">X509_verify_cert(3)</a>.\nIt is a complicated process consisting of a number of steps\nand depending on numerous options. The most important of\nthem are detailed in the following sections.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In a nutshell,\na valid chain of certificates needs to be built up and\nverified starting from the <i>target certificate</i> that is\nto be verified and ending in a certificate that due to some\npolicy is trusted. Verification is done relative to the\ngiven <i>purpose</i>, which is the intended use of the\ntarget certificate, such as <small>SSL</small> server, or by\ndefault for any purpose.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The details of\nhow each OpenSSL command handles errors are documented on\nthe specific command page.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><small>DANE</small>\nsupport is documented in <a href=\"https://man.page/1/openssl-s_client\">openssl-s_client(1)</a>,\n<a href=\"https://man.page/3/SSL_CTX_dane_enable\">SSL_CTX_dane_enable(3)</a>, <a href=\"https://man.page/3/SSL_set1_host\">SSL_set1_host(3)</a>,\n<a href=\"https://man.page/3/X509_VERIFY_PARAM_set_flags\">X509_VERIFY_PARAM_set_flags(3)</a>, and\n<a href=\"https://man.page/3/X509_check_host\">X509_check_host(3)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Trust\nAnchors</b> <br>\nIn general, according to <small>RFC 4158</small> and\n<small>RFC 5280,</small> a <i>trust anchor</i> is any public\nkey and related subject distinguished name (\n<small>DN</small> ) that for some reason is considered\ntrusted and thus is acceptable as the root of a chain of\ncertificates.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In practice,\ntrust anchors are given in the form of certificates, where\ntheir essential fields are the public key and the subject\n<small>DN.</small> In addition to the requirements in\n<small>RFC 5280,</small> OpenSSL checks the validity period\nof such certificates and makes use of some further fields.\nIn particular, the subject key identifier extension, if\npresent, is used for matching trust anchors during chain\nbuilding.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In the most\nsimple and common case, trust anchors are by default all\nself-signed &quot;root&quot; <small>CA</small> certificates\nthat are placed in the <i>trust store</i>, which is a\ncollection of certificates that are trusted for certain\nuses. This is akin to what is used in the trust stores of\nMozilla Firefox, or Apple&rsquo;s and Microsoft&rsquo;s\ncertificate stores, ...</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">From the\nOpenSSL perspective, a trust anchor is a certificate that\nshould be augmented with an explicit designation for which\nuses of a target certificate the certificate may serve as a\ntrust anchor. In <small>PEM</small> encoding, this is\nindicated by the &quot;TRUSTED CERTIFICATE&quot; string.\nSuch a designation provides a set of positive trust\nattributes explicitly stating trust for the listed purposes\nand/or a set of negative trust attributes explicitly\nrejecting the use for the listed purposes. The purposes are\nencoded using the values defined for the extended key usages\n(EKUs) that may be given in X.509 extensions of end-entity\ncertificates. See also the &quot;Extended Key Usage&quot;\nsection below.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The currently\nrecognized uses are <b>clientAuth</b> ( <small>SSL</small>\nclient use), <b>serverAuth</b> ( <small>SSL</small> server\nuse), <b>emailProtection</b> (S/MIME email use),\n<b>codeSigning</b> (object signer use), <b>OCSPSigning</b> (\n<small>OCSP</small> responder use),\n<b><small>OCSP</small></b> ( <small>OCSP</small> request\nuse), <b>timeStamping</b> ( <small>TSA</small> server use),\nand <b>anyExtendedKeyUsage</b>. As of OpenSSL 1.1.0, the\nlast of these blocks all uses when rejected or enables all\nuses when trusted.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A certificate,\nwhich may be <small>CA</small> certificate or an end-entity\ncertificate, is considered a trust anchor for the given use\nif and only if all the following conditions hold:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>It is an an element of the trust store.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>It does not have a negative trust attribute rejecting\nthe given use.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>It has a positive trust attribute accepting the given\nuse or (by default) one of the following compatibilty\nconditions apply: It is self-signed or the\n<b>-partial_chain</b> option is given (which corresponds to\nthe <b>X509_V_FLAG_PARTIAL_CHAIN</b> flag being set).</p></td></tr>\n</table>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Certification\nPath Building</b> <br>\nFirst, a certificate chain is built up starting from the\ntarget certificate and ending in a trust anchor.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The chain is\nbuilt up iteratively, looking up in turn a certificate with\nsuitable key usage that matches as an issuer of the current\n&quot;subject&quot; certificate as described below. If there\nis such a certificate, the first one found that is currently\nvalid is taken, otherwise the one that expired most recently\nof all such certificates. For efficiency, no backtracking is\nperformed, thus any further candidate issuer certificates\nthat would match equally are ignored.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When a\nself-signed certificate has been added, chain construction\nstops. In this case it must fully match a trust anchor,\notherwise chain building fails.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A candidate\nissuer certificate matches a subject certificate if all of\nthe following conditions hold:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p style=\"margin-top: 1em\">Its subject name matches the\nissuer name of the subject certificate.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>If the subject certificate has an authority key\nidentifier extension, each of its sub-fields equals the\ncorresponding subject key identifier, serial number, and\nissuer field of the candidate issuer certificate, as far as\nthe respective fields are present in both certificates.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>The certificate signature algorithm used to sign the\nsubject certificate is supported and equals the public key\nalgorithm of the candidate issuer certificate.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The lookup\nfirst searches for issuer certificates in the trust store.\nIf it does not find a match there it consults the list of\nuntrusted (&quot;intermediate&quot; <small>CA</small> )\ncertificates, if provided.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Certification\nPath Validation</b> <br>\nWhen the certificate chain building process was successful\nthe chain components and their links are checked\nthoroughly.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The first step\nis to check that each certificate is well-formed. Part of\nthese checks are enabled only if the <b>-x509_strict</b>\noption is given.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The second step\nis to check the extensions of every untrusted certificate\nfor consistency with the supplied purpose. If the\n<b>-purpose</b> option is not given then no such checks are\ndone except for <small>SSL/TLS</small> connection setup,\nwhere by default &quot;sslserver&quot; or\n&quot;sslclient&quot;, are checked. The target or\n&quot;leaf&quot; certificate, as well as any other untrusted\ncertificates, must have extensions compatible with the\nspecified purpose. All certificates except the target or\n&quot;leaf&quot; must also be valid <small>CA</small>\ncertificates. The precise extensions required are described\nin more detail in &quot; <small>CERTIFICATE\nEXTENSIONS&quot;</small> in <a href=\"https://man.page/1/openssl-x509\">openssl-x509(1)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The third step\nis to check the trust settings on the last certificate\n(which typically is a self-signed root <small>CA</small>\ncertificate). It must be trusted for the given use. For\ncompatibility with previous versions of OpenSSL, a\nself-signed certificate with no trust attributes is\nconsidered to be valid for all uses.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The fourth, and\nfinal, step is to check the validity of the certificate\nchain. For each element in the chain, including the root\n<small>CA</small> certificate, the validity period as\nspecified by the &quot;notBefore&quot; and\n&quot;notAfter&quot; fields is checked against the current\nsystem time. The <b>-attime</b> flag may be used to use a\nreference time other than &quot;now.&quot; The certificate\nsignature is checked as well (except for the signature of\nthe typically self-signed root <small>CA</small>\ncertificate, which is verified only if the\n<b>-check_ss_sig</b> option is given). When verifying a\ncertificate signature the keyUsage extension (if present) of\nthe candidate issuer certificate is checked to permit\ndigitalSignature for signing proxy certificates or to permit\nkeyCertSign for signing other certificates, respectively. If\nall operations complete successfully then certificate is\nconsidered valid. If any operation fails then the\ncertificate is not valid.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Trusted\nCertificate Options</b> <br>\nThe following options specify how to supply the certificates\nthat can be used as trust anchors for certain uses. As\nmentioned, a collection of such certificates is called a\n<i>trust store</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note that\nOpenSSL does not provide a default set of trust anchors.\nMany Linux distributions include a system default and\nconfigure OpenSSL to point to that. Mozilla maintains an\ninfluential trust store that can be found at\n&lt;https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/&gt;.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\ncertificates to add to the trust store can be specified\nusing following options. <b><br>\n-CAfile</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">Load the specified file which\ncontains a certificate or several of them in case the input\nis in <small>PEM</small> or PKCS#12 format. PEM-encoded\ncertificates may also have trust attributes set.</p>\n\n<p style=\"margin-left:11%;\"><b>-no-CAfile</b></p>\n\n<p style=\"margin-left:17%;\">Do not load the default file of\ntrusted certificates.</p>\n\n<p style=\"margin-left:11%;\"><b>-CApath</b> <i>dir</i></p>\n\n<p style=\"margin-left:17%;\">Use the specified directory as\na collection of trusted certificates, i.e., a trust store.\nFiles should be named with the hash value of the X.509\nSubjectName of each certificate. This is so that the library\ncan extract the IssuerName, hash it, and directly lookup the\nfile to get the issuer certificate. See\n<a href=\"https://man.page/1/openssl-rehash\">openssl-rehash(1)</a> for information on creating this\ntype of directory.</p>\n\n<p style=\"margin-left:11%;\"><b>-no-CApath</b></p>\n\n<p style=\"margin-left:17%;\">Do not use the default\ndirectory of trusted certificates.</p>\n\n<p style=\"margin-left:11%;\"><b>-CAstore</b> <i>uri</i></p>\n\n<p style=\"margin-left:17%;\">Use <i>uri</i> as a store of\n<small>CA</small> certificates. The <small>URI</small> may\nindicate a single certificate, as well as a collection of\nthem. With URIs in the &quot;file:&quot; scheme, this acts\nas <b>-CAfile</b> or <b>-CApath</b>, depending on if the\n<small>URI</small> indicates a single file or directory. See\n<a href=\"https://man.page/7/ossl_store-file\">ossl_store-file(7)</a> for more information on the\n&quot;file:&quot; scheme.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">These\ncertificates are also used when building the server\ncertificate chain (for example with\n<a href=\"https://man.page/1/openssl-s_server\">openssl-s_server(1)</a>) or client certificate chain (for\nexample with <a href=\"https://man.page/1/openssl-s_time\">openssl-s_time(1)</a>).</p>\n\n<p style=\"margin-left:11%;\"><b>-no-CAstore</b></p>\n\n<p style=\"margin-left:17%;\">Do not use the default store of\ntrusted <small>CA</small> certificates.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Verification\nOptions</b> <br>\nThe certificate verification can be fine-tuned with the\nfollowing flags. <b><br>\n-verbose</b></p>\n\n<p style=\"margin-left:17%;\">Print extra information about\nthe operations being performed.</p>\n\n<p style=\"margin-left:11%;\"><b>-attime</b>\n<i>timestamp</i></p>\n\n<p style=\"margin-left:17%;\">Perform validation checks using\ntime specified by <i>timestamp</i> and not current system\ntime. <i>timestamp</i> is the number of seconds since\nJanuary 1, 1970 (i.e., the Unix Epoch).</p>\n\n<p style=\"margin-left:11%;\"><b>-no_check_time</b></p>\n\n<p style=\"margin-left:17%;\">This option suppresses checking\nthe validity period of certificates and CRLs against the\ncurrent time. If option <b>-attime</b> is used to specify a\nverification time, the check is not suppressed.</p>\n\n<p style=\"margin-left:11%;\"><b>-x509_strict</b></p>\n\n<p style=\"margin-left:17%;\">This disables non-compliant\nworkarounds for broken certificates. Thus errors are thrown\non certificates not compliant with <small>RFC\n5280.</small></p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">When this\noption is set, among others, the following certificate\nwell-formedness conditions are checked:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The basicConstraints of <small>CA</small> certificates\nmust be marked critical.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p><small>CA</small> certificates must explicitly include\nthe keyUsage extension.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>If a pathlenConstraint is given the key usage\nkeyCertSign must be allowed.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The pathlenConstraint must not be given for non-CA\ncertificates.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The issuer name of any certificate must not be\nempty.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The subject name of <small>CA</small> certs, certs with\nkeyUsage crlSign, and certs without subjectAlternativeName\nmust not be empty.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>If a subjectAlternativeName extension is given it must\nnot be empty.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The signatureAlgorithm field and the cert signature must\nbe consistent.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>Any given authorityKeyIdentifier and any given\nsubjectKeyIdentifier must not be marked critical.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The authorityKeyIdentifier must be given for X.509v3\ncerts unless they are self-signed.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"17%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"77%\">\n\n\n<p>The subjectKeyIdentifier must be given for all X.509v3\n<small>CA</small> certs.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>-ignore_critical</b></p>\n\n<p style=\"margin-left:17%;\">Normally if an unhandled\ncritical extension is present that is not supported by\nOpenSSL the certificate is rejected (as required by\n<small>RFC5280</small> ). If this option is set critical\nextensions are ignored.</p>\n\n<p style=\"margin-left:11%;\"><b>-issuer_checks</b></p>\n\n<p style=\"margin-left:17%;\">Ignored.</p>\n\n<p style=\"margin-left:11%;\"><b>-crl_check</b></p>\n\n<p style=\"margin-left:17%;\">Checks end entity certificate\nvalidity by attempting to look up a valid\n<small>CRL.</small> If a valid <small>CRL</small> cannot be\nfound an error occurs.</p>\n\n<p style=\"margin-left:11%;\"><b>-crl_check_all</b></p>\n\n<p style=\"margin-left:17%;\">Checks the validity of\n<b>all</b> certificates in the chain by attempting to look\nup valid CRLs.</p>\n\n<p style=\"margin-left:11%;\"><b>-use_deltas</b></p>\n\n<p style=\"margin-left:17%;\">Enable support for delta\nCRLs.</p>\n\n<p style=\"margin-left:11%;\"><b>-extended_crl</b></p>\n\n<p style=\"margin-left:17%;\">Enable extended\n<small>CRL</small> features such as indirect CRLs and\nalternate <small>CRL</small> signing keys.</p>\n\n<p style=\"margin-left:11%;\"><b>-suiteB_128_only</b>,\n<b>-suiteB_128</b>, <b>-suiteB_192</b></p>\n\n<p style=\"margin-left:17%;\">Enable the Suite B mode\noperation at 128 bit Level of Security, 128 bit or 192 bit,\nor only 192 bit Level of Security respectively. See\n<small>RFC6460</small> for details. In particular the\nsupported signature algorithms are reduced to support only\n<small>ECDSA</small> and <small>SHA256</small> or\n<small>SHA384</small> and only the elliptic curves P-256 and\nP-384.</p>\n\n<p style=\"margin-left:11%;\"><b>-auth_level</b>\n<i>level</i></p>\n\n<p style=\"margin-left:17%;\">Set the certificate chain\nauthentication security level to <i>level</i>. The\nauthentication security level determines the acceptable\nsignature and public key strength when verifying certificate\nchains. For a certificate chain to validate, the public keys\nof all the certificates must meet the specified security\n<i>level</i>. The signature algorithm security level is\nenforced for all the certificates in the chain except for\nthe chain&rsquo;s <i>trust anchor</i>, which is either\ndirectly trusted or validated by means other than its\nsignature. See <a href=\"https://man.page/3/SSL_CTX_set_security_level\">SSL_CTX_set_security_level(3)</a> for the\ndefinitions of the available levels. The default security\nlevel is -1, or &quot;not set&quot;. At security level 0 or\nlower all algorithms are acceptable. Security level 1\nrequires at least 80-bit-equivalent security and is broadly\ninteroperable, though it will, for example, reject\n<small>MD5</small> signatures or <small>RSA</small> keys\nshorter than 1024 bits.</p>\n\n<p style=\"margin-left:11%;\"><b>-partial_chain</b></p>\n\n<p style=\"margin-left:17%;\">Allow verification to succeed\nif an incomplete chain can be built. That is, a chain ending\nin a certificate that normally would not be trusted (because\nit has no matching positive trust attributes and is not\nself-signed) but is an element of the trust store. This\ncertificate may be self-issued or belong to an intermediate\n<small>CA.</small></p>\n\n<p style=\"margin-left:11%;\"><b>-check_ss_sig</b></p>\n\n<p style=\"margin-left:17%;\">Verify the signature of the\nlast certificate in a chain if the certificate is supposedly\nself-signed. This is prohibited and will result in an error\nif it is a non-conforming <small>CA</small> certificate with\nkey usage restrictions not including the keyCertSign bit.\nThis verification is disabled by default because it\ndoesn&rsquo;t add any security.</p>\n\n<p style=\"margin-left:11%;\"><b>-allow_proxy_certs</b></p>\n\n<p style=\"margin-left:17%;\">Allow the verification of proxy\ncertificates.</p>\n\n<p style=\"margin-left:11%;\"><b>-trusted_first</b></p>\n\n<p style=\"margin-left:17%;\">As of OpenSSL 1.1.0 this option\nis on by default and cannot be disabled.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">When\nconstructing the certificate chain, the trusted certificates\nspecified via <b>-CAfile</b>, <b>-CApath</b>,\n<b>-CAstore</b> or <b>-trusted</b> are always used before\nany certificates specified via <b>-untrusted</b>.</p>\n\n<p style=\"margin-left:11%;\"><b>-no_alt_chains</b></p>\n\n<p style=\"margin-left:17%;\">As of OpenSSL 1.1.0, since\n<b>-trusted_first</b> always on, this option has no\neffect.</p>\n\n<p style=\"margin-left:11%;\"><b>-trusted</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">Parse <i>file</i> as a set of\none or more certificates. Each of them qualifies as trusted\nif has a suitable positive trust attribute or it is\nself-signed or the <b>-partial_chain</b> option is\nspecified. This option implies the <b>-no-CAfile</b>,\n<b>-no-CApath</b>, and <b>-no-CAstore</b> options and it\ncannot be used with the <b>-CAfile</b>, <b>-CApath</b> or\n<b>-CAstore</b> options, so only certificates specified\nusing the <b>-trusted</b> option are trust anchors. This\noption may be used multiple times.</p>\n\n<p style=\"margin-left:11%;\"><b>-untrusted</b>\n<i>file</i></p>\n\n<p style=\"margin-left:17%;\">Parse <i>file</i> as a set of\none or more certificates. All certificates (typically of\nintermediate CAs) are considered untrusted and may be used\nto construct a certificate chain from the target certificate\nto a trust anchor. This option may be used multiple\ntimes.</p>\n\n<p style=\"margin-left:11%;\"><b>-policy</b> <i>arg</i></p>\n\n<p style=\"margin-left:17%;\">Enable policy processing and\nadd <i>arg</i> to the user-initial-policy-set (see\n<small>RFC5280</small> ). The policy <i>arg</i> can be an\nobject name an <small>OID</small> in numeric form. This\nargument can appear more than once.</p>\n\n<p style=\"margin-left:11%;\"><b>-explicit_policy</b></p>\n\n<p style=\"margin-left:17%;\">Set policy variable\nrequire-explicit-policy (see <small>RFC5280</small> ).</p>\n\n<p style=\"margin-left:11%;\"><b>-policy_check</b></p>\n\n<p style=\"margin-left:17%;\">Enables certificate policy\nprocessing.</p>\n\n<p style=\"margin-left:11%;\"><b>-policy_print</b></p>\n\n<p style=\"margin-left:17%;\">Print out diagnostics related\nto policy processing.</p>\n\n<p style=\"margin-left:11%;\"><b>-inhibit_any</b></p>\n\n<p style=\"margin-left:17%;\">Set policy variable\ninhibit-any-policy (see <small>RFC5280</small> ).</p>\n\n<p style=\"margin-left:11%;\"><b>-inhibit_map</b></p>\n\n<p style=\"margin-left:17%;\">Set policy variable\ninhibit-policy-mapping (see <small>RFC5280</small> ).</p>\n\n<p style=\"margin-left:11%;\"><b>-purpose</b>\n<i>purpose</i></p>\n\n<p style=\"margin-left:17%;\">The intended use for the\ncertificate. Currently defined purposes are\n&quot;sslclient&quot;, &quot;sslserver&quot;,\n&quot;nssslserver&quot;, &quot;smimesign&quot;,\n&quot;smimeencrypt&quot;, &quot;crlsign&quot;,\n&quot;ocsphelper&quot;, &quot;timestampsign&quot;, and\n&quot;any&quot;. If peer certificate verification is\nenabled, by default the <small>TLS</small> implementation as\nwell as the commands <b>s_client</b> and <b>s_server</b>\ncheck for consistency with <small>TLS</small> server or\n<small>TLS</small> client use, respectively.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">While\n<small>IETF RFC 5280</small> says that\n<b>id-kp-serverAuth</b> and <b>id-kp-clientAuth</b> are only\nfor <small>WWW</small> use, in practice they are used for\nall kinds of <small>TLS</small> clients and servers, and\nthis is what OpenSSL assumes as well.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_depth</b>\n<i>num</i></p>\n\n<p style=\"margin-left:17%;\">Limit the certificate chain to\n<i>num</i> intermediate <small>CA</small> certificates. A\nmaximal depth chain can have up to <i>num</i>+2\ncertificates, since neither the end-entity certificate nor\nthe trust-anchor certificate count against the\n<b>-verify_depth</b> limit.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_email</b>\n<i>email</i></p>\n\n<p style=\"margin-left:17%;\">Verify if <i>email</i> matches\nthe email address in Subject Alternative Name or the email\nin the subject Distinguished Name.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_hostname</b>\n<i>hostname</i></p>\n\n<p style=\"margin-left:17%;\">Verify if <i>hostname</i>\nmatches <small>DNS</small> name in Subject Alternative Name\nor Common Name in the subject certificate.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_ip</b> <i>ip</i></p>\n\n<p style=\"margin-left:17%;\">Verify if <i>ip</i> matches the\n<small>IP</small> address in Subject Alternative Name of the\nsubject certificate.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_name</b>\n<i>name</i></p>\n\n<p style=\"margin-left:17%;\">Use default verification\npolicies like trust model and required certificate policies\nidentified by <i>name</i>. The trust model determines which\nauxiliary trust or reject OIDs are applicable to verifying\nthe given certificate chain. They can be given using the\n<b>-addtrust</b> and <b>-addreject</b> options for\n<a href=\"https://man.page/1/openssl-x509\">openssl-x509(1)</a>. Supported policy names include:\n<b>default</b>, <b>pkcs7</b>, <b>smime_sign</b>,\n<b>ssl_client</b>, <b>ssl_server</b>. These mimics the\ncombinations of purpose and trust settings used in\n<small>SSL, CMS</small> and S/MIME. As of OpenSSL 1.1.0, the\ntrust model is inferred from the purpose when not specified,\nso the <b>-verify_name</b> options are functionally\nequivalent to the corresponding <b>-purpose</b>\nsettings.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Extended\nVerification Options</b> <br>\nSometimes there may be more than one certificate chain\nleading to an end-entity certificate. This usually happens\nwhen a root or intermediate <small>CA</small> signs a\ncertificate for another a <small>CA</small> in other\norganization. Another reason is when a <small>CA</small>\nmight have intermediates that use two different signature\nformats, such as a <small>SHA-1</small> and a\n<small>SHA-256</small> digest.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The following\noptions can be used to provide data that will allow the\nOpenSSL command to generate an alternative chain. <b><br>\n-xkey</b> <i>infile</i>, <b>-xcert</b> <i>infile</i>,\n<b>-xchain</b></p>\n\n<p style=\"margin-left:17%;\">Specify an extra certificate,\nprivate key and certificate chain. These behave in the same\nmanner as the <b>-cert</b>, <b>-key</b> and\n<b>-cert_chain</b> options. When specified, the callback\nreturning the first valid chain will be in use by the\nclient.</p>\n\n<p style=\"margin-left:11%;\"><b>-xchain_build</b></p>\n\n<p style=\"margin-left:17%;\">Specify whether the application\nshould build the certificate chain to be provided to the\nserver for the extra certificates via the <b>-xkey</b>,\n<b>-xcert</b>, and <b>-xchain</b> options.</p>\n\n<p style=\"margin-left:11%;\"><b>-xcertform\n<small>DER</small></b> | <b><small>PEM</small></b>\n|<b>P12</b></p>\n\n<p style=\"margin-left:17%;\">The input format for the extra\ncertificate. This option has no effect and is retained for\nbackward compatibility only.</p>\n\n<p style=\"margin-left:11%;\"><b>-xkeyform\n<small>DER</small></b> | <b><small>PEM</small></b>\n|<b>P12</b></p>\n\n<p style=\"margin-left:17%;\">The input format for the extra\nkey. This option has no effect and is retained for backward\ncompatibility only.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Certificate\nExtensions</b> <br>\nOptions like <b>-purpose</b> lead to checking the\ncertificate extensions, which determine what the target\ncertificate and intermediate <small>CA</small> certificates\ncan be used for.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Basic\nConstraints</i></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\nbasicConstraints extension <small>CA</small> flag is used to\ndetermine whether the certificate can be used as a\n<small>CA.</small> If the <small>CA</small> flag is true\nthen it is a <small>CA,</small> if the <small>CA</small>\nflag is false then it is not a <small>CA.</small> <b>All</b>\nCAs should have the <small>CA</small> flag set to true.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\nbasicConstraints extension is absent, which includes the\ncase that it is an X.509v1 certificate, then the certificate\nis considered to be a &quot;possible <small>CA&quot;</small>\nand other extensions are checked according to the intended\nuse of the certificate. The treatment of certificates\nwithout basicConstraints as a <small>CA</small> is presently\nsupported, but this could change in the future.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Key\nUsage</i></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the keyUsage\nextension is present then additional restraints are made on\nthe uses of the certificate. A <small>CA</small> certificate\n<b>must</b> have the keyCertSign bit set if the keyUsage\nextension is present.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Extended Key\nUsage</i></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The extKeyUsage\n( <small>EKU</small> ) extension places additional\nrestrictions on the certificate uses. If this extension is\npresent (whether critical or not) the key can only be used\nfor the purposes specified.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A complete\ndescription of each check is given below. The comments about\nbasicConstraints and keyUsage and X.509v1 certificates above\napply to <b>all</b> <small>CA</small> certificates.\n<b><small><br>\nSSL</small> Client</b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;web client\nauthentication&quot; <small>OID.</small> The keyUsage\nextension must be absent or it must have the\ndigitalSignature bit set. The Netscape certificate type must\nbe absent or it must have the <small>SSL</small> client bit\nset.</p>\n\n<p style=\"margin-left:11%;\"><b><small>SSL</small> Client\n<small>CA</small></b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;web client\nauthentication&quot; <small>OID.</small> The Netscape\ncertificate type must be absent or it must have the\n<small>SSL CA</small> bit set. This is used as a work around\nif the basicConstraints extension is absent.</p>\n\n<p style=\"margin-left:11%;\"><b><small>SSL</small>\nServer</b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;web server\nauthentication&quot; and/or one of the <small>SGC</small>\nOIDs. The keyUsage extension must be absent or it must have\nthe digitalSignature, the keyEncipherment set or both bits\nset. The Netscape certificate type must be absent or have\nthe <small>SSL</small> server bit set.</p>\n\n<p style=\"margin-left:11%;\"><b><small>SSL</small> Server\n<small>CA</small></b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;web server\nauthentication&quot; and/or one of the <small>SGC</small>\nOIDs. The Netscape certificate type must be absent or the\n<small>SSL CA</small> bit must be set. This is used as a\nwork around if the basicConstraints extension is absent.</p>\n\n<p style=\"margin-left:11%;\"><b>Netscape <small>SSL</small>\nServer</b></p>\n\n<p style=\"margin-left:17%;\">For Netscape <small>SSL</small>\nclients to connect to an <small>SSL</small> server it must\nhave the keyEncipherment bit set if the keyUsage extension\nis present. This isn&rsquo;t always valid because some\ncipher suites use the key for digital signing. Otherwise it\nis the same as a normal <small>SSL</small> server.</p>\n\n<p style=\"margin-left:11%;\"><b>Common S/MIME Client\nTests</b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;email\nprotection&quot; <small>OID.</small> The Netscape\ncertificate type must be absent or should have the S/MIME\nbit set. If the S/MIME bit is not set in the Netscape\ncertificate type then the <small>SSL</small> client bit is\ntolerated as an alternative but a warning is shown. This is\nbecause some Verisign certificates don&rsquo;t set the\nS/MIME bit.</p>\n\n<p style=\"margin-left:11%;\"><b>S/MIME Signing</b></p>\n\n<p style=\"margin-left:17%;\">In addition to the common\nS/MIME client tests the digitalSignature bit or the\nnonRepudiation bit must be set if the keyUsage extension is\npresent.</p>\n\n<p style=\"margin-left:11%;\"><b>S/MIME Encryption</b></p>\n\n<p style=\"margin-left:17%;\">In addition to the common\nS/MIME tests the keyEncipherment bit must be set if the\nkeyUsage extension is present.</p>\n\n<p style=\"margin-left:11%;\"><b>S/MIME\n<small>CA</small></b></p>\n\n<p style=\"margin-left:17%;\">The extended key usage\nextension must be absent or include the &quot;email\nprotection&quot; <small>OID.</small> The Netscape\ncertificate type must be absent or must have the S/MIME\n<small>CA</small> bit set. This is used as a work around if\nthe basicConstraints extension is absent.</p>\n\n<p style=\"margin-left:11%;\"><b><small>CRL</small>\nSigning</b></p>\n\n<p style=\"margin-left:17%;\">The keyUsage extension must be\nabsent or it must have the <small>CRL</small> signing bit\nset.</p>\n\n<p style=\"margin-left:11%;\"><b><small>CRL</small> Signing\n<small>CA</small></b></p>\n\n<p style=\"margin-left:17%;\">The normal <small>CA</small>\ntests apply. Except in this case the basicConstraints\nextension must be present.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The issuer\nchecks still suffer from limitations in the underlying\nX509_LOOKUP <small>API.</small> One consequence of this is\nthat trusted certificates with matching subject name must\nappear in a file (as specified by the <b>-CAfile</b>\noption), a directory (as specified by <b>-CApath</b>), or a\nstore (as specified by <b>-CAstore</b>). If there are\nmultiple such matches, possibly in multiple locations, only\nthe first one (in the mentioned order of locations) is\nrecognised.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/X509_verify_cert\">X509_verify_cert(3)</a>,\n<a href=\"https://man.page/1/openssl-verify\">openssl-verify(1)</a>, <a href=\"https://man.page/1/openssl-ocsp\">openssl-ocsp(1)</a>,\n<a href=\"https://man.page/1/openssl-ts\">openssl-ts(1)</a>, <a href=\"https://man.page/1/openssl-s_client\">openssl-s_client(1)</a>,\n<a href=\"https://man.page/1/openssl-s_server\">openssl-s_server(1)</a>, <a href=\"https://man.page/1/openssl-smime\">openssl-smime(1)</a>,\n<a href=\"https://man.page/1/openssl-cmp\">openssl-cmp(1)</a>, <a href=\"https://man.page/1/openssl-cms\">openssl-cms(1)</a></p>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The checks\nenabled by <b>-x509_strict</b> have been extended in OpenSSL\n3.0.</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2000-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"]}