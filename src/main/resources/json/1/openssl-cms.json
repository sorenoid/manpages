{"name":"openssl-cms","description":"openssl-cms -\nCMS command","body":"\n\n<h1 align=\"center\">OPENSSL-CMS</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl-cms -\nCMS command</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl\ncms</b> [<b>-help</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">General\noptions:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-in</b>\n<i>filename</i>] [<b>-out</b> <i>filename</i>]\n[<b>-config</b> <i>configfile</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Operation\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-encrypt</b>]\n[<b>-decrypt</b>] [<b>-sign</b>] [<b>-verify</b>]\n[<b>-resign</b>] [<b>-sign_receipt</b>]\n[<b>-verify_receipt</b> <i>receipt</i>]\n[<b>-digest_create</b>] [<b>-digest_verify</b>]\n[<b>-compress</b>] [<b>-uncompress</b>]\n[<b>-EncryptedData_encrypt</b>]\n[<b>-EncryptedData_decrypt</b>] [<b>-data_create</b>]\n[<b>-data_out</b>] [<b>-cmsout</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">File format\noptions:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-inform\n<small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b> ] [<b>-outform\n<small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b> ] [<b>-rctform\n<small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b> ] [<b>-stream</b>]\n[<b>-indef</b>] [<b>-noindef</b>] [<b>-binary</b>]\n[<b>-crlfeol</b>] [<b>-asciicrlf</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Keys and\npassword options:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-pwri_password</b>\n<i>password</i>] [<b>-secretkey</b> <i>key</i>]\n[<b>-secretkeyid</b> <i>id</i>] [<b>-inkey</b>\n<i>filename</i>|<i>uri</i>] [<b>-passin</b> <i>arg</i>]\n[<b>-keyopt</b> <i>name</i>:<i>parameter</i>] [<b>-keyform\n<small>DER</small></b> | <b><small>PEM</small></b>\n|<b>P12</b>| <b><small>ENGINE</small></b> ] [<b>-engine</b>\n<i>id</i>] [<b>-provider</b> <i>name</i>]\n[<b>-provider-path</b> <i>path</i>] [<b>-propquery</b>\n<i>propq</i>] [<b>-rand</b> <i>files</i>] [<b>-writerand</b>\n<i>file</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Encryption\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-originator</b>\n<i>file</i>] [<b>-recip</b> <i>file</i>]\n[<i>recipient-cert</i> ...] [<b>-</b><b><i>cipher</i></b>]\n[<b>-wrap</b> <i>cipher</i>] [<b>-aes128-wrap</b>]\n[<b>-aes192-wrap</b>] [<b>-aes256-wrap</b>]\n[<b>-des3-wrap</b>] [<b>-debug_decrypt</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Signing\noptions:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-md</b>\n<i>digest</i>] [<b>-signer</b> <i>file</i>]\n[<b>-certfile</b> <i>file</i>] [<b>-cades</b>]\n[<b>-nodetach</b>] [<b>-nocerts</b>] [<b>-noattr</b>]\n[<b>-nosmimecap</b>] [<b>-receipt_request_all</b>]\n[<b>-receipt_request_first</b>]\n[<b>-receipt_request_from</b> <i>emailaddress</i>]\n[<b>-receipt_request_to</b> <i>emailaddress</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Verification\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-signer</b>\n<i>file</i>] [<b>-content</b> <i>filename</i>]\n[<b>-no_content_verify</b>] [<b>-no_attr_verify</b>]\n[<b>-nosigs</b>] [<b>-noverify</b>] [<b>-nointern</b>]\n[<b>-cades</b>] [<b>-verify_retcode</b>] [<b>-CAfile</b>\n<i>file</i>] [<b>-no-CAfile</b>] [<b>-CApath</b> <i>dir</i>]\n[<b>-no-CApath</b>] [<b>-CAstore</b> <i>uri</i>]\n[<b>-no-CAstore</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Output\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-keyid</b>]\n[<b>-econtent_type</b> <i>type</i>] [<b>-text</b>]\n[<b>-certsout</b> <i>file</i>] [<b>-to</b> <i>addr</i>]\n[<b>-from</b> <i>addr</i>] [<b>-subject</b> <i>subj</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Printing\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-noout</b>]\n[<b>-print</b>] [<b>-nameopt</b> <i>option</i>]\n[<b>-receipt_request_print</b>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Validation\noptions:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">[<b>-allow_proxy_certs</b>]\n[<b>-attime</b> <i>timestamp</i>] [<b>-no_check_time</b>]\n[<b>-check_ss_sig</b>] [<b>-crl_check</b>]\n[<b>-crl_check_all</b>] [<b>-explicit_policy</b>]\n[<b>-extended_crl</b>] [<b>-ignore_critical</b>]\n[<b>-inhibit_any</b>] [<b>-inhibit_map</b>]\n[<b>-partial_chain</b>] [<b>-policy</b> <i>arg</i>]\n[<b>-policy_check</b>] [<b>-policy_print</b>]\n[<b>-purpose</b> <i>purpose</i>] [<b>-suiteB_128</b>]\n[<b>-suiteB_128_only</b>] [<b>-suiteB_192</b>]\n[<b>-trusted_first</b>] [<b>-no_alt_chains</b>]\n[<b>-use_deltas</b>] [<b>-auth_level</b> <i>num</i>]\n[<b>-verify_depth</b> <i>num</i>] [<b>-verify_email</b>\n<i>email</i>] [<b>-verify_hostname</b> <i>hostname</i>]\n[<b>-verify_ip</b> <i>ip</i>] [<b>-verify_name</b>\n<i>name</i>] [<b>-x509_strict</b>]\n[<b>-issuer_checks</b>]</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This command\nhandles data in <small>CMS</small> format such as S/MIME\nv3.1 email messages. It can encrypt, decrypt, sign, verify,\ncompress, uncompress, and print messages.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">There are a\nnumber of operation options that set the type of operation\nto be performed: encrypt, decrypt, sign, verify, resign,\nsign_receipt, verify_receipt, digest_create, digest_verify,\ncompress, uncompress, EncryptedData_encrypt,\nEncryptedData_decrypt, data_create, data_out, or cmsout. The\nrelevance of the other options depends on the operation type\nand their meaning may vary according to it. <b><br>\n-help</b></p>\n\n<p style=\"margin-left:17%;\">Print out a usage message.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>General\noptions <br>\n-in</b> <i>filename</i></p>\n\n<p style=\"margin-left:17%;\">The input message to be\nencrypted or signed or the message to be decrypted or\nverified.</p>\n\n<p style=\"margin-left:11%;\"><b>-out</b> <i>filename</i></p>\n\n<p style=\"margin-left:17%;\">The message text that has been\ndecrypted or verified or the output <small>MIME</small>\nformat message that has been signed or verified.</p>\n\n<p style=\"margin-left:11%;\"><b>-config</b>\n<i>configfile</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Configuration\nOption&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Operation\noptions <br>\n-encrypt</b></p>\n\n<p style=\"margin-left:17%;\">Encrypt data for the given\nrecipient certificates. Input file is the message to be\nencrypted. The output file is the encrypted data in\n<small>MIME</small> format. The actual <small>CMS</small>\ntype is <b>EnvelopedData</b>.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Note that no\nrevocation check is done for the recipient cert, so if that\nkey has been compromised, others may be able to decrypt the\ntext.</p>\n\n<p style=\"margin-left:11%;\"><b>-decrypt</b></p>\n\n<p style=\"margin-left:17%;\">Decrypt data using the supplied\ncertificate and private key. Expects encrypted datain\n<small>MIME</small> format for the input file. The decrypted\ndata is written to the output file.</p>\n\n<p style=\"margin-left:11%;\"><b>-sign</b></p>\n\n<p style=\"margin-left:17%;\">Sign data using the supplied\ncertificate and private key. Input file is the message to be\nsigned. The signed data in <small>MIME</small> format is\nwritten to the output file.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify</b></p>\n\n<p style=\"margin-left:17%;\">Verify signed data. Expects a\nsigned data on input and outputs the signed data. Both clear\ntext and opaque signing is supported.</p>\n\n<p style=\"margin-left:11%;\"><b>-resign</b></p>\n\n<p style=\"margin-left:17%;\">Resign a message: take an\nexisting message and one or more new signers.</p>\n\n<p style=\"margin-left:11%;\"><b>-sign_receipt</b></p>\n\n<p style=\"margin-left:17%;\">Generate and output a signed\nreceipt for the supplied message. The input message\n<b>must</b> contain a signed receipt request. Functionality\nis otherwise similar to the <b>-sign</b> operation.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_receipt</b>\n<i>receipt</i></p>\n\n<p style=\"margin-left:17%;\">Verify a signed receipt in\nfilename <b>receipt</b>. The input message <b>must</b>\ncontain the original receipt request. Functionality is\notherwise similar to the <b>-verify</b> operation.</p>\n\n<p style=\"margin-left:11%;\"><b>-digest_create</b></p>\n\n<p style=\"margin-left:17%;\">Create a <small>CMS</small>\n<b>DigestedData</b> type.</p>\n\n<p style=\"margin-left:11%;\"><b>-digest_verify</b></p>\n\n<p style=\"margin-left:17%;\">Verify a <small>CMS</small>\n<b>DigestedData</b> type and output the content.</p>\n\n<p style=\"margin-left:11%;\"><b>-compress</b></p>\n\n<p style=\"margin-left:17%;\">Create a <small>CMS</small>\n<b>CompressedData</b> type. OpenSSL must be compiled with\n<b>zlib</b> support for this option to work, otherwise it\nwill output an error.</p>\n\n<p style=\"margin-left:11%;\"><b>-uncompress</b></p>\n\n<p style=\"margin-left:17%;\">Uncompress a <small>CMS</small>\n<b>CompressedData</b> type and output the content. OpenSSL\nmust be compiled with <b>zlib</b> support for this option to\nwork, otherwise it will output an error.</p>\n\n\n<p style=\"margin-left:11%;\"><b>-EncryptedData_encrypt</b></p>\n\n<p style=\"margin-left:17%;\">Encrypt content using supplied\nsymmetric key and algorithm using a <small>CMS</small>\n<b>EncryptedData</b> type and output the content.</p>\n\n\n<p style=\"margin-left:11%;\"><b>-EncryptedData_decrypt</b></p>\n\n<p style=\"margin-left:17%;\">Decrypt content using supplied\nsymmetric key and algorithm using a <small>CMS</small>\n<b>EncryptedData</b> type and output the content.</p>\n\n<p style=\"margin-left:11%;\"><b>-data_create</b></p>\n\n<p style=\"margin-left:17%;\">Create a <small>CMS</small>\n<b>Data</b> type.</p>\n\n<p style=\"margin-left:11%;\"><b>-data_out</b></p>\n\n<p style=\"margin-left:17%;\"><b>Data</b> type and output the\ncontent.</p>\n\n<p style=\"margin-left:11%;\"><b>-cmsout</b></p>\n\n<p style=\"margin-left:17%;\">Takes an input message and\nwrites out a <small>PEM</small> encoded <small>CMS</small>\nstructure.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>File format\noptions <br>\n-inform <small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b></p>\n\n<p style=\"margin-left:17%;\">The input format of the\n<small>CMS</small> structure (if one is being read); the\ndefault is <b><small>SMIME</small></b> . See\n<a href=\"https://man.page/1/openssl-format-options\">openssl-format-options(1)</a> for details.</p>\n\n<p style=\"margin-left:11%;\"><b>-outform\n<small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b></p>\n\n<p style=\"margin-left:17%;\">The output format of the\n<small>CMS</small> structure (if one is being written); the\ndefault is <b><small>SMIME</small></b> . See\n<a href=\"https://man.page/1/openssl-format-options\">openssl-format-options(1)</a> for details.</p>\n\n<p style=\"margin-left:11%;\"><b>-rctform\n<small>DER</small></b> | <b><small>PEM</small></b> |\n<b><small>SMIME</small></b></p>\n\n<p style=\"margin-left:17%;\">The signed receipt format for\nuse with the <b>-receipt_verify</b>; the default is\n<b><small>SMIME</small></b> . See\n<a href=\"https://man.page/1/openssl-format-options\">openssl-format-options(1)</a> for details.</p>\n\n<p style=\"margin-left:11%;\"><b>-stream</b>,\n<b>-indef</b></p>\n\n<p style=\"margin-left:17%;\">The <b>-stream</b> and\n<b>-indef</b> options are equivalent and enable streaming\nI/O for encoding operations. This permits single pass\nprocessing of data without the need to hold the entire\ncontents in memory, potentially supporting very large files.\nStreaming is automatically set for S/MIME signing with\ndetached data if the output format is\n<b><small>SMIME</small></b> it is currently off by default\nfor all other operations.</p>\n\n<p style=\"margin-left:11%;\"><b>-noindef</b></p>\n\n<p style=\"margin-left:17%;\">Disable streaming I/O where it\nwould produce and indefinite length constructed encoding.\nThis option currently has no effect. In future streaming\nwill be enabled by default on all relevant operations and\nthis option will disable it.</p>\n\n<p style=\"margin-left:11%;\"><b>-binary</b></p>\n\n<p style=\"margin-left:17%;\">Normally the input message is\nconverted to &quot;canonical&quot; format which is\neffectively using <small>CR</small> and <small>LF</small> as\nend of line: as required by the S/MIME specification. When\nthis option is present no translation occurs. This is useful\nwhen handling binary data which may not be in\n<small>MIME</small> format.</p>\n\n<p style=\"margin-left:11%;\"><b>-crlfeol</b></p>\n\n<p style=\"margin-left:17%;\">Normally the output file uses a\nsingle <b><small>LF</small></b> as end of line. When this\noption is present <b><small>CRLF</small></b> is used\ninstead.</p>\n\n<p style=\"margin-left:11%;\"><b>-asciicrlf</b></p>\n\n<p style=\"margin-left:17%;\">When signing use <small>ASCII\nCRLF</small> format canonicalisation. This strips trailing\nwhitespace from all lines, deletes trailing blank lines at\n<small>EOF</small> and sets the encapsulated content type.\nThis option is normally used with detached content and an\noutput signature format of <small>DER.</small> This option\nis not normally needed when verifying as it is enabled\nautomatically if the encapsulated content format is\ndetected.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Keys and\npassword options <br>\n-pwri_password</b> <i>password</i></p>\n\n<p style=\"margin-left:17%;\">Specify password for\nrecipient.</p>\n\n<p style=\"margin-left:11%;\"><b>-secretkey</b>\n<i>key</i></p>\n\n<p style=\"margin-left:17%;\">Specify symmetric key to use.\nThe key must be supplied in hex format and be consistent\nwith the algorithm used. Supported by the\n<b>-EncryptedData_encrypt -EncryptedData_decrypt</b>,\n<b>-encrypt</b> and <b>-decrypt</b> options. When used with\n<b>-encrypt</b> or <b>-decrypt</b> the supplied key is used\nto wrap or unwrap the content encryption key using an\n<small>AES</small> key in the <b>KEKRecipientInfo</b>\ntype.</p>\n\n<p style=\"margin-left:11%;\"><b>-secretkeyid</b>\n<i>id</i></p>\n\n<p style=\"margin-left:17%;\">The key identifier for the\nsupplied symmetric key for <b>KEKRecipientInfo</b> type.\nThis option <b>must</b> be present if the <b>-secretkey</b>\noption is used with <b>-encrypt</b>. With <b>-decrypt</b>\noperations the <i>id</i> is used to locate the relevant key\nif it is not supplied then an attempt is used to decrypt any\n<b>KEKRecipientInfo</b> structures.</p>\n\n<p style=\"margin-left:11%;\"><b>-inkey</b>\n<i>filename</i>|<i>uri</i></p>\n\n<p style=\"margin-left:17%;\">The private key to use when\nsigning or decrypting. This must match the corresponding\ncertificate. If this option is not specified then the\nprivate key must be included in the certificate file\nspecified with the <b>-recip</b> or <b>-signer</b> file.\nWhen signing this option can be used multiple times to\nspecify successive keys.</p>\n\n<p style=\"margin-left:11%;\"><b>-passin</b> <i>arg</i></p>\n\n<p style=\"margin-left:17%;\">The private key password\nsource. For more information about the format of <b>arg</b>\nsee <a href=\"https://man.page/1/openssl-passphrase-options\">openssl-passphrase-options(1)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>-keyopt</b>\n<i>name</i>:<i>parameter</i></p>\n\n<p style=\"margin-left:17%;\">For signing and encryption this\noption can be used multiple times to set customised\nparameters for the preceding key or certificate. It can\ncurrently be used to set RSA-PSS for signing, RSA-OAEP for\nencryption or to modify default parameters for\n<small>ECDH.</small></p>\n\n<p style=\"margin-left:11%;\"><b>-keyform\n<small>DER</small></b> | <b><small>PEM</small></b>\n|<b>P12</b>| <b><small>ENGINE</small></b></p>\n\n<p style=\"margin-left:17%;\">The format of the private key\nfile; unspecified by default. See\n<a href=\"https://man.page/1/openssl-format-options\">openssl-format-options(1)</a> for details.</p>\n\n<p style=\"margin-left:11%;\"><b>-engine</b> <i>id</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Engine Options&quot;\nin <a href=\"https://man.page/1/openssl\">openssl(1)</a>. This option is deprecated.</p>\n\n<p style=\"margin-left:11%;\"><b>-provider</b> <i>name</i>\n<b><br>\n-provider-path</b> <i>path</i> <b><br>\n-propquery</b> <i>propq</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Provider\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a>, <a href=\"https://man.page/7/provider\">provider(7)</a>, and\n<a href=\"https://man.page/7/property\">property(7)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>-rand</b> <i>files</i>,\n<b>-writerand</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Random State\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a> for details.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Encryption\nand decryption options <br>\n-originator</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">A certificate of the originator\nof the encrypted message. Necessary for decryption when Key\nAgreement is in use for a shared key.</p>\n\n<p style=\"margin-left:11%;\"><b>-recip</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">When decrypting a message this\nspecifies the certificate of the recipient. The certificate\nmust match one of the recipients of the message.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">When encrypting\na message this option may be used multiple times to specify\neach recipient. This form <b>must</b> be used if customised\nparameters are required (for example to specify\nRSA-OAEP).</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Only\ncertificates carrying <small>RSA,</small> Diffie-Hellman or\n<small>EC</small> keys are supported by this option.</p>\n\n<p style=\"margin-left:11%;\"><i>recipient-cert</i> ...</p>\n\n<p style=\"margin-left:17%;\">This is an alternative to using\nthe <b>-recip</b> option when encrypting a message. One or\nmore certificate filennames may be given.</p>\n\n\n<p style=\"margin-left:11%;\"><b>-</b><b><i>cipher</i></b></p>\n\n<p style=\"margin-left:17%;\">The encryption algorithm to\nuse. For example triple <small>DES</small> (168 bits) -\n<b>-des3</b> or 256 bit <small>AES</small> - <b>-aes256</b>.\nAny standard algorithm name (as used by the\n<b>EVP_get_cipherbyname()</b> function) can also be used\npreceded by a dash, for example <b>-aes-128-cbc</b>. See\n<a href=\"https://man.page/1/openssl-enc\">openssl-enc(1)</a> for a list of ciphers supported by\nyour version of OpenSSL.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Currently the\n<small>AES</small> variants with <small>GCM</small> mode are\nthe only supported <small>AEAD</small> algorithms.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">If not\nspecified triple <small>DES</small> is used. Only used with\n<b>-encrypt</b> and <b>-EncryptedData_create</b>\ncommands.</p>\n\n<p style=\"margin-left:11%;\"><b>-wrap</b> <i>cipher</i></p>\n\n<p style=\"margin-left:17%;\">Cipher algorithm to use for key\nwrap when encrypting the message using Key Agreement for key\ntransport. The algorithm specified should be suitable for\nkey wrap.</p>\n\n<p style=\"margin-left:11%;\"><b>-aes128-wrap</b>,\n<b>-aes192-wrap</b>, <b>-aes256-wrap</b>,\n<b>-des3-wrap</b></p>\n\n<p style=\"margin-left:17%;\">Use <small>AES128, AES192,\nAES256,</small> or 3DES-EDE, respectively, to wrap key.\nDepending on the OpenSSL build options used,\n<b>-des3-wrap</b> may not be supported.</p>\n\n<p style=\"margin-left:11%;\"><b>-debug_decrypt</b></p>\n\n<p style=\"margin-left:17%;\">This option sets the\n<b><small>CMS_DEBUG_DECRYPT</small></b> flag. This option\nshould be used with caution: see the notes section\nbelow.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Signing\noptions <br>\n-md</b> <i>digest</i></p>\n\n<p style=\"margin-left:17%;\">Digest algorithm to use when\nsigning or resigning. If not present then the default digest\nalgorithm for the signing key will be used (usually\n<small>SHA1</small> ).</p>\n\n<p style=\"margin-left:11%;\"><b>-signer</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">A signing certificate. When\nsigning or resigning a message, this option can be used\nmultiple times if more than one signer is required.</p>\n\n<p style=\"margin-left:11%;\"><b>-certfile</b>\n<i>file</i></p>\n\n<p style=\"margin-left:17%;\">Allows additional certificates\nto be specified. When signing these will be included with\nthe message. When verifying these will be searched for the\nsigners certificates. The input can be in <small>PEM,\nDER,</small> or PKCS#12 format.</p>\n\n<p style=\"margin-left:11%;\"><b>-cades</b></p>\n\n<p style=\"margin-left:17%;\">When used with <b>-sign</b>,\nadd an <small>ESS</small> signingCertificate or\n<small>ESS</small> signingCertificateV2 signed-attribute to\nthe SignerInfo, in order to make the signature comply with\nthe requirements for a CAdES Basic Electronic Signature\n(CAdES-BES).</p>\n\n<p style=\"margin-left:11%;\"><b>-nodetach</b></p>\n\n<p style=\"margin-left:17%;\">When signing a message use\nopaque signing: this form is more resistant to translation\nby mail relays but it cannot be read by mail agents that do\nnot support S/MIME. Without this option cleartext signing\nwith the <small>MIME</small> type multipart/signed is\nused.</p>\n\n<p style=\"margin-left:11%;\"><b>-nocerts</b></p>\n\n<p style=\"margin-left:17%;\">When signing a message the\nsigner&rsquo;s certificate is normally included with this\noption it is excluded. This will reduce the size of the\nsigned message but the verifier must have a copy of the\nsigners certificate available locally (passed using the\n<b>-certfile</b> option for example).</p>\n\n<p style=\"margin-left:11%;\"><b>-noattr</b></p>\n\n<p style=\"margin-left:17%;\">Normally when a message is\nsigned a set of attributes are included which include the\nsigning time and supported symmetric algorithms. With this\noption they are not included.</p>\n\n<p style=\"margin-left:11%;\"><b>-nosmimecap</b></p>\n\n<p style=\"margin-left:17%;\">Exclude the list of supported\nalgorithms from signed attributes, other options such as\nsigning time and content type are still included.</p>\n\n<p style=\"margin-left:11%;\"><b>-receipt_request_all</b>,\n<b>-receipt_request_first</b></p>\n\n<p style=\"margin-left:17%;\">For <b>-sign</b> option include\na signed receipt request. Indicate requests should be\nprovided by all recipient or first tier recipients (those\nmailed directly and not from a mailing list). Ignored it\n<b>-receipt_request_from</b> is included.</p>\n\n<p style=\"margin-left:11%;\"><b>-receipt_request_from</b>\n<i>emailaddress</i></p>\n\n<p style=\"margin-left:17%;\">For <b>-sign</b> option include\na signed receipt request. Add an explicit email address\nwhere receipts should be supplied.</p>\n\n<p style=\"margin-left:11%;\"><b>-receipt_request_to</b>\n<i>emailaddress</i></p>\n\n<p style=\"margin-left:17%;\">Add an explicit email address\nwhere signed receipts should be sent to. This option\n<b>must</b> but supplied if a signed receipt is\nrequested.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Verification\noptions <br>\n-signer</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">If a message has been verified\nsuccessfully then the signers certificate(s) will be written\nto this file if the verification was successful.</p>\n\n<p style=\"margin-left:11%;\"><b>-content</b>\n<i>filename</i></p>\n\n<p style=\"margin-left:17%;\">This specifies a file\ncontaining the detached content for operations taking S/MIME\ninput, such as the <b>-verify</b> command. This is only\nusable if the <small>CMS</small> structure is using the\ndetached signature form where the content is not included.\nThis option will override any content if the input format is\nS/MIME and it uses the multipart/signed <small>MIME</small>\ncontent type.</p>\n\n<p style=\"margin-left:11%;\"><b>-no_content_verify</b></p>\n\n<p style=\"margin-left:17%;\">Do not verify signed content\nsignatures.</p>\n\n<p style=\"margin-left:11%;\"><b>-no_attr_verify</b></p>\n\n<p style=\"margin-left:17%;\">Do not verify signed attribute\nsignatures.</p>\n\n<p style=\"margin-left:11%;\"><b>-nosigs</b></p>\n\n<p style=\"margin-left:17%;\">Don&rsquo;t verify message\nsignature.</p>\n\n<p style=\"margin-left:11%;\"><b>-noverify</b></p>\n\n<p style=\"margin-left:17%;\">Do not verify the signers\ncertificate of a signed message.</p>\n\n<p style=\"margin-left:11%;\"><b>-nointern</b></p>\n\n<p style=\"margin-left:17%;\">When verifying a message\nnormally certificates (if any) included in the message are\nsearched for the signing certificate. With this option only\nthe certificates specified in the <b>-certfile</b> option\nare used. The supplied certificates can still be used as\nuntrusted CAs however.</p>\n\n<p style=\"margin-left:11%;\"><b>-cades</b></p>\n\n<p style=\"margin-left:17%;\">When used with <b>-verify</b>,\nrequire and check signer certificate digest. See the\n<small>NOTES</small> section for more details.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify_retcode</b></p>\n\n<p style=\"margin-left:17%;\">Exit nonzero on verification\nfailure.</p>\n\n<p style=\"margin-left:11%;\"><b>-CAfile</b> <i>file</i>,\n<b>-no-CAfile</b>, <b>-CApath</b> <i>dir</i>,\n<b>-no-CApath</b>, <b>-CAstore</b> <i>uri</i>, <b><br>\n-no-CAstore</b></p>\n\n<p style=\"margin-left:17%;\">See &quot;Trusted Certificate\nOptions&quot; in <a href=\"https://man.page/1/openssl-verification-options\">openssl-verification-options(1)</a> for\ndetails.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Output\noptions <br>\n-keyid</b></p>\n\n<p style=\"margin-left:17%;\">Use subject key identifier to\nidentify certificates instead of issuer name and serial\nnumber. The supplied certificate <b>must</b> include a\nsubject key identifier extension. Supported by <b>-sign</b>\nand <b>-encrypt</b> options.</p>\n\n<p style=\"margin-left:11%;\"><b>-econtent_type</b>\n<i>type</i></p>\n\n<p style=\"margin-left:17%;\">Set the encapsulated content\ntype to <i>type</i> if not supplied the <b>Data</b> type is\nused. The <i>type</i> argument can be any valid\n<small>OID</small> name in either text or numerical\nformat.</p>\n\n<p style=\"margin-left:11%;\"><b>-text</b></p>\n\n<p style=\"margin-left:17%;\">This option adds plain text\n(text/plain) <small>MIME</small> headers to the supplied\nmessage if encrypting or signing. If decrypting or verifying\nit strips off text headers: if the decrypted or verified\nmessage is not of <small>MIME</small> type text/plain then\nan error occurs.</p>\n\n<p style=\"margin-left:11%;\"><b>-certsout</b>\n<i>file</i></p>\n\n<p style=\"margin-left:17%;\">Any certificates contained in\nthe input message are written to <i>file</i>.</p>\n\n<p style=\"margin-left:11%;\"><b>-to</b>, <b>-from</b>,\n<b>-subject</b></p>\n\n<p style=\"margin-left:17%;\">The relevant email headers.\nThese are included outside the signed portion of a message\nso they may be included manually. If signing then many\nS/MIME mail clients check the signers certificate&rsquo;s\nemail address matches that specified in the From:\naddress.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Printing\noptions <br>\n-noout</b></p>\n\n<p style=\"margin-left:17%;\">For the <b>-cmsout</b>\noperation do not output the parsed <small>CMS</small>\nstructure. This is useful if the syntax of the\n<small>CMS</small> structure is being checked.</p>\n\n<p style=\"margin-left:11%;\"><b>-print</b></p>\n\n<p style=\"margin-left:17%;\">For the <b>-cmsout</b>\noperation print out all fields of the <small>CMS</small>\nstructure. This implies <b>-noout</b>. This is mainly useful\nfor testing purposes.</p>\n\n<p style=\"margin-left:11%;\"><b>-nameopt</b>\n<i>option</i></p>\n\n<p style=\"margin-left:17%;\">For the <b>-cmsout</b>\noperation when <b>-print</b> option is in use, specifies\nprinting options for string fields. For most cases\n<b>utf8</b> is reasonable value. See\n<a href=\"https://man.page/1/openssl-namedisplay-options\">openssl-namedisplay-options(1)</a> for details.</p>\n\n\n<p style=\"margin-left:11%;\"><b>-receipt_request_print</b></p>\n\n<p style=\"margin-left:17%;\">For the <b>-verify</b>\noperation print out the contents of any signed receipt\nrequests.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Validation\noptions <br>\n-allow_proxy_certs</b>, <b>-attime</b>,\n<b>-no_check_time</b>, <b>-check_ss_sig</b>,\n<b>-crl_check</b>, <b><br>\n-crl_check_all</b>, <b>-explicit_policy</b>,\n<b>-extended_crl</b>, <b>-ignore_critical</b>, <b><br>\n-inhibit_any</b>, <b>-inhibit_map</b>,\n<b>-no_alt_chains</b>, <b>-partial_chain</b>,\n<b>-policy</b>, <b><br>\n-policy_check</b>, <b>-policy_print</b>, <b>-purpose</b>,\n<b>-suiteB_128</b>, <b>-suiteB_128_only</b>, <b><br>\n-suiteB_192</b>, <b>-trusted_first</b>, <b>-use_deltas</b>,\n<b>-auth_level</b>, <b>-verify_depth</b>, <b><br>\n-verify_email</b>, <b>-verify_hostname</b>,\n<b>-verify_ip</b>, <b>-verify_name</b>, <b>-x509_strict <br>\n-issuer_checks</b></p>\n\n<p style=\"margin-left:17%;\">Set various options of\ncertificate chain verification. See &quot;Verification\nOptions&quot; in <a href=\"https://man.page/1/openssl-verification-options\">openssl-verification-options(1)</a> for\ndetails.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Any validation\nerrors cause the command to exit.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<small>MIME</small> message must be sent without any blank\nlines between the headers and the output. Some mail programs\nwill automatically add a blank line. Piping the mail\ndirectly to sendmail is one way to achieve the correct\nformat.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The supplied\nmessage to be signed or encrypted must include the necessary\n<small>MIME</small> headers or many S/MIME clients\nwon&rsquo;t display it properly (if at all). You can use the\n<b>-text</b> option to automatically add plain text\nheaders.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A &quot;signed\nand encrypted&quot; message is one where a signed message is\nthen encrypted. This can be produced by encrypting an\nalready signed message: see the examples section.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This version of\nthe program only allows one signer per message but it will\nverify multiple signers on received messages. Some S/MIME\nclients choke if a message contains multiple signers. It is\npossible to sign messages &quot;in parallel&quot; by signing\nan already signed message.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The options\n<b>-encrypt</b> and <b>-decrypt</b> reflect common usage in\nS/MIME clients. Strictly speaking these process\n<small>CMS</small> enveloped data: <small>CMS</small>\nencrypted data is used for other purposes.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-resign</b> option uses an existing message digest when\nadding a new signer. This means that attributes must be\npresent in at least one existing signer using the same\nmessage digest or this operation will fail.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-stream</b> and <b>-indef</b> options enable streaming\nI/O support. As a result the encoding is <small>BER</small>\nusing indefinite length constructed encoding and no longer\n<small>DER.</small> Streaming is supported for the\n<b>-encrypt</b> operation and the <b>-sign</b> operation if\nthe content is not detached.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Streaming is\nalways used for the <b>-sign</b> operation with detached\ndata but since the content is no longer part of the\n<small>CMS</small> structure the encoding remains\n<small>DER.</small></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\n<b>-decrypt</b> option is used without a recipient\ncertificate then an attempt is made to locate the recipient\nby trying each potential recipient in turn using the\nsupplied private key. To thwart the <small>MMA</small>\nattack (Bleichenbacher&rsquo;s attack on <small>PKCS</small>\n#1 v1.5 <small>RSA</small> padding) all recipients are tried\nwhether they succeed or not and if no recipients match the\nmessage is &quot;decrypted&quot; using a random key which\nwill typically output garbage. The <b>-debug_decrypt</b>\noption can be used to disable the <small>MMA</small> attack\nprotection and return an error if no recipient can be found:\nthis option should be used with caution. For a fuller\ndescription see <a href=\"https://man.page/3/CMS_decrypt\">CMS_decrypt(3)</a>).</p>\n\n<h2>CADES BASIC ELECTRONIC SIGNATURE (CADES-BES)\n<a name=\"CADES BASIC ELECTRONIC SIGNATURE (CADES-BES)\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">A CAdES Basic\nElectronic Signature (CAdES-BES), as defined in the European\nStandard <small>ETSI EN 319 122-1 V1.1.1,</small>\ncontains:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>The signed user data as defined in <small>CMS</small> (\n<small>RFC 3852</small> );</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>Content-type of the EncapsulatedContentInfo value being\nsigned;</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>Message-digest of the eContent <small>OCTET\nSTRING</small> within encapContentInfo being signed;</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>An <small>ESS</small> signingCertificate or\n<small>ESS</small> signingCertificateV2 attribute, as\ndefined in Enhanced Security Services ( <small>ESS</small>\n), <small>RFC 2634</small> and <small>RFC 5035.</small> An\n<small>ESS</small> signingCertificate attribute only allows\nfor <small>SHA-1</small> as digest algorithm. An\n<small>ESS</small> signingCertificateV2 attribute allows for\nany digest algorithm.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>The digital signature value computed on the user data\nand, when present, on the signed attributes.</p></td></tr>\n</table>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><small>NOTE</small>\nthat the <b>-cades</b> option applies to the <b>-sign</b> or\n<b>-verify</b> operations. With this option, the\n<b>-verify</b> operation also requires that the\nsigningCertificate attribute is present and checks that the\ngiven identifiers match the verification trust chain built\nduring the verification process.</p>\n\n<h2>EXIT CODES\n<a name=\"EXIT CODES\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">0</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p style=\"margin-top: 1em\">The operation was completely\nsuccessfully.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>1</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>An error occurred parsing the command options.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>2</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>One of the input files could not be read.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>3</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>An error occurred creating the <small>CMS</small> file\nor when reading the <small>MIME</small> message.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>4</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>An error occurred decrypting or verifying the\nmessage.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>5</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>The message was verified correctly but an error occurred\nwriting out the signers certificates.</p></td></tr>\n</table>\n\n<h2>COMPATIBILITY WITH PKCS#7 FORMAT\n<a name=\"COMPATIBILITY WITH PKCS#7 FORMAT\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/openssl-smime\">openssl-smime(1)</a>\ncan only process the older <b>PKCS#7</b> format. <b>openssl\ncms</b> supports Cryptographic Message Syntax format. Use of\nsome features will result in messages which cannot be\nprocessed by applications which only support the older\nformat. These are detailed below.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The use of the\n<b>-keyid</b> option with <b>-sign</b> or\n<b>-encrypt</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-outform</b> <i><small>PEM</small></i> option uses\ndifferent headers.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-compress</b> option.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-secretkey</b> option when used with <b>-encrypt</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The use of\n<small>PSS</small> with <b>-sign</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The use of\n<small>OAEP</small> or non-RSA keys with\n<b>-encrypt</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Additionally\nthe <b>-EncryptedData_create</b> and <b>-data_create</b>\ntype cannot be processed by the older\n<a href=\"https://man.page/1/openssl-smime\">openssl-smime(1)</a> command.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create a\ncleartext signed message:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in message.txt -text -out mail.msg \\ <br>\n-signer mycert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create an\nopaque signed message</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in message.txt -text -out mail.msg -nodetach \\ <br>\n-signer mycert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create a signed\nmessage, include some additional certificates and read the\nprivate key from another file:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in in.txt -text -out mail.msg \\ <br>\n-signer mycert.pem -inkey mykey.pem -certfile\nmycerts.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create a signed\nmessage with two signers, use key identifier:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in message.txt -text -out mail.msg \\ <br>\n-signer mycert.pem -signer othercert.pem -keyid</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Send a signed\nmessage under Unix directly to sendmail, including\nheaders:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in in.txt -text -signer mycert.pem \\ <br>\n-from steve@openssl.org -to someone@somewhere \\ <br>\n-subject &quot;Signed message&quot; | sendmail\nsomeone@somewhere</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Verify a\nmessage and extract the signer&rsquo;s certificate if\nsuccessful:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-verify -in mail.msg -signer user.pem -out\nsignedtext.txt</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Send encrypted\nmail using triple <small>DES:</small></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-encrypt -in in.txt -from steve@openssl.org \\ <br>\n-to someone@somewhere -subject &quot;Encrypted message&quot;\n\\ <br>\n-des3 user.pem -out mail.msg</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Sign and\nencrypt mail:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in ml.txt -signer my.pem -text \\ <br>\n| openssl cms -encrypt -out mail.msg \\ <br>\n-from steve@openssl.org -to someone@somewhere \\ <br>\n-subject &quot;Signed and Encrypted message&quot; -des3\nuser.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note: the\nencryption command does not include the <b>-text</b> option\nbecause the message being encrypted already has\n<small>MIME</small> headers.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Decrypt a\nmessage:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-decrypt -in mail.msg -recip mycert.pem -inkey key.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The output from\nNetscape form signing is a PKCS#7 structure with the\ndetached signature format. You can use this program to\nverify the signature by line wrapping the base64 encoded\nstructure and surrounding it with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">-----BEGIN\nPKCS7----- <br>\n-----END PKCS7-----</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">and using the\ncommand,</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-verify -inform PEM -in signature.pem -content\ncontent.txt</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">alternatively\nyou can base64 decode the signature and use</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-verify -inform DER -in signature.der -content\ncontent.txt</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create an\nencrypted message using 128 bit Camellia:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-encrypt -in plain.txt -camellia128 -out mail.msg\ncert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Add a signer to\nan existing message:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-resign -in mail.msg -signer newsign.pem -out mail2.msg</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Sign a message\nusing RSA-PSS:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-sign -in message.txt -text -out mail.msg \\ <br>\n-signer mycert.pem -keyopt rsa_padding_mode:pss</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Create an\nencrypted message using RSA-OAEP:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-encrypt -in plain.txt -out mail.msg \\ <br>\n-recip cert.pem -keyopt rsa_padding_mode:oaep</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Use\n<small>SHA256 KDF</small> with an <small>ECDH</small>\ncertificate:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms\n-encrypt -in plain.txt -out mail.msg \\ <br>\n-recip ecdhcert.pem -keyopt ecdh_kdf_md:sha256</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Print\n<small>CMS</small> signed binary data in human-readable\nform:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl cms -in\nsigned.cms -binary -inform <small>DER</small> -cmsout\n-print</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<small>MIME</small> parser isn&rsquo;t very clever: it seems\nto handle most messages that I&rsquo;ve thrown at it but it\nmay choke on others.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The code\ncurrently will only write out the signer&rsquo;s certificate\nto a file: if the signer has a separate encryption\ncertificate this must be manually extracted. There should be\nsome heuristic that determines the correct encryption\ncertificate.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Ideally a\ndatabase should be maintained of a certificates for each\nemail address.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The code\ndoesn&rsquo;t currently take note of the permitted symmetric\nencryption algorithms as supplied in the SMIMECapabilities\nsigned attribute. this means the user has to manually\ninclude the correct encryption algorithm. It should store\nthe list of permitted ciphers in a database and only use\nthose.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">No revocation\nchecking is done on the signer&rsquo;s certificate.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/7/ossl_store-file\">ossl_store-file(7)</a></p>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The use of\nmultiple <b>-signer</b> options and the <b>-resign</b>\ncommand were first added in OpenSSL 1.0.0.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-keyopt</b> option was added in OpenSSL 1.0.2.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Support for\nRSA-OAEP and RSA-PSS was added in OpenSSL 1.0.2.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The use of\nnon-RSA keys with <b>-encrypt</b> and <b>-decrypt</b> was\nadded in OpenSSL 1.0.2.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n-no_alt_chains option was added in OpenSSL 1.0.2b.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-nameopt</b> option was added in OpenSSL 3.0.0.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-engine</b> option was deprecated in OpenSSL 3.0.</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2008-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#CADES BASIC ELECTRONIC SIGNATURE (CADES-BES)\">CADES BASIC ELECTRONIC SIGNATURE (CADES-BES)</a>","<a href=\"#EXIT CODES\">EXIT CODES</a>","<a href=\"#COMPATIBILITY WITH PKCS#7 FORMAT\">COMPATIBILITY WITH PKCS#7 FORMAT</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"]}