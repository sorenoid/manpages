{"name":"openssl-rsautl","description":"openssl-rsautl - RSA command","body":"\n\n<h1 align=\"center\">OPENSSL-RSAUTL</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl-rsautl\n- RSA command</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl\nrsautl</b> [<b>-help</b>] [<b>-in</b> <i>file</i>]\n[<b>-passin</b> <i>arg</i>] [<b>-rev</b>] [<b>-out</b>\n<i>file</i>] [<b>-inkey</b> <i>filename</i>|<i>uri</i>]\n[<b>-keyform <small>DER</small></b> |\n<b><small>PEM</small></b> |<b>P12</b>|\n<b><small>ENGINE</small></b> ] [<b>-pubin</b>]\n[<b>-certin</b>] [<b>-sign</b>] [<b>-verify</b>]\n[<b>-encrypt</b>] [<b>-decrypt</b>] [<b>-pkcs</b>]\n[<b>-x931</b>] [<b>-oaep</b>] [<b>-raw</b>]\n[<b>-hexdump</b>] [<b>-asn1parse</b>] [<b>-engine</b>\n<i>id</i>] [<b>-rand</b> <i>files</i>] [<b>-writerand</b>\n<i>file</i>] [<b>-provider</b> <i>name</i>]\n[<b>-provider-path</b> <i>path</i>] [<b>-propquery</b>\n<i>propq</i>]</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This command\nhas been deprecated. The <a href=\"https://man.page/1/openssl-pkeyutl\">openssl-pkeyutl(1)</a> command\nshould be used instead.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This command\ncan be used to sign, verify, encrypt and decrypt data using\nthe <small>RSA</small> algorithm.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>-help</b></p>\n\n<p style=\"margin-left:17%;\">Print out a usage message.</p>\n\n<p style=\"margin-left:11%;\"><b>-in</b> <i>filename</i></p>\n\n<p style=\"margin-left:17%;\">This specifies the input\nfilename to read data from or standard input if this option\nis not specified.</p>\n\n<p style=\"margin-left:11%;\"><b>-passin</b> <i>arg</i></p>\n\n<p style=\"margin-left:17%;\">The passphrase used in the\noutput file. See see\n<a href=\"https://man.page/1/openssl-passphrase-options\">openssl-passphrase-options(1)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>-rev</b></p>\n\n<p style=\"margin-left:17%;\">Reverse the order of the\ninput.</p>\n\n<p style=\"margin-left:11%;\"><b>-out</b> <i>filename</i></p>\n\n<p style=\"margin-left:17%;\">Specifies the output filename\nto write to or standard output by default.</p>\n\n<p style=\"margin-left:11%;\"><b>-inkey</b>\n<i>filename</i>|<i>uri</i></p>\n\n<p style=\"margin-left:17%;\">The input key, by default it\nshould be an <small>RSA</small> private key.</p>\n\n<p style=\"margin-left:11%;\"><b>-keyform\n<small>DER</small></b> | <b><small>PEM</small></b>\n|<b>P12</b>| <b><small>ENGINE</small></b></p>\n\n<p style=\"margin-left:17%;\">The key format; unspecified by\ndefault. See <a href=\"https://man.page/1/openssl-format-options\">openssl-format-options(1)</a> for\ndetails.</p>\n\n<p style=\"margin-left:11%;\"><b>-pubin</b></p>\n\n<p style=\"margin-left:17%;\">The input file is an\n<small>RSA</small> public key.</p>\n\n<p style=\"margin-left:11%;\"><b>-certin</b></p>\n\n<p style=\"margin-left:17%;\">The input is a certificate\ncontaining an <small>RSA</small> public key.</p>\n\n<p style=\"margin-left:11%;\"><b>-sign</b></p>\n\n<p style=\"margin-left:17%;\">Sign the input data and output\nthe signed result. This requires an <small>RSA</small>\nprivate key.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify</b></p>\n\n<p style=\"margin-left:17%;\">Verify the input data and\noutput the recovered data.</p>\n\n<p style=\"margin-left:11%;\"><b>-encrypt</b></p>\n\n<p style=\"margin-left:17%;\">Encrypt the input data using an\n<small>RSA</small> public key.</p>\n\n<p style=\"margin-left:11%;\"><b>-decrypt</b></p>\n\n<p style=\"margin-left:17%;\">Decrypt the input data using an\n<small>RSA</small> private key.</p>\n\n<p style=\"margin-left:11%;\"><b>-pkcs</b>, <b>-oaep</b>,\n<b>-x931 -raw</b></p>\n\n<p style=\"margin-left:17%;\">The padding to use: PKCS#1 v1.5\n(the default), PKCS#1 <small>OAEP, ANSI X9.31,</small> or no\npadding, respectively. For signatures, only <b>-pkcs</b> and\n<b>-raw</b> can be used.</p>\n\n<p style=\"margin-left:11%;\"><b>-hexdump</b></p>\n\n<p style=\"margin-left:17%;\">Hex dump the output data.</p>\n\n<p style=\"margin-left:11%;\"><b>-asn1parse</b></p>\n\n<p style=\"margin-left:17%;\">Parse the <small>ASN.1</small>\noutput data, this is useful when combined with the\n<b>-verify</b> option.</p>\n\n<p style=\"margin-left:11%;\"><b>-engine</b> <i>id</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Engine Options&quot;\nin <a href=\"https://man.page/1/openssl\">openssl(1)</a>. This option is deprecated.</p>\n\n<p style=\"margin-left:11%;\"><b>-rand</b> <i>files</i>,\n<b>-writerand</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Random State\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a> for details.</p>\n\n<p style=\"margin-left:11%;\"><b>-provider</b> <i>name</i>\n<b><br>\n-provider-path</b> <i>path</i> <b><br>\n-propquery</b> <i>propq</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Provider\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a>, <a href=\"https://man.page/7/provider\">provider(7)</a>, and\n<a href=\"https://man.page/7/property\">property(7)</a>.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Since this\ncommand uses the <small>RSA</small> algorithm directly, it\ncan only be used to sign or verify small pieces of data.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Examples\nequivalent to these can be found in the documentation for\nthe non-deprecated <a href=\"https://man.page/1/openssl-pkeyutl\">openssl-pkeyutl(1)</a> command.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Sign some data\nusing a private key:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl rsautl\n-sign -in file -inkey key.pem -out sig</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Recover the\nsigned data</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl rsautl\n-verify -in sig -inkey key.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Examine the raw\nsigned data:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl rsautl\n-verify -in sig -inkey key.pem -raw -hexdump <br>\n0000 - 00 01 ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0010 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0020 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0030 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0040 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0050 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0060 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff\n................ <br>\n0070 - ff ff ff ff 00 68 65 6c-6c 6f 20 77 6f 72 6c 64\n.....hello world</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The PKCS#1\nblock formatting is evident from this. If this was done\nusing encrypt and decrypt the block would have been of type\n2 (the second byte) and random padding data visible instead\nof the 0xff bytes.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">It is possible\nto analyse the signature of certificates using this command\nin conjunction with <a href=\"https://man.page/1/openssl-asn1parse\">openssl-asn1parse(1)</a>. Consider\nthe self signed example in <i>certs/pca-cert.pem</i>.\nRunning <a href=\"https://man.page/1/openssl-asn1parse\">openssl-asn1parse(1)</a> as follows yields:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl\nasn1parse -in pca-cert.pem <br>\n0:d=0 hl=4 l= 742 cons: SEQUENCE <br>\n4:d=1 hl=4 l= 591 cons: SEQUENCE <br>\n8:d=2 hl=2 l= 3 cons: cont [ 0 ] <br>\n10:d=3 hl=2 l= 1 prim: INTEGER :02 <br>\n13:d=2 hl=2 l= 1 prim: INTEGER :00 <br>\n16:d=2 hl=2 l= 13 cons: SEQUENCE <br>\n18:d=3 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>\n29:d=3 hl=2 l= 0 prim: NULL <br>\n31:d=2 hl=2 l= 92 cons: SEQUENCE <br>\n33:d=3 hl=2 l= 11 cons: SET <br>\n35:d=4 hl=2 l= 9 cons: SEQUENCE <br>\n37:d=5 hl=2 l= 3 prim: OBJECT :countryName <br>\n42:d=5 hl=2 l= 2 prim: PRINTABLESTRING :AU <br>\n.... <br>\n599:d=1 hl=2 l= 13 cons: SEQUENCE <br>\n601:d=2 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>\n612:d=2 hl=2 l= 0 prim: NULL <br>\n614:d=1 hl=3 l= 129 prim: BIT STRING</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The final\n<small>BIT STRING</small> contains the actual signature. It\ncan be extracted with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl\nasn1parse -in pca-cert.pem -out sig -noout -strparse 614</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The certificate\npublic key can be extracted with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl x509\n-in test/testx509.pem -pubkey -noout &gt;pubkey.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The signature\ncan be analysed with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl rsautl\n-in sig -verify -asn1parse -inkey pubkey.pem -pubin <br>\n0:d=0 hl=2 l= 32 cons: SEQUENCE <br>\n2:d=1 hl=2 l= 12 cons: SEQUENCE <br>\n4:d=2 hl=2 l= 8 prim: OBJECT :md5 <br>\n14:d=2 hl=2 l= 0 prim: NULL <br>\n16:d=1 hl=2 l= 16 prim: OCTET STRING <br>\n0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5\n.F...Js.7...H%..</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This is the\nparsed version of an <small>ASN1</small> DigestInfo\nstructure. It can be seen that the digest used was md5. The\nactual part of the certificate that was signed can be\nextracted with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl\nasn1parse -in pca-cert.pem -out tbs -noout -strparse 4</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">and its digest\ncomputed with:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl md5 -c\ntbs <br>\nMD5(tbs)=\nf3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">which it can be\nseen agrees with the recovered value above.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/openssl\">openssl(1)</a>,\n<a href=\"https://man.page/1/openssl-pkeyutl\">openssl-pkeyutl(1)</a>, <a href=\"https://man.page/1/openssl-dgst\">openssl-dgst(1)</a>,\n<a href=\"https://man.page/1/openssl-rsa\">openssl-rsa(1)</a>, <a href=\"https://man.page/1/openssl-genrsa\">openssl-genrsa(1)</a></p>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This command\nwas deprecated in OpenSSL 3.0.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-engine</b> option was deprecated in OpenSSL 3.0.</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2000-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"]}