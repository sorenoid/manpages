{"name":"openssl-ts","description":"openssl-ts -\nTime Stamping Authority command","body":"\n\n<h1 align=\"center\">OPENSSL-TS</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl-ts -\nTime Stamping Authority command</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl ts\n-help</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl ts\n-query</b> [<b>-config</b> <i>configfile</i>] [<b>-data</b>\n<i>file_to_hash</i>] [<b>-digest</b> <i>digest_bytes</i>]\n[<b>-</b><b><i>digest</i></b>] [<b>-tspolicy</b>\n<i>object_id</i>] [<b>-no_nonce</b>] [<b>-cert</b>]\n[<b>-in</b> <i>request.tsq</i>] [<b>-out</b>\n<i>request.tsq</i>] [<b>-text</b>] [<b>-rand</b>\n<i>files</i>] [<b>-writerand</b> <i>file</i>]\n[<b>-provider</b> <i>name</i>] [<b>-provider-path</b>\n<i>path</i>] [<b>-propquery</b> <i>propq</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl ts\n-reply</b> [<b>-config</b> <i>configfile</i>]\n[<b>-section</b> <i>tsa_section</i>] [<b>-queryfile</b>\n<i>request.tsq</i>] [<b>-passin</b> <i>password_src</i>]\n[<b>-signer</b> <i>tsa_cert.pem</i>] [<b>-inkey</b>\n<i>filename</i>|<i>uri</i>] [<b>-</b><b><i>digest</i></b>]\n[<b>-chain</b> <i>certs_file.pem</i>] [<b>-tspolicy</b>\n<i>object_id</i>] [<b>-in</b> <i>response.tsr</i>]\n[<b>-token_in</b>] [<b>-out</b> <i>response.tsr</i>]\n[<b>-token_out</b>] [<b>-text</b>] [<b>-engine</b>\n<i>id</i>] [<b>-provider</b> <i>name</i>]\n[<b>-provider-path</b> <i>path</i>] [<b>-propquery</b>\n<i>propq</i>]</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>openssl ts\n-verify</b> [<b>-data</b> <i>file_to_hash</i>]\n[<b>-digest</b> <i>digest_bytes</i>] [<b>-queryfile</b>\n<i>request.tsq</i>] [<b>-in</b> <i>response.tsr</i>]\n[<b>-token_in</b>] [<b>-untrusted</b>\n<i>files</i>|<i>uris</i>] [<b>-CAfile</b> <i>file</i>]\n[<b>-CApath</b> <i>dir</i>] [<b>-CAstore</b> <i>uri</i>]\n[<b>-allow_proxy_certs</b>] [<b>-attime</b>\n<i>timestamp</i>] [<b>-no_check_time</b>]\n[<b>-check_ss_sig</b>] [<b>-crl_check</b>]\n[<b>-crl_check_all</b>] [<b>-explicit_policy</b>]\n[<b>-extended_crl</b>] [<b>-ignore_critical</b>]\n[<b>-inhibit_any</b>] [<b>-inhibit_map</b>]\n[<b>-partial_chain</b>] [<b>-policy</b> <i>arg</i>]\n[<b>-policy_check</b>] [<b>-policy_print</b>]\n[<b>-purpose</b> <i>purpose</i>] [<b>-suiteB_128</b>]\n[<b>-suiteB_128_only</b>] [<b>-suiteB_192</b>]\n[<b>-trusted_first</b>] [<b>-no_alt_chains</b>]\n[<b>-use_deltas</b>] [<b>-auth_level</b> <i>num</i>]\n[<b>-verify_depth</b> <i>num</i>] [<b>-verify_email</b>\n<i>email</i>] [<b>-verify_hostname</b> <i>hostname</i>]\n[<b>-verify_ip</b> <i>ip</i>] [<b>-verify_name</b>\n<i>name</i>] [<b>-x509_strict</b>] [<b>-issuer_checks</b>]\n[<b>-provider</b> <i>name</i>] [<b>-provider-path</b>\n<i>path</i>] [<b>-propquery</b> <i>propq</i>]</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This command is\na basic Time Stamping Authority ( <small>TSA</small> )\nclient and server application as specified in <small>RFC\n3161</small> (Time-Stamp Protocol, <small>TSP</small> ). A\n<small>TSA</small> can be part of a <small>PKI</small>\ndeployment and its role is to provide long term proof of the\nexistence of a certain datum before a particular time. Here\nis a brief description of the protocol:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p>1.</p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>The <small>TSA</small> client computes a one-way hash\nvalue for a data file and sends the hash to the\n<small>TSA.</small></p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p>2.</p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>The <small>TSA</small> attaches the current date and\ntime to the received hash value, signs them and sends the\ntimestamp token back to the client. By creating this token\nthe <small>TSA</small> certifies the existence of the\noriginal data file at the time of response generation.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p>3.</p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>The <small>TSA</small> client receives the timestamp\ntoken and verifies the signature on it. It also checks if\nthe token contains the same hash value that it had sent to\nthe <small>TSA.</small></p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">There is one\n<small>DER</small> encoded protocol data unit defined for\ntransporting a timestamp request to the <small>TSA</small>\nand one for sending the timestamp response back to the\nclient. This command has three main functions: creating a\ntimestamp request based on a data file, creating a timestamp\nresponse based on a request, verifying if a response\ncorresponds to a particular request or a data file.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">There is no\nsupport for sending the requests/responses automatically\nover <small>HTTP</small> or <small>TCP</small> yet as\nsuggested in <small>RFC 3161.</small> The users must send\nthe requests either by ftp or e-mail.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>-help</b></p>\n\n<p style=\"margin-left:17%;\">Print out a usage message.</p>\n\n<p style=\"margin-left:11%;\"><b>-query</b></p>\n\n<p style=\"margin-left:17%;\">Generate a <small>TS</small>\nquery. For details see &quot;Timestamp Request\ngeneration&quot;.</p>\n\n<p style=\"margin-left:11%;\"><b>-reply</b></p>\n\n<p style=\"margin-left:17%;\">Generate a <small>TS</small>\nreply. For details see &quot;Timestamp Response\ngeneration&quot;.</p>\n\n<p style=\"margin-left:11%;\"><b>-verify</b></p>\n\n<p style=\"margin-left:17%;\">Verify a <small>TS</small>\nresponse. For details see &quot;Timestamp Response\nverification&quot;.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nRequest generation</b> <br>\nThe <b>-query</b> command can be used for creating and\nprinting a timestamp request with the following options:\n<b><br>\n-config</b> <i>configfile</i></p>\n\n<p style=\"margin-left:17%;\">The configuration file to use.\nOptional; for a description of the default value, see &quot;\n<small>COMMAND SUMMARY&quot;</small> in\n<a href=\"https://man.page/1/openssl\">openssl(1)</a>.</p>\n\n<p style=\"margin-left:11%;\"><b>-data</b>\n<i>file_to_hash</i></p>\n\n<p style=\"margin-left:17%;\">The data file for which the\ntimestamp request needs to be created. stdin is the default\nif neither the <b>-data</b> nor the <b>-digest</b> parameter\nis specified. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-digest</b>\n<i>digest_bytes</i></p>\n\n<p style=\"margin-left:17%;\">It is possible to specify the\nmessage imprint explicitly without the data file. The\nimprint must be specified in a hexadecimal format, two\ncharacters per byte, the bytes optionally separated by\ncolons (e.g. 1A:F6:01:... or 1AF601...). The number of bytes\nmust match the message digest algorithm in use.\n(Optional)</p>\n\n\n<p style=\"margin-left:11%;\"><b>-</b><b><i>digest</i></b></p>\n\n<p style=\"margin-left:17%;\">The message digest to apply to\nthe data file. Any digest supported by the\n<a href=\"https://man.page/1/openssl-dgst\">openssl-dgst(1)</a> command can be used. The default is\n<small>SHA-256.</small> (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-tspolicy</b>\n<i>object_id</i></p>\n\n<p style=\"margin-left:17%;\">The policy that the client\nexpects the <small>TSA</small> to use for creating the\ntimestamp token. Either the dotted <small>OID</small>\nnotation or <small>OID</small> names defined in the config\nfile can be used. If no policy is requested the\n<small>TSA</small> will use its own default policy.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-no_nonce</b></p>\n\n<p style=\"margin-left:17%;\">No nonce is specified in the\nrequest if this option is given. Otherwise a 64 bit long\npseudo-random none is included in the request. It is\nrecommended to use nonce to protect against replay-attacks.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-cert</b></p>\n\n<p style=\"margin-left:17%;\">The <small>TSA</small> is\nexpected to include its signing certificate in the response.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-in</b>\n<i>request.tsq</i></p>\n\n<p style=\"margin-left:17%;\">This option specifies a\npreviously created timestamp request in <small>DER</small>\nformat that will be printed into the output file. Useful\nwhen you need to examine the content of a request in\nhuman-readable format. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-out</b>\n<i>request.tsq</i></p>\n\n<p style=\"margin-left:17%;\">Name of the output file to\nwhich the request will be written. Default is stdout.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-text</b></p>\n\n<p style=\"margin-left:17%;\">If this option is specified the\noutput is human-readable text format instead of\n<small>DER.</small> (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-rand</b> <i>files</i>,\n<b>-writerand</b> <i>file</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Random State\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a> for details.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nResponse generation</b> <br>\nA timestamp response (TimeStampResp) consists of a response\nstatus and the timestamp token itself (ContentInfo), if the\ntoken generation was successful. The <b>-reply</b> command\nis for creating a timestamp response or timestamp token\nbased on a request and printing the response/token in\nhuman-readable format. If <b>-token_out</b> is not specified\nthe output is always a timestamp response (TimeStampResp),\notherwise it is a timestamp token (ContentInfo). <b><br>\n-config</b> <i>configfile</i></p>\n\n<p style=\"margin-left:17%;\">The configuration file to use.\nOptional; for a description of the default value, see &quot;\n<small>COMMAND SUMMARY&quot;</small> in <a href=\"https://man.page/1/openssl\">openssl(1)</a>.\nSee &quot; <small>CONFIGURATION FILE OPTIONS&quot;</small>\nfor configurable variables.</p>\n\n<p style=\"margin-left:11%;\"><b>-section</b>\n<i>tsa_section</i></p>\n\n<p style=\"margin-left:17%;\">The name of the config file\nsection containing the settings for the response generation.\nIf not specified the default <small>TSA</small> section is\nused, see &quot; <small>CONFIGURATION FILE\nOPTIONS&quot;</small> for details. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-queryfile</b>\n<i>request.tsq</i></p>\n\n<p style=\"margin-left:17%;\">The name of the file containing\na <small>DER</small> encoded timestamp request.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-passin</b>\n<i>password_src</i></p>\n\n<p style=\"margin-left:17%;\">Specifies the password source\nfor the private key of the <small>TSA.</small> See\ndescription in <a href=\"https://man.page/1/openssl\">openssl(1)</a>. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-signer</b>\n<i>tsa_cert.pem</i></p>\n\n<p style=\"margin-left:17%;\">The signer certificate of the\n<small>TSA</small> in <small>PEM</small> format. The\n<small>TSA</small> signing certificate must have exactly one\nextended key usage assigned to it: timeStamping. The\nextended key usage must also be critical, otherwise the\ncertificate is going to be refused. Overrides the\n<b>signer_cert</b> variable of the config file.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-inkey</b>\n<i>filename</i>|<i>uri</i></p>\n\n<p style=\"margin-left:17%;\">The signer private key of the\n<small>TSA</small> in <small>PEM</small> format. Overrides\nthe <b>signer_key</b> config file option. (Optional)</p>\n\n\n<p style=\"margin-left:11%;\"><b>-</b><b><i>digest</i></b></p>\n\n<p style=\"margin-left:17%;\">Signing digest to use.\nOverrides the <b>signer_digest</b> config file option.\n(Mandatory unless specified in the config file)</p>\n\n<p style=\"margin-left:11%;\"><b>-chain</b>\n<i>certs_file.pem</i></p>\n\n<p style=\"margin-left:17%;\">The collection of certificates\nin <small>PEM</small> format that will all be included in\nthe response in addition to the signer certificate if the\n<b>-cert</b> option was used for the request. This file is\nsupposed to contain the certificate chain for the signer\ncertificate from its issuer upwards. The <b>-reply</b>\ncommand does not build a certificate chain automatically.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-tspolicy</b>\n<i>object_id</i></p>\n\n<p style=\"margin-left:17%;\">The default policy to use for\nthe response unless the client explicitly requires a\nparticular <small>TSA</small> policy. The <small>OID</small>\ncan be specified either in dotted notation or with its name.\nOverrides the <b>default_policy</b> config file option.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-in</b>\n<i>response.tsr</i></p>\n\n<p style=\"margin-left:17%;\">Specifies a previously created\ntimestamp response or timestamp token (if <b>-token_in</b>\nis also specified) in <small>DER</small> format that will be\nwritten to the output file. This option does not require a\nrequest, it is useful e.g. when you need to examine the\ncontent of a response or token or you want to extract the\ntimestamp token from a response. If the input is a token and\nthe output is a timestamp response a default\n&rsquo;granted&rsquo; status info is added to the token.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-token_in</b></p>\n\n<p style=\"margin-left:17%;\">This flag can be used together\nwith the <b>-in</b> option and indicates that the input is a\n<small>DER</small> encoded timestamp token (ContentInfo)\ninstead of a timestamp response (TimeStampResp).\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-out</b>\n<i>response.tsr</i></p>\n\n<p style=\"margin-left:17%;\">The response is written to this\nfile. The format and content of the file depends on other\noptions (see <b>-text</b>, <b>-token_out</b>). The default\nis stdout. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-token_out</b></p>\n\n<p style=\"margin-left:17%;\">The output is a timestamp token\n(ContentInfo) instead of timestamp response (TimeStampResp).\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-text</b></p>\n\n<p style=\"margin-left:17%;\">If this option is specified the\noutput is human-readable text format instead of\n<small>DER.</small> (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-engine</b> <i>id</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Engine Options&quot;\nin <a href=\"https://man.page/1/openssl\">openssl(1)</a>. This option is deprecated.</p>\n\n<p style=\"margin-left:11%;\"><b>-provider</b> <i>name</i>\n<b><br>\n-provider-path</b> <i>path</i> <b><br>\n-propquery</b> <i>propq</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Provider\nOptions&quot; in <a href=\"https://man.page/1/openssl\">openssl(1)</a>, <a href=\"https://man.page/7/provider\">provider(7)</a>, and\n<a href=\"https://man.page/7/property\">property(7)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nResponse verification</b> <br>\nThe <b>-verify</b> command is for verifying if a timestamp\nresponse or timestamp token is valid and matches a\nparticular timestamp request or data file. The\n<b>-verify</b> command does not use the configuration file.\n<b><br>\n-data</b> <i>file_to_hash</i></p>\n\n<p style=\"margin-left:17%;\">The response or token must be\nverified against file_to_hash. The file is hashed with the\nmessage digest algorithm specified in the token. The\n<b>-digest</b> and <b>-queryfile</b> options must not be\nspecified with this one. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-digest</b>\n<i>digest_bytes</i></p>\n\n<p style=\"margin-left:17%;\">The response or token must be\nverified against the message digest specified with this\noption. The number of bytes must match the message digest\nalgorithm specified in the token. The <b>-data</b> and\n<b>-queryfile</b> options must not be specified with this\none. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-queryfile</b>\n<i>request.tsq</i></p>\n\n<p style=\"margin-left:17%;\">The original timestamp request\nin <small>DER</small> format. The <b>-data</b> and\n<b>-digest</b> options must not be specified with this one.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-in</b>\n<i>response.tsr</i></p>\n\n<p style=\"margin-left:17%;\">The timestamp response that\nneeds to be verified in <small>DER</small> format.\n(Mandatory)</p>\n\n<p style=\"margin-left:11%;\"><b>-token_in</b></p>\n\n<p style=\"margin-left:17%;\">This flag can be used together\nwith the <b>-in</b> option and indicates that the input is a\n<small>DER</small> encoded timestamp token (ContentInfo)\ninstead of a timestamp response (TimeStampResp).\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>-untrusted</b>\n<i>files</i>|<i>uris</i></p>\n\n<p style=\"margin-left:17%;\">A set of additional untrusted\ncertificates which may be needed when building the\ncertificate chain for the <small>TSA</small> &rsquo;s\nsigning certificate. These do not need to contain the\n<small>TSA</small> signing certificate and intermediate\n<small>CA</small> certificates as far as the response\nalready includes them. (Optional)</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Multiple\nsources may be given, separated by commas and/or whitespace.\nEach file may contain multiple certificates.</p>\n\n<p style=\"margin-left:11%;\"><b>-CAfile</b> <i>file</i>,\n<b>-CApath</b> <i>dir</i>, <b>-CAstore</b> <i>uri</i></p>\n\n<p style=\"margin-left:17%;\">See &quot;Trusted Certificate\nOptions&quot; in <a href=\"https://man.page/1/openssl-verification-options\">openssl-verification-options(1)</a> for\ndetails. At least one of <b>-CAfile</b>, <b>-CApath</b> or\n<b>-CAstore</b> must be specified.</p>\n\n<p style=\"margin-left:11%;\"><b>-allow_proxy_certs</b>,\n<b>-attime</b>, <b>-no_check_time</b>, <b>-check_ss_sig</b>,\n<b>-crl_check</b>, <b><br>\n-crl_check_all</b>, <b>-explicit_policy</b>,\n<b>-extended_crl</b>, <b>-ignore_critical</b>, <b><br>\n-inhibit_any</b>, <b>-inhibit_map</b>,\n<b>-no_alt_chains</b>, <b>-partial_chain</b>,\n<b>-policy</b>, <b><br>\n-policy_check</b>, <b>-policy_print</b>, <b>-purpose</b>,\n<b>-suiteB_128</b>, <b>-suiteB_128_only</b>, <b><br>\n-suiteB_192</b>, <b>-trusted_first</b>, <b>-use_deltas</b>,\n<b>-auth_level</b>, <b>-verify_depth</b>, <b><br>\n-verify_email</b>, <b>-verify_hostname</b>,\n<b>-verify_ip</b>, <b>-verify_name</b>, <b>-x509_strict <br>\n-issuer_checks</b></p>\n\n<p style=\"margin-left:17%;\">Set various options of\ncertificate chain verification. See &quot;Verification\nOptions&quot; in <a href=\"https://man.page/1/openssl-verification-options\">openssl-verification-options(1)</a> for\ndetails.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Any\nverification errors cause the command to exit.</p>\n\n<h2>CONFIGURATION FILE OPTIONS\n<a name=\"CONFIGURATION FILE OPTIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-query</b> and <b>-reply</b> commands make use of a\nconfiguration file. See <a href=\"https://man.page/5/config\">config(5)</a> for a general\ndescription of the syntax of the config file. The\n<b>-query</b> command uses only the symbolic\n<small>OID</small> names section and it can work without it.\nHowever, the <b>-reply</b> command needs the config file for\nits operation.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When there is a\ncommand line switch equivalent of a variable the switch\nalways overrides the settings in the config file. <b><br>\ntsa</b> section, <b>default_tsa</b></p>\n\n<p style=\"margin-left:17%;\">This is the main section and it\nspecifies the name of another section that contains all the\noptions for the <b>-reply</b> command. This default section\ncan be overridden with the <b>-section</b> command line\nswitch. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>oid_file</b></p>\n\n<p style=\"margin-left:17%;\">This specifies a file\ncontaining additional <b><small>OBJECT\nIDENTIFIERS</small></b> . Each line of the file should\nconsist of the numerical form of the object identifier\nfollowed by whitespace then the short name followed by\nwhitespace and finally the long name. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>oid_section</b></p>\n\n<p style=\"margin-left:17%;\">This specifies a section in the\nconfiguration file containing extra object identifiers. Each\nline should consist of the short name of the object\nidentifier followed by <b>=</b> and the numerical form. The\nshort and long names are the same when this option is used.\n(Optional)</p>\n\n\n<p style=\"margin-left:11%;\"><b><small>RANDFILE</small></b></p>\n\n<p style=\"margin-left:17%;\">At startup the specified file\nis loaded into the random number generator, and at exit 256\nbytes will be written to it. (Note: Using a\n<small>RANDFILE</small> is not necessary anymore, see the\n&quot; <small>HISTORY&quot;</small> section.</p>\n\n<p style=\"margin-left:11%;\"><b>serial</b></p>\n\n<p style=\"margin-left:17%;\">The name of the file containing\nthe hexadecimal serial number of the last timestamp response\ncreated. This number is incremented by 1 for each response.\nIf the file does not exist at the time of response\ngeneration a new file is created with serial number 1.\n(Mandatory)</p>\n\n<p style=\"margin-left:11%;\"><b>crypto_device</b></p>\n\n<p style=\"margin-left:17%;\">Specifies the OpenSSL engine\nthat will be set as the default for all available\nalgorithms. The default value is built-in, you can specify\nany other engines supported by OpenSSL (e.g. use chil for\nthe NCipher <small>HSM</small> ). (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>signer_cert</b></p>\n\n<p style=\"margin-left:17%;\"><small>TSA</small> signing\ncertificate in <small>PEM</small> format. The same as the\n<b>-signer</b> command line option. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>certs</b></p>\n\n<p style=\"margin-left:17%;\">A file containing a set of\n<small>PEM</small> encoded certificates that need to be\nincluded in the response. The same as the <b>-chain</b>\ncommand line option. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>signer_key</b></p>\n\n<p style=\"margin-left:17%;\">The private key of the\n<small>TSA</small> in <small>PEM</small> format. The same as\nthe <b>-inkey</b> command line option. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>signer_digest</b></p>\n\n<p style=\"margin-left:17%;\">Signing digest to use. The same\nas the <b>-</b><b><i>digest</i></b> command line option.\n(Mandatory unless specified on the command line)</p>\n\n<p style=\"margin-left:11%;\"><b>default_policy</b></p>\n\n<p style=\"margin-left:17%;\">The default policy to use when\nthe request does not mandate any policy. The same as the\n<b>-tspolicy</b> command line option. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>other_policies</b></p>\n\n<p style=\"margin-left:17%;\">Comma separated list of\npolicies that are also acceptable by the <small>TSA</small>\nand used only if the request explicitly specifies one of\nthem. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>digests</b></p>\n\n<p style=\"margin-left:17%;\">The list of message digest\nalgorithms that the <small>TSA</small> accepts. At least one\nalgorithm must be specified. (Mandatory)</p>\n\n<p style=\"margin-left:11%;\"><b>accuracy</b></p>\n\n<p style=\"margin-left:17%;\">The accuracy of the time source\nof the <small>TSA</small> in seconds, milliseconds and\nmicroseconds. E.g. secs:1, millisecs:500, microsecs:100. If\nany of the components is missing zero is assumed for that\nfield. (Optional)</p>\n\n\n<p style=\"margin-left:11%;\"><b>clock_precision_digits</b></p>\n\n<p style=\"margin-left:17%;\">Specifies the maximum number of\ndigits, which represent the fraction of seconds, that need\nto be included in the time field. The trailing zeros must be\nremoved from the time, so there might actually be fewer\ndigits, or no fraction of seconds at all. Supported only on\n<small>UNIX</small> platforms. The maximum value is 6,\ndefault is 0. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>ordering</b></p>\n\n<p style=\"margin-left:17%;\">If this option is yes the\nresponses generated by this <small>TSA</small> can always be\nordered, even if the time difference between two responses\nis less than the sum of their accuracies. Default is no.\n(Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>tsa_name</b></p>\n\n<p style=\"margin-left:17%;\">Set this option to yes if the\nsubject name of the <small>TSA</small> must be included in\nthe <small>TSA</small> name field of the response. Default\nis no. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>ess_cert_id_chain</b></p>\n\n<p style=\"margin-left:17%;\">The SignedData objects created\nby the <small>TSA</small> always contain the certificate\nidentifier of the signing certificate in a signed attribute\n(see <small>RFC 2634,</small> Enhanced Security Services).\nIf this variable is set to no, only this signing certificate\nidentifier is included in the SigningCertificate signed\nattribute. If this variable is set to yes and the\n<b>certs</b> variable or the <b>-chain</b> option is\nspecified then the certificate identifiers of the chain will\nalso be included, where the <b>-chain</b> option overrides\nthe <b>certs</b> variable. Default is no. (Optional)</p>\n\n<p style=\"margin-left:11%;\"><b>ess_cert_id_alg</b></p>\n\n<p style=\"margin-left:17%;\">This option specifies the hash\nfunction to be used to calculate the <small>TSA</small>\n&rsquo;s public key certificate identifier. Default is\nsha256. (Optional)</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">All the\nexamples below presume that\n<b><small>OPENSSL_CONF</small></b> is set to a proper\nconfiguration file, e.g. the example configuration file\n<i>openssl/apps/openssl.cnf</i> will do.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nRequest</b> <br>\nTo create a timestamp request for <i>design1.txt</i> with\n<small>SHA-256</small> digest, without nonce and policy, and\nwithout requirement for a certificate in the response:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-query -data design1.txt -no_nonce \\ <br>\n-out design1.tsq</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To create a\nsimilar timestamp request with specifying the message\nimprint explicitly:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-query -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \\\n<br>\n-no_nonce -out design1.tsq</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To print the\ncontent of the previous request in human readable\nformat:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-query -in design1.tsq -text</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To create a\ntimestamp request which includes the <small>SHA-512</small>\ndigest of <i>design2.txt</i>, requests the signer\ncertificate and nonce, and specifies a policy id (assuming\nthe tsa_policy1 name is defined in the <small>OID</small>\nsection of the config file):</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-query -data design2.txt -sha512 \\ <br>\n-tspolicy tsa_policy1 -cert -out design2.tsq</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nResponse</b> <br>\nBefore generating a response a signing certificate must be\ncreated for the <small>TSA</small> that contains the\n<b>timeStamping</b> critical extended key usage extension\nwithout any other key usage extensions. You can add this\nline to the user certificate section of the config file to\ngenerate a proper certificate;</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">extendedKeyUsage\n= critical,timeStamping</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">See\n<a href=\"https://man.page/1/openssl-req\">openssl-req(1)</a>, <a href=\"https://man.page/1/openssl-ca\">openssl-ca(1)</a>, and\n<a href=\"https://man.page/1/openssl-x509\">openssl-x509(1)</a> for instructions. The examples below\nassume that <i>cacert.pem</i> contains the certificate of\nthe <small>CA,</small> <i>tsacert.pem</i> is the signing\ncertificate issued by <i>cacert.pem</i> and\n<i>tsakey.pem</i> is the private key of the\n<small>TSA.</small></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To create a\ntimestamp response for a request:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -queryfile design1.tsq -inkey tsakey.pem \\ <br>\n-signer tsacert.pem -out design1.tsr</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If you want to\nuse the settings in the config file you could just\nwrite:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -queryfile design1.tsq -out design1.tsr</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To print a\ntimestamp reply to stdout in human readable format:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -in design1.tsr -text</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To create a\ntimestamp token instead of timestamp response:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -queryfile design1.tsq -out design1_token.der\n-token_out</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To print a\ntimestamp token to stdout in human readable format:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -in design1_token.der -token_in -text -token_out</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To extract the\ntimestamp token from a response:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -in design1.tsr -out design1_token.der -token_out</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To add\n&rsquo;granted&rsquo; status info to a timestamp token\nthereby creating a valid response:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-reply -in design1_token.der -token_in -out design1.tsr</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Timestamp\nVerification</b> <br>\nTo verify a timestamp reply against a request:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-verify -queryfile design1.tsq -in design1.tsr \\ <br>\n-CAfile cacert.pem -untrusted tsacert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To verify a\ntimestamp reply that includes the certificate chain:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">openssl ts\n-verify -queryfile design2.tsq -in design2.tsr \\ <br>\n-CAfile cacert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To verify a\ntimestamp token against the original data file: <br>\nopenssl ts -verify -data design2.txt -in design2.tsr \\ <br>\n-CAfile cacert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To verify a\ntimestamp token against a message imprint: <br>\nopenssl ts -verify -digest\nb7e5d3f93198b38379852f2c04e78d73abdd0f4b \\ <br>\n-in design2.tsr -CAfile cacert.pem</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">You could also\nlook at the &rsquo;test&rsquo; directory for more\nexamples.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p style=\"margin-top: 1em\">No support for timestamps over\n<small>SMTP,</small> though it is quite easy to implement an\nautomatic e-mail based <small>TSA</small> with\n<a href=\"https://man.page/1/procmail\">procmail(1)</a> and <a href=\"https://man.page/1/perl\">perl(1)</a>. <small>HTTP</small>\nserver support is provided in the form of a separate apache\nmodule. <small>HTTP</small> client support is provided by\n<a href=\"https://man.page/1/tsget\">tsget(1)</a>. Pure <small>TCP/IP</small> protocol is not\nsupported.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The file containing the last serial number of the\n<small>TSA</small> is not locked when being read or written.\nThis is a problem if more than one instance of\n<a href=\"https://man.page/1/openssl\">openssl(1)</a> is trying to create a timestamp response\nat the same time. This is not an issue when using the apache\nserver module, it does proper locking.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>Look for the <small>FIXME</small> word in the source\nfiles.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The source code should really be reviewed by somebody\nelse, too.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>More testing is needed, I have done only some basic\ntests (see test/testtsa).</p></td></tr>\n</table>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">OpenSSL 1.1.1\nintroduced a new random generator ( <small>CSPRNG</small> )\nwith an improved seeding mechanism. The new seeding\nmechanism makes it unnecessary to define a\n<small>RANDFILE</small> for saving and restoring randomness.\nThis option is retained mainly for compatibility\nreasons.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>-engine</b> option was deprecated in OpenSSL 3.0.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/openssl\">openssl(1)</a>,\n<a href=\"https://man.page/1/tsget\">tsget(1)</a>, <a href=\"https://man.page/1/openssl-req\">openssl-req(1)</a>,\n<a href=\"https://man.page/1/openssl-x509\">openssl-x509(1)</a>, <a href=\"https://man.page/1/openssl-ca\">openssl-ca(1)</a>,\n<a href=\"https://man.page/1/openssl-genrsa\">openssl-genrsa(1)</a>, <a href=\"https://man.page/5/config\">config(5)</a>,\n<a href=\"https://man.page/7/ossl_store-file\">ossl_store-file(7)</a></p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2006-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#CONFIGURATION FILE OPTIONS\">CONFIGURATION FILE OPTIONS</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"]}