{"name":"dpkg-gensymbols","description":"dpkg-gensymbols\n- generate symbols files (shared library dependency\ninformation)","body":"\n\n<h1 align=\"center\">dpkg-gensymbols</h1>\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">dpkg-gensymbols\n- generate symbols files (shared library dependency\ninformation)</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>dpkg-gensymbols</b>\n[<i>option</i>...]</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>dpkg-gensymbols</b>\nscans a temporary build tree (debian/tmp by default) looking\nfor libraries and generates a <i>symbols</i> file describing\nthem. This file, if non-empty, is then installed in the\n<small>DEBIAN</small> subdirectory of the build tree so that\nit ends up included in the control information of the\npackage.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When generating\nthose files, it uses as input some symbols files provided by\nthe maintainer. It looks for the following files (and uses\nthe first that is found):</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"41%\">\n\n\n<p>debian/<i>package</i>.symbols.<i>arch</i></p></td>\n<td width=\"42%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"41%\">\n\n\n<p>debian/symbols.<i>arch</i></p></td>\n<td width=\"42%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"41%\">\n\n\n<p>debian/<i>package</i>.symbols</p></td>\n<td width=\"42%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"41%\">\n\n\n<p>debian/symbols</p></td>\n<td width=\"42%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The main\ninterest of those files is to provide the minimal version\nassociated to each symbol provided by the libraries. Usually\nit corresponds to the first version of that package that\nprovided the symbol, but it can be manually incremented by\nthe maintainer if the <small>ABI</small> of the symbol is\nextended without breaking backwards compatibility.\nIt&rsquo;s the responsibility of the maintainer to keep\nthose files up-to-date and accurate, but\n<b>dpkg-gensymbols</b> helps with that.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When the\ngenerated symbols files differ from the maintainer supplied\none, <b>dpkg-gensymbols</b> will print a diff between the\ntwo versions. Furthermore if the difference is too\nsignificant, it will even fail (you can customize how much\ndifference you can tolerate, see the <b>-c</b> option).</p>\n\n<h2>MAINTAINING SYMBOLS FILES\n<a name=\"MAINTAINING SYMBOLS FILES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The base\ninterchange format of the symbols file is described in\n<a href=\"https://man.page/5/deb-symbols\">deb-symbols(5)</a>, which is used by the symbols files\nincluded in binary packages. These are generated from\ntemplate symbols files with a format based on the former,\ndescribed in <a href=\"https://man.page/5/deb-src-symbols\">deb-src-symbols(5)</a> and included in\nsource packages.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The symbols\nfiles are really useful only if they reflect the evolution\nof the package through several releases. Thus the maintainer\nhas to update them every time that a new symbol is added so\nthat its associated minimal version matches reality.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The diffs\ncontained in the build logs can be used as a starting point,\nbut the maintainer, additionally, has to make sure that the\nbehaviour of those symbols has not changed in a way that\nwould make anything using those symbols and linking against\nthe new version, stop working with the old version.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In most cases,\nthe diff applies directly to the\ndebian/<i>package</i>.symbols file. That said, further\ntweaks are usually needed: it&rsquo;s recommended for\nexample to drop the Debian revision from the minimal version\nso that backports with a lower version number but the same\nupstream version still satisfy the generated dependencies.\nIf the Debian revision can&rsquo;t be dropped because the\nsymbol really got added by the Debian specific change, then\none should suffix the version with\n&rsquo;<b>~</b>&rsquo;.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Before applying\nany patch to the symbols file, the maintainer should\ndouble-check that it&rsquo;s sane. Public symbols are not\nsupposed to disappear, so the patch should ideally only add\nnew lines.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note that you\ncan put comments in symbols files.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Do not forget\nto check if old symbol versions need to be increased. There\nis no way <b>dpkg-gensymbols</b> can warn about this.\nBlindly applying the diff or assuming there is nothing to\nchange if there is no diff, without checking for such\nchanges, can lead to packages with loose dependencies that\nclaim they can work with older packages they cannot work\nwith. This will introduce hard to find bugs with (partial)\nupgrades.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Good library\nmanagement</b> <br>\nA well-maintained library has the following features:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p style=\"margin-top: 1em\">its <small>API</small> is stable\n(public symbols are never dropped, only new public symbols\nare added) and changes in incompatible ways only when the\n<small>SONAME</small> changes;</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>ideally, it uses symbol versioning to achieve\n<small>ABI</small> stability despite internal changes and\n<small>API</small> extension;</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"5%\"></td>\n<td width=\"83%\">\n\n\n<p>it doesn&rsquo;t export private symbols (such symbols\ncan be tagged optional as workaround).</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">While\nmaintaining the symbols file, it&rsquo;s easy to notice\nappearance and disappearance of symbols. But it&rsquo;s more\ndifficult to catch incompatible <small>API</small> and\n<small>ABI</small> change. Thus the maintainer should read\nthoroughly the upstream changelog looking for cases where\nthe rules of good library management have been broken. If\npotential problems are discovered, the upstream author\nshould be notified as an upstream fix is always better than\na Debian specific work-around.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>-P</b><i>package-build-dir</i></p>\n\n<p style=\"margin-left:17%;\">Scan <i>package-build-dir</i>\ninstead of debian/tmp.</p>\n\n<p style=\"margin-left:11%;\"><b>-p</b><i>package</i></p>\n\n<p style=\"margin-left:17%;\">Define the package name.\nRequired if more than one binary package is listed in\ndebian/control (or if there&rsquo;s no debian/control\nfile).</p>\n\n<p style=\"margin-left:11%;\"><b>-v</b><i>version</i></p>\n\n<p style=\"margin-left:17%;\">Define the package version.\nDefaults to the version extracted from debian/changelog.\nRequired if called outside of a source package tree.</p>\n\n\n<p style=\"margin-left:11%;\"><b>-e</b><i>library-file</i></p>\n\n<p style=\"margin-left:17%;\">Only analyze libraries\nexplicitly listed instead of finding all public libraries.\nYou can use shell patterns used for pathname expansions (see\nthe <b>File::Glob</b>(3perl) manual page for details) in\n<i>library-file</i> to match multiple libraries with a\nsingle argument (otherwise you need multiple <b>-e</b>).</p>\n\n<p style=\"margin-left:11%;\"><b>-l</b><i>directory</i></p>\n\n<p style=\"margin-left:17%;\">Prepend <i>directory</i> to the\nlist of directories to search for private shared libraries\n(since dpkg 1.19.1). This option can be used multiple\ntimes.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\"><b>Note:</b>\nUse this option instead of setting\n<b><small>LD_LIBRARY_PATH</small></b> , as that environment\nvariable is used to control the run-time linker and abusing\nit to set the shared library paths at build-time can be\nproblematic when cross-compiling for example.</p>\n\n<p style=\"margin-left:11%;\"><b>-I</b><i>filename</i></p>\n\n<p style=\"margin-left:17%;\">Use <i>filename</i> as\nreference file to generate the symbols file that is\nintegrated in the package itself.</p>\n\n<p style=\"margin-left:11%;\"><b>-O</b>[<i>filename</i>]</p>\n\n<p style=\"margin-left:17%;\">Print the generated symbols\nfile to standard output or to <i>filename</i> if specified,\nrather than to <b>debian/tmp/DEBIAN/symbols</b> (or\n<i>package-build-dir</i><b>/DEBIAN/symbols</b> if <b>-P</b>\nwas used). If <i>filename</i> is pre-existing, its contents\nare used as basis for the generated symbols file. You can\nuse this feature to update a symbols file so that it matches\na newer upstream version of your library.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p><b>-t</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>Write the symbol file in template mode rather than the\nformat compatible with <a href=\"https://man.page/5/deb-symbols\">deb-symbols(5)</a>. The main\ndifference is that in the template mode symbol names and\ntags are written in their original form contrary to the\npost-processed symbol names with tags stripped in the\ncompatibility mode. Moreover, some symbols might be omitted\nwhen writing a standard <a href=\"https://man.page/5/deb-symbols\">deb-symbols(5)</a> file\n(according to the tag processing rules) while all symbols\nare always written to the symbol file template.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>-c</b><i>[0-4]</i></p>\n\n<p style=\"margin-left:17%;\">Define the checks to do when\ncomparing the generated symbols file with the template file\nused as starting point. By default the level is 1.\nIncreasing levels do more checks and include all checks of\nlower levels. <br>\nLevel 0</p>\n\n<p style=\"margin-left:23%;\">Never fails.</p>\n\n<p style=\"margin-left:17%;\">Level 1</p>\n\n<p style=\"margin-left:23%;\">Fails if some symbols have\ndisappeared.</p>\n\n<p style=\"margin-left:17%;\">Level 2</p>\n\n<p style=\"margin-left:23%;\">Fails if some new symbols have\nbeen introduced.</p>\n\n<p style=\"margin-left:17%;\">Level 3</p>\n\n<p style=\"margin-left:23%;\">Fails if some libraries have\ndisappeared.</p>\n\n<p style=\"margin-left:17%;\">Level 4</p>\n\n<p style=\"margin-left:23%;\">Fails if some libraries have\nbeen introduced.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">This value can\nbe overridden by the environment variable\n<b><small>DPKG_GENSYMBOLS_CHECK_LEVEL</small></b> .</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p><b>-q</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>Keep quiet and never generate a diff between generated\nsymbols file and the template file used as starting point or\nshow any warnings about new/lost libraries or new/lost\nsymbols. This option only disables informational output but\nnot the checks themselves (see <b>-c</b> option).</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>-a</b><i>arch</i></p>\n\n<p style=\"margin-left:17%;\">Assume <i>arch</i> as host\narchitecture when processing symbol files. Use this option\nto generate a symbol file or diff for any architecture\nprovided its binaries are already available.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p><b>-d</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>Enable debug mode. Numerous messages are displayed to\nexplain what <b>dpkg-gensymbols</b> does.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p><b>-V</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"83%\">\n\n\n<p>Enable verbose mode. The generated symbols file contains\ndeprecated symbols as comments. Furthermore in template\nmode, pattern symbols are followed by comments listing real\nsymbols that have matched the pattern.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>-?</b>, <b>--help</b></p>\n\n<p style=\"margin-left:17%;\">Show the usage message and\nexit.</p>\n\n<p style=\"margin-left:11%;\"><b>--version</b></p>\n\n<p style=\"margin-left:17%;\">Show the version and exit.</p>\n\n<h2>ENVIRONMENT\n<a name=\"ENVIRONMENT\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b><small>DPKG_GENSYMBOLS_CHECK_LEVEL</small></b></p>\n\n<p style=\"margin-left:17%;\">Overrides the command check\nlevel, even if the <b>-c</b> command-line argument was given\n(note that this goes against the common convention of\ncommand-line arguments having precedence over environment\nvariables).</p>\n\n\n<p style=\"margin-left:11%;\"><b><small>DPKG_COLORS</small></b></p>\n\n<p style=\"margin-left:17%;\">Sets the color mode (since dpkg\n1.18.5). The currently accepted values are: <b>auto</b>\n(default), <b>always</b> and <b>never</b>.</p>\n\n\n<p style=\"margin-left:11%;\"><b><small>DPKG_NLS</small></b></p>\n\n<p style=\"margin-left:17%;\">If set, it will be used to\ndecide whether to activate Native Language Support, also\nknown as internationalization (or i18n) support (since dpkg\n1.19.0). The accepted values are: <b>0</b> and <b>1</b>\n(default).</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">&lt;https://people.redhat.com/drepper/symbol-versioning&gt;,\n&lt;https://people.redhat.com/drepper/goodpractice.pdf&gt;,\n&lt;https://people.redhat.com/drepper/dsohowto.pdf&gt;,\n<a href=\"https://man.page/5/deb-src-symbol\">deb-src-symbol(5)</a>, <a href=\"https://man.page/5/deb-symbols\">deb-symbols(5)</a>,\n<a href=\"https://man.page/1/dpkg-shlibdeps\">dpkg-shlibdeps(1)</a>.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#MAINTAINING SYMBOLS FILES\">MAINTAINING SYMBOLS FILES</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#ENVIRONMENT\">ENVIRONMENT</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>"]}