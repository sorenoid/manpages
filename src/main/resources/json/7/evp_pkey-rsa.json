{"name":"evp_pkey-rsa","description":"EVP_PKEY-RSA, EVP_KEYMGMT-RSA, RSA - EVP_PKEY RSA keytype and algorithm support","body":"\n\n<h1 align=\"center\">EVP_PKEY-RSA</h1>\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_PKEY-RSA,\nEVP_KEYMGMT-RSA, RSA - EVP_PKEY RSA keytype and algorithm\nsupport</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b><small>RSA</small></b> keytype is implemented in\nOpenSSL&rsquo;s default and <small>FIPS</small> providers.\nThat implementation supports the basic <small>RSA</small>\nkeys, containing the modulus <i>n</i>, the public exponent\n<i>e</i>, the private exponent <i>d</i>, and a collection of\nprime factors, exponents and coefficient for\n<small>CRT</small> calculations, of which the first few are\nknown as <i>p</i> and <i>q</i>, <i>dP</i> and <i>dQ</i>, and\n<i>qInv</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Common\n<small>RSA</small> parameters</b> <br>\nIn addition to the common parameters that all keytypes\nshould support (see &quot;Common parameters&quot; in\n<a href=\"https://man.page/7/provider-keymgmt\">provider-keymgmt(7)</a>), the <b><small>RSA</small></b>\nkeytype implementation supports the following. <br>\n&quot;n&quot; ( <b><small>OSSL_PKEY_PARAM_RSA_N</small></b>\n) &lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The <small>RSA</small>\n&quot;n&quot; value.</p>\n\n<p style=\"margin-left:11%;\">&quot;e&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_E</small></b> ) &lt;unsigned\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\">The <small>RSA</small>\n&quot;e&quot; value.</p>\n\n<p style=\"margin-left:11%;\">&quot;d&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_D</small></b> ) &lt;unsigned\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\">The <small>RSA</small>\n&quot;d&quot; value.</p>\n\n<p style=\"margin-left:11%;\">&quot;rsa-factor1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR2</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor3&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR3</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor4&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR4</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor5&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR5</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor6&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR6</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor7&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR7</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor8&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR8</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor9&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR9</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-factor10&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_FACTOR10</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\"><small>RSA</small> prime\nfactors. The factors are known as &quot;p&quot;,\n&quot;q&quot; and &quot;r_i&quot; in <small>RFC8017.</small>\nUp to eight additional &quot;r_i&quot; prime factors are\nsupported.</p>\n\n<p style=\"margin-left:11%;\">&quot;rsa-exponent1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT2</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent3&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT3</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent4&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT4</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent5&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT5</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent6&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT6</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent7&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT7</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent8&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT8</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent9&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT9</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;rsa-exponent10&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT10</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\"><small>RSA CRT</small> (Chinese\nRemainder Theorem) exponents. The exponents are known as\n&quot;dP&quot;, &quot;dQ&quot; and &quot;d_i in\n<small>RFC8017&quot;.</small> Up to eight additional\n&quot;d_i&quot; exponents are supported.</p>\n\n<p style=\"margin-left:11%;\">&quot;rsa-coefficient1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT1</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT2</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient3&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT3</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient4&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT4</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient5&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT5</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient6&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT6</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient7&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT7</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient8&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT8</small></b> )\n&lt;unsigned <br>\ninteger&gt; <br>\n&quot;rsa-coefficient9&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT9</small></b> )\n&lt;unsigned <br>\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\"><small>RSA CRT</small> (Chinese\nRemainder Theorem) coefficients. The coefficients are known\nas &quot;qInv&quot; and &quot;t_i&quot;. Up to eight\nadditional &quot;t_i&quot; exponents are supported.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b><small>RSA</small>\nkey generation parameters</b> <br>\nWhen generating <small>RSA</small> keys, the following key\ngeneration parameters may be used. <br>\n&quot;bits&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_BITS</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The value should be the\ncryptographic length for the <b><small>RSA</small></b>\ncryptosystem, in bits.</p>\n\n<p style=\"margin-left:11%;\">&quot;primes&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_PRIMES</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The value should be the number\nof primes for the generated <b><small>RSA</small></b> key.\nThe default is 2. It isn&rsquo;t permitted to specify a\nlarger number of primes than 10. Additionally, the number of\nprimes is limited by the length of the key being generated\nso the maximum number could be less. Some providers may only\nsupport a value of 2.</p>\n\n<p style=\"margin-left:11%;\">&quot;e&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_E</small></b> ) &lt;unsigned\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\">The <small>RSA</small>\n&quot;e&quot; value. The value may be any odd number greater\nthan or equal to 65537. The default value is 65537. For\nlegacy reasons a value of 3 is currently accepted but is\ndeprecated.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b><small>RSA</small>\nkey generation parameters for <small>FIPS</small> module\ntesting</b> <br>\nWhen generating <small>RSA</small> keys, the following\nadditional key generation parameters may be used for\nalgorithm testing purposes only. Do not use these to\ngenerate <small>RSA</small> keys for a production\nenvironment. <br>\n&quot;xp&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;xq&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">These 2 fields are normally\nrandomly generated and are used to generate &quot;p&quot;\nand &quot;q&quot;.</p>\n\n<p style=\"margin-left:11%;\">&quot;xp1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;xp2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP2</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;xq1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;xq2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ2</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">These 4 fields are normally\nrandomly generated. The prime factors &quot;p1&quot;,\n&quot;p2&quot;, &quot;q1&quot; and &quot;q2&quot; are\ndetermined from these values.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b><small>RSA</small>\nkey parameters for <small>FIPS</small> module testing</b>\n<br>\nThe following intermediate values can be retrieved only if\nthe values specified in &quot; <small>RSA</small> key\ngeneration parameters for <small>FIPS</small> module\ntesting&quot; are set. These should not be accessed in a\nproduction environment. <br>\n&quot;p1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_P1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;p2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_P2</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;q1&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_Q1</small></b> )\n&lt;unsigned integer&gt; <br>\n&quot;q2&quot; (\n<b><small>OSSL_PKEY_PARAM_RSA_TEST_Q2</small></b> )\n&lt;unsigned integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The auxiliary probable\nprimes.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><small>FIPS186-4</small></p>\n\n<p style=\"margin-left:17%;\">Section B.3.6 Generation of\nProbable Primes with Conditions Based on Auxiliary Probable\nPrimes</p>\n\n<p style=\"margin-left:11%;\"><small>RFC 8017,</small>\nexcluding RSA-PSS and RSA-OAEP</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">An\n<b><small>EVP_PKEY</small></b> context can be obtained by\ncalling:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_PKEY_CTX\n*pctx = <br>\nEVP_PKEY_CTX_new_from_name(NULL, &quot;RSA&quot;, NULL);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">An\n<b><small>RSA</small></b> key can be generated simply like\nthis:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">pkey =\nEVP_RSA_gen(4096);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">or like\nthis:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_PKEY *pkey\n= NULL; <br>\nEVP_PKEY_CTX *pctx = <br>\nEVP_PKEY_CTX_new_from_name(NULL, &quot;RSA&quot;, NULL);\n<br>\nEVP_PKEY_keygen_init(pctx); <br>\nEVP_PKEY_generate(pctx, &amp;pkey); <br>\nEVP_PKEY_CTX_free(pctx);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">An\n<b><small>RSA</small></b> key can be generated with key\ngeneration parameters:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">unsigned int\nprimes = 3; <br>\nunsigned int bits = 4096; <br>\nOSSL_PARAM params[3]; <br>\nEVP_PKEY *pkey = NULL; <br>\nEVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_from_name(NULL,\n&quot;RSA&quot;, NULL); <br>\nEVP_PKEY_keygen_init(pctx); <br>\nparams[0] = OSSL_PARAM_construct_uint(&quot;bits&quot;,\n&amp;bits); <br>\nparams[1] = OSSL_PARAM_construct_uint(&quot;primes&quot;,\n&amp;primes); <br>\nparams[2] = OSSL_PARAM_construct_end(); <br>\nEVP_PKEY_CTX_set_params(pctx, params); <br>\nEVP_PKEY_generate(pctx, &amp;pkey); <br>\nEVP_PKEY_print_private(bio_out, pkey, 0, NULL); <br>\nEVP_PKEY_CTX_free(pctx);</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/EVP_RSA_gen\">EVP_RSA_gen(3)</a>,\n<b><small>EVP_KEYMGMT</small></b> (3),\n<b><small>EVP_PKEY</small></b> (3),\n<a href=\"https://man.page/7/provider-keymgmt\">provider-keymgmt(7)</a></p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2020-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"],"level":7}