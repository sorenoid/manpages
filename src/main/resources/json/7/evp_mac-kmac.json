{"name":"evp_mac-kmac","body":"\n\n<h1 align=\"center\">EVP_MAC-KMAC</h1>\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_MAC-KMAC,\nEVP_MAC-KMAC128, EVP_MAC-KMAC256 - The KMAC EVP_MAC\nimplementations</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Support for\ncomputing <small>KMAC</small> MACs through the\n<b><small>EVP_MAC</small></b> <small>API.</small></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Identity</b>\n<br>\nThese implementations are identified with one of these names\nand properties, to be used with <b>EVP_MAC_fetch()</b>: <br>\n&quot; <small>KMAC-128&quot;,</small>\n&quot;provider=default&quot; or &quot;provider=fips&quot;\n<br>\n&quot; <small>KMAC-256&quot;,</small>\n&quot;provider=default&quot; or\n&quot;provider=fips&quot;</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nparameters</b> <br>\nThe general description of these parameters can be found in\n&quot; <small>PARAMETERS&quot;</small> in\n<b><small>EVP_MAC</small></b> (3).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">All these\nparameters can be set with <b>EVP_MAC_CTX_set_params()</b>.\nFurthermore, the &quot;size&quot; parameter can be retrieved\nwith <b>EVP_MAC_CTX_get_params()</b>, or with\n<b>EVP_MAC_CTX_get_mac_size()</b>. The length of the\n&quot;size&quot; parameter should not exceed that of a\n<b>size_t</b>. Likewise, the &quot;block-size&quot;\nparameter can be retrieved with\n<b>EVP_MAC_CTX_get_params()</b>, or with\n<b>EVP_MAC_CTX_get_block_size()</b>. <br>\n&quot;key&quot; ( <b><small>OSSL_MAC_PARAM_KEY</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">Sets the <small>MAC</small>\nkey. Setting this parameter is identical to passing a\n<i>key</i> to <a href=\"https://man.page/3/EVP_MAC_init\">EVP_MAC_init(3)</a>.</p>\n\n<p style=\"margin-left:11%;\">&quot;custom&quot; (\n<b><small>OSSL_MAC_PARAM_CUSTOM</small></b> ) &lt;octet\nstring&gt;</p>\n\n<p style=\"margin-left:17%;\">Sets the custom value. It is an\noptional value of at most 256 bytes, and is empty by\ndefault.</p>\n\n<p style=\"margin-left:11%;\">&quot;size&quot; (\n<b><small>OSSL_MAC_PARAM_SIZE</small></b> ) &lt;unsigned\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\">Sets the <small>MAC</small>\nsize. By default, it is 16 for &quot;KMAC-128&quot; and 32\nfor &quot;KMAC-256&quot;.</p>\n\n<p style=\"margin-left:11%;\">&quot;block-size&quot; (\n<b><small>OSSL_MAC_PARAM_SIZE</small></b> ) &lt;unsigned\ninteger&gt;</p>\n\n<p style=\"margin-left:17%;\">Gets the <small>MAC</small>\nblock size. By default, it is 168 for &quot;KMAC-128&quot;\nand 136 for &quot;KMAC-256&quot;.</p>\n\n<p style=\"margin-left:11%;\">&quot;xof&quot; (\n<b><small>OSSL_MAC_PARAM_XOF</small></b> )\n&lt;integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The &quot;xof&quot; parameter\nvalue is expected to be 1 or 0. Use 1 to enable\n<small>XOF</small> mode. The default value is 0.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n&quot;custom&quot; parameter must be set as part of or\nbefore the <b>EVP_MAC_init()</b> call. The &quot;xof&quot;\nand &quot;size&quot; parameters can be set at any time\nbefore <b>EVP_MAC_final()</b>. The &quot;key&quot; parameter\nis set as part of the <b>EVP_MAC_init()</b> call, but can be\nset before it instead.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">#include\n&lt;openssl/evp.h&gt; <br>\n#include &lt;openssl/params.h&gt; <br>\nstatic int do_kmac(const unsigned char *in, size_t in_len,\n<br>\nconst unsigned char *key, size_t key_len, <br>\nconst unsigned char *custom, size_t custom_len, <br>\nint xof_enabled, unsigned char *out, int out_len) <br>\n{ <br>\nEVP_MAC_CTX *ctx = NULL; <br>\nEVP_MAC *mac = NULL; <br>\nOSSL_PARAM params[4], *p; <br>\nint ret = 0; <br>\nsize_t l = 0; <br>\nmac = EVP_MAC_fetch(NULL, &quot;KMAC-128&quot;, NULL); <br>\nif (mac == NULL) <br>\ngoto err; <br>\nctx = EVP_MAC_CTX_new(mac); <br>\n/* The mac can be freed after it is used by EVP_MAC_CTX_new\n*/ <br>\nEVP_MAC_free(mac); <br>\nif (ctx == NULL) <br>\ngoto err; <br>\n/* <br>\n* Setup parameters required before calling EVP_MAC_init()\n<br>\n* The parameters OSSL_MAC_PARAM_XOF and OSSL_MAC_PARAM_SIZE\nmay also be <br>\n* used at this point. <br>\n*/ <br>\np = params; <br>\n*p++ = OSSL_PARAM_construct_octet_string(OSSL_MAC_PARAM_KEY,\n<br>\n(void *)key, key_len); <br>\nif (custom != NULL &amp;&amp; custom_len != 0) <br>\n*p++ =\nOSSL_PARAM_construct_octet_string(OSSL_MAC_PARAM_CUSTOM,\n<br>\n(void *)custom, custom_len); <br>\n*p = OSSL_PARAM_construct_end(); <br>\nif (!EVP_MAC_CTX_set_params(ctx, params)) <br>\ngoto err; <br>\nif (!EVP_MAC_init(ctx)) <br>\ngoto err; <br>\n/* <br>\n* Note: the following optional parameters can be set any\ntime <br>\n* before EVP_MAC_final(). <br>\n*/ <br>\np = params; <br>\n*p++ = OSSL_PARAM_construct_int(OSSL_MAC_PARAM_XOF,\n&amp;xof_enabled); <br>\n*p++ = OSSL_PARAM_construct_int(OSSL_MAC_PARAM_SIZE,\n&amp;out_len); <br>\n*p = OSSL_PARAM_construct_end(); <br>\nif (!EVP_MAC_CTX_set_params(ctx, params)) <br>\ngoto err; <br>\n/* The update may be called multiple times here for streamed\ninput */ <br>\nif (!EVP_MAC_update(ctx, in, in_len)) <br>\ngoto err; <br>\nif (!EVP_MAC_final(ctx, out, &amp;l, out_len)) <br>\ngoto err; <br>\nret = 1; <br>\nerr: <br>\nEVP_MAC_CTX_free(ctx); <br>\nreturn ret; <br>\n}</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/EVP_MAC_CTX_get_params\">EVP_MAC_CTX_get_params(3)</a>,\n<a href=\"https://man.page/3/EVP_MAC_CTX_set_params\">EVP_MAC_CTX_set_params(3)</a>, &quot;\n<small>PARAMETERS&quot;</small> in\n<b><small>EVP_MAC</small></b> (3),\n<b><small>OSSL_PARAM</small></b> (3)</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2018-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"],"level":7}