{"name":"qemu-cpu-models","description":"qemu-cpu-models\n- QEMU CPU Models","body":"\n\n<h1 align=\"center\">QEMU-CPU-MODELS</h1>\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">qemu-cpu-models\n- QEMU CPU Models</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">QEMU CPU\nModelling Infrastructure manual</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Recommendations\nfor KVM CPU model configuration on x86 hosts</b> <br>\nThe information that follows provides recommendations for\nconfiguring CPU models on x86 hosts. The goals are to\nmaximise performance, while protecting guest OS against\nvarious CPU hardware flaws, and optionally enabling live\nmigration between hosts with heterogeneous CPU models.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Two ways to\nconfigure CPU models with QEMU / KVM</b></p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p>1.</p></td>\n<td width=\"1%\"></td>\n<td width=\"25%\">\n\n\n<p><b>Host passthrough</b></p></td>\n<td width=\"60%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:15%; margin-top: 1em\">This passes the\nhost CPU model features, model, stepping, exactly to the\nguest. Note that KVM may filter out some host CPU model\nfeatures if they cannot be supported with virtualization.\nLive migration is unsafe when this mode is used as libvirt /\nQEMU cannot guarantee a stable CPU is exposed to the guest\nacross hosts. This is the recommended CPU to use, provided\nlive migration is not required.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"3%\">\n\n\n<p style=\"margin-top: 1em\">2.</p></td>\n<td width=\"1%\"></td>\n<td width=\"17%\">\n\n\n<p style=\"margin-top: 1em\"><b>Named model</b></p></td>\n<td width=\"68%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:15%; margin-top: 1em\">QEMU comes with\na number of predefined named CPU models, that typically\nrefer to specific generations of hardware released by Intel\nand AMD. These allow the guest VMs to have a degree of\nisolation from the host CPU, allowing greater flexibility in\nlive migrating between hosts with differing hardware. @end\ntable</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In both cases,\nit is possible to optionally add or remove individual CPU\nfeatures, to alter what is presented to the guest by\ndefault.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Libvirt\nsupports a third way to configure CPU models known as\n&quot;Host model&quot;. This uses the QEMU &quot;Named\nmodel&quot; feature, automatically picking a CPU model that\nis similar the host CPU, and then adding extra features to\napproximate the host model as closely as possible. This does\nnot guarantee the CPU family, stepping, etc will precisely\nmatch the host CPU, as they would with &quot;Host\npassthrough&quot;, but gives much of the benefit of\npassthrough, while making live migration safe.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>ABI\ncompatibility levels for CPU models</b> <br>\nThe x86_64 architecture has a number of <i>ABI compatibility\nlevels</i> defined. Traditionally most operating systems and\ntoolchains would only target the original baseline ABI. It\nis expected that in future OS and toolchains are likely to\ntarget newer ABIs. The table that follows illustrates which\nABI compatibility levels can be satisfied by the QEMU CPU\nmodels. Note that the table only lists the long term stable\nCPU model versions (eg Haswell-v4). In addition to what is\nlisted, there are also many CPU model aliases which resolve\nto a different CPU model version, depending on the machine\ntype is in use.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>x86-64 ABI\ncompatibility levels</b></p>\n\n\n<p align=\"center\"><img src=\"grohtml-3530081.png\" alt=\"Image grohtml-3530081.png\"></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Preferred\nCPU models for Intel x86 hosts</b> <br>\nThe following CPU models are preferred for use on Intel\nhosts. Administrators / applications are recommended to use\nthe CPU model that matches the generation of the host CPUs\nin use. In a deployment with a mixture of host CPU models\nbetween machines, if live migration compatibility is\nrequired, use the newest CPU model that is compatible across\nall desired hosts. <b><br>\nCascadelake-Server, Cascadelake-Server-noTSX</b></p>\n\n<p style=\"margin-left:22%;\">Intel Xeon Processor (Cascade\nLake, 2019), with &quot;stepping&quot; levels 6 or 7 only.\n(The Cascade Lake Xeon processor with <i>stepping 5 is\nvulnerable to MDS variants</i>.)</p>\n\n<p style=\"margin-left:11%;\"><b>Skylake-Server,\nSkylake-Server-IBRS, Skylake-Server-IBRS-noTSX</b></p>\n\n<p style=\"margin-left:22%;\">Intel Xeon Processor (Skylake,\n2016)</p>\n\n<p style=\"margin-left:11%;\"><b>Skylake-Client,\nSkylake-Client-IBRS, Skylake-Client-noTSX-IBRS}</b></p>\n\n<p style=\"margin-left:22%;\">Intel Core Processor (Skylake,\n2015)</p>\n\n<p style=\"margin-left:11%;\"><b>Broadwell, Broadwell-IBRS,\nBroadwell-noTSX, Broadwell-noTSX-IBRS</b></p>\n\n<p style=\"margin-left:22%;\">Intel Core Processor\n(Broadwell, 2014)</p>\n\n<p style=\"margin-left:11%;\"><b>Haswell, Haswell-IBRS,\nHaswell-noTSX, Haswell-noTSX-IBRS</b></p>\n\n<p style=\"margin-left:22%;\">Intel Core Processor (Haswell,\n2013)</p>\n\n<p style=\"margin-left:11%;\"><b>IvyBridge,\nIvyBridge-IBR</b></p>\n\n<p style=\"margin-left:22%;\">Intel Xeon E3-12xx v2 (Ivy\nBridge, 2012)</p>\n\n<p style=\"margin-left:11%;\"><b>SandyBridge,\nSandyBridge-IBRS</b></p>\n\n<p style=\"margin-left:22%;\">Intel Xeon E312xx (Sandy\nBridge, 2011)</p>\n\n<p style=\"margin-left:11%;\"><b>Westmere,\nWestmere-IBRS</b></p>\n\n<p style=\"margin-left:22%;\">Westmere E56xx/L56xx/X56xx\n(Nehalem-C, 2010)</p>\n\n<p style=\"margin-left:11%;\"><b>Nehalem,\nNehalem-IBRS</b></p>\n\n<p style=\"margin-left:22%;\">Intel Core i7 9xx (Nehalem\nClass Core i7, 2008)</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>Penryn</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Intel Core 2 Duo P9xxx (Penryn Class Core 2, 2007)</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>Conroe</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Intel Celeron_4x0 (Conroe/Merom Class Core 2, 2006)</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Important\nCPU features for Intel x86 hosts</b> <br>\nThe following are important CPU features that should be used\non Intel x86 hosts, when available in the host CPU. Some of\nthem require explicit configuration to enable, as they are\nnot included by default in some, or all, of the named CPU\nmodels listed above. In general all of these features are\nincluded if using &quot;Host passthrough&quot; or &quot;Host\nmodel&quot;.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p style=\"margin-top: 1em\"><b>pcid</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Recommended to mitigate the cost\nof the Meltdown (CVE-2017-5754) fix.</p></td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Included by\ndefault in Haswell, Broadwell &amp; Skylake Intel CPU\nmodels.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Should be\nexplicitly turned on for Westmere, SandyBridge, and\nIvyBridge Intel CPU models. Note that some desktop/mobile\nWestmere CPUs cannot support this feature.</p>\n\n<p style=\"margin-left:11%;\"><b>spec-ctrl</b></p>\n\n<p style=\"margin-left:22%;\">Required to enable the Spectre\nv2 (CVE-2017-5715) fix.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Included by\ndefault in Intel CPU models with -IBRS suffix.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for Intel CPU models without -IBRS\nsuffix.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>stibp</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>Required to enable stronger Spectre v2 (CVE-2017-5715)\nfixes in some operating systems.</p></td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all Intel CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p style=\"margin-top: 1em\"><b>ssbd</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"63%\">\n\n\n<p style=\"margin-top: 1em\">Required to enable the\nCVE-2018-3639 fix.</p></td>\n<td width=\"15%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any Intel CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all Intel CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<p style=\"margin-left:11%;\"><b>pdpe1gb</b></p>\n\n<p style=\"margin-left:22%;\">Recommended to allow guest OS\nto use 1GB size pages.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any Intel CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Should be\nexplicitly turned on for all Intel CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Note that not\nall CPU hardware will support this feature.</p>\n\n<p style=\"margin-left:11%;\"><b>md-clear</b></p>\n\n<p style=\"margin-left:22%;\">Required to confirm the MDS\n(CVE-2018-12126, CVE-2018-12127, CVE-2018-12130,\nCVE-2019-11091) fixes.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any Intel CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all Intel CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>mds-no</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Recommended to inform the guest OS that the host is\n<i>not</i> vulnerable to any of the MDS variants ([MFBDS]\nCVE-2018-12130, [MLPDS] CVE-2018-12127, [MSBDS]\nCVE-2018-12126).</p> </td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">This is an MSR\n(Model-Specific Register) feature rather than a CPUID\nfeature, so it will not appear in the Linux\n<b>/proc/cpuinfo</b> in the host or guest. Instead, the host\nkernel uses it to populate the MDS vulnerability file in\n<b>sysfs</b>.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">So it should\nonly be enabled for VMs if the host reports @code{Not\naffected} in the\n<b>/sys/devices/system/cpu/vulnerabilities/mds</b> file.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>taa-no</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Recommended to inform that the\nguest that the host is <b>not</b> vulnerable to\nCVE-2019-11135, TSX Asynchronous Abort (TAA).</p></td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">This too is an\nMSR feature, so it does not show up in the Linux\n<b>/proc/cpuinfo</b> in the host or guest.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">It should only\nbe enabled for VMs if the host reports <b>Not affected</b>\nin the\n<b>/sys/devices/system/cpu/vulnerabilities/tsx_async_abort</b>\nfile.</p>\n\n<p style=\"margin-left:11%;\"><b>tsx-ctrl</b></p>\n\n<p style=\"margin-left:22%;\">Recommended to inform the guest\nthat it can disable the Intel TSX (Transactional\nSynchronization Extensions) feature; or, if the processor is\nvulnerable, use the Intel VERW instruction (a\nprocessor-level instruction that performs checks on memory\naccess) as a mitigation for the TAA vulnerability. (For\ndetails, refer to Intel's <i>deep dive into MDS</i>.)</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Expose this to\nthe guest OS if and only if: (a) the host has TSX enabled;\n<i>and</i> (b) the guest has <b>rtm</b> CPU flag\nenabled.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">By disabling\nTSX, KVM-based guests can avoid paying the price of\nmitigating TSX-based attacks.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Note that\n<b>tsx-ctrl</b> too is an MSR feature, so it does not show\nup in the Linux <b>/proc/cpuinfo</b> in the host or\nguest.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">To validate\nthat Intel TSX is indeed disabled for the guest, there are\ntwo ways: (a) check for the <i>absence</i> of <b>rtm</b> in\nthe guest's <b>/proc/cpuinfo</b>; or (b) the\n<b>/sys/devices/system/cpu/vulnerabilities/tsx_async_abort</b>\nfile in the guest should report <b>Mitigation: TSX\ndisabled</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Preferred\nCPU models for AMD x86 hosts</b> <br>\nThe following CPU models are preferred for use on AMD hosts.\nAdministrators / applications are recommended to use the CPU\nmodel that matches the generation of the host CPUs in use.\nIn a deployment with a mixture of host CPU models between\nmachines, if live migration compatibility is required, use\nthe newest CPU model that is compatible across all desired\nhosts. <b><br>\nEPYC, EPYC-IBPB</b></p>\n\n<p style=\"margin-left:22%;\">AMD EPYC Processor (2017)</p>\n\n<p style=\"margin-left:11%;\"><b>Opteron_G5</b></p>\n\n<p style=\"margin-left:22%;\">AMD Opteron 63xx class CPU\n(2012)</p>\n\n<p style=\"margin-left:11%;\"><b>Opteron_G4</b></p>\n\n<p style=\"margin-left:22%;\">AMD Opteron 62xx class CPU\n(2011)</p>\n\n<p style=\"margin-left:11%;\"><b>Opteron_G3</b></p>\n\n<p style=\"margin-left:22%;\">AMD Opteron 23xx (Gen 3 Class\nOpteron, 2009)</p>\n\n<p style=\"margin-left:11%;\"><b>Opteron_G2</b></p>\n\n<p style=\"margin-left:22%;\">AMD Opteron 22xx (Gen 2 Class\nOpteron, 2006)</p>\n\n<p style=\"margin-left:11%;\"><b>Opteron_G1</b></p>\n\n<p style=\"margin-left:22%;\">AMD Opteron 240 (Gen 1 Class\nOpteron, 2004)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Important\nCPU features for AMD x86 hosts</b> <br>\nThe following are important CPU features that should be used\non AMD x86 hosts, when available in the host CPU. Some of\nthem require explicit configuration to enable, as they are\nnot included by default in some, or all, of the named CPU\nmodels listed above. In general all of these features are\nincluded if using &quot;Host passthrough&quot; or &quot;Host\nmodel&quot;.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p><b>ibpb</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"78%\">\n\n\n<p>Required to enable the Spectre v2 (CVE-2017-5715)\nfix.</p> </td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Included by\ndefault in AMD CPU models with -IBPB suffix.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for AMD CPU models without -IBPB\nsuffix.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p style=\"margin-top: 1em\"><b>stibp</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Required to enable stronger\nSpectre v2 (CVE-2017-5715) fixes in some operating\nsystems.</p> </td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all AMD CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Requires the\nhost CPU microcode to support this feature before it can be\nused for guest CPUs.</p>\n\n<p style=\"margin-left:11%;\"><b>virt-ssbd</b></p>\n\n<p style=\"margin-left:22%;\">Required to enable the\nCVE-2018-3639 fix</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any AMD CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all AMD CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">This should be\nprovided to guests, even if amd-ssbd is also provided, for\nmaximum guest compatibility.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Note for some\nQEMU / libvirt versions, this must be force enabled when\nwhen using &quot;Host model&quot;, because this is a virtual\nfeature that doesn't exist in the physical host CPUs.</p>\n\n<p style=\"margin-left:11%;\"><b>amd-ssbd</b></p>\n\n<p style=\"margin-left:22%;\">Required to enable the\nCVE-2018-3639 fix</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any AMD CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Must be\nexplicitly turned on for all AMD CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">This provides\nhigher performance than <b>virt-ssbd</b> so should be\nexposed to guests whenever available in the host.\n<b>virt-ssbd</b> should none the less also be exposed for\nmaximum guest compatibility as some kernels only know about\n<b>virt-ssbd</b>.</p>\n\n<p style=\"margin-left:11%;\"><b>amd-no-ssb</b></p>\n\n<p style=\"margin-left:22%;\">Recommended to indicate the\nhost is not vulnerable CVE-2018-3639</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any AMD CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Future hardware\ngenerations of CPU will not be vulnerable to CVE-2018-3639,\nand thus the guest should be told not to enable its\nmitigations, by exposing amd-no-ssb. This is mutually\nexclusive with virt-ssbd and amd-ssbd.</p>\n\n<p style=\"margin-left:11%;\"><b>pdpe1gb</b></p>\n\n<p style=\"margin-left:22%;\">Recommended to allow guest OS\nto use 1GB size pages</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Not included by\ndefault in any AMD CPU model.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Should be\nexplicitly turned on for all AMD CPU models.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Note that not\nall CPU hardware will support this feature.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Default x86\nCPU models</b> <br>\nThe default QEMU CPU models are designed such that they can\nrun on all hosts. If an application does not wish to do\nperform any host compatibility checks before launching\nguests, the default is guaranteed to work.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The default CPU\nmodels will, however, leave the guest OS vulnerable to\nvarious CPU hardware flaws, so their use is strongly\ndiscouraged. Applications should follow the earlier guidance\nto setup a better CPU configuration, with host passthrough\nrecommended if live migration is not needed. <b><br>\nqemu32, qemu64</b></p>\n\n<p style=\"margin-left:22%;\">QEMU Virtual CPU version 2.5+\n(32 &amp; 64 bit variants)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>qemu64</b>\nis used for x86_64 guests and <b>qemu32</b> is used for i686\nguests, when no <b>-cpu</b> argument is given to QEMU, or no\n<b>&lt;cpu&gt;</b> is provided in libvirt XML.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Other\nnon-recommended x86 CPUs</b> <br>\nThe following CPUs models are compatible with most AMD and\nIntel x86 hosts, but their usage is discouraged, as they\nexpose a very limited featureset, which prevents guests\nhaving optimal performance. <b><br>\nkvm32, kvm64</b></p>\n\n<p style=\"margin-left:22%;\">Common KVM processor (32 &amp;\n64 bit variants).</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Legacy models\njust for historical compatibility with ancient QEMU\nversions.</p>\n\n<p style=\"margin-left:11%;\"><b>486, athlon, phenom,\ncoreduo, core2duo, n270, pentium, pentium2, <br>\npentium3</b></p>\n\n<p style=\"margin-left:22%;\">Various very old x86 CPU\nmodels, mostly predating the introduction of hardware\nassisted virtualization, that should thus not be required\nfor running virtual machines.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Syntax for\nconfiguring CPU models</b> <br>\nThe examples below illustrate the approach to configuring\nthe various CPU models / features in QEMU and libvirt.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>QEMU command\nline</b> <br>\nHost passthrough:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">qemu-system-x86_64 -cpu host</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Host\npassthrough with feature customization:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">qemu-system-x86_64 -cpu host,vmx=off,...</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Named CPU\nmodels:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">qemu-system-x86_64 -cpu Westmere</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Named CPU\nmodels with feature customization:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">qemu-system-x86_64 -cpu Westmere,pcid=on,...</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Libvirt\nguest XML</b> <br>\nHost passthrough:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='host-passthrough'/&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Host\npassthrough with feature customization:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='host-passthrough'&gt;\n    &lt;feature name=&quot;vmx&quot; policy=&quot;disable&quot;/&gt;\n    ...\n&lt;/cpu&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Host model:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='host-model'/&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Host model with\nfeature customization:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='host-model'&gt;\n    &lt;feature name=&quot;vmx&quot; policy=&quot;disable&quot;/&gt;\n    ...\n&lt;/cpu&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Named\nmodel:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='custom'&gt;\n    &lt;model name=&quot;Westmere&quot;/&gt;\n&lt;/cpu&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Named model\nwith feature customization:</p>\n\n<pre style=\"margin-left:15%; margin-top: 1em\">&lt;cpu mode='custom'&gt;\n    &lt;model name=&quot;Westmere&quot;/&gt;\n    &lt;feature name=&quot;pcid&quot; policy=&quot;require&quot;/&gt;\n    ...\n&lt;/cpu&gt;</pre>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nCPU model configurations on MIPS hosts</b> <br>\nQEMU supports variety of MIPS CPU models:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nCPU models for MIPS32 hosts</b> <br>\nThe following CPU models are supported for use on MIPS32\nhosts. Administrators / applications are recommended to use\nthe CPU model that matches the generation of the host CPUs\nin use. In a deployment with a mixture of host CPU models\nbetween machines, if live migration compatibility is\nrequired, use the newest CPU model that is compatible across\nall desired hosts. <b><br>\nmips32r6-generic</b></p>\n\n<p style=\"margin-left:22%;\">MIPS32 Processor (Release 6,\n2015)</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>P5600</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"46%\">\n\n\n<p>MIPS32 Processor (P5600, 2014)</p></td>\n<td width=\"32%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>M14K, M14Kc</b></p>\n\n<p style=\"margin-left:22%;\">MIPS32 Processor (M14K,\n2009)</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p><b>74Kf</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"43%\">\n\n\n<p>MIPS32 Processor (74K, 2007)</p></td>\n<td width=\"35%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p><b>34Kf</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"43%\">\n\n\n<p>MIPS32 Processor (34K, 2006)</p></td>\n<td width=\"35%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>24Kc, 24KEc, 24Kf</b></p>\n\n<p style=\"margin-left:22%;\">MIPS32 Processor (24K,\n2003)</p>\n\n<p style=\"margin-left:11%;\"><b>4Kc, 4Km, 4KEcR1, 4KEmR1,\n4KEc, 4KEm</b></p>\n\n<p style=\"margin-left:22%;\">MIPS32 Processor (4K, 1999)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nCPU models for MIPS64 hosts</b> <br>\nThe following CPU models are supported for use on MIPS64\nhosts. Administrators / applications are recommended to use\nthe CPU model that matches the generation of the host CPUs\nin use. In a deployment with a mixture of host CPU models\nbetween machines, if live migration compatibility is\nrequired, use the newest CPU model that is compatible across\nall desired hosts.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>I6400</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"52%\">\n\n\n<p>MIPS64 Processor (Release 6, 2014)</p></td>\n<td width=\"26%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>Loongson-2E</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Loongson 2,\n2006)</p>\n\n<p style=\"margin-left:11%;\"><b>Loongson-2F</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Loongson 2,\n2008)</p>\n\n<p style=\"margin-left:11%;\"><b>Loongson-3A1000</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Loongson 3,\n2010)</p>\n\n<p style=\"margin-left:11%;\"><b>Loongson-3A4000</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Loongson 3,\n2018)</p>\n\n<p style=\"margin-left:11%;\"><b>mips64dspr2</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Release 2,\n2006)</p>\n\n<p style=\"margin-left:11%;\"><b>MIPS64R2-generic, 5KEc,\n5KEf</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (Release 2,\n2002)</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"6%\">\n\n\n<p><b>20Kc</b></p></td>\n<td width=\"5%\"></td>\n<td width=\"41%\">\n\n\n<p>MIPS64 Processor (20K, 2000</p></td>\n<td width=\"37%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>5Kc, 5Kf</b></p>\n\n<p style=\"margin-left:22%;\">MIPS64 Processor (5K, 1999)</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>VR5432</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"50%\">\n\n\n<p>MIPS64 Processor (VR, 1998)</p></td>\n<td width=\"28%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>R4000</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"50%\">\n\n\n<p>MIPS64 Processor (MIPS III, 1991)</p></td>\n<td width=\"28%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nCPU models for nanoMIPS hosts</b> <br>\nThe following CPU models are supported for use on nanoMIPS\nhosts. Administrators / applications are recommended to use\nthe CPU model that matches the generation of the host CPUs\nin use. In a deployment with a mixture of host CPU models\nbetween machines, if live migration compatibility is\nrequired, use the newest CPU model that is compatible across\nall desired hosts.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p style=\"margin-top: 1em\"><b>I7200</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"41%\">\n\n\n<p style=\"margin-top: 1em\">MIPS I7200 (nanoMIPS, 2018)</p></td>\n<td width=\"37%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Preferred\nCPU models for MIPS hosts</b> <br>\nThe following CPU models are preferred for use on different\nMIPS hosts: <b><br>\nMIPS III</b></p>\n\n<p style=\"margin-left:22%;\">R4000</p>\n\n<p style=\"margin-left:11%;\"><b>MIPS32R2</b></p>\n\n<p style=\"margin-left:22%;\">34Kf</p>\n\n<p style=\"margin-left:11%;\"><b>MIPS64R6</b></p>\n\n<p style=\"margin-left:22%;\">I6400</p>\n\n<p style=\"margin-left:11%;\"><b>nanoMIPS</b></p>\n\n<p style=\"margin-left:22%;\">I7200</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The HTML\ndocumentation of QEMU for more precise information and Linux\nuser mode emulator invocation.</p>\n\n<h2>AUTHOR\n<a name=\"AUTHOR\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The QEMU\nProject developers</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">2022, The QEMU\nProject Developers</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#AUTHOR\">AUTHOR</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"],"level":7}