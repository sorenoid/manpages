{"name":"pam_selinux","body":"\n\n<h1 align=\"center\">PAM_SELINUX</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pam_selinux -\nPAM module to set the default security context</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"89%\">\n\n\n<p style=\"margin-top: 1em\"><b>pam_selinux.so</b> [open]\n[close] [restore] [nottys] [debug] [verbose]\n[select_context] [env_params] [use_current_range]</p></td></tr>\n</table>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pam_selinux is\na PAM module that sets up the default SELinux security\ncontext for the next executed process.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When a new\nsession is started, the open_session part of the module\ncomputes and sets up the execution security context used for\nthe next <a href=\"https://man.page/2/execve\">execve(2)</a> call, the file security context\nfor the controlling terminal, and the security context used\nfor creating a new kernel keyring.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When the\nsession is ended, the close_session part of the module\nrestores old security contexts that were in effect before\nthe change made by the open_session part of the module.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Adding\npam_selinux into the PAM stack might disrupt behavior of\nother PAM modules which execute applications. To avoid that,\n<i>pam_selinux.so open</i> should be placed after such\nmodules in the PAM stack, and <i>pam_selinux.so close</i>\nshould be placed before them. When such a placement is not\nfeasible, <i>pam_selinux.so restore</i> could be used to\ntemporary restore original security contexts.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>open</b></p>\n\n<p style=\"margin-left:17%;\">Only execute the open_session\npart of the module.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>close</b></p>\n\n<p style=\"margin-left:17%;\">Only execute the close_session\npart of the module.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>restore</b></p>\n\n<p style=\"margin-left:17%;\">In open_session part of the\nmodule, temporarily restore the security contexts as they\nwere before the previous call of the module. Another call of\nthis module without the restore option will set up the new\nsecurity contexts again.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>nottys</b></p>\n\n<p style=\"margin-left:17%;\">Do not setup security context\nof the controlling terminal.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>debug</b></p>\n\n<p style=\"margin-left:17%;\">Turn on debug messages via\n<a href=\"https://man.page/3/syslog\">syslog(3)</a>.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>verbose</b></p>\n\n<p style=\"margin-left:17%;\">Attempt to inform the user when\nsecurity context is set.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>select_context</b></p>\n\n<p style=\"margin-left:17%;\">Attempt to ask the user for a\ncustom security context role. If MLS is on, ask also for\nsensitivity level.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>env_params</b></p>\n\n<p style=\"margin-left:17%;\">Attempt to obtain a custom\nsecurity context role from PAM environment. If MLS is on,\nobtain also sensitivity level. This option and the\nselect_context option are mutually exclusive. The respective\nPAM environment variables are <i>SELINUX_ROLE_REQUESTED</i>,\n<i>SELINUX_LEVEL_REQUESTED</i>, and\n<i>SELINUX_USE_CURRENT_RANGE</i>. The first two variables\nare self describing and the last one if set to 1 makes the\nPAM module behave as if the use_current_range was specified\non the command line of the module.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>use_current_range</b></p>\n\n<p style=\"margin-left:17%;\">Use the sensitivity level of\nthe current process for the user context instead of the\ndefault level. Also suppresses asking of the sensitivity\nlevel from the user or obtaining it from PAM\nenvironment.</p>\n\n<h2>MODULE TYPES PROVIDED\n<a name=\"MODULE TYPES PROVIDED\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Only the\n<b>session</b> module type is provided.</p>\n\n<h2>RETURN VALUES\n<a name=\"RETURN VALUES\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">PAM_SUCCESS</p>\n\n<p style=\"margin-left:17%;\">The security context was set\nsuccessfully.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">PAM_SESSION_ERR</p>\n\n<p style=\"margin-left:17%;\">Unable to get or set a valid\ncontext.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">PAM_USER_UNKNOWN</p>\n\n<p style=\"margin-left:17%;\">The user is not known to the\nsystem.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">PAM_BUF_ERR</p>\n\n<p style=\"margin-left:17%;\">Memory allocation error.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">auth required\npam_unix.so <br>\nsession required pam_permit.so <br>\nsession optional pam_selinux.so</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/execve\">execve(2)</a>,\n<a href=\"https://man.page/4/tty\">tty(4)</a>, <b>pam.d</b>(5), <a href=\"https://man.page/7/pam\">pam(7)</a>,\n<b>selinux</b>(8)</p>\n\n<h2>AUTHOR\n<a name=\"AUTHOR\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pam_selinux was\nwritten by Dan Walsh &lt;dwalsh@redhat.com&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#MODULE TYPES PROVIDED\">MODULE TYPES PROVIDED</a>","<a href=\"#RETURN VALUES\">RETURN VALUES</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#AUTHOR\">AUTHOR</a>"],"level":7}