{"name":"kernel_lockdown","body":"\n\n<h1 align=\"center\">KERNEL_LOCKDOWN</h1>\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">kernel_lockdown\n- kernel image access prevention feature</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The Kernel\nLockdown feature is designed to prevent both direct and\nindirect access to a running kernel image, attempting to\nprotect against unauthorized modification of the kernel\nimage and to prevent access to security and cryptographic\ndata located in kernel memory, whilst still permitting\ndriver modules to be loaded.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If a prohibited\nor restricted feature is accessed or used, the kernel will\nemit a message that looks like:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Lockdown: X: Y\nis restricted, see man kernel_lockdown.7</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">where X\nindicates the process name and Y indicates what is\nrestricted.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On an\nEFI-enabled x86 or arm64 machine, lockdown will be\nautomatically enabled if the system boots in EFI Secure Boot\nmode.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Coverage</b>\n<br>\nWhen lockdown is in effect, a number of features are\ndisabled or have their use restricted. This includes special\ndevice files and kernel services that allow direct access of\nthe kernel image:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">/dev/mem <br>\n/dev/kmem <br>\n/dev/kcore <br>\n/dev/ioports <br>\nBPF <br>\nkprobes</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">and the ability\nto directly configure and control devices, so as to prevent\nthe use of a device to access or modify a kernel image:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of module parameters that directly specify\nhardware parameters to drivers through the kernel command\nline or when loading a module.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of direct PCI BAR access.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of the ioperm and iopl instructions on x86.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of the KD*IO console ioctls.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of the TIOCSSERIAL serial ioctl.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The alteration of MSR registers on x86.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The replacement of the PCMCIA CIS.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The overriding of ACPI tables.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of ACPI error injection.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The specification of the ACPI RDSP address.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>The use of ACPI custom methods.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Certain\nfacilities are restricted:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p style=\"margin-top: 1em\">&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p style=\"margin-top: 1em\">Only validly signed modules may\nbe loaded (waived if the module file being loaded is vouched\nfor by IMA appraisal).</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>Only validly signed binaries may be kexec&rsquo;d\n(waived if the binary image file to be executed is vouched\nfor by IMA appraisal).</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>Unencrypted hibernation/suspend to swap are disallowed\nas the kernel image is saved to a medium that can then be\naccessed.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>Use of debugfs is not permitted as this allows a whole\nrange of actions including direct configuration of, access\nto and driving of hardware.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>&bull;</p></td>\n<td width=\"2%\"></td>\n<td width=\"86%\">\n\n\n<p>IMA requires the addition of the &quot;secure_boot&quot;\nrules to the policy, whether or not they are specified on\nthe command line, for both the built-in and custom policies\nin secure boot lockdown mode.</p></td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The Kernel\nLockdown feature was added in Linux 5.4.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The Kernel\nLockdown feature is enabled by CONFIG_SECURITY_LOCKDOWN_LSM.\nThe <i>lsm=lsm1,...,lsmN</i> command line parameter controls\nthe sequence of the initialization of Linux Security\nModules. It must contain the string <i>lockdown</i> to\nenable the Kernel Lockdown feature. If the command line\nparameter is not specified, the initialization falls back to\nthe value of the deprecated <i>security=</i> command line\nparameter and further to the value of CONFIG_LSM.</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":7}