{"name":"evp_kdf-x942-asn1","body":"\n\n<h1 align=\"center\">EVP_KDF-X942-ASN1</h1>\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_KDF-X942-ASN1\n- The X9.42-2003 asn1 EVP_KDF implementation</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<small>EVP_KDF-X942-ASN1</small> algorithm implements the\nkey derivation function X942KDF-ASN1. It is used by\n<small>DH</small> KeyAgreement, to derive a key using input\nsuch as a shared secret key and other info. The other info\nis <small>DER</small> encoded data that contains a 32 bit\ncounter as well as optional fields for\n&quot;partyu-info&quot;, &quot;partyv-info&quot;,\n&quot;supp-pubinfo&quot; and &quot;supp-privinfo&quot;. This\nkdf is used by Cryptographic Message Syntax (\n<small>CMS</small> ).</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Identity</b>\n<br>\n&quot;X942KDF-ASN1&quot; or &quot;X942KDF&quot; is the name\nfor this implementation; it can be used with the\n<b>EVP_KDF_fetch()</b> function.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Supported\nparameters</b> <br>\nThe supported parameters are: <br>\n&quot;properties&quot; (\n<b><small>OSSL_KDF_PARAM_PROPERTIES</small></b> ) &lt;\n<small>UTF8</small> string&gt; <br>\n&quot;digest&quot; (\n<b><small>OSSL_KDF_PARAM_DIGEST</small></b> ) &lt;\n<small>UTF8</small> string&gt;</p>\n\n<p style=\"margin-left:17%;\">These parameters work as\ndescribed in &quot; <small>PARAMETERS&quot;</small> in\n<b><small>EVP_KDF</small></b> (3).</p>\n\n<p style=\"margin-left:11%;\">&quot;key&quot; (\n<b><small>OSSL_KDF_PARAM_KEY</small></b> ) &lt;octet\nstring&gt;</p>\n\n<p style=\"margin-left:17%;\">The shared secret used for key\nderivation. This parameter sets the secret.</p>\n\n<p style=\"margin-left:11%;\">&quot;acvp-info&quot; (\n<b><small>OSSL_KDF_PARAM_X942_ACVPINFO</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">This value should not be used\nin production and should only be used for\n<small>ACVP</small> testing. It is an optional octet string\ncontaining a combined <small>DER</small> encoded blob of any\nof the optional fields related to &quot;partyu-info&quot;,\n&quot;partyv-info&quot;, &quot;supp-pubinfo&quot; and\n&quot;supp-privinfo&quot;. If it is specified then none of\nthese other fields should be used.</p>\n\n<p style=\"margin-left:11%;\">&quot;partyu-info&quot; (\n<b><small>OSSL_KDF_PARAM_X942_PARTYUINFO</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">An optional octet string\ncontaining public info contributed by the initiator.</p>\n\n<p style=\"margin-left:11%;\">&quot;ukm&quot; (\n<b><small>OSSL_KDF_PARAM_UKM</small></b> ) &lt;octet\nstring&gt;</p>\n\n<p style=\"margin-left:17%;\">An alias for\n&quot;partyu-info&quot;. In <small>CMS</small> this is the\nuser keying material.</p>\n\n<p style=\"margin-left:11%;\">&quot;partyv-info&quot; (\n<b><small>OSSL_KDF_PARAM_X942_PARTYVINFO</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">An optional octet string\ncontaining public info contributed by the responder.</p>\n\n<p style=\"margin-left:11%;\">&quot;supp-pubinfo&quot; (\n<b><small>OSSL_KDF_PARAM_X942_SUPP_PUBINFO</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">An optional octet string\ncontaining some additional, mutually-known public\ninformation. Setting this value also sets\n&quot;use-keybits&quot; to 0.</p>\n\n<p style=\"margin-left:11%;\">&quot;use-keybits&quot; (\n<b><small>OSSL_KDF_PARAM_X942_SUPP_PRIVINFO</small></b> )\n&lt;integer&gt;</p>\n\n<p style=\"margin-left:17%;\">The default value of 1 will use\nthe <small>KEK</small> key length (in bits) as the\n&quot;supp-pubinfo&quot;. A value of 0 disables setting the\n&quot;supp-pubinfo&quot;.</p>\n\n<p style=\"margin-left:11%;\">&quot;supp-privinfo&quot; (\n<b><small>OSSL_KDF_PARAM_X942_SUPP_PRIVINFO</small></b> )\n&lt;octet string&gt;</p>\n\n<p style=\"margin-left:17%;\">An optional octet string\ncontaining some additional, mutually-known private\ninformation.</p>\n\n<p style=\"margin-left:11%;\">&quot;cekalg&quot; (\n<b><small>OSSL_KDF_PARAM_CEK_ALG</small></b> ) &lt;\n<small>UTF8</small> string&gt;</p>\n\n<p style=\"margin-left:17%;\">This parameter sets the\n<small>CEK</small> wrapping algorithm name. Valid values are\n&quot; <small>AES-128-WRAP&quot;, &quot;AES-192-WRAP&quot;,\n&quot;AES-256-WRAP&quot;</small> and &quot;\n<small>DES3-WRAP&quot;.</small></p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">A context for\nX942KDF can be obtained by calling:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_KDF *kdf =\nEVP_KDF_fetch(NULL, &quot;X942KDF&quot;, NULL); <br>\nEVP_KDF_CTX *kctx = EVP_KDF_CTX_new(kdf);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The output\nlength of an X942KDF is specified via the <i>keylen</i>\nparameter to the <a href=\"https://man.page/3/EVP_KDF_derive\">EVP_KDF_derive(3)</a> function.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This example\nderives 24 bytes, with the secret key &quot;secret&quot; and\nrandom user keying material:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">EVP_KDF_CTX\n*kctx; <br>\nEVP_KDF_CTX *kctx; <br>\nunsigned char out[192/8]; <br>\nunsignred char ukm[64]; <br>\nOSSL_PARAM params[5], *p = params; <br>\nif (RAND_bytes(ukm, sizeof(ukm)) &lt;= 0) <br>\nerror(&quot;RAND_bytes&quot;); <br>\nkdf = EVP_KDF_fetch(NULL, &quot;X942KDF&quot;, NULL); <br>\nif (kctx == NULL) <br>\nerror(&quot;EVP_KDF_fetch&quot;); <br>\nkctx = EVP_KDF_CTX_new(kdf); <br>\nEVP_KDF_free(kdf); <br>\nif (kctx == NULL) <br>\nerror(&quot;EVP_KDF_CTX_new&quot;); <br>\n*p++ =\nOSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_DIGEST,\n&quot;SHA256&quot;, 0); <br>\n*p++ =\nOSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_SECRET,\n<br>\n&quot;secret&quot;, (size_t)6); <br>\n*p++ = OSSL_PARAM_construct_octet_string(OSSL_KDF_PARAM_UKM,\nukm, sizeof(ukm)); <br>\n*p++ =\nOSSL_PARAM_construct_utf8_string(OSSL_KDF_PARAM_CEK_ALG,\n&quot;AES-256-WRAP, 0); <br>\n*p = OSSL_PARAM_construct_end(); <br>\nif (EVP_KDF_derive(kctx, out, sizeof(out), params) &lt;= 0)\n<br>\nerror(&quot;EVP_KDF_derive&quot;); <br>\nEVP_KDF_CTX_free(kctx);</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><small>ANS1\nX9.42-2003 RFC 2631</small></p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><small><b>EVP_KDF</b></small>\n(3), <a href=\"https://man.page/3/EVP_KDF_CTX_new\">EVP_KDF_CTX_new(3)</a>, <a href=\"https://man.page/3/EVP_KDF_CTX_free\">EVP_KDF_CTX_free(3)</a>,\n<a href=\"https://man.page/3/EVP_KDF_CTX_set_params\">EVP_KDF_CTX_set_params(3)</a>,\n<a href=\"https://man.page/3/EVP_KDF_CTX_get_kdf_size\">EVP_KDF_CTX_get_kdf_size(3)</a>,\n<a href=\"https://man.page/3/EVP_KDF_derive\">EVP_KDF_derive(3)</a>, &quot;\n<small>PARAMETERS&quot;</small> in\n<b><small>EVP_KDF</small></b> (3)</p>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This\nfunctionality was added to OpenSSL 3.0.</p>\n\n<h2>COPYRIGHT\n<a name=\"COPYRIGHT\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Copyright\n2019-2021 The OpenSSL Project Authors. All Rights\nReserved.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Licensed under\nthe Apache License 2.0 (the &quot;License&quot;). You may\nnot use this file except in compliance with the License. You\ncan obtain a copy in the file <small>LICENSE</small> in the\nsource distribution or at\n&lt;https://www.openssl.org/source/license.html&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#COPYRIGHT\">COPYRIGHT</a>"],"level":7}