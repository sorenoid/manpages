{"name":"apparmor_xattrs","description":"apparmor_xattrs - AppArmor profile xattr(7) matching","body":"\n\n<h1 align=\"center\">APPARMOR_XATTRS</h1>\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">apparmor_xattrs\n- AppArmor profile xattr(7) matching</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">AppArmor\nprofiles can conditionally match files based on the presence\nand value of extended attributes in addition to file path.\nThe following profile applies to any file under\n&quot;/usr/bin&quot; where the &quot;security.apparmor&quot;\nextended attribute has the value &quot;trusted&quot;:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">profile trusted\n/usr/bin/* xattrs=(security.apparmor=&quot;trusted&quot;) {\n<br>\n# ... <br>\n}</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note that\n&quot;security.apparmor&quot; and &quot;trusted&quot; are\narbitrary, and profiles can match based on the value of any\nattribute.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The xattrs\nvalue may also contain a path regex:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">profile trusted\n/usr/bin/* xattrs=(user.trust=&quot;tier/*&quot;) { <br>\n# ... <br>\n}</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<a href=\"https://man.page/1/getfattr\">getfattr(1)</a> and <a href=\"https://man.page/1/setfattr\">setfattr(1)</a> tools can be used\nto view and manage xattr values:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">$ setfattr -n\n'security.apparmor' -v 'trusted' /usr/bin/example-tool <br>\n$ getfattr --absolute-names -d -m - /usr/bin/example-tool\n<br>\n# file: usr/bin/example-tool <br>\nsecurity.apparmor=&quot;trusted&quot;</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The priority of\neach profile is determined by the length of the path, then\nthe number of xattrs specified. A more specific path is\npreferred over xattr matches:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"># Highest\npriority, longest path. <br>\nprofile example1 /usr/bin/example-tool { <br>\n# ... <br>\n} <br>\n# Lower priority than the longer path, but higher priority\nthan a rule <br>\n# with fewer xattr matches. <br>\nprofile example2 /usr/** xattrs=( <br>\nsecurity.apparmor=&quot;trusted&quot; <br>\nuser.domain=&quot;**&quot; <br>\n) { <br>\n# ... <br>\n} <br>\n# Lowest priority. Same path length as the second profile,\nbut has <br>\n# fewer xattr matches. <br>\nprofile example2 /usr/** { <br>\n# ... <br>\n}</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">xattr matching\nrequires the following kernel feature:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/sys/kernel/security/apparmor/features/domain/attach_conditions/xattr</p>\n\n<h2>KNOWN ISSUES\n<a name=\"KNOWN ISSUES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">AppArmor\nprofiles currently can&rsquo;t reliably match extended\nattributes with binary values such as security.evm and\nsecurity.ima. In the future AppArmor may gain the ability to\nmatch based on the presence of certain attributes while\nignoring their values.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>apparmor</b>(8),\n<b>apparmor_parser</b>(8), <b>apparmor.d</b>(5),\n<a href=\"https://man.page/7/xattr\">xattr(7)</a>, <a href=\"https://man.page/1/aa-autodep\">aa-autodep(1)</a>, <a href=\"https://man.page/1/clean\">clean(1)</a>,\n<b>auditd</b>(8), <a href=\"https://man.page/1/getfattr\">getfattr(1)</a>, <a href=\"https://man.page/1/setfattr\">setfattr(1)</a>,\nand &lt;https://wiki.apparmor.net&gt;.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#KNOWN ISSUES\">KNOWN ISSUES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>"],"level":7}