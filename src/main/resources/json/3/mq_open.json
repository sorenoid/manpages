{"name":"mq_open","description":"mq_open - open\na message queue","body":"\n\n<h1 align=\"center\">MQ_OPEN</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">mq_open - open\na message queue</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;fcntl.h&gt;</b> /* For O_* constants */ <b><br>\n#include &lt;sys/stat.h&gt;</b> /* For mode constants */\n<b><br>\n#include &lt;mqueue.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>mqd_t\nmq_open(const char *</b><i>name</i><b>, int</b>\n<i>oflag</i><b>); <br>\nmqd_t mq_open(const char *</b><i>name</i><b>, int</b>\n<i>oflag</i><b>, mode_t</b> <i>mode</i><b>, <br>\nstruct mq_attr *</b><i>attr</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Link with\n<i>-lrt</i>.</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>mq_open</b>()\ncreates a new POSIX message queue or opens an existing\nqueue. The queue is identified by <i>name</i>. For details\nof the construction of <i>name</i>, see\n<a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>oflag</i> argument specifies flags that control the\noperation of the call. (Definitions of the flags values can\nbe obtained by including <i>&lt;fcntl.h&gt;</i>.) Exactly\none of the following must be specified in <i>oflag</i>:\n<b><br>\nO_RDONLY</b></p>\n\n<p style=\"margin-left:22%;\">Open the queue to receive\nmessages only.</p>\n\n<p style=\"margin-left:11%;\"><b>O_WRONLY</b></p>\n\n<p style=\"margin-left:22%;\">Open the queue to send messages\nonly.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>O_RDWR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"75%\">\n\n\n<p>Open the queue to both send and receive messages.</p></td>\n<td width=\"3%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Zero or more of\nthe following flags can additionally be <i>OR</i>ed in\n<i>oflag</i>: <b><br>\nO_CLOEXEC</b> (since Linux 2.6.26)</p>\n\n<p style=\"margin-left:22%;\">Set the close-on-exec flag for\nthe message queue descriptor. See <a href=\"https://man.page/2/open\">open(2)</a> for a\ndiscussion of why this flag is useful.</p>\n\n<p style=\"margin-left:11%;\"><b>O_CREAT</b></p>\n\n<p style=\"margin-left:22%;\">Create the message queue if it\ndoes not exist. The owner (user ID) of the message queue is\nset to the effective user ID of the calling process. The\ngroup ownership (group ID) is set to the effective group ID\nof the calling process.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>O_EXCL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>If <b>O_CREAT</b> was specified in <i>oflag</i>, and a\nqueue with the given <i>name</i> already exists, then fail\nwith the error <b>EEXIST</b>.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>O_NONBLOCK</b></p>\n\n<p style=\"margin-left:22%;\">Open the queue in nonblocking\nmode. In circumstances where <a href=\"https://man.page/3/mq_receive\">mq_receive(3)</a> and\n<a href=\"https://man.page/3/mq_send\">mq_send(3)</a> would normally block, these functions\ninstead fail with the error <b>EAGAIN</b>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If\n<b>O_CREAT</b> is specified in <i>oflag</i>, then two\nadditional arguments must be supplied. The <i>mode</i>\nargument specifies the permissions to be placed on the new\nqueue, as for <a href=\"https://man.page/2/open\">open(2)</a>. (Symbolic definitions for the\npermissions bits can be obtained by including\n<i>&lt;sys/stat.h&gt;</i>.) The permissions settings are\nmasked against the process umask.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The fields of\nthe <i>struct mq_attr</i> pointed to <i>attr</i> specify the\nmaximum number of messages and the maximum size of messages\nthat the queue will allow. This structure is defined as\nfollows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct mq_attr\n{ <br>\nlong mq_flags; /* Flags (ignored for mq_open()) */ <br>\nlong mq_maxmsg; /* Max. # of messages on queue */ <br>\nlong mq_msgsize; /* Max. message size (bytes) */ <br>\nlong mq_curmsgs; /* # of messages currently in queue <br>\n(ignored for mq_open()) */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Only the\n<i>mq_maxmsg</i> and <i>mq_msgsize</i> fields are employed\nwhen calling <b>mq_open</b>(); the values in the remaining\nfields are ignored.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>attr</i>\nis NULL, then the queue is created with\nimplementation-defined default attributes. Since Linux 3.5,\ntwo <i>/proc</i> files can be used to control these\ndefaults; see <a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a> for details.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\n<b>mq_open</b>() returns a message queue descriptor for use\nby other message queue functions. On error, <b>mq_open</b>()\nreturns <i>(mqd_t)&nbsp;-1</i>, with <i>errno</i> set to\nindicate the error.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>EACCES</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">The queue exists, but the caller\ndoes not have permission to open it in the specified\nmode.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EACCES</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>name</i> contained more than one slash.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EEXIST</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Both <b>O_CREAT</b> and <b>O_EXCL</b> were specified in\n<i>oflag</i>, but a queue with this <i>name</i> already\nexists.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>name</i> doesn&rsquo;t follow the format in\n<a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><b>O_CREAT</b> was specified in <i>oflag</i>, and\n<i>attr</i> was not NULL, but <i>attr-&gt;mq_maxmsg</i> or\n<i>attr-&gt;mq_msqsize</i> was invalid. Both of these fields\nmust be greater than zero. In a process that is unprivileged\n(does not have the <b>CAP_SYS_RESOURCE</b> capability),\n<i>attr-&gt;mq_maxmsg</i> must be less than or equal to the\n<i>msg_max</i> limit, and <i>attr-&gt;mq_msgsize</i> must be\nless than or equal to the <i>msgsize_max</i> limit. In\naddition, even in a privileged process,\n<i>attr-&gt;mq_maxmsg</i> cannot exceed the <b>HARD_MAX</b>\nlimit. (See <a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a> for details of these\nlimits.)</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EMFILE</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The per-process limit on the number of open file and\nmessage queue descriptors has been reached (see the\ndescription of <b>RLIMIT_NOFILE</b> in\n<a href=\"https://man.page/2/getrlimit\">getrlimit(2)</a>).</p> </td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENAMETOOLONG</b></p>\n\n<p style=\"margin-left:22%;\"><i>name</i> was too long.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENFILE</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The system-wide limit on the total number of open files\nand message queues has been reached.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The <b>O_CREAT</b> flag was not specified in\n<i>oflag</i>, and no queue with this <i>name</i> exists.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>name</i> was just &quot;/&quot; followed by no other\ncharacters.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOMEM</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Insufficient memory.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOSPC</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Insufficient space for the creation of a new message\nqueue. This probably occurred because the <i>queues_max</i>\nlimit was encountered; see <a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a>.</p></td></tr>\n</table>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3313471.png\" alt=\"Image grohtml-3313471.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>C\nlibrary/kernel differences</b> <br>\nThe <b>mq_open</b>() library function is implemented on top\nof a system call of the same name. The library function\nperforms the check that the <i>name</i> starts with a slash\n(/), giving the <b>EINVAL</b> error if it does not. The\nkernel system call expects <i>name</i> to contain no\npreceding slash, so the C library function passes\n<i>name</i> without the preceding slash (i.e.,\n<i>name+1</i>) to the system call.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">In kernels\nbefore 2.6.14, the process umask was not applied to the\npermissions specified in <i>mode</i>.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/mq_close\">mq_close(3)</a>,\n<a href=\"https://man.page/3/mq_getattr\">mq_getattr(3)</a>, <a href=\"https://man.page/3/mq_notify\">mq_notify(3)</a>,\n<a href=\"https://man.page/3/mq_receive\">mq_receive(3)</a>, <a href=\"https://man.page/3/mq_send\">mq_send(3)</a>,\n<a href=\"https://man.page/3/mq_unlink\">mq_unlink(3)</a>, <a href=\"https://man.page/7/mq_overview\">mq_overview(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}