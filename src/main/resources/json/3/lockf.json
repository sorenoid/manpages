{"name":"lockf","body":"\n\n<h1 align=\"center\">LOCKF</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">lockf - apply,\ntest or remove a POSIX lock on an open file</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;unistd.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nlockf(int</b> <i>fd</i><b>, int</b> <i>cmd</i><b>, off_t</b>\n<i>len</i><b>);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>lockf</b>():</p>\n\n\n<p style=\"margin-left:17%;\">_XOPEN_SOURCE&nbsp;&gt;=&nbsp;500\n<br>\n|| /* Glibc since 2.19: */ _DEFAULT_SOURCE <br>\n|| /* Glibc versions &lt;= 2.19: */ _BSD_SOURCE ||\n_SVID_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Apply, test or\nremove a POSIX lock on a section of an open file. The file\nis specified by <i>fd</i>, a file descriptor open for\nwriting, the action by <i>cmd</i>, and the section consists\nof byte positions <i>pos</i>..<i>pos</i>+<i>len</i>-1 if\n<i>len</i> is positive, and\n<i>pos</i>-<i>len</i>..<i>pos</i>-1 if <i>len</i> is\nnegative, where <i>pos</i> is the current file position, and\nif <i>len</i> is zero, the section extends from the current\nfile position to infinity, encompassing the present and\nfuture end-of-file positions. In all cases, the section may\nextend past current end-of-file.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Linux,\n<b>lockf</b>() is just an interface on top of\n<a href=\"https://man.page/2/fcntl\">fcntl(2)</a> locking. Many other systems implement\n<b>lockf</b>() in this way, but note that POSIX.1 leaves the\nrelationship between <b>lockf</b>() and <a href=\"https://man.page/2/fcntl\">fcntl(2)</a>\nlocks unspecified. A portable application should probably\navoid mixing calls to these interfaces.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Valid\noperations are given below:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>F_LOCK</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Set an exclusive lock on the specified section of the\nfile. If (part of) this section is already locked, the call\nblocks until the previous lock is released. If this section\noverlaps an earlier locked section, both are merged. File\nlocks are released as soon as the process holding the locks\ncloses some file descriptor for the file. A child process\ndoes not inherit these locks.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>F_TLOCK</b></p>\n\n<p style=\"margin-left:22%;\">Same as <b>F_LOCK</b> but the\ncall never blocks and returns an error instead if the file\nis already locked.</p>\n\n<p style=\"margin-left:11%;\"><b>F_ULOCK</b></p>\n\n<p style=\"margin-left:22%;\">Unlock the indicated section of\nthe file. This may cause a locked section to be split into\ntwo locked sections.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>F_TEST</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Test the lock: return 0 if the specified section is\nunlocked or locked by this process; return -1, set\n<i>errno</i> to <b>EAGAIN</b> (<b>EACCES</b> on some other\nsystems), if another process holds a lock.</p></td></tr>\n</table>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\nzero is returned. On error, -1 is returned, and <i>errno</i>\nis set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>EACCES</b>\nor <b>EAGAIN</b></p>\n\n<p style=\"margin-left:22%;\">The file is locked and\n<b>F_TLOCK</b> or <b>F_TEST</b> was specified, or the\noperation is prohibited because the file has been\nmemory-mapped by another process.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><b>EBADF</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p><i>fd</i> is not an open file descriptor; or <i>cmd</i>\nis <b>F_LOCK</b> or <b>F_TLOCK</b> and <i>fd</i> is not a\nwritable file descriptor.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>EDEADLK</b></p>\n\n<p style=\"margin-left:22%;\">The command was <b>F_LOCK</b>\nand this lock operation would cause a deadlock.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINTR</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>While waiting to acquire a lock, the call was\ninterrupted by delivery of a signal caught by a handler; see\n<a href=\"https://man.page/7/signal\">signal(7)</a>.</p> </td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>An invalid operation was specified in <i>cmd</i>.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOLCK</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>Too many segment locks open, lock table is full.</p></td></tr>\n</table>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3377431.png\" alt=\"Image grohtml-3377431.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008, SVr4.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/fcntl\">fcntl(2)</a>,\n<a href=\"https://man.page/2/flock\">flock(2)</a></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>locks.txt</i>\nand <i>mandatory-locking.txt</i> in the Linux kernel source\ndirectory <i>Documentation/filesystems</i> (on older\nkernels, these files are directly under the\n<i>Documentation</i> directory, and\n<i>mandatory-locking.txt</i> is called\n<i>mandatory.txt</i>)</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}