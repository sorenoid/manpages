{"name":"fexecve","description":"fexecve -\nexecute program specified via file descriptor","body":"\n\n<h1 align=\"center\">FEXECVE</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">fexecve -\nexecute program specified via file descriptor</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;unistd.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nfexecve(int</b> <i>fd</i><b>, char *const</b>\n<i>argv</i><b>[], char *const</b> <i>envp</i><b>[]);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>fexecve</b>():</p>\n\n<p style=\"margin-left:17%;\">Since glibc 2.10:</p>\n\n\n<p style=\"margin-left:23%;\">_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;200809L</p>\n\n<p style=\"margin-left:17%;\">Before glibc 2.10:</p>\n\n<p style=\"margin-left:23%;\">_GNU_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>fexecve</b>()\nperforms the same task as <a href=\"https://man.page/2/execve\">execve(2)</a>, with the\ndifference that the file to be executed is specified via a\nfile descriptor, <i>fd</i>, rather than via a pathname. The\nfile descriptor <i>fd</i> must be opened read-only\n(<b>O_RDONLY</b>) or with the <b>O_PATH</b> flag and the\ncaller must have permission to execute the file that it\nrefers to.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">A successful\ncall to <b>fexecve</b>() never returns. On error, the\nfunction does return, with a result value of -1, and\n<i>errno</i> is set appropriately.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Errors are as\nfor <a href=\"https://man.page/2/execve\">execve(2)</a>, with the following additions:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>EINVAL</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p><i>fd</i> is not a valid file descriptor, or <i>argv</i>\nis NULL, or <i>envp</i> is NULL.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The close-on-exec flag is set on <i>fd</i>, and\n<i>fd</i> refers to a script. See BUGS.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ENOSYS</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>The kernel does not provide the <a href=\"https://man.page/2/execveat\">execveat(2)</a>\nsystem call, and the <i>/proc</i> filesystem could not be\naccessed.</p> </td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>fexecve</b>()\nis implemented since glibc 2.3.2.</p>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3386251.png\" alt=\"Image grohtml-3386251.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2008.\nThis function is not specified in POSIX.1-2001, and is not\nwidely available on other systems. It is specified in\nPOSIX.1-2008.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Linux with\nglibc versions 2.26 and earlier, <b>fexecve</b>() is\nimplemented using the <a href=\"https://man.page/5/proc\">proc(5)</a> filesystem, so\n<i>/proc</i> needs to be mounted and available at the time\nof the call. Since glibc 2.27, if the underlying kernel\nsupports the <a href=\"https://man.page/2/execveat\">execveat(2)</a> system call, then\n<b>fexecve</b>() is implemented using that system call, with\nthe benefit that <i>/proc</i> does not need to be\nmounted.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The idea behind\n<b>fexecve</b>() is to allow the caller to verify (checksum)\nthe contents of an executable before executing it. Simply\nopening the file, checksumming the contents, and then doing\nan <a href=\"https://man.page/2/execve\">execve(2)</a> would not suffice, since, between the\ntwo steps, the filename, or a directory prefix of the\npathname, could have been exchanged (by, for example,\nmodifying the target of a symbolic link). <b>fexecve</b>()\ndoes not mitigate the problem that the <i>contents</i> of a\nfile could be changed between the checksumming and the call\nto <b>fexecve</b>(); for that, the solution is to ensure\nthat the permissions on the file prevent it from being\nmodified by malicious users.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The natural\nidiom when using <b>fexecve</b>() is to set the\nclose-on-exec flag on <i>fd</i>, so that the file descriptor\ndoes not leak through to the program that is executed. This\napproach is natural for two reasons. First, it prevents file\ndescriptors being consumed unnecessarily. (The executed\nprogram normally has no need of a file descriptor that\nrefers to the program itself.) Second, if <b>fexecve</b>()\nis used recursively, employing the close-on-exec flag\nprevents the file descriptor exhaustion that would result\nfrom the fact that each step in the recursion would cause\none more file descriptor to be passed to the new program.\n(But see BUGS.)</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">If <i>fd</i>\nrefers to a script (i.e., it is an executable text file that\nnames a script interpreter with a first line that begins\nwith the characters <i>#!</i>) and the close-on-exec flag\nhas been set for <i>fd</i>, then <b>fexecve</b>() fails with\nthe error <b>ENOENT</b>. This error occurs because, by the\ntime the script interpreter is executed, <i>fd</i> has\nalready been closed because of the close-on-exec flag. Thus,\nthe close-on-exec flag can&rsquo;t be set on <i>fd</i> if it\nrefers to a script, leading to the problems described in\nNOTES.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/execve\">execve(2)</a>,\n<a href=\"https://man.page/2/execveat\">execveat(2)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}