{"name":"readdir_r","description":"readdir_r - read a directory","body":"\n\n<h1 align=\"center\">READDIR_R</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">readdir_r -\nread a directory</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;dirent.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nreaddir_r(DIR *</b><i>dirp</i><b>, struct dirent\n*</b><i>entry</i><b>, struct dirent\n**</b><i>result</i><b>);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>readdir_r</b>():</p>\n\n<p style=\"margin-left:17%;\">_POSIX_C_SOURCE <br>\n|| /* Glibc versions &lt;= 2.19: */ _BSD_SOURCE ||\n_SVID_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This function\nis deprecated; use <a href=\"https://man.page/3/readdir\">readdir(3)</a> instead.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>readdir_r</b>() function was invented as a reentrant\nversion of <a href=\"https://man.page/3/readdir\">readdir(3)</a>. It reads the next directory\nentry from the directory stream <i>dirp</i>, and returns it\nin the caller-allocated buffer pointed to by <i>entry</i>.\nFor details of the <i>dirent</i> structure, see\n<a href=\"https://man.page/3/readdir\">readdir(3)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">A pointer to\nthe returned buffer is placed in <i>*result</i>; if the end\nof the directory stream was encountered, then NULL is\ninstead returned in <i>*result</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">It is\nrecommended that applications use <a href=\"https://man.page/3/readdir\">readdir(3)</a> instead\nof <b>readdir_r</b>(). Furthermore, since version 2.24,\nglibc deprecates <b>readdir_r</b>(). The reasons are as\nfollows:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"85%\">\n\n\n<p>On systems where <b>NAME_MAX</b> is undefined, calling\n<b>readdir_r</b>() may be unsafe because the interface does\nnot allow the caller to specify the length of the buffer\nused for the returned directory entry.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"85%\">\n\n\n<p>On some systems, <b>readdir_r</b>() can&rsquo;t read\ndirectory entries with very long names. When the glibc\nimplementation encounters such a name, <b>readdir_r</b>()\nfails with the error <b>ENAMETOOLONG</b> <i>after the final\ndirectory entry has been read</i>. On some other systems,\n<b>readdir_r</b>() may return a success status, but the\nreturned <i>d_name</i> field may not be null terminated or\nmay be truncated.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"85%\">\n\n\n<p>In the current POSIX.1 specification (POSIX.1-2008),\n<a href=\"https://man.page/3/readdir\">readdir(3)</a> is not required to be thread-safe.\nHowever, in modern implementations (including the glibc\nimplementation), concurrent calls to <a href=\"https://man.page/3/readdir\">readdir(3)</a> that\nspecify different directory streams are thread-safe.\nTherefore, the use of <b>readdir_r</b>() is generally\nunnecessary in multithreaded programs. In cases where\nmultiple threads must read from the same directory stream,\nusing <a href=\"https://man.page/3/readdir\">readdir(3)</a> with external synchronization is\nstill preferable to the use of <b>readdir_r</b>(), for the\nreasons given in the points above.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"1%\">\n\n\n<p>*</p></td>\n<td width=\"3%\"></td>\n<td width=\"85%\">\n\n\n<p>It is expected that a future version of POSIX.1 will\nmake <b>readdir_r</b>() obsolete, and require that\n<a href=\"https://man.page/3/readdir\">readdir(3)</a> be thread-safe when concurrently employed\non different directory streams.</p></td></tr>\n</table>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>readdir_r</b>() function returns 0 on success. On error,\nit returns a positive error number (listed under ERRORS). If\nthe end of the directory stream is reached,\n<b>readdir_r</b>() returns 0, and returns NULL in\n<i>*result</i>.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p style=\"margin-top: 1em\"><b>EBADF</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"63%\">\n\n\n<p style=\"margin-top: 1em\">Invalid directory stream\ndescriptor <i>dirp</i>.</p></td>\n<td width=\"15%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><b>ENAMETOOLONG</b></p>\n\n<p style=\"margin-left:22%;\">A directory entry whose name\nwas too long to be read was encountered.</p>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3348651.png\" alt=\"Image grohtml-3348651.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/readdir\">readdir(3)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}