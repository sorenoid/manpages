{"name":"rcmd","body":"\n\n<h1 align=\"center\">RCMD</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">rcmd,\nrresvport, iruserok, ruserok, rcmd_af, rresvport_af,\niruserok_af, ruserok_af - routines for returning a stream to\na remote command</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;netdb.h&gt; &nbsp;&nbsp;</b>/* Or &lt;unistd.h&gt; on\nsome systems */</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nrcmd(char **</b><i>ahost</i><b>, unsigned short</b>\n<i>inport</i><b>, const char *</b><i>locuser</i><b>, <br>\nconst char *</b><i>remuser</i><b>, const char\n*</b><i>cmd</i><b>, int *</b><i>fd2p</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nrresvport(int *</b><i>port</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\niruserok(uint32_t</b> <i>raddr</i><b>, int</b>\n<i>superuser</i><b>, <br>\nconst char *</b><i>ruser</i><b>, const char\n*</b><i>luser</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nruserok(const char *</b><i>rhost</i><b>, int</b>\n<i>superuser</i><b>, <br>\nconst char *</b><i>ruser</i><b>, const char\n*</b><i>luser</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nrcmd_af(char **</b><i>ahost</i><b>, unsigned short</b>\n<i>inport</i><b>, const char *</b><i>locuser</i><b>, <br>\nconst char *</b><i>remuser</i><b>, const char\n*</b><i>cmd</i><b>, int *</b><i>fd2p</i><b>, <br>\nsa_family_t</b> <i>af</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nrresvport_af(int *</b><i>port</i><b>, sa_family_t</b>\n<i>af</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\niruserok_af(const void *</b><i>raddr</i><b>, int</b>\n<i>superuser</i><b>, <br>\nconst char *</b><i>ruser</i><b>, const char\n*</b><i>luser</i><b>, sa_family_t</b> <i>af</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nruserok_af(const char *</b><i>rhost</i><b>, int</b>\n<i>superuser</i><b>, <br>\nconst char *</b><i>ruser</i><b>, const char\n*</b><i>luser</i><b>, sa_family_t</b> <i>af</i><b>);</b></p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>rcmd</b>(),\n<b>rcmd_af</b>(), <b>rresvport</b>(), <b>rresvport_af</b>(),\n<b>iruserok</b>(), <b>iruserok_af</b>(), <b>ruserok</b>(),\n<b>ruserok_af</b>(): <br>\nSince glibc 2.19: <br>\n_DEFAULT_SOURCE <br>\nGlibc 2.19 and earlier: <br>\n_BSD_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>rcmd</b>() function is used by the superuser to execute a\ncommand on a remote machine using an authentication scheme\nbased on privileged port numbers. The <b>rresvport</b>()\nfunction returns a file descriptor to a socket with an\naddress in the privileged port space. The <b>iruserok</b>()\nand <b>ruserok</b>() functions are used by servers to\nauthenticate clients requesting service with <b>rcmd</b>().\nAll four functions are used by the <b>rshd</b>(8) server\n(among others).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>rcmd()</b>\n<br>\nThe <b>rcmd</b>() function looks up the host <i>*ahost</i>\nusing <a href=\"https://man.page/3/gethostbyname\">gethostbyname(3)</a>, returning -1 if the host does\nnot exist. Otherwise, <i>*ahost</i> is set to the standard\nname of the host and a connection is established to a server\nresiding at the well-known Internet port <i>inport</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the\nconnection succeeds, a socket in the Internet domain of type\n<b>SOCK_STREAM</b> is returned to the caller, and given to\nthe remote command as <i>stdin</i> and <i>stdout</i>. If\n<i>fd2p</i> is nonzero, then an auxiliary channel to a\ncontrol process will be set up, and a file descriptor for it\nwill be placed in <i>*fd2p</i>. The control process will\nreturn diagnostic output from the command (unit 2) on this\nchannel, and will also accept bytes on this channel as being\nUNIX signal numbers, to be forwarded to the process group of\nthe command. If <i>fd2p</i> is 0, then the <i>stderr</i>\n(unit 2 of the remote command) will be made the same as the\n<i>stdout</i> and no provision is made for sending arbitrary\nsignals to the remote process, although you may be able to\nget its attention by using out-of-band data.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The protocol is\ndescribed in detail in <b>rshd</b>(8).</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>rresvport()</b>\n<br>\nThe <b>rresvport</b>() function is used to obtain a socket\nwith a privileged port bound to it. This socket is suitable\nfor use by <b>rcmd</b>() and several other functions.\nPrivileged ports are those in the range 0 to 1023. Only a\nprivileged process (on Linux: a process that has the\n<b>CAP_NET_BIND_SERVICE</b> capability in the user namespace\ngoverning its network namespace). is allowed to bind to a\nprivileged port. In the glibc implementation, this function\nrestricts its search to the ports from 512 to 1023. The\n<i>port</i> argument is value-result: the value it supplies\nto the call is used as the starting point for a circular\nsearch of the port range; on (successful) return, it\ncontains the port number that was bound to.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>iruserok()\nand ruserok()</b> <br>\nThe <b>iruserok</b>() and <b>ruserok</b>() functions take a\nremote host&rsquo;s IP address or name, respectively, two\nusernames and a flag indicating whether the local\nuser&rsquo;s name is that of the superuser. Then, if the\nuser is <i>not</i> the superuser, it checks the\n<i>/etc/hosts.equiv</i> file. If that lookup is not done, or\nis unsuccessful, the <i>.rhosts</i> in the local\nuser&rsquo;s home directory is checked to see if the request\nfor service is allowed.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If this file\ndoes not exist, is not a regular file, is owned by anyone\nother than the user or the superuser, is writable by anyone\nother than the owner, or is hardlinked anywhere, the check\nautomatically fails. Zero is returned if the machine name is\nlisted in the <i>hosts.equiv</i> file, or the host and\nremote username are found in the <i>.rhosts</i> file;\notherwise <b>iruserok</b>() and <b>ruserok</b>() return -1.\nIf the local domain (as obtained from <a href=\"https://man.page/2/gethostname\">gethostname(2)</a>)\nis the same as the remote domain, only the machine name need\nbe specified.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the IP\naddress of the remote host is known, <b>iruserok</b>()\nshould be used in preference to <b>ruserok</b>(), as it does\nnot require trusting the DNS server for the remote\nhost&rsquo;s domain.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>*_af()\nvariants</b> <br>\nAll of the functions described above work with IPv4\n(<b>AF_INET</b>) sockets. The &quot;_af&quot; variants take\nan extra argument that allows the socket address family to\nbe specified. For these functions, the <i>af</i> argument\ncan be specified as <b>AF_INET</b> or <b>AF_INET6</b>. In\naddition, <b>rcmd_af</b>() supports the use of\n<b>AF_UNSPEC</b>.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>rcmd</b>() function returns a valid socket descriptor on\nsuccess. It returns -1 on error and prints a diagnostic\nmessage on the standard error.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>rresvport</b>() function returns a valid, bound socket\ndescriptor on success. It returns -1 on error with the\nglobal value <i>errno</i> set according to the reason for\nfailure. The error code <b>EAGAIN</b> is overloaded to mean\n&quot;All network ports in use.&quot;</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For information\non the return from <b>ruserok</b>() and <b>iruserok</b>(),\nsee above.</p>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The functions\n<b>iruserok_af</b>(), <b>rcmd_af</b>(),\n<b>rresvport_af</b>(), and <b>ruserok_af</b>() functions are\nprovide in glibc since version 2.2.</p>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"8%\"></td>\n<td width=\"7%\">\n</td>\n<td width=\"8%\">\n</td>\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"62%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"8%\">\n</td>\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"62%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"8%\">\n</td>\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"62%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"8%\">\n</td>\n<td width=\"8%\"></td>\n<td width=\"7%\"></td>\n<td width=\"62%\">\n</td></tr>\n</table>\n\n\n<p align=\"center\"><img src=\"grohtml-3327821.png\" alt=\"Image grohtml-3327821.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Not in POSIX.1.\nPresent on the BSDs, Solaris, and many other systems. These\nfunctions appeared in 4.2BSD. The &quot;_af&quot; variants\nare more recent additions, and are not present on as wide a\nrange of systems.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>iruserok</b>()\nand <b>iruserok_af</b>() are declared in glibc headers only\nsince version 2.12.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/rlogin\">rlogin(1)</a>,\n<a href=\"https://man.page/1/rsh\">rsh(1)</a>, <a href=\"https://man.page/3/rexec\">rexec(3)</a>, <b>rexecd</b>(8),\n<b>rlogind</b>(8), <b>rshd</b>(8)</p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}