{"name":"pthread_getcpuclockid","description":"pthread_getcpuclockid - retrieve ID of a thread&rsquo;s CPU time clock","body":"\n\n<h1 align=\"center\">PTHREAD_GETCPUCLOCKID</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pthread_getcpuclockid\n- retrieve ID of a thread&rsquo;s CPU time clock</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;pthread.h&gt; <br>\n#include &lt;time.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\npthread_getcpuclockid(pthread_t</b> <i>thread</i><b>,\nclockid_t *</b><i>clockid</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Compile and\nlink with <i>-pthread</i>.</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>pthread_getcpuclockid</b>() function obtains the ID of\nthe CPU-time clock of the thread whose ID is given in\n<i>thread</i>, and returns it in the location pointed to by\n<i>clockid</i>.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\nthis function returns 0; on error, it returns a nonzero\nerror number.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><b>ENOENT</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">Per-thread CPU time clocks are\nnot supported by the system.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><b>ESRCH</b></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>No thread with the ID <i>thread</i> could be found.</p></td></tr>\n</table>\n\n<h2>VERSIONS\n<a name=\"VERSIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This function\nis available in glibc since version 2.2.</p>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3356581.png\" alt=\"Image grohtml-3356581.png\"></p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">When\n<i>thread</i> refers to the calling thread, this function\nreturns an identifier that refers to the same clock\nmanipulated by <a href=\"https://man.page/2/clock_gettime\">clock_gettime(2)</a> and\n<a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a> when given the clock ID\n<b>CLOCK_THREAD_CPUTIME_ID</b>.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The program\nbelow creates a thread and then uses <a href=\"https://man.page/2/clock_gettime\">clock_gettime(2)</a>\nto retrieve the total process CPU time, and the per-thread\nCPU time consumed by the two threads. The following shell\nsession shows an example run:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">$\n<b>./a.out</b> <br>\nMain thread sleeping <br>\nSubthread starting infinite loop <br>\nMain thread consuming some CPU time... <br>\nProcess total CPU time: 1.368 <br>\nMain thread CPU time: 0.376 <br>\nSubthread CPU time: 0.992</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>Program\nsource</b> <br>\n/* Link with &quot;-lrt&quot; */</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">#include\n&lt;time.h&gt; <br>\n#include &lt;stdio.h&gt; <br>\n#include &lt;stdint.h&gt; <br>\n#include &lt;stdlib.h&gt; <br>\n#include &lt;unistd.h&gt; <br>\n#include &lt;pthread.h&gt; <br>\n#include &lt;string.h&gt; <br>\n#include &lt;errno.h&gt;</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">#define\nhandle_error(msg) \\ <br>\ndo { perror(msg); exit(EXIT_FAILURE); } while (0)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">#define\nhandle_error_en(en, msg) \\ <br>\ndo { errno = en; perror(msg); exit(EXIT_FAILURE); } while\n(0)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">static void *\n<br>\nthread_start(void *arg) <br>\n{ <br>\nprintf(&quot;Subthread starting infinite loop\\n&quot;); <br>\nfor (;;) <br>\ncontinue; <br>\n}</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">static void\n<br>\npclock(char *msg, clockid_t cid) <br>\n{ <br>\nstruct timespec ts;</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">printf(&quot;%s&quot;,\nmsg); <br>\nif (clock_gettime(cid, &amp;ts) == -1) <br>\nhandle_error(&quot;clock_gettime&quot;); <br>\nprintf(&quot;%4jd.%03ld\\n&quot;, (intmax_t) ts.tv_sec,\nts.tv_nsec / 1000000); <br>\n}</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">int <br>\nmain(int argc, char *argv[]) <br>\n{ <br>\npthread_t thread; <br>\nclockid_t cid; <br>\nint s;</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">s =\npthread_create(&amp;thread, NULL, thread_start, NULL); <br>\nif (s != 0) <br>\nhandle_error_en(s, &quot;pthread_create&quot;);</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">printf(&quot;Main\nthread sleeping\\n&quot;); <br>\nsleep(1);</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">printf(&quot;Main\nthread consuming some CPU time...\\n&quot;); <br>\nfor (int j = 0; j &lt; 2000000; j++) <br>\ngetppid();</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pclock(&quot;Process\ntotal CPU time: &quot;, CLOCK_PROCESS_CPUTIME_ID);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">s =\npthread_getcpuclockid(pthread_self(), &amp;cid); <br>\nif (s != 0) <br>\nhandle_error_en(s, &quot;pthread_getcpuclockid&quot;); <br>\npclock(&quot;Main thread CPU time: &quot;, cid);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">/* The\npreceding 4 lines of code could have been replaced by: <br>\npclock(&quot;Main thread CPU time: &quot;,\nCLOCK_THREAD_CPUTIME_ID); */</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">s =\npthread_getcpuclockid(thread, &amp;cid); <br>\nif (s != 0) <br>\nhandle_error_en(s, &quot;pthread_getcpuclockid&quot;); <br>\npclock(&quot;Subthread CPU time: 1 &quot;, cid);</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">exit(EXIT_SUCCESS);\n/* Terminates both threads */ <br>\n}</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/clock_gettime\">clock_gettime(2)</a>,\n<a href=\"https://man.page/2/clock_settime\">clock_settime(2)</a>, <a href=\"https://man.page/2/timer_create\">timer_create(2)</a>,\n<a href=\"https://man.page/3/clock_getcpuclockid\">clock_getcpuclockid(3)</a>, <a href=\"https://man.page/3/pthread_self\">pthread_self(3)</a>,\n<a href=\"https://man.page/7/pthreads\">pthreads(7)</a>, <a href=\"https://man.page/7/time\">time(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#VERSIONS\">VERSIONS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}