{"name":"rtnetlink","description":"rtnetlink -\nmacros to manipulate rtnetlink messages","body":"\n\n<h1 align=\"center\">RTNETLINK</h1>\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">rtnetlink -\nmacros to manipulate rtnetlink messages</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;asm/types.h&gt; <br>\n#include &lt;linux/netlink.h&gt; <br>\n#include &lt;linux/rtnetlink.h&gt; <br>\n#include &lt;sys/socket.h&gt;</b></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>rtnetlink_socket\n= socket(AF_NETLINK, int</b> <i>socket_type</i><b>,\nNETLINK_ROUTE);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>int\nRTA_OK(struct rtattr *</b><i>rta</i><b>, int</b>\n<i>rtabuflen</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>void\n*RTA_DATA(struct rtattr *</b><i>rta</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>unsigned int\nRTA_PAYLOAD(struct rtattr *</b><i>rta</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>struct\nrtattr *RTA_NEXT(struct rtattr *</b><i>rta</i><b>, unsigned\nint</b> <i>rtabuflen</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>unsigned int\nRTA_LENGTH(unsigned int</b> <i>length</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>unsigned int\nRTA_SPACE(unsigned int</b> <i>length</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">All\n<a href=\"https://man.page/7/rtnetlink\">rtnetlink(7)</a> messages consist of a <a href=\"https://man.page/7/netlink\">netlink(7)</a>\nmessage header and appended attributes. The attributes\nshould be manipulated only using the macros provided\nhere.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_OK(</b><i>rta</i><b>,</b>\n<i>attrlen</i><b>)</b> returns true if <i>rta</i> points to\na valid routing attribute; <i>attrlen</i> is the running\nlength of the attribute buffer. When not true then you must\nassume there are no more attributes in the message, even if\n<i>attrlen</i> is nonzero.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_DATA(</b><i>rta</i><b>)</b>\nreturns a pointer to the start of this attribute&rsquo;s\ndata.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_PAYLOAD(</b><i>rta</i><b>)</b>\nreturns the length of this attribute&rsquo;s data.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_NEXT(</b><i>rta</i><b>,</b>\n<i>attrlen</i><b>)</b> gets the next attribute after\n<i>rta</i>. Calling this macro will update <i>attrlen</i>.\nYou should use <b>RTA_OK</b> to check the validity of the\nreturned pointer.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_LENGTH(</b><i>len</i><b>)</b>\nreturns the length which is required for <i>len</i> bytes of\ndata plus the header.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>RTA_SPACE(</b><i>len</i><b>)</b>\nreturns the amount of space which will be needed in a\nmessage with <i>len</i> bytes of data.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These macros\nare nonstandard Linux extensions.</p>\n\n<h2>BUGS\n<a name=\"BUGS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This manual\npage is incomplete.</p>\n\n<h2>EXAMPLES\n<a name=\"EXAMPLES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Creating a\nrtnetlink message to set the MTU of a device:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">#include\n&lt;linux/rtnetlink.h&gt;</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">...</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct { <br>\nstruct nlmsghdr nh; <br>\nstruct ifinfomsg if; <br>\nchar attrbuf[512]; <br>\n} req;</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct rtattr\n*rta; <br>\nunsigned int mtu = 1000;</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">int\nrtnetlink_sk = socket(AF_NETLINK, SOCK_DGRAM,\nNETLINK_ROUTE);</p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">memset(&amp;req,\n0, sizeof(req)); <br>\nreq.nh.nlmsg_len = NLMSG_LENGTH(sizeof(req.if)); <br>\nreq.nh.nlmsg_flags = NLM_F_REQUEST; <br>\nreq.nh.nlmsg_type = RTM_NEWLINK; <br>\nreq.if.ifi_family = AF_UNSPEC; <br>\nreq.if.ifi_index = INTERFACE_INDEX; <br>\nreq.if.ifi_change = 0xffffffff; /* ??? */ <br>\nrta = (struct rtattr *)(((char *) &amp;req) + <br>\nNLMSG_ALIGN(req.nh.nlmsg_len)); <br>\nrta-&gt;rta_type = IFLA_MTU; <br>\nrta-&gt;rta_len = RTA_LENGTH(sizeof(mtu)); <br>\nreq.nh.nlmsg_len = NLMSG_ALIGN(req.nh.nlmsg_len) + <br>\nRTA_LENGTH(sizeof(mtu)); <br>\nmemcpy(RTA_DATA(rta), &amp;mtu, sizeof(mtu)); <br>\nsend(rtnetlink_sk, &amp;req, req.nh.nlmsg_len, 0);</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/netlink\">netlink(3)</a>,\n<a href=\"https://man.page/7/netlink\">netlink(7)</a>, <a href=\"https://man.page/7/rtnetlink\">rtnetlink(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#BUGS\">BUGS</a>","<a href=\"#EXAMPLES\">EXAMPLES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}