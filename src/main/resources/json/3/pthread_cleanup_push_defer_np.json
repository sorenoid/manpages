{"name":"pthread_cleanup_push_defer_np","description":"pthread_cleanup_push_defer_np, pthread_cleanup_pop_restore_np - push and pop thread cancellation clean-up handlers while saving cancelability type","body":"\n\n<h1 align=\"center\">PTHREAD_CLEANUP_PUSH_DEFER_NP</h1>\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">pthread_cleanup_push_defer_np,\npthread_cleanup_pop_restore_np - push and pop thread\ncancellation clean-up handlers while saving cancelability\ntype</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;pthread.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>void\npthread_cleanup_push_defer_np(void\n(*</b><i>routine</i><b>)(void *), <br>\nvoid *</b><i>arg</i><b>); <br>\nvoid pthread_cleanup_pop_restore_np(int</b>\n<i>execute</i><b>);</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Compile and\nlink with <i>-pthread</i>.</p>\n\n<p style=\"margin-left:5%; margin-top: 1em\">Feature Test\nMacro Requirements for glibc (see\n<a href=\"https://man.page/7/feature_test_macros\">feature_test_macros(7)</a>):</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>pthread_cleanup_push_defer_np</b>(),\n<b>pthread_cleanup_pop_defer_np</b>():</p>\n\n<p style=\"margin-left:17%;\">_GNU_SOURCE</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These functions\nare the same as <a href=\"https://man.page/3/pthread_cleanup_push\">pthread_cleanup_push(3)</a> and\n<a href=\"https://man.page/3/pthread_cleanup_pop\">pthread_cleanup_pop(3)</a>, except for the differences\nnoted on this page.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Like\n<a href=\"https://man.page/3/pthread_cleanup_push\">pthread_cleanup_push(3)</a>,\n<b>pthread_cleanup_push_defer_np</b>() pushes <i>routine</i>\nonto the thread&rsquo;s stack of cancellation clean-up\nhandlers. In addition, it also saves the thread&rsquo;s\ncurrent cancelability type, and sets the cancelability type\nto &quot;deferred&quot; (see\n<a href=\"https://man.page/3/pthread_setcanceltype\">pthread_setcanceltype(3)</a>); this ensures that\ncancellation clean-up will occur even if the thread&rsquo;s\ncancelability type was &quot;asynchronous&quot; before the\ncall.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Like\n<a href=\"https://man.page/3/pthread_cleanup_pop\">pthread_cleanup_pop(3)</a>,\n<b>pthread_cleanup_pop_restore_np</b>() pops the top-most\nclean-up handler from the thread&rsquo;s stack of\ncancellation clean-up handlers. In addition, it restores the\nthread&rsquo;s cancelability type to its value at the time\nof the matching <b>pthread_cleanup_push_defer_np</b>().</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The caller must\nensure that calls to these functions are paired within the\nsame function, and at the same lexical nesting level. Other\nrestrictions apply, as described in\n<a href=\"https://man.page/3/pthread_cleanup_push\">pthread_cleanup_push(3)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This sequence\nof calls:</p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">pthread_cleanup_push_defer_np(routine,\narg); <br>\npthread_cleanup_pop_restore_np(execute);</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">is equivalent\nto (but shorter and more efficient than):</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">int\noldtype;</p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">pthread_cleanup_push(routine,\narg); <br>\npthread_setcanceltype(PTHREAD_CANCEL_DEFERRED,\n&amp;oldtype); <br>\n... <br>\npthread_setcanceltype(oldtype, NULL); <br>\npthread_cleanup_pop(execute);</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These functions\nare nonstandard GNU extensions; hence the suffix\n&quot;_np&quot; (nonportable) in the names.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/3/pthread_cancel\">pthread_cancel(3)</a>,\n<a href=\"https://man.page/3/pthread_cleanup_push\">pthread_cleanup_push(3)</a>,\n<a href=\"https://man.page/3/pthread_setcancelstate\">pthread_setcancelstate(3)</a>,\n<a href=\"https://man.page/3/pthread_testcancel\">pthread_testcancel(3)</a>, <a href=\"https://man.page/7/pthreads\">pthreads(7)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}