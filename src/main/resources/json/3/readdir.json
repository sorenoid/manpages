{"name":"readdir","description":"readdir - read\na directory","body":"\n\n<h1 align=\"center\">READDIR</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">readdir - read\na directory</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>#include\n&lt;dirent.h&gt;</b></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>struct\ndirent *readdir(DIR *</b><i>dirp</i><b>);</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<b>readdir</b>() function returns a pointer to a\n<i>dirent</i> structure representing the next directory\nentry in the directory stream pointed to by <i>dirp</i>. It\nreturns NULL on reaching the end of the directory stream or\nif an error occurred.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In the glibc\nimplementation, the <i>dirent</i> structure is defined as\nfollows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">struct dirent {\n<br>\nino_t d_ino; /* Inode number */ <br>\noff_t d_off; /* Not an offset; see below */ <br>\nunsigned short d_reclen; /* Length of this record */ <br>\nunsigned char d_type; /* Type of file; not supported <br>\nby all filesystem types */ <br>\nchar d_name[256]; /* Null-terminated filename */ <br>\n};</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The only fields\nin the <i>dirent</i> structure that are mandated by POSIX.1\nare <i>d_name</i> and <i>d_ino</i>. The other fields are\nunstandardized, and not present on all systems; see NOTES\nbelow for some further details.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The fields of\nthe <i>dirent</i> structure are as follows:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><i>d_ino</i></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>This is the inode number of the file.</p></td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p><i>d_off</i></p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>The value returned in <i>d_off</i> is the same as would\nbe returned by calling <a href=\"https://man.page/3/telldir\">telldir(3)</a> at the current\nposition in the directory stream. Be aware that despite its\ntype and name, the <i>d_off</i> field is seldom any kind of\ndirectory offset on modern filesystems. Applications should\ntreat this field as an opaque value, making no assumptions\nabout its contents; see also <a href=\"https://man.page/3/telldir\">telldir(3)</a>.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%;\"><i>d_reclen</i></p>\n\n<p style=\"margin-left:22%;\">This is the size (in bytes) of\nthe returned record. This may not match the size of the\nstructure definition shown above; see NOTES.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p><i>d_type</i></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p>This field contains a value indicating the file type,\nmaking it possible to avoid the expense of calling\n<a href=\"https://man.page/2/lstat\">lstat(2)</a> if further actions depend on the type of the\nfile.</p> </td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">When a suitable\nfeature test macro is defined (<b>_DEFAULT_SOURCE</b> on\nglibc versions since 2.19, or <b>_BSD_SOURCE</b> on glibc\nversions 2.19 and earlier), glibc defines the following\nmacro constants for the value returned in <i>d_type</i>:</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p style=\"margin-top: 1em\"><b>DT_BLK</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p style=\"margin-top: 1em\">This is a block device.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_CHR</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a character device.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_DIR</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a directory.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_FIFO</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a named pipe (FIFO).</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_LNK</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a symbolic link.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_REG</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a regular file.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_SOCK</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>This is a UNIX domain socket.</p></td>\n<td width=\"2%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"22%\"></td>\n<td width=\"15%\">\n\n\n<p><b>DT_UNKNOWN</b></p></td>\n<td width=\"3%\"></td>\n<td width=\"58%\">\n\n\n<p>The file type could not be determined.</p></td>\n<td width=\"2%\">\n</td></tr>\n</table>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Currently, only\nsome filesystems (among them: Btrfs, ext2, ext3, and ext4)\nhave full support for returning the file type in\n<i>d_type</i>. All applications must properly handle a\nreturn of <b>DT_UNKNOWN</b>.</p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"9%\">\n\n\n<p style=\"margin-top: 1em\"><i>d_name</i></p></td>\n<td width=\"2%\"></td>\n<td width=\"78%\">\n\n\n<p style=\"margin-top: 1em\">This field contains the null\nterminated filename. <i>See NOTES</i>.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The data\nreturned by <b>readdir</b>() may be overwritten by\nsubsequent calls to <b>readdir</b>() for the same directory\nstream.</p>\n\n<h2>RETURN VALUE\n<a name=\"RETURN VALUE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">On success,\n<b>readdir</b>() returns a pointer to a <i>dirent</i>\nstructure. (This structure may be statically allocated; do\nnot attempt to <a href=\"https://man.page/3/free\">free(3)</a> it.)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If the end of\nthe directory stream is reached, NULL is returned and\n<i>errno</i> is not changed. If an error occurs, NULL is\nreturned and <i>errno</i> is set appropriately. To\ndistinguish end of stream from an error, set <i>errno</i> to\nzero before calling <b>readdir</b>() and then check the\nvalue of <i>errno</i> if NULL is returned.</p>\n\n<h2>ERRORS\n<a name=\"ERRORS\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p style=\"margin-top: 1em\"><b>EBADF</b></p></td>\n<td width=\"4%\"></td>\n<td width=\"63%\">\n\n\n<p style=\"margin-top: 1em\">Invalid directory stream\ndescriptor <i>dirp</i>.</p></td>\n<td width=\"15%\">\n</td></tr>\n</table>\n\n<h2>ATTRIBUTES\n<a name=\"ATTRIBUTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">For an\nexplanation of the terms used in this section, see\n<a href=\"https://man.page/7/attributes\">attributes(7)</a>.</p>\n\n\n<p align=\"center\" style=\"margin-top: 1em\"><img src=\"grohtml-3304861.png\" alt=\"Image grohtml-3304861.png\"></p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In the current\nPOSIX.1 specification (POSIX.1-2008), <b>readdir</b>() is\nnot required to be thread-safe. However, in modern\nimplementations (including the glibc implementation),\nconcurrent calls to <b>readdir</b>() that specify different\ndirectory streams are thread-safe. In cases where multiple\nthreads must read from the same directory stream, using\n<b>readdir</b>() with external synchronization is still\npreferable to the use of the deprecated <a href=\"https://man.page/3/readdir_r\">readdir_r(3)</a>\nfunction. It is expected that a future version of POSIX.1\nwill require that <b>readdir</b>() be thread-safe when\nconcurrently employed on different directory streams.</p>\n\n<h2>CONFORMING TO\n<a name=\"CONFORMING TO\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1-2001,\nPOSIX.1-2008, SVr4, 4.3BSD.</p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">A directory\nstream is opened using <a href=\"https://man.page/3/opendir\">opendir(3)</a>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The order in\nwhich filenames are read by successive calls to\n<b>readdir</b>() depends on the filesystem implementation;\nit is unlikely that the names will be sorted in any\nfashion.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Only the fields\n<i>d_name</i> and (as an XSI extension) <i>d_ino</i> are\nspecified in POSIX.1. Other than Linux, the <i>d_type</i>\nfield is available mainly only on BSD systems. The remaining\nfields are available on many, but not all systems. Under\nglibc, programs can check for the availability of the fields\nnot defined in POSIX.1 by testing whether the macros\n<b>_DIRENT_HAVE_D_NAMLEN</b>, <b>_DIRENT_HAVE_D_RECLEN</b>,\n<b>_DIRENT_HAVE_D_OFF</b>, or <b>_DIRENT_HAVE_D_TYPE</b> are\ndefined.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>The d_name\nfield</b> <br>\nThe <i>dirent</i> structure definition shown above is taken\nfrom the glibc headers, and shows the <i>d_name</i> field\nwith a fixed size.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Warning</i>:\napplications should avoid any dependence on the size of the\n<i>d_name</i> field. POSIX defines it as\n<i>char&nbsp;d_name[]</i>, a character array of unspecified\nsize, with at most <b>NAME_MAX</b> characters preceding the\nterminating null byte ('\\0').</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">POSIX.1\nexplicitly notes that this field should not be used as an\nlvalue. The standard also notes that the use of\n<i>sizeof(d_name)</i> is incorrect; use\n<i>strlen(d_name)</i> instead. (On some systems, this field\nis defined as <i>char&nbsp;d_name[1]</i>!) By implication,\nthe use <i>sizeof(struct dirent)</i> to capture the size of\nthe record including the size of <i>d_name</i> is also\nincorrect.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note that while\nthe call</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">fpathconf(fd,\n_PC_NAME_MAX)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">returns the\nvalue 255 for most filesystems, on some filesystems (e.g.,\nCIFS, Windows SMB servers), the null-terminated filename\nthat is (correctly) returned in <i>d_name</i> can actually\nexceed this size. In such cases, the <i>d_reclen</i> field\nwill contain a value that exceeds the size of the glibc\n<i>dirent</i> structure shown above.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/2/getdents\">getdents(2)</a>,\n<a href=\"https://man.page/2/read\">read(2)</a>, <a href=\"https://man.page/3/closedir\">closedir(3)</a>, <a href=\"https://man.page/3/dirfd\">dirfd(3)</a>,\n<a href=\"https://man.page/3/ftw\">ftw(3)</a>, <a href=\"https://man.page/3/offsetof\">offsetof(3)</a>, <a href=\"https://man.page/3/opendir\">opendir(3)</a>,\n<a href=\"https://man.page/3/readdir_r\">readdir_r(3)</a>, <a href=\"https://man.page/3/rewinddir\">rewinddir(3)</a>, <a href=\"https://man.page/3/scandir\">scandir(3)</a>,\n<a href=\"https://man.page/3/seekdir\">seekdir(3)</a>, <a href=\"https://man.page/3/telldir\">telldir(3)</a></p>\n\n<h2>COLOPHON\n<a name=\"COLOPHON\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This page is\npart of release 5.10 of the Linux <i>man-pages</i> project.\nA description of the project, information about reporting\nbugs, and the latest version of this page, can be found at\nhttps://www.kernel.org/doc/man-pages/.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#RETURN VALUE\">RETURN VALUE</a>","<a href=\"#ERRORS\">ERRORS</a>","<a href=\"#ATTRIBUTES\">ATTRIBUTES</a>","<a href=\"#CONFORMING TO\">CONFORMING TO</a>","<a href=\"#NOTES\">NOTES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#COLOPHON\">COLOPHON</a>"],"level":3}