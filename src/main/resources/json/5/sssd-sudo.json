{"name":"sssd-sudo","body":"\n\n<h1 align=\"center\">SSSD-SUDO</h1>\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">sssd-sudo -\nConfiguring sudo with the SSSD back end</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This manual\npage describes how to configure <b>sudo</b>(8) to work with\n<b>sssd</b>(8) and how SSSD caches sudo rules.</p>\n\n<h2>CONFIGURING SUDO TO COOPERATE WITH SSSD\n<a name=\"CONFIGURING SUDO TO COOPERATE WITH SSSD\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">To enable SSSD\nas a source for sudo rules, add <i>sss</i> to the\n<i>sudoers</i> entry in <b>nsswitch.conf</b>(5).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For example, to\nconfigure sudo to first lookup rules in the standard\n<a href=\"https://man.page/5/sudoers\">sudoers(5)</a> file (which should contain rules that\napply to local users) and then in SSSD, the nsswitch.conf\nfile should contain the following line:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">sudoers: files\nsss</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">More\ninformation about configuring the sudoers search order from\nthe nsswitch.conf file as well as information about the LDAP\nschema that is used to store sudo rules in the directory can\nbe found in <b>sudoers.ldap</b>(5).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Note</i>: in\norder to use netgroups or IPA hostgroups in sudo rules, you\nalso need to correctly set <a href=\"https://man.page/1/nisdomainname\">nisdomainname(1)</a> to your\nNIS domain name (which equals to IPA domain name when using\nhostgroups).</p>\n\n<h2>CONFIGURING SSSD TO FETCH SUDO RULES\n<a name=\"CONFIGURING SSSD TO FETCH SUDO RULES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">All\nconfiguration that is needed on SSSD side is to extend the\nlist of <i>services</i> with &quot;sudo&quot; in [sssd]\nsection of <b>sssd.conf</b>(5). To speed up the LDAP\nlookups, you can also set search base for sudo rules using\n<i>ldap_sudo_search_base</i> option.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The following\nexample shows how to configure SSSD to download sudo rules\nfrom an LDAP server.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">[sssd] <br>\nconfig_file_version = 2 <br>\nservices = nss, pam, sudo <br>\ndomains = EXAMPLE</p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\">[domain/EXAMPLE]\n<br>\nid_provider = ldap <br>\nsudo_provider = ldap <br>\nldap_uri = ldap://example.com <br>\nldap_sudo_search_base = ou=sudoers,dc=example,dc=com</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">It's important\nto note that on platforms where systemd is supported there's\nno need to add the &quot;sudo&quot; provider to the list of\nservices, as it became optional. However, sssd-sudo.socket\nmust be enabled instead.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When SSSD is\nconfigured to use IPA as the ID provider, the sudo provider\nis automatically enabled. The sudo search base is configured\nto use the IPA native LDAP tree (cn=sudo,$SUFFIX). If any\nother search base is defined in sssd.conf, this value will\nbe used instead. The compat tree (ou=sudoers,$SUFFIX) is no\nlonger required for IPA sudo functionality.</p>\n\n<h2>THE SUDO RULE CACHING MECHANISM\n<a name=\"THE SUDO RULE CACHING MECHANISM\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The biggest\nchallenge, when developing sudo support in SSSD, was to\nensure that running sudo with SSSD as the data source\nprovides the same user experience and is as fast as sudo but\nkeeps providing the most current set of rules as possible.\nTo satisfy these requirements, SSSD uses three kinds of\nupdates. They are referred to as full refresh, smart refresh\nand rules refresh.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>smart\nrefresh</i> periodically downloads rules that are new or\nwere modified after the last update. Its primary goal is to\nkeep the database growing by fetching only small increments\nthat do not generate large amounts of network traffic.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>full\nrefresh</i> simply deletes all sudo rules stored in the\ncache and replaces them with all rules that are stored on\nthe server. This is used to keep the cache consistent by\nremoving every rule which was deleted from the server.\nHowever, full refresh may produce a lot of traffic and thus\nit should be run only occasionally depending on the size and\nstability of the sudo rules.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The <i>rules\nrefresh</i> ensures that we do not grant the user more\npermission than defined. It is triggered each time the user\nruns sudo. Rules refresh will find all rules that apply to\nthis user, check their expiration time and redownload them\nif expired. In the case that any of these rules are missing\non the server, the SSSD will do an out of band full refresh\nbecause more rules (that apply to other users) may have been\ndeleted.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If enabled,\nSSSD will store only rules that can be applied to this\nmachine. This means rules that contain one of the following\nvalues in <i>sudoHost</i> attribute:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull; keyword\nALL</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull;\nwildcard</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull; netgroup\n(in the form &quot;+netgroup&quot;)</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull; hostname\nor fully qualified domain name of this machine</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull; one of\nthe IP addresses of this machine</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">&bull; one of\nthe IP addresses of the network (in the form\n&quot;address/mask&quot;)</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">There are many\nconfiguration options that can be used to adjust the\nbehavior. Please refer to &quot;ldap_sudo_*&quot; in\n<a href=\"https://man.page/5/sssd-ldap\">sssd-ldap(5)</a> and &quot;sudo_*&quot; in\n<b>sssd.conf</b>(5).</p>\n\n<h2>TUNING THE PERFORMANCE\n<a name=\"TUNING THE PERFORMANCE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">SSSD uses\ndifferent kinds of mechanisms with more or less complex LDAP\nfilters to keep the cached sudo rules up to date. The\ndefault configuration is set to values that should satisfy\nmost of our users, but the following paragraphs contain few\ntips on how to fine- tune the configuration to your\nrequirements.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">1. <i>Index\nLDAP attributes</i>. Make sure that following LDAP\nattributes are indexed: objectClass, cn, entryUSN or\nmodifyTimestamp.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">2. <i>Set\nldap_sudo_search_base</i>. Set the search base to the\ncontainer that holds the sudo rules to limit the scope of\nthe lookup.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">3. <i>Set full\nand smart refresh interval</i>. If your sudo rules do not\nchange often and you do not require quick update of cached\nrules on your clients, you may consider increasing the\n<i>ldap_sudo_full_refresh_interval</i> and\n<i>ldap_sudo_smart_refresh_interval</i>. You may also\nconsider disabling the smart refresh by setting\n<i>ldap_sudo_smart_refresh_interval = 0</i>.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">4. If you have\nlarge number of clients, you may consider increasing the\nvalue of <i>ldap_sudo_random_offset</i> to distribute the\nload on the server better.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>sssd</b>(8),\n<b>sssd.conf</b>(5), <a href=\"https://man.page/5/sssd-ldap\">sssd-ldap(5)</a>,\n<a href=\"https://man.page/5/sssd-krb5\">sssd-krb5(5)</a>, <a href=\"https://man.page/5/sssd-simple\">sssd-simple(5)</a>,\n<a href=\"https://man.page/5/sssd-ipa\">sssd-ipa(5)</a>, <a href=\"https://man.page/5/sssd-ad\">sssd-ad(5)</a>, <a href=\"https://man.page/5/sssd-files\">sssd-files(5)</a>,\n<a href=\"https://man.page/5/sssd-sudo\">sssd-sudo(5)</a>, <a href=\"https://man.page/5/sssd-session-recording\">sssd-session-recording(5)</a>,\n<b>sss_cache</b>(8), <b>sss_debuglevel</b>(8),\n<b>sss_obfuscate</b>(8), <b>sss_seed</b>(8),\n<b>sssd_krb5_locator_plugin</b>(8),\n<b>sss_ssh_authorizedkeys</b>(8),\n<b>sss_ssh_knownhostsproxy</b>(8), <a href=\"https://man.page/5/sssd-ifp\">sssd-ifp(5)</a>,\n<b>pam_sss</b>(8). <a href=\"https://man.page/5/sss_rpcidmapd\">sss_rpcidmapd(5)</a>\n<a href=\"https://man.page/5/sssd-systemtap\">sssd-systemtap(5)</a></p>\n\n<h2>AUTHORS\n<a name=\"AUTHORS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>The SSSD\nupstream - https://github.com/SSSD/sssd/</b></p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#CONFIGURING SUDO TO COOPERATE WITH SSSD\">CONFIGURING SUDO TO COOPERATE WITH SSSD</a>","<a href=\"#CONFIGURING SSSD TO FETCH SUDO RULES\">CONFIGURING SSSD TO FETCH SUDO RULES</a>","<a href=\"#THE SUDO RULE CACHING MECHANISM\">THE SUDO RULE CACHING MECHANISM</a>","<a href=\"#TUNING THE PERFORMANCE\">TUNING THE PERFORMANCE</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#AUTHORS\">AUTHORS</a>"],"level":5}