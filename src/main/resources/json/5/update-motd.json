{"name":"update-motd","description":"update-motd - dynamic MOTD generation","body":"\n\n<h1 align=\"center\">update-motd</h1>\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">update-motd -\ndynamic MOTD generation</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>/etc/update-motd.d/*</b></p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">UNIX/Linux\nsystem adminstrators often communicate important information\nto console and remote users by maintaining text in the file\n<i>/etc/motd</i>, which is displayed by the\n<b>pam_motd</b>(8) module on interactive shell logins.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Traditionally,\nthis file is static text, typically installed by the\ndistribution and only updated on release upgrades, or\noverwritten by the local administrator with pertinent\ninformation.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Ubuntu\nintroduced the <b>update-motd</b> framework, by which the\n<a href=\"https://man.page/5/motd\">motd(5)</a> is dynamically assembled from a collection of\nscripts at login.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Executable\nscripts in <i>/etc/update-motd.d/*</i> are executed by\n<b>pam_motd</b>(8) as the root user at each login, and this\ninformation is concatenated in <i>/run/motd.dynamic</i>. The\norder of script execution is determined by the\n<b>run-parts</b>(8) --lsbsysinit option (basically\nalphabetical order, with a few caveats).</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Ubuntu\nsystems, <i>/etc/motd</i> is typically a symbolic link to\n<i>/run/motd.dynamic</i>.</p>\n\n<h2>BEST PRACTICES\n<a name=\"BEST PRACTICES\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">MOTD fragments\nmust be scripts in <i>/etc/update-motd.d</i>, must be\nexecutable, and must emit information on standard out.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Scripts should\nbe named named NN-xxxxxx where NN is a two digit number\nindicating their position in the MOTD, and xxxxxx is an\nappropriate name for the script.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Scripts must\nnot have filename extensions, per <b>run-parts</b>(8)\n--lsbsysinit instructions.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Packages should\nadd scripts directly into <i>/etc/update-motd.d</i>, rather\nthan symlinks to other scripts, such that administrators can\nmodify or remove these scripts and upgrades will not wipe\nthe local changes. Consider using a simple shell script that\nsimply calls <b>exec</b> on the external utility.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Long running\noperations (such as network calls) or resource intensive\nscripts should cache output, and only update that output if\nit is deemed expired. For instance:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/update-motd.d/50-news\n<br>\n#!/bin/sh <br>\nout=/run/foo <br>\nscript=&quot;w3m -dump http://news.google.com/&quot; <br>\nif [ -f &quot;$out&quot; ]; then <br>\n# Output exists, print it <br>\necho <br>\ncat &quot;$out&quot; <br>\n# See if it&rsquo;s expired, and background update <br>\nlastrun=$(stat -c %Y &quot;$out&quot;) || lastrun=0 <br>\nexpiration=$(expr $lastrun + 86400) <br>\nif [ $(date +%s) -ge $expiration ]; then <br>\n$script &gt; &quot;$out&quot; &amp; <br>\nfi <br>\nelse <br>\n# No cache at all, so update in the background <br>\n$script &gt; &quot;$out&quot; &amp; <br>\nfi</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Scripts should\nemit a blank line before output, and end with a newline\ncharacter. For instance:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/update-motd/05-lsb-release\n<br>\n#!/bin/sh <br>\necho <br>\nlsb-release -a</p>\n\n<h2>FILES\n<a name=\"FILES\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>/etc/motd</i>,\n<i>/run/motd.dynamic</i>, <i>/etc/update-motd.d</i></p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i><b>motd</b></i>(5),\n<b>pam_motd</b>(8), <b>run-parts</b>(8)</p>\n\n<h2>AUTHOR\n<a name=\"AUTHOR\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This manpage\nand the update-motd framework was written by Dustin Kirkland\n&lt;kirkland@canonical.com&gt; for Ubuntu systems (but may\nbe used by others). Permission is granted to copy,\ndistribute and/or modify this document under the terms of\nthe GNU General Public License, Version 3 published by the\nFree Software Foundation.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">On Debian\nsystems, the complete text of the GNU General Public License\ncan be found in /usr/share/common-licenses/GPL.</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#BEST PRACTICES\">BEST PRACTICES</a>","<a href=\"#FILES\">FILES</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#AUTHOR\">AUTHOR</a>"],"level":5}