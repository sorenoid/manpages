{"name":"resolved.conf","description":"resolved.conf, resolved.conf.d - Network Name Resolution configuration files","body":"\n\n<h1 align=\"center\">RESOLVED.CONF</h1>\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">resolved.conf,\nresolved.conf.d - Network Name Resolution configuration\nfiles</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/systemd/resolved.conf</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/systemd/resolved.conf.d/*.conf</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/run/systemd/resolved.conf.d/*.conf</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/usr/lib/systemd/resolved.conf.d/*.conf</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">These\nconfiguration files control local DNS and LLMNR name\nresolution.</p>\n\n<h2>CONFIGURATION DIRECTORIES AND PRECEDENCE\n<a name=\"CONFIGURATION DIRECTORIES AND PRECEDENCE\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The default\nconfiguration is set during compilation, so configuration is\nonly needed when it is necessary to deviate from those\ndefaults. Initially, the main configuration file in\n/etc/systemd/ contains commented out entries showing the\ndefaults as a guide to the administrator. Local overrides\ncan be created by editing this file or by creating drop-ins,\nas described below. Using drop-ins for local configuration\nis recommended over modifications to the main configuration\nfile.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">In addition to\nthe &quot;main&quot; configuration file, drop-in\nconfiguration snippets are read from\n/usr/lib/systemd/*.conf.d/,\n/usr/local/lib/systemd/*.conf.d/, and\n/etc/systemd/*.conf.d/. Those drop-ins have higher\nprecedence and override the main configuration file. Files\nin the *.conf.d/ configuration subdirectories are sorted by\ntheir filename in lexicographic order, regardless of in\nwhich of the subdirectories they reside. When multiple files\nspecify the same option, for options which accept just a\nsingle value, the entry in the file sorted last takes\nprecedence, and for options which accept a list of values,\nentries are collected as they occur in the sorted files.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When packages\nneed to customize the configuration, they can install\ndrop-ins under /usr/. Files in /etc/ are reserved for the\nlocal administrator, who may use this logic to override the\nconfiguration files installed by vendor packages. Drop-ins\nhave to be used to override package drop-ins, since the main\nconfiguration file has lower precedence. It is recommended\nto prefix all filenames in those subdirectories with a\ntwo-digit number and a dash, to simplify the ordering of the\nfiles.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To disable a\nconfiguration file supplied by the vendor, the recommended\nway is to place a symlink to /dev/null in the configuration\ndirectory in /etc/, with the same filename as the vendor\nconfiguration file.</p>\n\n<h2>OPTIONS\n<a name=\"OPTIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The following\noptions are available in the [Resolve] section:</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>DNS=</i></p>\n\n<p style=\"margin-left:17%;\">A space-separated list of IPv4\nand IPv6 addresses to use as system DNS servers. Each\naddress can optionally take a port number separated with\n&quot;:&quot;, a network interface name or index separated\nwith &quot;%&quot;, and a Server Name Indication (SNI)\nseparated with &quot;#&quot;. When IPv6 address is specified\nwith a port number, then the address must be in the square\nbrackets. That is, the acceptable full formats are\n&quot;111.222.333.444:9953%ifname#example.com&quot; for IPv4\nand &quot;[1111:2222::3333]:9953%ifname#example.com&quot;\nfor IPv6. DNS requests are sent to one of the listed DNS\nservers in parallel to suitable per-link DNS servers\nacquired from <b>systemd-networkd.service</b>(8) or set at\nruntime by external applications. For compatibility reasons,\nif this setting is not specified, the DNS servers listed in\n/etc/resolv.conf are used instead, if that file exists and\nany servers are configured in it. This setting defaults to\nthe empty list.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>FallbackDNS=</i></p>\n\n<p style=\"margin-left:17%;\">A space-separated list of IPv4\nand IPv6 addresses to use as the fallback DNS servers.\nPlease see <i>DNS=</i> for acceptable format of addresses.\nAny per-link DNS servers obtained from\n<b>systemd-networkd.service</b>(8) take precedence over this\nsetting, as do any servers set via <i>DNS=</i> above or\n/etc/resolv.conf. This setting is hence only used if no\nother DNS server information is known. If this option is not\ngiven, a compiled-in list of DNS servers is used\ninstead.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>Domains=</i></p>\n\n<p style=\"margin-left:17%;\">A space-separated list of\ndomains optionally prefixed with &quot;~&quot;, used for two\ndistinct purposes described below. Defaults to the empty\nlist.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Any domains\n<i>not</i> prefixed with &quot;~&quot; are used as search\nsuffixes when resolving single-label hostnames (domain names\nwhich contain no dot), in order to qualify them into\nfully-qualified domain names (FQDNs). These &quot;search\ndomains&quot; are strictly processed in the order they are\nspecified in, until the name with the suffix appended is\nfound. For compatibility reasons, if this setting is not\nspecified, the search domains listed in /etc/resolv.conf\nwith the <i>search</i> keyword are used instead, if that\nfile exists and any domains are configured in it.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">The domains\nprefixed with &quot;~&quot; are called &quot;routing\ndomains&quot;. All domains listed here (both search domains\nand routing domains after removing the &quot;~&quot; prefix)\ndefine a search path that preferably directs DNS queries to\nthis interface. This search path has an effect only when\nsuitable per-link DNS servers are known. Such servers may be\ndefined through the <i>DNS=</i> setting (see above) and\ndynamically at run time, for example from DHCP leases. If no\nper-link DNS servers are known, routing domains have no\neffect.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">Use the\nconstruct &quot;~.&quot; (which is composed from\n&quot;~&quot; to indicate a routing domain and &quot;.&quot;\nto indicate the DNS root domain that is the implied suffix\nof all DNS domains) to use the DNS servers defined for this\nlink preferably for all domains.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><i>LLMNR=</i></p>\n\n<p style=\"margin-left:17%;\">Takes a boolean argument or\n&quot;resolve&quot;. Controls Link-Local Multicast Name\nResolution support (<b><font color=\"#0000FF\">RFC\n4795</font></b>\n<small><font color=\"#000000\">[1]</font></small>\n<font color=\"#000000\">) on the local host. If true, enables\nfull LLMNR responder and resolver support. If false,\ndisables both. If set to &quot;resolve&quot;, only\nresolution support is enabled, but responding is disabled.\nNote that <b>systemd-networkd.service</b>(8) also maintains\nper-link LLMNR settings. LLMNR will be enabled on a link\nonly if the per-link and the global setting is\non.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>MulticastDNS=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument or &quot;resolve&quot;. Controls Multicast\nDNS support (</font><b><font color=\"#0000FF\">RFC\n6762</font></b>\n<small><font color=\"#000000\">[2]</font></small>\n<font color=\"#000000\">) on the local host. If true, enables\nfull Multicast DNS responder and resolver support. If false,\ndisables both. If set to &quot;resolve&quot;, only\nresolution support is enabled, but responding is disabled.\nNote that <b>systemd-networkd.service</b>(8) also maintains\nper-link Multicast DNS settings. Multicast DNS will be\nenabled on a link only if the per-link and the global\nsetting is on.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>DNSSEC=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument or &quot;allow-downgrade&quot;. If true all\nDNS lookups are DNSSEC-validated locally (excluding LLMNR\nand Multicast DNS). If the response to a lookup request is\ndetected to be invalid a lookup failure is returned to\napplications. Note that this mode requires a DNS server that\nsupports DNSSEC. If the DNS server does not properly support\nDNSSEC all validations will fail. If set to\n&quot;allow-downgrade&quot; DNSSEC validation is attempted,\nbut if the server does not support DNSSEC properly, DNSSEC\nmode is automatically disabled. Note that this mode makes\nDNSSEC validation vulnerable to &quot;downgrade&quot;\nattacks, where an attacker might be able to trigger a\ndowngrade to non-DNSSEC mode by synthesizing a DNS response\nthat suggests DNSSEC was not supported. If set to false, DNS\nlookups are not DNSSEC validated.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Note\nthat DNSSEC validation requires retrieval of additional DNS\ndata, and thus results in a small DNS look-up time\npenalty.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">DNSSEC\nrequires knowledge of &quot;trust anchors&quot; to prove\ndata integrity. The trust anchor for the Internet root\ndomain is built into the resolver, additional trust anchors\nmay be defined with <b>dnssec-trust-anchors.d</b>(5). Trust\nanchors may change at regular intervals, and old trust\nanchors may be revoked. In such a case DNSSEC validation is\nnot possible until new trust anchors are configured locally\nor the resolver software package is updated with the new\nroot trust anchor. In effect, when the built-in trust anchor\nis revoked and <i>DNSSEC=</i> is true, all further lookups\nwill fail, as it cannot be proved anymore whether lookups\nare correctly signed, or validly unsigned. If <i>DNSSEC=</i>\nis set to &quot;allow-downgrade&quot; the resolver will\nautomatically turn off DNSSEC validation in such a\ncase.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Client\nprograms looking up DNS data will be informed whether\nlookups could be verified using DNSSEC, or whether the\nreturned data could not be verified (either because the data\nwas found unsigned in the DNS, or the DNS server did not\nsupport DNSSEC or no appropriate trust anchors were known).\nIn the latter case it is assumed that client programs employ\na secondary scheme to validate the returned DNS data, should\nthis be required.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">It\nis recommended to set <i>DNSSEC=</i> to true on systems\nwhere it is known that the DNS server supports DNSSEC\ncorrectly, and where software or trust anchor updates happen\nregularly. On other systems it is recommended to set\n<i>DNSSEC=</i> to &quot;allow-downgrade&quot;.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">In\naddition to this global DNSSEC setting\n<b>systemd-networkd.service</b>(8) also maintains per-link\nDNSSEC settings. For system DNS servers (see above), only\nthe global DNSSEC setting is in effect. For per-link DNS\nservers the per-link setting is in effect, unless it is\nunset in which case the global setting is used\ninstead.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Site-private\nDNS zones generally conflict with DNSSEC operation, unless a\nnegative (if the private zone is not signed) or positive (if\nthe private zone is signed) trust anchor is configured for\nthem. If &quot;allow-downgrade&quot; mode is selected, it is\nattempted to detect site-private DNS zones using top-level\ndomains (TLDs) that are not known by the DNS root server.\nThis logic does not work in all private zone\nsetups.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Defaults\nto &quot;no&quot;.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>DNSOverTLS=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument or &quot;opportunistic&quot;. If true all\nconnections to the server will be encrypted. Note that this\nmode requires a DNS server that supports DNS-over-TLS and\nhas a valid certificate. If the hostname was specified in\n<i>DNS=</i> by using the format format\n&quot;address#server_name&quot; it is used to validate its\ncertificate and also to enable Server Name Indication (SNI)\nwhen opening a TLS connection. Otherwise the certificate is\nchecked against the server's IP. If the DNS server does not\nsupport DNS-over-TLS all DNS requests will fail.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">When\nset to &quot;opportunistic&quot; DNS request are attempted\nto send encrypted with DNS-over-TLS. If the DNS server does\nnot support TLS, DNS-over-TLS is disabled. Note that this\nmode makes DNS-over-TLS vulnerable to &quot;downgrade&quot;\nattacks, where an attacker might be able to trigger a\ndowngrade to non-encrypted mode by synthesizing a response\nthat suggests DNS-over-TLS was not supported. If set to\nfalse, DNS lookups are send over UDP.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Note\nthat DNS-over-TLS requires additional data to be send for\nsetting up an encrypted connection, and thus results in a\nsmall DNS look-up time penalty.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Note\nthat in &quot;opportunistic&quot; mode the resolver is not\ncapable of authenticating the server, so it is vulnerable to\n&quot;man-in-the-middle&quot; attacks.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">In\naddition to this global <i>DNSOverTLS=</i> setting\n<b>systemd-networkd.service</b>(8) also maintains per-link\n<i>DNSOverTLS=</i> settings. For system DNS servers (see\nabove), only the global <i>DNSOverTLS=</i> setting is in\neffect. For per-link DNS servers the per-link setting is in\neffect, unless it is unset in which case the global setting\nis used instead.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Defaults\nto &quot;no&quot;.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>Cache=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean or &quot;no-negative&quot; as argument. If\n&quot;yes&quot;, resolving a domain name which already got\nqueried earlier will return the previous result as long as\nit is still valid, and thus does not result in a new network\nrequest. Be aware that turning off caching comes at a\nperformance penalty, which is particularly high when DNSSEC\nis used. If &quot;no-negative&quot; (the default), only\npositive answers are cached.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Note\nthat caching is turned off by default for host-local DNS\nservers. See <i>CacheFromLocalhost=</i> for\ndetails.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>CacheFromLocalhost=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean as argument. If &quot;no&quot; (the default), and\nresponse cames from host-local IP address (such as 127.0.0.1\nor ::1), the result wouldn't be cached in order to avoid\npotential duplicate local caching.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>DNSStubListener=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument or one of &quot;udp&quot; and\n&quot;tcp&quot;. If &quot;udp&quot;, a DNS stub resolver\nwill listen for UDP requests on address 127.0.0.53 port 53.\nIf &quot;tcp&quot;, the stub will listen for TCP requests on\nthe same address and port. If &quot;yes&quot; (the default),\nthe stub listens for both UDP and TCP requests. If\n&quot;no&quot;, the stub listener is disabled.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Note\nthat the DNS stub listener is turned off implicitly when its\nlistening address and port are already in use.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>DNSStubListenerExtra=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes an\nIPv4 or IPv6 address to listen on. The address may be\noptionally prefixed with a protocol name (&quot;udp&quot; or\n&quot;tcp&quot;) separated with &quot;:&quot;. If the\nprotocol is not specified, the service will listen on both\nUDP and TCP. It may be also optionally suffixed by a numeric\nport number with separator &quot;:&quot;. When an IPv6\naddress is specified with a port number, then the address\nmust be in the square brackets. If the port is not\nspecified, then the service uses port 53. Note that this is\nindependent of the primary DNS stub configured with\n<i>DNSStubListener=</i>, and only configures\n<i>additional</i> sockets to listen on. This option can be\nspecified multiple times. If an empty string is assigned,\nthen the all previous assignments are cleared. Defaults to\nunset.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">Examples:</font></p>\n\n\n<p style=\"margin-left:23%; margin-top: 1em\"><font color=\"#000000\">DNSStubListenerExtra=192.168.10.10\n<br>\nDNSStubListenerExtra=2001:db8:0:f102::10 <br>\nDNSStubListenerExtra=192.168.10.11:9953 <br>\nDNSStubListenerExtra=[2001:db8:0:f102::11]:9953 <br>\nDNSStubListenerExtra=tcp:192.168.10.12 <br>\nDNSStubListenerExtra=udp:2001:db8:0:f102::12 <br>\nDNSStubListenerExtra=tcp:192.168.10.13:9953 <br>\n\nDNSStubListenerExtra=udp:[2001:db8:0:f102::13]:9953</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>ReadEtcHosts=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument. If &quot;yes&quot; (the default),\n<b>systemd-resolved</b> will read /etc/hosts, and try to\nresolve hosts or address by using the entries in the file\nbefore sending query to DNS servers.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><i>ResolveUnicastSingleLabel=</i></font></p>\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">Takes a\nboolean argument. When false (the default),\n<b>systemd-resolved</b> will not resolve A and AAAA queries\nfor single-label names over classic DNS. Note that such\nnames may still be resolved if search domains are specified\n(see <i>Domains=</i> above), or using other mechanisms, in\nparticular via LLMNR or from /etc/hosts. When true, queries\nfor single-label names will be forwarded to global DNS\nservers even if no search domains are defined.</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">This\noption is provided for compatibility with configurations\nwhere <i>public DNS servers are not used</i>. Forwarding\nsingle-label names to servers not under your control is not\nstandard-conformant, see</font> <b><font color=\"#0000FF\">IAB\nStatement</font></b>\n<small><font color=\"#000000\">[3]</font></small>\n<font color=\"#000000\">, and may create a privacy and\nsecurity risk.</font></p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><a href=\"https://man.page/1/systemd\">systemd(1)</a>,\n<b>systemd-resolved.service</b>(8),\n<b>systemd-networkd.service</b>(8),\n<b>dnssec-trust-anchors.d</b>(5),\n<b>resolv.conf</b>(5)</font></p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"12%\"></td>\n<td width=\"3%\">\n\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">1.</font></p> </td>\n<td width=\"2%\"></td>\n<td width=\"12%\">\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">RFC\n4795</font></p> </td>\n<td width=\"71%\">\n</td></tr>\n</table>\n\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">https://tools.ietf.org/html/rfc4795</font></p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"12%\"></td>\n<td width=\"3%\">\n\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">2.</font></p> </td>\n<td width=\"2%\"></td>\n<td width=\"12%\">\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">RFC\n6762</font></p> </td>\n<td width=\"71%\">\n</td></tr>\n</table>\n\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">https://tools.ietf.org/html/rfc6762</font></p>\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"12%\"></td>\n<td width=\"3%\">\n\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">3.</font></p> </td>\n<td width=\"2%\"></td>\n<td width=\"20%\">\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">IAB\nStatement</font></p> </td>\n<td width=\"63%\">\n</td></tr>\n</table>\n\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">https://www.iab.org/documents/correspondence-reports-documents/2013-2/iab-statement-dotless-domains-considered-harmful/</font></p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#CONFIGURATION DIRECTORIES AND PRECEDENCE\">CONFIGURATION DIRECTORIES AND PRECEDENCE</a>","<a href=\"#OPTIONS\">OPTIONS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#NOTES\">NOTES</a>"],"level":5}