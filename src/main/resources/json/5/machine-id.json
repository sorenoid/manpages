{"name":"machine-id","body":"\n\n<h1 align=\"center\">MACHINE-ID</h1>\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">machine-id -\nLocal machine ID configuration file</p>\n\n<h2>SYNOPSIS\n<a name=\"SYNOPSIS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/machine-id</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n/etc/machine-id file contains the unique machine ID of the\nlocal system that is set during installation or boot. The\nmachine ID is a single newline-terminated, hexadecimal,\n32-character, lowercase ID. When decoded from hexadecimal,\nthis corresponds to a 16-byte/128-bit value. This ID may not\nbe all zeros.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The machine ID\nis usually generated from a random source during system\ninstallation or first boot and stays constant for all\nsubsequent boots. Optionally, for stateless systems, it is\ngenerated during runtime during early boot if necessary.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The machine ID\nmay be set, for example when network booting, with the\n<i>systemd.machine_id=</i> kernel command line parameter or\nby passing the option <b>--machine-id=</b> to systemd. An ID\nspecified in this manner has higher priority and will be\nused instead of the ID stored in /etc/machine-id.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The machine ID\ndoes not change based on local or network configuration or\nwhen hardware is replaced. Due to this and its greater\nlength, it is a more useful replacement for the\n<a href=\"https://man.page/3/gethostid\">gethostid(3)</a> call that POSIX specifies.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This machine ID\nadheres to the same format and logic as the D-Bus machine\nID.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">This ID\nuniquely identifies the host. It should be considered\n&quot;confidential&quot;, and must not be exposed in\nuntrusted environments, in particular on the network. If a\nstable unique identifier that is tied to the machine is\nneeded for some application, the machine ID or any part of\nit must not be used directly. Instead the machine ID should\nbe hashed with a cryptographic, keyed hash function, using a\nfixed, application-specific key. That way the ID will be\nproperly unique, and derived in a constant way from the\nmachine ID but there will be no way to retrieve the original\nmachine ID from the application-specific one. The\n<a href=\"https://man.page/3/sd_id128_get_machine_app_specific\">sd_id128_get_machine_app_specific(3)</a> API provides an\nimplementation of such an algorithm.</p>\n\n<h2>INITIALIZATION\n<a name=\"INITIALIZATION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Each machine\nshould have a non-empty ID in normal operation. The ID of\neach machine should be unique. To achieve those objectives,\n/etc/machine-id can be initialized in a few different\nways.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For normal\noperating system installations, where a custom image is\ncreated for a specific machine, /etc/machine-id should be\npopulated during installation.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/systemd-machine-id-setup\">systemd-machine-id-setup(1)</a>\nmay be used by installer tools to initialize the machine ID\nat install time, but /etc/machine-id may also be written\nusing any other means.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">For operating\nsystem images which are created once and used on multiple\nmachines, for example for containers or in the cloud,\n/etc/machine-id should be either missing or an empty file in\nthe generic file system image (the difference between the\ntwo options is described under &quot;First Boot\nSemantics&quot; below). An ID will be generated during boot\nand saved to this file if possible. Having an empty file in\nplace is useful because it allows a temporary file to be\nbind-mounted over the real file, in case the image is used\nread-only.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><a href=\"https://man.page/1/systemd-firstboot\">systemd-firstboot(1)</a>\nmay be used to initialize /etc/machine-id on mounted (but\nnot booted) system images.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">When a machine\nis booted with <a href=\"https://man.page/1/systemd\">systemd(1)</a> the ID of the machine will\nbe established. If <i>systemd.machine_id=</i> or\n<b>--machine-id=</b> options (see first section) are\nspecified, this value will be used. Otherwise, the value in\n/etc/machine-id will be used. If this file is empty or\nmissing, systemd will attempt to use the D-Bus machine ID\nfrom /var/lib/dbus/machine-id, the value of the kernel\ncommand line option <i>container_uuid</i>, the KVM DMI\nproduct_uuid or the devicetree vm,uuid (on KVM systems), and\nfinally a randomly generated UUID.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">After the\nmachine ID is established, <a href=\"https://man.page/1/systemd\">systemd(1)</a> will attempt to\nsave it to /etc/machine-id. If this fails, it will attempt\nto bind-mount a temporary file over /etc/machine-id. It is\nan error if the file system is read-only and does not\ncontain a (possibly empty) /etc/machine-id file.</p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><b>systemd-machine-id-commit.service</b>(8)\nwill attempt to write the machine ID to the file system if\n/etc/machine-id or /etc/ are read-only during early boot but\nbecome writable later on.</p>\n\n<h2>FIRST BOOT SEMANTICS\n<a name=\"FIRST BOOT SEMANTICS\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">/etc/machine-id\nis used to decide whether a boot is the first one. The rules\nare as follows:</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">1. If\n/etc/machine-id does not exist, this is a first boot. During\nearly boot, <b>systemd</b> will write\n&quot;uninitialized\\n&quot; to this file and overmount a\ntemporary file which contains the actual machine ID. Later\n(after first-boot-complete.target has been reached), the\nreal machine ID will be written to disk.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">2. If\n/etc/machine-id contains the string\n&quot;uninitialized&quot;, a boot is also considered the\nfirst boot. The same mechanism as above applies.</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">3. If\n/etc/machine-id exists and is empty, a boot is <i>not</i>\nconsidered the first boot. <b>systemd</b> will still\nbind-mount a file containing the actual machine-id over it\nand later try to commit it to disk (if /etc/ is\nwritable).</p>\n\n<p style=\"margin-left:17%; margin-top: 1em\">4. If\n/etc/machine-id already contains a valid machine-id, this is\nnot a first boot.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">If by any of\nthe above rules, a first boot is detected, units with\n<i>ConditionFirstBoot=yes</i> will be run.</p>\n\n<h2>RELATION TO OSF UUIDS\n<a name=\"RELATION TO OSF UUIDS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Note that the\nmachine ID historically is not an OSF UUID as defined by\n<b><font color=\"#0000FF\">RFC 4122</font></b>\n<small><font color=\"#000000\">[1]</font></small>\n<font color=\"#000000\">, nor a Microsoft GUID; however,\nstarting with systemd v30, newly generated machine IDs do\nqualify as Variant 1 Version 4 UUIDs, as per RFC\n4122.</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\">In\norder to maintain compatibility with existing installations,\nan application requiring a strictly RFC 4122 compliant UUID\nshould decode the machine ID, and then (non-reversibly)\napply the following operations to turn it into a valid RFC\n4122 Variant 1 Version 4 UUID. With &quot;id&quot; being an\nunsigned character array:</font></p>\n\n\n<p style=\"margin-left:17%; margin-top: 1em\"><font color=\"#000000\">/*\nSet UUID version to 4 --- truly random generation */ <br>\nid[6] = (id[6] &amp; 0x0F) | 0x40; <br>\n/* Set the UUID variant to DCE */ <br>\nid[8] = (id[8] &amp; 0x3F) | 0x80;</font></p>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\">(This\ncode is inspired by &quot;generate_random_uuid()&quot; of\ndrivers/char/random.c from the Linux kernel\nsources.)</font></p>\n\n<h2>HISTORY\n<a name=\"HISTORY\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\">The\nsimple configuration file format of /etc/machine-id\noriginates in the /var/lib/dbus/machine-id file introduced\nby D-Bus. In fact, this latter file might be a symlink to\n/etc/machine-id.</font></p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\"><font color=\"#000000\"><a href=\"https://man.page/1/systemd\">systemd(1)</a>,\n<a href=\"https://man.page/1/systemd-machine-id-setup\">systemd-machine-id-setup(1)</a>, <a href=\"https://man.page/3/gethostid\">gethostid(3)</a>,\n<a href=\"https://man.page/5/hostname\">hostname(5)</a>, <a href=\"https://man.page/5/machine-info\">machine-info(5)</a>,\n<a href=\"https://man.page/5/os-release\">os-release(5)</a>, <a href=\"https://man.page/3/sd-id128\">sd-id128(3)</a>,\n<a href=\"https://man.page/3/sd_id128_get_machine\">sd_id128_get_machine(3)</a>,\n<a href=\"https://man.page/1/systemd-firstboot\">systemd-firstboot(1)</a></font></p>\n\n<h2>NOTES\n<a name=\"NOTES\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"12%\"></td>\n<td width=\"3%\">\n\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">1.</font></p> </td>\n<td width=\"2%\"></td>\n<td width=\"12%\">\n\n\n<p style=\"margin-top: 1em\"><font color=\"#000000\">RFC\n4122</font></p> </td>\n<td width=\"71%\">\n</td></tr>\n</table>\n\n\n<p style=\"margin-left:17%;\"><font color=\"#000000\">https://tools.ietf.org/html/rfc4122</font></p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#SYNOPSIS\">SYNOPSIS</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#INITIALIZATION\">INITIALIZATION</a>","<a href=\"#FIRST BOOT SEMANTICS\">FIRST BOOT SEMANTICS</a>","<a href=\"#RELATION TO OSF UUIDS\">RELATION TO OSF UUIDS</a>","<a href=\"#HISTORY\">HISTORY</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#NOTES\">NOTES</a>"],"level":5}