{"name":"hosts_options","description":"hosts_options - host access control language extensions","body":"\n\n<h1 align=\"center\">HOSTS_OPTIONS</h1>\n\n\n\n\n\n\n\n\n\n\n\n\n\n<hr>\n\n\n<h2>NAME\n<a name=\"NAME\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">hosts_options -\nhost access control language extensions</p>\n\n<h2>DESCRIPTION\n<a name=\"DESCRIPTION\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">This document\ndescribes extensions to the language described in the\nhosts_access(5) document.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The extensible\nlanguage uses the following format:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">daemon_list :\nclient_list : option : option ...</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The first two\nfields are described in the hosts_access(5) manual page. The\nremainder of the rules is a list of zero or more options.\nAny &quot;:&quot; characters within options should be\nprotected with a backslash.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">An option is of\nthe form &quot;keyword&quot; or &quot;keyword value&quot;.\nOptions are processed in the specified order. Some options\nare subjected to %&lt;letter&gt; substitutions. For the sake\nof backwards compatibility with earlier versions, an\n&quot;=&quot; is permitted between keyword and value.</p>\n\n<h2>LOGGING\n<a name=\"LOGGING\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">severity\nmail.info <br>\nseverity notice</p>\n\n<p style=\"margin-left:22%;\">Change the severity level at\nwhich the event will be logged. Facility names (such as\nmail) are optional, and are not supported on systems with\nolder syslog implementations. The severity option can be\nused to emphasize or to ignore specific events.</p>\n\n<h2>ACCESS CONTROL\n<a name=\"ACCESS CONTROL\"></a>\n</h2>\n\n\n<table width=\"100%\" border=\"0\" rules=\"none\" frame=\"void\"\n       cellspacing=\"0\" cellpadding=\"0\">\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p style=\"margin-top: 1em\">allow</p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n</td></tr>\n<tr valign=\"top\" align=\"left\">\n<td width=\"11%\"></td>\n<td width=\"7%\">\n\n\n<p>deny</p></td>\n<td width=\"4%\"></td>\n<td width=\"78%\">\n\n\n<p>Grant (deny) service. These options must appear at the\nend of a rule.</p></td></tr>\n</table>\n\n<p style=\"margin-left:11%; margin-top: 1em\">The\n<i>allow</i> and <i>deny</i> keywords make it possible to\nkeep all access control rules within a single file, for\nexample in the <i>hosts.allow</i> file.</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To permit\naccess from specific hosts only:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">ALL:\n.friendly.domain: ALLOW <br>\nALL: ALL: DENY</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">To permit\naccess from all hosts except a few trouble makers:</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">ALL:\n.bad.domain: DENY <br>\nALL: ALL: ALLOW</p>\n\n<p style=\"margin-left:11%; margin-top: 1em\">Notice the\nleading dot on the domain name patterns.</p>\n\n<h2>RUNNING OTHER COMMANDS\n<a name=\"RUNNING OTHER COMMANDS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">aclexec\nshell_command</p>\n\n<p style=\"margin-left:22%;\">Execute, in a child process,\nthe specified shell command, after performing the\n%&lt;letter&gt; expansions described in the hosts_access(5)\nmanual page. The command is executed with stdin, stdout and\nstderr connected to the null device, so that it won&rsquo;t\nmess up the conversation with the client host. Example:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">smtp : ALL :\naclexec checkdnsbl %a</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">executes, in a\nbackground child process, the shell command &quot;checkdnsbl\n%a&quot; after replacing %a by the address of the remote\nhost.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">The connection\nwill be allowed or refused depending on whether the command\nreturns a true or false exit status.</p>\n\n<p style=\"margin-left:11%;\">spawn shell_command</p>\n\n<p style=\"margin-left:22%;\">Execute, in a child process,\nthe specified shell command, after performing the\n%&lt;letter&gt; expansions described in the hosts_access(5)\nmanual page. The command is executed with stdin, stdout and\nstderr connected to the null device, so that it won&rsquo;t\nmess up the conversation with the client host. Example:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">spawn\n(/usr/sbin/safe_finger -l @%h | /usr/bin/mail root)\n&amp;</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">executes, in a\nbackground child process, the shell command\n&quot;safe_finger -l @%h | mail root&quot; after replacing\n%h by the name or address of the remote host.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">The example\nuses the &quot;safe_finger&quot; command instead of the\nregular &quot;finger&quot; command, to limit possible damage\nfrom data sent by the finger server. The\n&quot;safe_finger&quot; command is part of the daemon\nwrapper package; it is a wrapper around the regular finger\ncommand that filters the data sent by the remote host.</p>\n\n<p style=\"margin-left:11%;\">twist shell_command</p>\n\n<p style=\"margin-left:22%;\">Replace the current process by\nan instance of the specified shell command, after performing\nthe %&lt;letter&gt; expansions described in the\nhosts_access(5) manual page. Stdin, stdout and stderr are\nconnected to the client process. This option must appear at\nthe end of a rule.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">To send a\ncustomized bounce message to the client instead of running\nthe real ftp daemon:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">in.ftpd : ... :\ntwist /bin/echo 421 Some bounce message</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">For an\nalternative way to talk to client processes, see the\n<i>banners</i> option below.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">To run\n/some/other/in.telnetd without polluting its command-line\narray or its process environment:</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">in.telnetd :\n... : twist PATH=/some/other; exec in.telnetd</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Warning: in\ncase of UDP services, do not twist to commands that use the\nstandard I/O or the read(2)/write(2) routines to communicate\nwith the client process; UDP requires other I/O\nprimitives.</p>\n\n<h2>NETWORK OPTIONS\n<a name=\"NETWORK OPTIONS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">keepalive</p>\n\n<p style=\"margin-left:22%;\">Causes the server to\nperiodically send a message to the client. The connection is\nconsidered broken when the client does not respond. The\nkeepalive option can be useful when users turn off their\nmachine while it is still connected to a server. The\nkeepalive option is not useful for datagram (UDP)\nservices.</p>\n\n<p style=\"margin-left:11%;\">linger number_of_seconds</p>\n\n<p style=\"margin-left:22%;\">Specifies how long the kernel\nwill try to deliver not-yet delivered data after the server\nprocess closes a connection.</p>\n\n<h2>USERNAME LOOKUP\n<a name=\"USERNAME LOOKUP\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">rfc931 [\ntimeout_in_seconds ]</p>\n\n<p style=\"margin-left:22%;\">Look up the client user name\nwith the RFC 931 (TAP, IDENT, RFC 1413) protocol. This\noption is silently ignored in case of services based on\ntransports other than TCP. It requires that the client\nsystem runs an RFC 931 (IDENT, etc.) -compliant daemon, and\nmay cause noticeable delays with connections from non-UNIX\nclients. The timeout period is optional. If no timeout is\nspecified a compile-time defined default value is taken.</p>\n\n<h2>MISCELLANEOUS\n<a name=\"MISCELLANEOUS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">banners\n/some/directory</p>\n\n<p style=\"margin-left:22%;\">Look for a file in\n&rsquo;/some/directory&acute; with the same name as the\ndaemon process (for example in.telnetd for the telnet\nservice), and copy its contents to the client. Newline\ncharacters are replaced by carriage-return newline, and\n%&lt;letter&gt; sequences are expanded (see the\nhosts_access(5) manual page).</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">The tcp\nwrappers source code distribution provides a sample makefile\n(Banners.Makefile) for convenient banner maintenance.</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Warning:\nbanners are supported for connection-oriented (TCP) network\nservices only.</p>\n\n<p style=\"margin-left:11%;\">nice [ number ]</p>\n\n<p style=\"margin-left:22%;\">Change the nice value of the\nprocess (default 10). Specify a positive value to spend more\nCPU resources on other processes.</p>\n\n<p style=\"margin-left:11%;\">setenv name value</p>\n\n<p style=\"margin-left:22%;\">Place a (name, value) pair into\nthe process environment. The value is subjected to\n%&lt;letter&gt; expansions and may contain whitespace (but\nleading and trailing blanks are stripped off).</p>\n\n<p style=\"margin-left:22%; margin-top: 1em\">Warning: many\nnetwork daemons reset their environment before spawning a\nlogin or shell process.</p>\n\n<p style=\"margin-left:11%;\">umask 022</p>\n\n<p style=\"margin-left:22%;\">Like the umask command that is\nbuilt into the shell. An umask of 022 prevents the creation\nof files with group and world write permission. The umask\nargument should be an octal number.</p>\n\n<p style=\"margin-left:11%;\">user nobody <br>\nuser nobody.kmem</p>\n\n<p style=\"margin-left:22%;\">Assume the privileges of the\n&quot;nobody&quot; userid (or user &quot;nobody&quot;, group\n&quot;kmem&quot;). The first form is useful with inetd\nimplementations that run all services with root privilege.\nThe second form is useful for services that need special\ngroup privileges only.</p>\n\n<h2>DIAGNOSTICS\n<a name=\"DIAGNOSTICS\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">When a syntax\nerror is found in an access control rule, the error is\nreported to the syslog daemon; further options will be\nignored, and service is denied.</p>\n\n<h2>SEE ALSO\n<a name=\"SEE ALSO\"></a>\n</h2>\n\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">hosts_access(5),\nthe default access control language</p>\n\n<h2>AUTHOR\n<a name=\"AUTHOR\"></a>\n</h2>\n\n\n<p style=\"margin-left:11%; margin-top: 1em\">Wietse Venema\n(wietse@wzv.win.tue.nl) <br>\nDepartment of Mathematics and Computing Science <br>\nEindhoven University of Technology <br>\nDen Dolech 2, P.O. Box 513, <br>\n5600 MB Eindhoven, The Netherlands</p>\n<hr>\n","headings":["<a href=\"#NAME\">NAME</a>","<a href=\"#DESCRIPTION\">DESCRIPTION</a>","<a href=\"#LOGGING\">LOGGING</a>","<a href=\"#ACCESS CONTROL\">ACCESS CONTROL</a>","<a href=\"#RUNNING OTHER COMMANDS\">RUNNING OTHER COMMANDS</a>","<a href=\"#NETWORK OPTIONS\">NETWORK OPTIONS</a>","<a href=\"#USERNAME LOOKUP\">USERNAME LOOKUP</a>","<a href=\"#MISCELLANEOUS\">MISCELLANEOUS</a>","<a href=\"#DIAGNOSTICS\">DIAGNOSTICS</a>","<a href=\"#SEE ALSO\">SEE ALSO</a>","<a href=\"#AUTHOR\">AUTHOR</a>"],"level":5}