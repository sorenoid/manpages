<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:40:23 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>EVP_PKEY-RSA</title>

</head>
<body>

<h1 align="center">EVP_PKEY-RSA</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFORMING TO">CONFORMING TO</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">EVP_PKEY-RSA,
EVP_KEYMGMT-RSA, RSA - EVP_PKEY RSA keytype and algorithm
support</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b><small>RSA</small></b> keytype is implemented in
OpenSSL&rsquo;s default and <small>FIPS</small> providers.
That implementation supports the basic <small>RSA</small>
keys, containing the modulus <i>n</i>, the public exponent
<i>e</i>, the private exponent <i>d</i>, and a collection of
prime factors, exponents and coefficient for
<small>CRT</small> calculations, of which the first few are
known as <i>p</i> and <i>q</i>, <i>dP</i> and <i>dQ</i>, and
<i>qInv</i>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Common
<small>RSA</small> parameters</b> <br>
In addition to the common parameters that all keytypes
should support (see &quot;Common parameters&quot; in
<b>provider-keymgmt</b>(7)), the <b><small>RSA</small></b>
keytype implementation supports the following. <br>
&quot;n&quot; ( <b><small>OSSL_PKEY_PARAM_RSA_N</small></b>
) &lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">The <small>RSA</small>
&quot;n&quot; value.</p>

<p style="margin-left:11%;">&quot;e&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_E</small></b> ) &lt;unsigned
integer&gt;</p>

<p style="margin-left:17%;">The <small>RSA</small>
&quot;e&quot; value.</p>

<p style="margin-left:11%;">&quot;d&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_D</small></b> ) &lt;unsigned
integer&gt;</p>

<p style="margin-left:17%;">The <small>RSA</small>
&quot;d&quot; value.</p>

<p style="margin-left:11%;">&quot;rsa-factor1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR2</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor3&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR3</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor4&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR4</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor5&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR5</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor6&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR6</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor7&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR7</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor8&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR8</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor9&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR9</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-factor10&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_FACTOR10</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;"><small>RSA</small> prime
factors. The factors are known as &quot;p&quot;,
&quot;q&quot; and &quot;r_i&quot; in <small>RFC8017.</small>
Up to eight additional &quot;r_i&quot; prime factors are
supported.</p>

<p style="margin-left:11%;">&quot;rsa-exponent1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT2</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent3&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT3</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent4&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT4</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent5&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT5</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent6&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT6</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent7&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT7</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent8&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT8</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent9&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT9</small></b> )
&lt;unsigned integer&gt; <br>
&quot;rsa-exponent10&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_EXPONENT10</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;"><small>RSA CRT</small> (Chinese
Remainder Theorem) exponents. The exponents are known as
&quot;dP&quot;, &quot;dQ&quot; and &quot;d_i in
<small>RFC8017&quot;.</small> Up to eight additional
&quot;d_i&quot; exponents are supported.</p>

<p style="margin-left:11%;">&quot;rsa-coefficient1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT1</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT2</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient3&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT3</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient4&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT4</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient5&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT5</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient6&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT6</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient7&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT7</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient8&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT8</small></b> )
&lt;unsigned <br>
integer&gt; <br>
&quot;rsa-coefficient9&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_COEFFICIENT9</small></b> )
&lt;unsigned <br>
integer&gt;</p>

<p style="margin-left:17%;"><small>RSA CRT</small> (Chinese
Remainder Theorem) coefficients. The coefficients are known
as &quot;qInv&quot; and &quot;t_i&quot;. Up to eight
additional &quot;t_i&quot; exponents are supported.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>RSA</small>
key generation parameters</b> <br>
When generating <small>RSA</small> keys, the following key
generation parameters may be used. <br>
&quot;bits&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_BITS</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">The value should be the
cryptographic length for the <b><small>RSA</small></b>
cryptosystem, in bits.</p>

<p style="margin-left:11%;">&quot;primes&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_PRIMES</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">The value should be the number
of primes for the generated <b><small>RSA</small></b> key.
The default is 2. It isn&rsquo;t permitted to specify a
larger number of primes than 10. Additionally, the number of
primes is limited by the length of the key being generated
so the maximum number could be less. Some providers may only
support a value of 2.</p>

<p style="margin-left:11%;">&quot;e&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_E</small></b> ) &lt;unsigned
integer&gt;</p>

<p style="margin-left:17%;">The <small>RSA</small>
&quot;e&quot; value. The value may be any odd number greater
than or equal to 65537. The default value is 65537. For
legacy reasons a value of 3 is currently accepted but is
deprecated.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>RSA</small>
key generation parameters for <small>FIPS</small> module
testing</b> <br>
When generating <small>RSA</small> keys, the following
additional key generation parameters may be used for
algorithm testing purposes only. Do not use these to
generate <small>RSA</small> keys for a production
environment. <br>
&quot;xp&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP</small></b> )
&lt;unsigned integer&gt; <br>
&quot;xq&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">These 2 fields are normally
randomly generated and are used to generate &quot;p&quot;
and &quot;q&quot;.</p>

<p style="margin-left:11%;">&quot;xp1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;xp2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XP2</small></b> )
&lt;unsigned integer&gt; <br>
&quot;xq1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;xq2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_XQ2</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">These 4 fields are normally
randomly generated. The prime factors &quot;p1&quot;,
&quot;p2&quot;, &quot;q1&quot; and &quot;q2&quot; are
determined from these values.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>RSA</small>
key parameters for <small>FIPS</small> module testing</b>
<br>
The following intermediate values can be retrieved only if
the values specified in &quot; <small>RSA</small> key
generation parameters for <small>FIPS</small> module
testing&quot; are set. These should not be accessed in a
production environment. <br>
&quot;p1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_P1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;p2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_P2</small></b> )
&lt;unsigned integer&gt; <br>
&quot;q1&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_Q1</small></b> )
&lt;unsigned integer&gt; <br>
&quot;q2&quot; (
<b><small>OSSL_PKEY_PARAM_RSA_TEST_Q2</small></b> )
&lt;unsigned integer&gt;</p>

<p style="margin-left:17%;">The auxiliary probable
primes.</p>

<h2>CONFORMING TO
<a name="CONFORMING TO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><small>FIPS186-4</small></p>

<p style="margin-left:17%;">Section B.3.6 Generation of
Probable Primes with Conditions Based on Auxiliary Probable
Primes</p>

<p style="margin-left:11%;"><small>RFC 8017,</small>
excluding RSA-PSS and RSA-OAEP</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">An
<b><small>EVP_PKEY</small></b> context can be obtained by
calling:</p>

<p style="margin-left:11%; margin-top: 1em">EVP_PKEY_CTX
*pctx = <br>
EVP_PKEY_CTX_new_from_name(NULL, &quot;RSA&quot;, NULL);</p>

<p style="margin-left:11%; margin-top: 1em">An
<b><small>RSA</small></b> key can be generated simply like
this:</p>

<p style="margin-left:11%; margin-top: 1em">pkey =
EVP_RSA_gen(4096);</p>

<p style="margin-left:11%; margin-top: 1em">or like
this:</p>

<p style="margin-left:11%; margin-top: 1em">EVP_PKEY *pkey
= NULL; <br>
EVP_PKEY_CTX *pctx = <br>
EVP_PKEY_CTX_new_from_name(NULL, &quot;RSA&quot;, NULL);
<br>
EVP_PKEY_keygen_init(pctx); <br>
EVP_PKEY_generate(pctx, &amp;pkey); <br>
EVP_PKEY_CTX_free(pctx);</p>

<p style="margin-left:11%; margin-top: 1em">An
<b><small>RSA</small></b> key can be generated with key
generation parameters:</p>

<p style="margin-left:11%; margin-top: 1em">unsigned int
primes = 3; <br>
unsigned int bits = 4096; <br>
OSSL_PARAM params[3]; <br>
EVP_PKEY *pkey = NULL; <br>
EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_from_name(NULL,
&quot;RSA&quot;, NULL); <br>
EVP_PKEY_keygen_init(pctx); <br>
params[0] = OSSL_PARAM_construct_uint(&quot;bits&quot;,
&amp;bits); <br>
params[1] = OSSL_PARAM_construct_uint(&quot;primes&quot;,
&amp;primes); <br>
params[2] = OSSL_PARAM_construct_end(); <br>
EVP_PKEY_CTX_set_params(pctx, params); <br>
EVP_PKEY_generate(pctx, &amp;pkey); <br>
EVP_PKEY_print_private(bio_out, pkey, 0, NULL); <br>
EVP_PKEY_CTX_free(pctx);</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>EVP_RSA_gen</b>(3),
<b><small>EVP_KEYMGMT</small></b> (3),
<b><small>EVP_PKEY</small></b> (3),
<b>provider-keymgmt</b>(7)</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
2020-2021 The OpenSSL Project Authors. All Rights
Reserved.</p>

<p style="margin-left:11%; margin-top: 1em">Licensed under
the Apache License 2.0 (the &quot;License&quot;). You may
not use this file except in compliance with the License. You
can obtain a copy in the file <small>LICENSE</small> in the
source distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr>
</body>
</html>
