<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:40:24 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SYMLINK</title>

</head>
<body>

<h1 align="center">SYMLINK</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COLOPHON">COLOPHON</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">symlink -
symbolic link handling</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Symbolic links
are files that act as pointers to other files. To understand
their behavior, you must first understand how hard links
work.</p>

<p style="margin-left:11%; margin-top: 1em">A hard link to
a file is indistinguishable from the original file because
it is a reference to the object underlying the original
filename. (To be precise: each of the hard links to a file
is a reference to the same <i>inode number</i>, where an
inode number is an index into the inode table, which
contains metadata about all files on a filesystem. See
<a href="https://man.page/2/stat">stat(2)</a>.) Changes to a file are independent of the
name used to reference the file. Hard links may not refer to
directories (to prevent the possibility of loops within the
filesystem tree, which would confuse many programs) and may
not refer to files on different filesystems (because inode
numbers are not unique across filesystems).</p>

<p style="margin-left:11%; margin-top: 1em">A symbolic link
is a special type of file whose contents are a string that
is the pathname of another file, the file to which the link
refers. (The contents of a symbolic link can be read using
<a href="https://man.page/2/readlink">readlink(2)</a>.) In other words, a symbolic link is a
pointer to another name, and not to an underlying object.
For this reason, symbolic links may refer to directories and
may cross filesystem boundaries.</p>

<p style="margin-left:11%; margin-top: 1em">There is no
requirement that the pathname referred to by a symbolic link
should exist. A symbolic link that refers to a pathname that
does not exist is said to be a <i>dangling link</i>.</p>

<p style="margin-left:11%; margin-top: 1em">Because a
symbolic link and its referenced object coexist in the
filesystem name space, confusion can arise in distinguishing
between the link itself and the referenced object. On
historical systems, commands and system calls adopted their
own link-following conventions in a somewhat ad-hoc fashion.
Rules for a more uniform approach, as they are implemented
on Linux and other systems, are outlined here. It is
important that site-local applications also conform to these
rules, so that the user interface can be as consistent as
possible.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Magic
links</b> <br>
There is a special class of symbolic-link-like objects known
as &quot;magic links&quot;, which can be found in certain
pseudofilesystems such as <a href="https://man.page/5/proc">proc(5)</a> (examples include
<i>/proc/[pid]/exe</i> and <i>/proc/[pid]/fd/*</i>). Unlike
normal symbolic links, magic links are not resolved through
pathname-expansion, but instead act as direct references to
the kernel&rsquo;s own representation of a file handle. As
such, these magic links allow users to access files which
cannot be referenced with normal paths (such as unlinked
files still referenced by a running program ).</p>

<p style="margin-left:11%; margin-top: 1em">Because they
can bypass ordinary <a href="https://man.page/7/mount_namespaces">mount_namespaces(7)</a>-based
restrictions, magic links have been used as attack vectors
in various exploits.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Symbolic
link ownership, permissions, and timestamps</b> <br>
The owner and group of an existing symbolic link can be
changed using <a href="https://man.page/2/lchown">lchown(2)</a>. The only time that the
ownership of a symbolic link matters is when the link is
being removed or renamed in a directory that has the sticky
bit set (see <a href="https://man.page/2/stat">stat(2)</a>).</p>

<p style="margin-left:11%; margin-top: 1em">The last access
and last modification timestamps of a symbolic link can be
changed using <a href="https://man.page/2/utimensat">utimensat(2)</a> or <a href="https://man.page/3/lutimes">lutimes(3)</a>.</p>

<p style="margin-left:11%; margin-top: 1em">On Linux, the
permissions of an ordinary symbolic link are not used in any
operations; the permissions are always 0777 (read, write,
and execute for all user categories), and can&rsquo;t be
changed.</p>

<p style="margin-left:11%; margin-top: 1em">However, magic
links do not follow this rule. They can have a non-0777
mode, though this mode is not currently used in any
permission checks.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Obtaining a
file descriptor that refers to a symbolic link</b> <br>
Using the combination of the <b>O_PATH</b> and
<b>O_NOFOLLOW</b> flags to <a href="https://man.page/2/open">open(2)</a> yields a file
descriptor that can be passed as the <i>dirfd</i> argument
in system calls such as <a href="https://man.page/2/fstatat">fstatat(2)</a>,
<a href="https://man.page/2/fchownat">fchownat(2)</a>, <a href="https://man.page/2/fchmodat">fchmodat(2)</a>, <a href="https://man.page/2/linkat">linkat(2)</a>,
and <a href="https://man.page/2/readlinkat">readlinkat(2)</a>, in order to operate on the
symbolic link itself (rather than the file to which it
refers).</p>

<p style="margin-left:11%; margin-top: 1em">By default
(i.e., if the <b>AT_SYMLINK_FOLLOW</b> flag is not
specified), if <a href="https://man.page/2/name_to_handle_at">name_to_handle_at(2)</a> is applied to a
symbolic link, it yields a handle for the symbolic link
(rather than the file to which it refers). One can then
obtain a file descriptor for the symbolic link (rather than
the file to which it refers) by specifying the <b>O_PATH</b>
flag in a subsequent call to <a href="https://man.page/2/open_by_handle_at">open_by_handle_at(2)</a>.
Again, that file descriptor can be used in the
aforementioned system calls to operate on the symbolic link
itself.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Handling of
symbolic links by system calls and commands</b> <br>
Symbolic links are handled either by operating on the link
itself, or by operating on the object referred to by the
link. In the latter case, an application or system call is
said to <i>follow</i> the link. Symbolic links may refer to
other symbolic links, in which case the links are
dereferenced until an object that is not a symbolic link is
found, a symbolic link that refers to a file which does not
exist is found, or a loop is detected. (Loop detection is
done by placing an upper limit on the number of links that
may be followed, and an error results if this limit is
exceeded.)</p>

<p style="margin-left:11%; margin-top: 1em">There are three
separate areas that need to be discussed. They are as
follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>1.</p></td>
<td width="1%"></td>
<td width="85%">


<p>Symbolic links used as filename arguments for system
calls.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="1%"></td>
<td width="85%">


<p>Symbolic links specified as command-line arguments to
utilities that are not traversing a file tree.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>3.</p></td>
<td width="1%"></td>
<td width="85%">


<p>Symbolic links encountered by utilities that are
traversing a file tree (either specified on the command line
or encountered as part of the file hierarchy walk).</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Before
describing the treatment of symbolic links by system calls
and commands, we require some terminology. Given a pathname
of the form <i>a/b/c</i>, the part preceding the final slash
(i.e., <i>a/b</i>) is called the <i>dirname</i> component,
and the part following the final slash (i.e., <i>c</i>) is
called the <i>basename</i> component.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Treatment of
symbolic links in system calls</b> <br>
The first area is symbolic links used as filename arguments
for system calls.</p>

<p style="margin-left:11%; margin-top: 1em">The treatment
of symbolic links within a pathname passed to a system call
is as follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em">1.</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">Within the dirname component of
a pathname, symbolic links are always followed in nearly
every system call. (This is also true for commands.) The one
exception is <a href="https://man.page/2/openat2">openat2(2)</a>, which provides flags that
can be used to explicitly prevent following of symbolic
links in the dirname component.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="1%"></td>
<td width="85%">


<p>Except as noted below, all system calls follow symbolic
links in the basename component of a pathname. For example,
if there were a symbolic link <i>slink</i> which pointed to
a file named <i>afile</i>, the system call
<i>open(&quot;slink&quot; ...)</i> would return a file
descriptor referring to the file <i>afile</i>.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Various system
calls do not follow links in the basename component of a
pathname, and operate on the symbolic link itself. They are:
<a href="https://man.page/2/lchown">lchown(2)</a>, <a href="https://man.page/2/lgetxattr">lgetxattr(2)</a>, <a href="https://man.page/2/llistxattr">llistxattr(2)</a>,
<a href="https://man.page/2/lremovexattr">lremovexattr(2)</a>, <a href="https://man.page/2/lsetxattr">lsetxattr(2)</a>,
<a href="https://man.page/2/lstat">lstat(2)</a>, <a href="https://man.page/2/readlink">readlink(2)</a>, <a href="https://man.page/2/rename">rename(2)</a>,
<a href="https://man.page/2/rmdir">rmdir(2)</a>, and <a href="https://man.page/2/unlink">unlink(2)</a>.</p>

<p style="margin-left:11%; margin-top: 1em">Certain other
system calls optionally follow symbolic links in the
basename component of a pathname. They are:
<a href="https://man.page/2/faccessat">faccessat(2)</a>, <a href="https://man.page/2/fchownat">fchownat(2)</a>, <a href="https://man.page/2/fstatat">fstatat(2)</a>,
<a href="https://man.page/2/linkat">linkat(2)</a>, <a href="https://man.page/2/name_to_handle_at">name_to_handle_at(2)</a>,
<a href="https://man.page/2/open">open(2)</a>, <a href="https://man.page/2/openat">openat(2)</a>,
<a href="https://man.page/2/open_by_handle_at">open_by_handle_at(2)</a>, and <a href="https://man.page/2/utimensat">utimensat(2)</a>; see
their manual pages for details. Because <a href="https://man.page/3/remove">remove(3)</a> is
an alias for <a href="https://man.page/2/unlink">unlink(2)</a>, that library function also
does not follow symbolic links. When <a href="https://man.page/2/rmdir">rmdir(2)</a> is
applied to a symbolic link, it fails with the error
<b>ENOTDIR</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/2/link">link(2)</a>
warrants special discussion. POSIX.1-2001 specifies that
<a href="https://man.page/2/link">link(2)</a> should dereference <i>oldpath</i> if it is a
symbolic link. However, Linux does not do this. (By default,
Solaris is the same, but the POSIX.1-2001 specified behavior
can be obtained with suitable compiler options.)
POSIX.1-2008 changed the specification to allow either
behavior in an implementation.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Commands not
traversing a file tree</b> <br>
The second area is symbolic links, specified as command-line
filename arguments, to commands which are not traversing a
file tree.</p>

<p style="margin-left:11%; margin-top: 1em">Except as noted
below, commands follow symbolic links named as command-line
arguments. For example, if there were a symbolic link
<i>slink</i> which pointed to a file named <i>afile</i>, the
command <i>cat slink</i> would display the contents of the
file <i>afile</i>.</p>

<p style="margin-left:11%; margin-top: 1em">It is important
to realize that this rule includes commands which may
optionally traverse file trees; for example, the command
<i>chown file</i> is included in this rule, while the
command <i>chown&nbsp;-R file</i>, which performs a tree
traversal, is not. (The latter is described in the third
area, below.)</p>

<p style="margin-left:11%; margin-top: 1em">If it is
explicitly intended that the command operate on the symbolic
link instead of following the symbolic link&mdash;for
example, it is desired that <i>chown slink</i> change the
ownership of the file that <i>slink</i> is, whether it is a
symbolic link or not&mdash;then the <i>-h</i> option should
be used. In the above example, <i>chown root slink</i> would
change the ownership of the file referred to by
<i>slink</i>, while <i>chown&nbsp;-h root slink</i> would
change the ownership of <i>slink</i> itself.</p>

<p style="margin-left:11%; margin-top: 1em">There are some
exceptions to this rule:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">*</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">The <a href="https://man.page/1/mv">mv(1)</a> and
<a href="https://man.page/1/rm">rm(1)</a> commands do not follow symbolic links named as
arguments, but respectively attempt to rename and delete
them. (Note, if the symbolic link references a file via a
relative path, moving it to another directory may very well
cause it to stop working, since the path may no longer be
correct.)</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>*</p></td>
<td width="2%"></td>
<td width="86%">


<p>The <a href="https://man.page/1/ls">ls(1)</a> command is also an exception to this
rule. For compatibility with historic systems (when
<a href="https://man.page/1/ls">ls(1)</a> is not doing a tree walk&mdash;that is,
<i>-R</i> option is not specified), the <a href="https://man.page/1/ls">ls(1)</a> command
follows symbolic links named as arguments if the <i>-H</i>
or <i>-L</i> option is specified, or if the <i>-F</i>,
<i>-d</i>, or <i>-l</i> options are not specified. (The
<a href="https://man.page/1/ls">ls(1)</a> command is the only command where the <i>-H</i>
and <i>-L</i> options affect its behavior even though it is
not doing a walk of a file tree.)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>*</p></td>
<td width="2%"></td>
<td width="86%">


<p>The <a href="https://man.page/1/file">file(1)</a> command is also an exception to this
rule. The <a href="https://man.page/1/file">file(1)</a> command does not follow symbolic
links named as argument by default. The <a href="https://man.page/1/file">file(1)</a>
command does follow symbolic links named as argument if the
<i>-L</i> option is specified.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Commands
traversing a file tree</b> <br>
The following commands either optionally or always traverse
file trees: <a href="https://man.page/1/chgrp">chgrp(1)</a>, <a href="https://man.page/1/chmod">chmod(1)</a>,
<a href="https://man.page/1/chown">chown(1)</a>, <a href="https://man.page/1/cp">cp(1)</a>, <a href="https://man.page/1/du">du(1)</a>, <a href="https://man.page/1/find">find(1)</a>,
<a href="https://man.page/1/ls">ls(1)</a>, <a href="https://man.page/1/pax">pax(1)</a>, <a href="https://man.page/1/rm">rm(1)</a>, and
<a href="https://man.page/1/tar">tar(1)</a>.</p>

<p style="margin-left:11%; margin-top: 1em">It is important
to realize that the following rules apply equally to
symbolic links encountered during the file tree traversal
and symbolic links listed as command-line arguments.</p>

<p style="margin-left:11%; margin-top: 1em">The <i>first
rule</i> applies to symbolic links that reference files
other than directories. Operations that apply to symbolic
links are performed on the links themselves, but otherwise
the links are ignored.</p>

<p style="margin-left:11%; margin-top: 1em">The command
<i>rm&nbsp;-r slink directory</i> will remove <i>slink</i>,
as well as any symbolic links encountered in the tree
traversal of <i>directory</i>, because symbolic links may be
removed. In no case will <a href="https://man.page/1/rm">rm(1)</a> affect the file
referred to by <i>slink</i>.</p>

<p style="margin-left:11%; margin-top: 1em">The <i>second
rule</i> applies to symbolic links that refer to
directories. Symbolic links that refer to directories are
never followed by default. This is often referred to as a
&quot;physical&quot; walk, as opposed to a
&quot;logical&quot; walk (where symbolic links that refer to
directories are followed).</p>

<p style="margin-left:11%; margin-top: 1em">Certain
conventions are (should be) followed as consistently as
possible by commands that perform file tree walks:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">*</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">A command can be made to follow
any symbolic links named on the command line, regardless of
the type of file they reference, by specifying the <i>-H</i>
(for &quot;half-logical&quot;) flag. This flag is intended
to make the command-line name space look like the logical
name space. (Note, for commands that do not always do file
tree traversals, the <i>-H</i> flag will be ignored if the
<i>-R</i> flag is not also specified.)</p></td></tr>
</table>

<p style="margin-left:14%; margin-top: 1em">For example,
the command <i>chown&nbsp;-HR user slink</i> will traverse
the file hierarchy rooted in the file pointed to by
<i>slink</i>. Note, the <i>-H</i> is not the same as the
previously discussed <i>-h</i> flag. The <i>-H</i> flag
causes symbolic links specified on the command line to be
dereferenced for the purposes of both the action to be
performed and the tree walk, and it is as if the user had
specified the name of the file to which the symbolic link
pointed.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">*</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">A command can be made to follow
any symbolic links named on the command line, as well as any
symbolic links encountered during the traversal, regardless
of the type of file they reference, by specifying the
<i>-L</i> (for &quot;logical&quot;) flag. This flag is
intended to make the entire name space look like the logical
name space. (Note, for commands that do not always do file
tree traversals, the <i>-L</i> flag will be ignored if the
<i>-R</i> flag is not also specified.)</p></td></tr>
</table>

<p style="margin-left:14%; margin-top: 1em">For example,
the command <i>chown&nbsp;-LR user slink</i> will change the
owner of the file referred to by <i>slink</i>. If
<i>slink</i> refers to a directory, <b>chown</b> will
traverse the file hierarchy rooted in the directory that it
references. In addition, if any symbolic links are
encountered in any file tree that <b>chown</b> traverses,
they will be treated in the same fashion as
<i>slink</i>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">*</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">A command can be made to provide
the default behavior by specifying the <i>-P</i> (for
&quot;physical&quot;) flag. This flag is intended to make
the entire name space look like the physical name space.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">For commands
that do not by default do file tree traversals, the
<i>-H</i>, <i>-L</i>, and <i>-P</i> flags are ignored if the
<i>-R</i> flag is not also specified. In addition, you may
specify the <i>-H</i>, <i>-L</i>, and <i>-P</i> options more
than once; the last one specified determines the
command&rsquo;s behavior. This is intended to permit you to
alias commands to behave one way or the other, and then
override that behavior on the command line.</p>

<p style="margin-left:11%; margin-top: 1em">The
<a href="https://man.page/1/ls">ls(1)</a> and <a href="https://man.page/1/rm">rm(1)</a> commands have exceptions to
these rules:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">*</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">The <a href="https://man.page/1/rm">rm(1)</a> command
operates on the symbolic link, and not the file it
references, and therefore never follows a symbolic link. The
<a href="https://man.page/1/rm">rm(1)</a> command does not support the <i>-H</i>,
<i>-L</i>, or <i>-P</i> options.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>*</p></td>
<td width="2%"></td>
<td width="86%">


<p>To maintain compatibility with historic systems, the
<a href="https://man.page/1/ls">ls(1)</a> command acts a little differently. If you do
not specify the <i>-F</i>, <i>-d</i> or <i>-l</i> options,
<a href="https://man.page/1/ls">ls(1)</a> will follow symbolic links specified on the
command line. If the <i>-L</i> flag is specified,
<a href="https://man.page/1/ls">ls(1)</a> follows all symbolic links, regardless of their
type, whether specified on the command line or encountered
in the tree walk.</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/1/chgrp">chgrp(1)</a>,
<a href="https://man.page/1/chmod">chmod(1)</a>, <a href="https://man.page/1/find">find(1)</a>, <a href="https://man.page/1/ln">ln(1)</a>, <a href="https://man.page/1/ls">ls(1)</a>,
<a href="https://man.page/1/mv">mv(1)</a>, <a href="https://man.page/1/namei">namei(1)</a>, <a href="https://man.page/1/rm">rm(1)</a>,
<a href="https://man.page/2/lchown">lchown(2)</a>, <a href="https://man.page/2/link">link(2)</a>, <a href="https://man.page/2/lstat">lstat(2)</a>,
<a href="https://man.page/2/readlink">readlink(2)</a>, <a href="https://man.page/2/rename">rename(2)</a>, <a href="https://man.page/2/symlink">symlink(2)</a>,
<a href="https://man.page/2/unlink">unlink(2)</a>, <a href="https://man.page/2/utimensat">utimensat(2)</a>, <a href="https://man.page/3/lutimes">lutimes(3)</a>,
<a href="https://man.page/7/path_resolution">path_resolution(7)</a></p>

<h2>COLOPHON
<a name="COLOPHON"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This page is
part of release 5.10 of the Linux <i>man-pages</i> project.
A description of the project, information about reporting
bugs, and the latest version of this page, can be found at
https://www.kernel.org/doc/man-pages/.</p>
<hr>
</body>
</html>
