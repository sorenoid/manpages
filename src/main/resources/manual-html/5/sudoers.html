<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:39:16 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SUDOERS(5) BSD File Formats Manual SUDOERS(5)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>sudoers</b> &mdash; default
sudo security policy plugin</p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;">The <b>sudoers</b> policy plugin
determines a user&rsquo;s <b>sudo</b> privileges. It is the
default <b>sudo</b> policy plugin. The policy is driven by
the <i>/etc/sudoers</i> file or, optionally, in LDAP. The
policy format is described in detail in the <i>SUDOERS FILE
FORMAT</i> section. For information on storing
<b>sudoers</b> policy information in LDAP, please see
sudoers.ldap(5).</p>

<p style="margin-left:6%; margin-top: 1em"><b>Configuring
sudo.conf for sudoers <br>
sudo</b> consults the sudo.conf(5) file to determine which
plugins to load. If no sudo.conf(5) file is present, or if
it contains no Plugin lines, <b>sudoers</b> will be used for
auditing, policy decisions and I/O logging. To explicitly
configure sudo.conf(5) to use the <b>sudoers</b> plugin, the
following configuration can be used.</p>

<p style="margin-left:14%; margin-top: 1em">Plugin
sudoers_audit sudoers.so <br>
Plugin sudoers_policy sudoers.so <br>
Plugin sudoers_io sudoers.so</p>

<p style="margin-left:6%; margin-top: 1em">Starting with
<b>sudo</b> 1.8.5, it is possible to specify optional
arguments to the <b>sudoers</b> plugin in the sudo.conf(5)
file. Plugin arguments, if any, should be listed after the
path to the plugin (i.e., after <i>sudoers.so</i>). The
arguments are only effective for the plugin that opens (and
parses) the <i>sudoers</i> file.</p>

<p style="margin-left:6%; margin-top: 1em">For <b>sudo</b>
version 1.9.1 and higher, this is the <i>sudoers_audit</i>
plugin. For older versions, it is the <i>sudoers_policy</i>
plugin. Multiple arguments may be specified, separated by
white space. For example:</p>

<p style="margin-left:14%; margin-top: 1em">Plugin
sudoers_audit sudoers.so sudoers_mode=0400
error_recovery=false</p>

<p style="margin-left:6%; margin-top: 1em">The following
plugin arguments are supported:</p>

<p style="margin-top: 1em">error_recovery=bool</p>

<p style="margin-left:19%;">The <i>error_recovery</i>
argument can be used to control whether <b>sudoers</b>
should attempt to recover from syntax errors in the
<i>sudoers</i> file. If set to <i>true</i> (the default),
<b>sudoers</b> will try to recover from a syntax error by
discarding the portion of the line that contains the error
until the end of the line. A value of <i>false</i> will
disable error recovery. Prior to version 1.9.3, no error
recovery was performed.</p>

<p style="margin-top: 1em">ldap_conf=pathname</p>

<p style="margin-left:19%;">The <i>ldap_conf</i> argument
can be used to override the default path to the
<i>ldap.conf</i> file.</p>

<p style="margin-top: 1em">ldap_secret=pathname</p>

<p style="margin-left:19%;">The <i>ldap_secret</i> argument
can be used to override the default path to the
<i>ldap.secret</i> file.</p>

<p style="margin-top: 1em">sudoers_file=pathname</p>

<p style="margin-left:19%;">The <i>sudoers_file</i>
argument can be used to override the default path to the
<i>sudoers</i> file.</p>

<p style="margin-top: 1em">sudoers_uid=user-ID</p>

<p style="margin-left:19%;">The <i>sudoers_uid</i> argument
can be used to override the default owner of the sudoers
file. It should be specified as a numeric user-ID.</p>

<p style="margin-top: 1em">sudoers_gid=group-ID</p>

<p style="margin-left:19%;">The <i>sudoers_gid</i> argument
can be used to override the default group of the sudoers
file. It must be specified as a numeric group-ID (not a
group name).</p>

<p style="margin-top: 1em">sudoers_mode=mode</p>

<p style="margin-left:19%;">The <i>sudoers_mode</i>
argument can be used to override the default file mode for
the sudoers file. It should be specified as an octal
value.</p>

<p style="margin-left:6%; margin-top: 1em">For more
information on configuring sudo.conf(5), please refer to its
manual.</p>

<p style="margin-left:6%; margin-top: 1em"><b>User
Authentication</b> <br>
The <b>sudoers</b> security policy requires that most users
authenticate themselves before they can use <b>sudo</b>. A
password is not required if the invoking user is root, if
the target user is the same as the invoking user, or if the
policy has disabled authentication for the user or command.
Unlike su(1), when <b>sudoers</b> requires authentication,
it validates the invoking user&rsquo;s credentials, not the
target user&rsquo;s (or root&rsquo;s) credentials. This can
be changed via the <i>rootpw</i>, <i>targetpw</i> and
<i>runaspw</i> flags, described later.</p>

<p style="margin-left:6%; margin-top: 1em">If a user who is
not listed in the policy tries to run a command via
<b>sudo</b>, mail is sent to the proper authorities. The
address used for such mail is configurable via the
<i>mailto</i> Defaults entry (described later) and defaults
to root.</p>

<p style="margin-left:6%; margin-top: 1em">Note that no
mail will be sent if an unauthorized user tries to run
<b>sudo</b> with the <b>-l</b> or <b>-v</b> option unless
there is an authentication error and either the
<i>mail_always</i> or <i>mail_badpass</i> flags are enabled.
This allows users to determine for themselves whether or not
they are allowed to use <b>sudo</b>. By default, all
attempts to run <b>sudo</b> (successful or not) are logged,
regardless of whether or not mail is sent.</p>

<p style="margin-left:6%; margin-top: 1em">If <b>sudo</b>
is run by root and the SUDO_USER environment variable is
set, the <b>sudoers</b> policy will use this value to
determine who the actual user is. This can be used by a user
to log commands through sudo even when a root shell has been
invoked. It also allows the <b>-e</b> option to remain
useful even when invoked via a sudo-run script or program.
Note, however, that the <i>sudoers</i> file lookup is still
done for root, not the user specified by SUDO_USER.</p>

<p style="margin-left:6%; margin-top: 1em"><b>sudoers</b>
uses per-user time stamp files for credential caching. Once
a user has been authenticated, a record is written
containing the user-ID that was used to authenticate, the
terminal session ID, the start time of the session leader
(or parent process) and a time stamp (using a monotonic
clock if one is available). The user may then use
<b>sudo</b> without a password for a short period of time
(</p>

<p>15 minutes unless overridden by the
<i>timestamp_timeout</i> option ). By default,
<b>sudoers</b> uses a separate record for each terminal,
which means that a user&rsquo;s login sessions are
authenticated separately. The <i>timestamp_type</i> option
can be used to select the type of time stamp record
<b>sudoers</b> will use.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Logging</b>
<br>
By default, <b>sudoers</b> logs both successful and
unsuccessful attempts (as well as errors). The
<i>log_allowed</i> and <i>log_denied</i> flags can be used
to control this behavior. Messages can be logged to
syslog(3), a log file, or both. The default is to log to
syslog(3) but this is configurable via the <i>syslog</i> and
<i>logfile</i> settings. See <i>LOG FORMAT</i> for a
description of the log file format.</p>

<p style="margin-left:6%; margin-top: 1em"><b>sudoers</b>
is also capable of running a command in a pseudo-terminal
and logging all input and/or output. The standard input,
standard output, and standard error can be logged even when
not associated with a terminal. I/O logging is not on by
default but can be enabled using the <i>log_input</i> and
<i>log_output</i> options as well as the LOG_INPUT and
LOG_OUTPUT command tags. See <i>I/O LOG FILES</i> for
details on how I/O log files are stored.</p>

<p style="margin-left:6%; margin-top: 1em">Starting with
version 1.9, the <i>log_servers</i> setting may be used to
send event and I/O log data to a remote server running
<b>sudo_logsrvd</b> or another service that implements the
protocol described by sudo_logsrv.proto(5).</p>

<p style="margin-left:6%; margin-top: 1em"><b>Command
environment</b> <br>
Since environment variables can influence program behavior,
<b>sudoers</b> provides a means to restrict which variables
from the user&rsquo;s environment are inherited by the
command to be run. There are two distinct ways
<b>sudoers</b> can deal with environment variables.</p>

<p style="margin-left:6%; margin-top: 1em">By default, the
<i>env_reset</i> flag is enabled. This causes commands to be
executed with a new, minimal environment. On AIX (and Linux
systems without PAM), the environment is initialized with
the contents of the <i>/etc/environment</i> file. The HOME,
MAIL, SHELL, LOGNAME and USER environment variables are
initialized based on the target user and the SUDO_*
variables are set based on the invoking user. Additional
variables, such as DISPLAY, PATH and TERM, are preserved
from the invoking user&rsquo;s environment if permitted by
the <i>env_check</i>, or <i>env_keep</i> options. A few
environment variables are treated specially. If the PATH and
TERM variables are not preserved from the user&rsquo;s
environment, they will be set to default values. The LOGNAME
and USER are handled as a single entity. If one of them is
preserved (or removed) from the user&rsquo;s environment,
the other will be as well. If LOGNAME and USER are to be
preserved but only one of them is present in the
user&rsquo;s environment, the other will be set to the same
value. This avoids an inconsistent environment where one of
the variables describing the user name is set to the
invoking user and one is set to the target user. Environment
variables with a value beginning with () are removed unless
both the name and value parts are matched by <i>env_keep</i>
or <i>env_check</i>, as they may be interpreted as functions
by the <b>bash</b> shell. Prior to version 1.8.11, such
variables were always removed.</p>

<p style="margin-left:6%; margin-top: 1em">If, however, the
<i>env_reset</i> flag is disabled, any variables not
explicitly denied by the <i>env_check</i> and
<i>env_delete</i> options are allowed and their values are
inherited from the invoking process. Prior to version
1.8.21, environment variables with a value beginning with ()
were always removed. Beginning with version 1.8.21, a
pattern in <i>env_delete</i> is used to match <b>bash</b>
shell functions instead. Since it is not possible to block
all potentially dangerous environment variables, use of the
default <i>env_reset</i> behavior is encouraged.</p>

<p style="margin-left:6%; margin-top: 1em">Environment
variables specified by <i>env_check</i>, <i>env_delete</i>,
or <i>env_keep</i> may include one or more &rsquo;*&rsquo;
characters which will match zero or more characters. No
other wildcard characters are supported.</p>

<p style="margin-left:6%; margin-top: 1em">By default,
environment variables are matched by name. However, if the
pattern includes an equal sign (&rsquo;=&rsquo;), both the
variables name and value must match. For example, a
<b>bash</b> shell function could be matched as follows:</p>

<p style="margin-left:12%; margin-top: 1em">env_keep +=
&quot;BASH_FUNC_my_func%%=()*&quot;</p>

<p style="margin-left:6%; margin-top: 1em">Without the
&ldquo;=()*&rdquo; suffix, this would not match, as
<b>bash</b> shell functions are not preserved by
default.</p>

<p style="margin-left:6%; margin-top: 1em">The complete
list of environment variables that are preserved or removed,
as modified by global Defaults parameters in <i>sudoers</i>,
is displayed when <b>sudo</b> is run by root with the
<b>-V</b> option. Please note that the list of environment
variables to remove varies based on the operating system
<b>sudo</b> is running on.</p>

<p style="margin-left:6%; margin-top: 1em">Other
<b>sudoers</b> options may influence the command
environment, such as <i>always_set_home</i>,
<i>secure_path</i>, <i>set_logname</i>, and
<i>set_home</i>.</p>

<p style="margin-left:6%; margin-top: 1em">On systems that
support PAM where the <b>pam_env</b> module is enabled for
<b>sudo</b>, variables in the PAM environment may be merged
in to the environment. If a variable in the PAM environment
is already present in the user&rsquo;s environment, the
value will only be overridden if the variable was not
preserved by <b>sudoers</b>. When <i>env_reset</i> is
enabled, variables preserved from the invoking user&rsquo;s
environment by the <i>env_keep</i> list take precedence over
those in the PAM environment. When <i>env_reset</i> is
disabled, variables present the invoking user&rsquo;s
environment take precedence over those in the PAM
environment unless they match a pattern in the
<i>env_delete</i> list.</p>

<p style="margin-left:6%; margin-top: 1em">Note that the
dynamic linker on most operating systems will remove
variables that can control dynamic linking from the
environment of set-user-ID executables, including
<b>sudo</b>. Depending on the operating system this may
include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and
others. These type of variables are removed from the
environment before <b>sudo</b> even begins execution and, as
such, it is not possible for <b>sudo</b> to preserve
them.</p>

<p style="margin-left:6%; margin-top: 1em">As a special
case, if the <b>-i</b> option (initial login) is specified,
<b>sudoers</b> will initialize the environment regardless of
the value of <i>env_reset</i>. The DISPLAY, PATH and TERM
variables remain unchanged; HOME, MAIL, SHELL, USER, and
LOGNAME are set based on the target user. On AIX (and Linux
systems without PAM), the contents of
<i>/etc/environment</i> are also included. All other
environment variables are removed unless permitted by
<i>env_keep</i> or <i>env_check</i>, described above.</p>

<p style="margin-left:6%; margin-top: 1em">Finally, the
<i>restricted_env_file</i> and <i>env_file</i> files are
applied, if present. The variables in
<i>restricted_env_file</i> are applied first and are subject
to the same restrictions as the invoking user&rsquo;s
environment, as detailed above. The variables in
<i>env_file</i> are applied last and are not subject to
these restrictions. In both cases, variables present in the
files will only be set to their specified values if they
would not conflict with an existing environment
variable.</p>

<p style="margin-top: 1em"><b>SUDOERS FILE FORMAT</b></p>

<p style="margin-left:6%;">The <i>sudoers</i> file is
composed of two types of entries: aliases (basically
variables) and user specifications (which specify who may
run what).</p>

<p style="margin-left:6%; margin-top: 1em">When multiple
entries match for a user, they are applied in order. Where
there are multiple matches, the last match is used (which is
not necessarily the most specific match).</p>

<p style="margin-left:6%; margin-top: 1em">The
<i>sudoers</i> file grammar will be described below in
Extended Backus-Naur Form (EBNF). Don&rsquo;t despair if you
are unfamiliar with EBNF; it is fairly simple, and the
definitions below are annotated.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Resource
limits</b> <br>
By default, <b>sudoers</b> uses the operating system&rsquo;s
native method of setting resource limits for the target
user. On Linux systems, resource limits are usually set by
the pam_limits.so PAM module. On some BSD systems, the
<i>/etc/login.conf</i> file specifies resource limits for
the user. On AIX systems, resource limits are configured in
the <i>/etc/security/limits</i> file. If there is no system
mechanism to set per-user resource limits, the command will
run with the same limits as the invoking user. The one
exception to this is the core dump file size, which is set
by <b>sudoers</b> to 0 by default. Disabling core dumps by
default makes it possible to avoid potential security
problems where the core file is treated as trusted
input.</p>

<p style="margin-left:6%; margin-top: 1em">Resource limits
may also be set in the <i>sudoers</i> file itself, in which
case they override those set by the system. See the
<i>rlimit_as, rlimit_core, rlimit_cpu, rlimit_data,
rlimit_fsize, rlimit_locks, rlimit_memlock, rlimit_nofile,
rlimit_nproc, rlimit_rss, rlimit_stack</i> options described
below. Resource limits in <b>sudoers</b> may be specified in
one of the following formats:</p>

<p style="margin-top: 1em">&ldquo;value&rdquo;</p>

<p style="margin-left:17%;">Both the soft and hard resource
limits are set to the same value. The special value
&ldquo;infinity&rdquo; can be used to indicate that the
value is unlimited.</p>

<p style="margin-top: 1em">&ldquo;soft,hard&rdquo;</p>

<p style="margin-left:17%;">Two comma-separated values. The
soft limit is set to the first value and the hard limit is
set to the second. Both values must either be enclosed in a
set of double quotes, or the comma must be escaped with a
backslash (&rsquo;\&rsquo;). The special value
&ldquo;infinity&rdquo; may be used in place of either
value.</p>

<p style="margin-top: 1em">&ldquo;default&rdquo;</p>

<p style="margin-left:17%;">The default resource limit for
the user will be used. This may be a user-specific value
(see above) or the value of the resource limit when
<b>sudo</b> was invoked for systems that don&rsquo;t support
per-user limits.</p>

<p style="margin-top: 1em">&ldquo;user&rdquo;</p>

<p style="margin-left:17%; margin-top: 1em">The invoking
user&rsquo;s resource limits will be preserved when running
the command.</p>

<p style="margin-left:6%; margin-top: 1em">For example, to
restore the historic core dump file size behavior, a line
like the following may be used.</p>

<p style="margin-left:14%; margin-top: 1em">Defaults
rlimit_core=default</p>

<p style="margin-left:6%; margin-top: 1em">Resource limits
in <b>sudoers</b> are only supported by version 1.8.7 or
higher.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Quick guide
to EBNF</b> <br>
EBNF is a concise and exact way of describing the grammar of
a language. Each EBNF definition is made up of <i>production
rules</i>. E.g.,</p>

<p style="margin-left:6%; margin-top: 1em">symbol ::=
definition | alternate1 | alternate2 ...</p>

<p style="margin-left:6%; margin-top: 1em">Each
<i>production rule</i> references others and thus makes up a
grammar for the language. EBNF also contains the following
operators, which many readers will recognize from regular
expressions. Do not, however, confuse them with
&ldquo;wildcard&rdquo; characters, which have different
meanings.</p>

<p style="margin-top: 1em">?</p>

<p style="margin-left:14%; margin-top: 1em">Means that the
preceding symbol (or group of symbols) is optional. That is,
it may appear once or not at all.</p>

<p style="margin-top: 1em">*</p>

<p style="margin-left:14%; margin-top: 1em">Means that the
preceding symbol (or group of symbols) may appear zero or
more times.</p>

<p style="margin-top: 1em">+</p>

<p style="margin-left:14%; margin-top: 1em">Means that the
preceding symbol (or group of symbols) may appear one or
more times.</p>

<p style="margin-left:6%; margin-top: 1em">Parentheses may
be used to group symbols together. For clarity, we will use
single quotes (&rsquo;&rsquo;) to designate what is a
verbatim character string (as opposed to a symbol name).</p>

<p style="margin-left:6%; margin-top: 1em"><b>Aliases</b>
<br>
There are four kinds of aliases: User_Alias, Runas_Alias,
Host_Alias and Cmnd_Alias. Beginning with <b>sudo</b> 1.9.0,
Cmd_Alias may be used in place of Cmnd_Alias if desired.</p>

<p style="margin-left:6%; margin-top: 1em">Alias ::=
&rsquo;User_Alias&rsquo; User_Alias_Spec (&rsquo;:&rsquo;
User_Alias_Spec)* | <br>
&rsquo;Runas_Alias&rsquo; Runas_Alias_Spec (&rsquo;:&rsquo;
Runas_Alias_Spec)* | <br>
&rsquo;Host_Alias&rsquo; Host_Alias_Spec (&rsquo;:&rsquo;
Host_Alias_Spec)* | <br>
&rsquo;Cmnd_Alias&rsquo; Cmnd_Alias_Spec (&rsquo;:&rsquo;
Cmnd_Alias_Spec)* | <br>
&rsquo;Cmd_Alias&rsquo; Cmnd_Alias_Spec (&rsquo;:&rsquo;
Cmnd_Alias_Spec)*</p>

<p style="margin-left:6%; margin-top: 1em">User_Alias ::=
NAME</p>

<p style="margin-left:6%; margin-top: 1em">User_Alias_Spec
::= User_Alias &rsquo;=&rsquo; User_List</p>

<p style="margin-left:6%; margin-top: 1em">Runas_Alias ::=
NAME</p>


<p style="margin-left:6%; margin-top: 1em">Runas_Alias_Spec
::= Runas_Alias &rsquo;=&rsquo; Runas_List</p>

<p style="margin-left:6%; margin-top: 1em">Host_Alias ::=
NAME</p>

<p style="margin-left:6%; margin-top: 1em">Host_Alias_Spec
::= Host_Alias &rsquo;=&rsquo; Host_List</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd_Alias ::=
NAME</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd_Alias_Spec
::= Cmnd_Alias &rsquo;=&rsquo; Cmnd_List</p>

<p style="margin-left:6%; margin-top: 1em">NAME ::=
[A-Z]([A-Z][0-9]_)*</p>

<p style="margin-left:6%; margin-top: 1em">Each
<i>alias</i> definition is of the form</p>

<p style="margin-left:6%; margin-top: 1em">Alias_Type NAME
= item1, item2, ...</p>

<p style="margin-left:6%; margin-top: 1em">where
<i>Alias_Type</i> is one of User_Alias, Runas_Alias,
Host_Alias, or Cmnd_Alias. A NAME is a string of uppercase
letters, numbers, and underscore characters
(&rsquo;_&rsquo;). A NAME <b>must</b> start with an
uppercase letter. It is possible to put several alias
definitions of the same type on a single line, joined by a
colon (&rsquo;:&rsquo;). E.g.,</p>

<p style="margin-left:6%; margin-top: 1em">Alias_Type NAME
= item1, item2, item3 : NAME = item4, item5</p>

<p style="margin-left:6%; margin-top: 1em">It is a syntax
error to redefine an existing <i>alias</i>. It is possible
to use the same name for <i>aliases</i> of different types,
but this is not recommended.</p>

<p style="margin-left:6%; margin-top: 1em">The definitions
of what constitutes a valid <i>alias</i> member follow.</p>

<p style="margin-left:6%; margin-top: 1em">User_List ::=
User | <br>
User &rsquo;,&rsquo; User_List</p>

<p style="margin-left:6%; margin-top: 1em">User ::=
&rsquo;!&rsquo;* user name | <br>
&rsquo;!&rsquo;* #user-ID | <br>
&rsquo;!&rsquo;* %group | <br>
&rsquo;!&rsquo;* %#group-ID | <br>
&rsquo;!&rsquo;* +netgroup | <br>
&rsquo;!&rsquo;* %:nonunix_group | <br>
&rsquo;!&rsquo;* %:#nonunix_gid | <br>
&rsquo;!&rsquo;* User_Alias</p>

<p style="margin-left:6%; margin-top: 1em">A User_List is
made up of one or more user names, user-IDs (prefixed with
&rsquo;#&rsquo;), system group names and IDs (prefixed with
&rsquo;%&rsquo; and &rsquo;%#&rsquo; respectively),
netgroups (prefixed with &rsquo;+&rsquo;), non-Unix group
names and IDs (prefixed with &rsquo;%:&rsquo; and
&rsquo;%:#&rsquo; respectively), and User_Aliases. Each list
item may be prefixed with zero or more &rsquo;!&rsquo;
operators. An odd number of &rsquo;!&rsquo; operators negate
the value of the item; an even number just cancel each other
out. User netgroups are matched using the user and domain
members only; the host member is not used when matching.</p>

<p style="margin-left:6%; margin-top: 1em">A user name,
user-ID, group, group-ID, netgroup, nonunix_group or
nonunix_gid may be enclosed in double quotes to avoid the
need for escaping special characters. Alternately, special
characters may be specified in escaped hex mode, e.g., \x20
for space. When using double quotes, any prefix characters
must be included inside the quotes.</p>

<p style="margin-left:6%; margin-top: 1em">The actual
nonunix_group and nonunix_gid syntax depends on the
underlying group provider plugin. For instance, the QAS AD
plugin supports the following formats:</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">Group in the same domain:
&quot;%:Group Name&quot;</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">Group in any domain:
&quot;%:Group Name@FULLY.QUALIFIED.DOMAIN&quot;</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">Group SID:
&quot;%:S-1-2-34-5678901234-5678901234-5678901234-567&quot;</p>

<p style="margin-left:6%; margin-top: 1em">See <i>GROUP
PROVIDER PLUGINS</i> for more information.</p>

<p style="margin-left:6%; margin-top: 1em">Note that quotes
around group names are optional. Unquoted strings must use a
backslash (&rsquo;\&rsquo;) to escape spaces and special
characters. See <i>Other special characters and reserved
words</i> for a list of characters that need to be
escaped.</p>

<p style="margin-left:6%; margin-top: 1em">Runas_List ::=
Runas_Member | <br>
Runas_Member &rsquo;,&rsquo; Runas_List</p>

<p style="margin-left:6%; margin-top: 1em">Runas_Member ::=
&rsquo;!&rsquo;* user name | <br>
&rsquo;!&rsquo;* #user-ID | <br>
&rsquo;!&rsquo;* %group | <br>
&rsquo;!&rsquo;* %#group-ID | <br>
&rsquo;!&rsquo;* %:nonunix_group | <br>
&rsquo;!&rsquo;* %:#nonunix_gid | <br>
&rsquo;!&rsquo;* +netgroup | <br>
&rsquo;!&rsquo;* Runas_Alias</p>

<p style="margin-left:6%; margin-top: 1em">A Runas_List is
similar to a User_List except that instead of User_Aliases
it can contain Runas_Aliases. Note that user names and
groups are matched as strings. In other words, two users
(groups) with the same user (group) ID are considered to be
distinct. If you wish to match all user names with the same
user-ID (e.g., root and toor), you can use a user-ID instead
of a name (#0 in the example given). Note that the user-ID
or group-ID specified in a Runas_Member need not be listed
in the password or group database.</p>

<p style="margin-left:6%; margin-top: 1em">Host_List ::=
Host | <br>
Host &rsquo;,&rsquo; Host_List</p>

<p style="margin-left:6%; margin-top: 1em">Host ::=
&rsquo;!&rsquo;* host name | <br>
&rsquo;!&rsquo;* ip_addr | <br>
&rsquo;!&rsquo;* network(/netmask)? | <br>
&rsquo;!&rsquo;* +netgroup | <br>
&rsquo;!&rsquo;* Host_Alias</p>

<p style="margin-left:6%; margin-top: 1em">A Host_List is
made up of one or more host names, IP addresses, network
numbers, netgroups (prefixed with &rsquo;+&rsquo;), and
other aliases. Again, the value of an item may be negated
with the &rsquo;!&rsquo; operator. Host netgroups are
matched using the host (both qualified and unqualified) and
domain members only; the user member is not used when
matching. If you specify a network number without a netmask,
<b>sudo</b> will query each of the local host&rsquo;s
network interfaces and, if the network number corresponds to
one of the hosts&rsquo;s network interfaces, will use the
netmask of that interface. The netmask may be specified
either in standard IP address notation (e.g., 255.255.255.0
or ffff:ffff:ffff:ffff::), or CIDR notation (number of bits,
e.g., 24 or 64). A host name may include shell-style
wildcards (see the <i>Wildcards</i> section below), but
unless the host name command on your machine returns the
fully qualified host name, you&rsquo;ll need to use the
<i>fqdn</i> flag for wildcards to be useful. Note that
<b>sudo</b> only inspects actual network interfaces; this
means that IP address 127.0.0.1 (localhost) will never
match. Also, the host name &ldquo;localhost&rdquo; will only
match if that is the actual host name, which is usually only
the case for non-networked systems.</p>

<p style="margin-left:6%; margin-top: 1em">digest ::=
[A-Fa-f0-9]+ |</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="10%">


<p>[A-Za-z0-9\+/=]+</p></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Digest_Spec ::=
&quot;sha224&quot; &rsquo;:&rsquo; digest |</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="10%">
</td>
<td width="10%">


<p>&quot;sha256&quot; &rsquo;:&rsquo; digest |</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="10%">
</td>
<td width="10%">


<p>&quot;sha384&quot; &rsquo;:&rsquo; digest |</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="10%">
</td>
<td width="10%">


<p>&quot;sha512&quot; &rsquo;:&rsquo; digest</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Digest_List ::=
Digest_Spec | <br>
Digest_Spec &rsquo;,&rsquo; Digest_List</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd_List ::=
Cmnd | <br>
Cmnd &rsquo;,&rsquo; Cmnd_List</p>

<p style="margin-left:6%; margin-top: 1em">command name ::=
file name | <br>
file name args | <br>
file name &rsquo;&quot;&quot;&rsquo;</p>

<p style="margin-left:6%; margin-top: 1em">Edit_Spec ::=
&quot;sudoedit&quot; file name+</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd ::=
Digest_List? &rsquo;!&rsquo;* command name | <br>
&rsquo;!&rsquo;* directory | <br>
&rsquo;!&rsquo;* Edit_Spec | <br>
&rsquo;!&rsquo;* Cmnd_Alias</p>

<p style="margin-left:6%; margin-top: 1em">A Cmnd_List is a
list of one or more command names, directories, and other
aliases. A command name is a fully qualified file name which
may include shell-style wildcards (see the <i>Wildcards</i>
section below). A simple file name allows the user to run
the command with any arguments they wish. However, you may
also specify command line arguments (including wildcards).
Alternately, you can specify &quot;&quot; to indicate that
the command may only be run <b>without</b> command line
arguments. A directory is a fully qualified path name ending
in a &rsquo;/&rsquo;. When you specify a directory in a
Cmnd_List, the user will be able to run any file within that
directory (but not in any sub-directories therein).</p>

<p style="margin-left:6%; margin-top: 1em">If a Cmnd has
associated command line arguments, then the arguments in the
Cmnd must match exactly those given by the user on the
command line (or match the wildcards if there are any). Note
that the following characters must be escaped with a
&rsquo;\&rsquo; if they are used in command arguments:
&rsquo;,&rsquo;, &rsquo;:&rsquo;, &rsquo;=&rsquo;,
&rsquo;\&rsquo;. The built-in command &ldquo;sudoedit&rdquo;
is used to permit a user to run <b>sudo</b> with the
<b>-e</b> option (or as <b>sudoedit</b>). It may take
command line arguments just as a normal command does. Note
that &ldquo;sudoedit&rdquo; is a command built into
<b>sudo</b> itself and must be specified in the
<i>sudoers</i> file <b>without</b> a leading path. If a
leading path is present, for example
<i>/usr/bin/sudoedit</i>, the path name will be silently
converted to &ldquo;sudoedit&rdquo;. A fully-qualified path
for <b>sudoedit</b> is treated as an error by
<b>visudo</b>.</p>

<p style="margin-left:6%; margin-top: 1em">A command name
may be preceded by a Digest_List, a comma-separated list of
one or more Digest_Spec entries. If a Digest_List is
present, the command will only match successfully if it can
be verified using one of the SHA-2 digests in the list.
Starting with version 1.9.0, the <b>ALL</b> reserved word
can be used in conjunction with a Digest_List. The following
digest formats are supported: sha224, sha256, sha384, and
sha512. The string may be specified in either hex or base64
format (base64 is more compact). There are several utilities
capable of generating SHA-2 digests in hex format such as
openssl, shasum, sha224sum, sha256sum, sha384sum,
sha512sum.</p>

<p style="margin-left:6%; margin-top: 1em">For example,
using openssl:</p>

<p style="margin-left:6%; margin-top: 1em">$ openssl dgst
-sha224 /bin/ls <br>
SHA224(/bin/ls)=
118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25</p>

<p style="margin-left:6%; margin-top: 1em">It is also
possible to use openssl to generate base64 output:</p>

<p style="margin-left:6%; margin-top: 1em">$ openssl dgst
-binary -sha224 /bin/ls | openssl base64 <br>
EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==</p>

<p style="margin-left:6%; margin-top: 1em">Warning, if the
user has write access to the command itself (directly or via
a <b>sudo</b> command), it may be possible for the user to
replace the command after the digest check has been
performed but before the command is executed. A similar race
condition exists on systems that lack the <b>fexecve</b>()
system call when the directory in which the command is
located is writable by the user. See the description of the
<i>fdexec</i> setting for more information on how
<b>sudo</b> executes commands that have an associated
digest.</p>

<p style="margin-left:6%; margin-top: 1em">Command digests
are only supported by version 1.8.7 or higher.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Defaults</b>
<br>
Certain configuration options may be changed from their
default values at run-time via one or more Default_Entry
lines. These may affect all users on any host, all users on
a specific host, a specific user, a specific command, or
commands being run as a specific user. Note that per-command
entries may not include command line arguments. If you need
to specify arguments, define a Cmnd_Alias and reference that
instead.</p>

<p style="margin-left:6%; margin-top: 1em">Default_Type ::=
&rsquo;Defaults&rsquo; | <br>
&rsquo;Defaults&rsquo; &rsquo;@&rsquo; Host_List | <br>
&rsquo;Defaults&rsquo; &rsquo;:&rsquo; User_List | <br>
&rsquo;Defaults&rsquo; &rsquo;!&rsquo; Cmnd_List | <br>
&rsquo;Defaults&rsquo; &rsquo;&gt;&rsquo; Runas_List</p>

<p style="margin-left:6%; margin-top: 1em">Default_Entry
::= Default_Type Parameter_List</p>

<p style="margin-left:6%; margin-top: 1em">Parameter_List
::= Parameter | <br>
Parameter &rsquo;,&rsquo; Parameter_List</p>

<p style="margin-left:6%; margin-top: 1em">Parameter ::=
Parameter &rsquo;=&rsquo; Value | <br>
Parameter &rsquo;+=&rsquo; Value | <br>
Parameter &rsquo;-=&rsquo; Value | <br>
&rsquo;!&rsquo;* Parameter</p>

<p style="margin-left:6%; margin-top: 1em">Parameters may
be <b>flags</b>, <b>integer</b> values, <b>strings</b>, or
<b>lists</b>. Flags are implicitly boolean and can be turned
off via the &rsquo;!&rsquo; operator. Some integer, string
and list parameters may also be used in a boolean context to
disable them. Values may be enclosed in double quotes
(&quot;&quot;) when they contain multiple words. Special
characters may be escaped with a backslash
(&rsquo;\&rsquo;).</p>

<p style="margin-left:6%; margin-top: 1em">To include a
literal backslash character in a command line argument you
must escape the backslash twice. For example, to match
&rsquo;\n&rsquo; as part of a command line argument, you
must use &rsquo;\\\\n&rsquo; in the <i>sudoers</i> file.
This is due to there being two levels of escaping, one in
the <i>sudoers</i> parser itself and another when command
line arguments are matched by the fnmatch(3) function.</p>

<p style="margin-left:6%; margin-top: 1em">Lists have two
additional assignment operators, += and -=. These operators
are used to add to and delete from a list respectively. It
is not an error to use the -= operator to remove an element
that does not exist in a list.</p>

<p style="margin-left:6%; margin-top: 1em">Defaults entries
are parsed in the following order: generic, host, user, and
runas Defaults first, then command defaults. If there are
multiple Defaults settings of the same type, the last
matching setting is used. The following Defaults settings
are parsed before all others since they may affect
subsequent entries: <i>fqdn</i>, <i>group_plugin</i>,
<i>runas_default</i>, <i>sudoers_locale</i>.</p>

<p style="margin-left:6%; margin-top: 1em">See <i>SUDOERS
OPTIONS</i> for a list of supported Defaults parameters.</p>

<p style="margin-left:6%; margin-top: 1em"><b>User
specification</b> <br>
User_Spec ::= User_List Host_List &rsquo;=&rsquo;
Cmnd_Spec_List \ <br>
(&rsquo;:&rsquo; Host_List &rsquo;=&rsquo;
Cmnd_Spec_List)*</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd_Spec_List
::= Cmnd_Spec | <br>
Cmnd_Spec &rsquo;,&rsquo; Cmnd_Spec_List</p>

<p style="margin-left:6%; margin-top: 1em">Cmnd_Spec ::=
Runas_Spec? Option_Spec* Tag_Spec* Cmnd</p>

<p style="margin-left:6%; margin-top: 1em">Runas_Spec ::=
&rsquo;(&rsquo; Runas_List? (&rsquo;:&rsquo; Runas_List)?
&rsquo;)&rsquo;</p>

<p style="margin-left:6%; margin-top: 1em">Option_Spec ::=
(SELinux_Spec | Date_Spec | Timeout_Spec | Chdir_Spec |
Chroot_Spec)</p>

<p style="margin-left:6%; margin-top: 1em">SELinux_Spec ::=
(&rsquo;ROLE=role&rsquo; | &rsquo;TYPE=type&rsquo;)</p>

<p style="margin-left:6%; margin-top: 1em">Date_Spec ::=
(&rsquo;NOTBEFORE=timestamp&rsquo; |
&rsquo;NOTAFTER=timestamp&rsquo;)</p>

<p style="margin-left:6%; margin-top: 1em">Timeout_Spec ::=
&rsquo;TIMEOUT=timeout&rsquo;</p>

<p style="margin-left:6%; margin-top: 1em">Chdir_Spec ::=
&rsquo;CWD=directory&rsquo;</p>

<p style="margin-left:6%; margin-top: 1em">Chroot_Spec ::=
&rsquo;CHROOT=directory&rsquo;</p>

<p style="margin-left:6%; margin-top: 1em">Tag_Spec ::=
(&rsquo;EXEC:&rsquo; | &rsquo;NOEXEC:&rsquo; |
&rsquo;FOLLOW:&rsquo; | &rsquo;NOFOLLOW&rsquo; | <br>
&rsquo;LOG_INPUT:&rsquo; | &rsquo;NOLOG_INPUT:&rsquo; |
&rsquo;LOG_OUTPUT:&rsquo; | <br>
&rsquo;NOLOG_OUTPUT:&rsquo; | &rsquo;MAIL:&rsquo; |
&rsquo;NOMAIL:&rsquo; | &rsquo;INTERCEPT:&rsquo; | <br>
&rsquo;NOINTERCEPT:&rsquo; | &rsquo;PASSWD:&rsquo; |
&rsquo;NOPASSWD:&rsquo; | &rsquo;SETENV:&rsquo; | <br>
&rsquo;NOSETENV:&rsquo;)</p>

<p style="margin-left:6%; margin-top: 1em">A <b>user
specification</b> determines which commands a user may run
(and as what user) on specified hosts. By default, commands
are run as <b>root</b>, but this can be changed on a
per-command basis.</p>

<p style="margin-left:6%; margin-top: 1em">The basic
structure of a user specification is &ldquo;who where =
(as_whom) what&rdquo;. Let&rsquo;s break that down into its
constituent parts:</p>


<p style="margin-left:6%; margin-top: 1em"><b>Runas_Spec</b>
<br>
A Runas_Spec determines the user and/or the group that a
command may be run as. A fully-specified Runas_Spec consists
of two Runas_Lists (as defined above) separated by a colon
(&rsquo;:&rsquo;) and enclosed in a set of parentheses. The
first Runas_List indicates which users the command may be
run as via the <b>-u</b> option. The second defines a list
of groups that may be specified via the <b>-g</b> option (in
addition to any of the target user&rsquo;s groups). If both
Runas_Lists are specified, the command may be run with any
combination of users and groups listed in their respective
Runas_Lists. If only the first is specified, the command may
be run as any user in the list and, optionally, with any
group the target user belongs to. If the first Runas_List is
empty but the second is specified, the command may be run as
the invoking user with the group set to any listed in the
Runas_List. If both Runas_Lists are empty, the command may
only be run as the invoking user and the group, if
specified, must be one that the invoking user is a member
of. If no Runas_Spec is specified, the command may only be
run as <b>root</b> and the group, if specified, must be one
that <b>root</b> is a member of.</p>

<p style="margin-left:6%; margin-top: 1em">A Runas_Spec
sets the default for the commands that follow it. What this
means is that for the entry:</p>

<p style="margin-left:6%; margin-top: 1em">dgb boulder =
(operator) /bin/ls, /bin/kill, /usr/bin/lprm</p>

<p style="margin-left:6%; margin-top: 1em">The user
<b>dgb</b> may run <i>/bin/ls</i>, <i>/bin/kill</i>, and
<i>/usr/bin/lprm</i> on the host boulder&mdash;but only as
<b>operator</b>. E.g.,</p>

<p style="margin-left:6%; margin-top: 1em">$ sudo -u
operator /bin/ls</p>

<p style="margin-left:6%; margin-top: 1em">It is also
possible to override a Runas_Spec later on in an entry. If
we modify the entry like so:</p>

<p style="margin-left:6%; margin-top: 1em">dgb boulder =
(operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm</p>

<p style="margin-left:6%; margin-top: 1em">Then user
<b>dgb</b> is now allowed to run <i>/bin/ls</i> as
<b>operator</b>, but <i>/bin/kill</i> and
<i>/usr/bin/lprm</i> as <b>root</b>.</p>

<p style="margin-left:6%; margin-top: 1em">We can extend
this to allow <b>dgb</b> to run /bin/ls with either the user
or group set to <b>operator</b>:</p>

<p style="margin-left:6%; margin-top: 1em">dgb boulder =
(operator : operator) /bin/ls, (root) /bin/kill,\</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="10%">


<p>/usr/bin/lprm</p></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Note that while
the group portion of the Runas_Spec permits the user to run
as command with that group, it does not force the user to do
so. If no group is specified on the command line, the
command will run with the group listed in the target
user&rsquo;s password database entry. The following would
all be permitted by the sudoers entry above:</p>

<p style="margin-left:6%; margin-top: 1em">$ sudo -u
operator /bin/ls <br>
$ sudo -u operator -g operator /bin/ls <br>
$ sudo -g operator /bin/ls</p>

<p style="margin-left:6%; margin-top: 1em">In the following
example, user <b>tcm</b> may run commands that access a
modem device file with the dialer group.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>tcm</p></td>
<td width="10%">


<p>boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\</p></td>
<td width="73%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%"></td>
<td width="10%">


<p>/usr/local/bin/minicom</p></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Note that in
this example only the group will be set, the command still
runs as user <b>tcm</b>. E.g.</p>

<p style="margin-left:6%; margin-top: 1em">$ sudo -g dialer
/usr/bin/cu</p>

<p style="margin-left:6%; margin-top: 1em">Multiple users
and groups may be present in a Runas_Spec, in which case the
user may select any combination of users and groups via the
<b>-u</b> and <b>-g</b> options. In this example:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>alan</p></td>
<td width="10%">


<p>ALL = (root, bin : operator, system) ALL</p></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">user <b>alan</b>
may run any command as either user root or bin, optionally
setting the group to operator or system.</p>


<p style="margin-left:6%; margin-top: 1em"><b>Option_Spec</b>
<br>
A Cmnd may have zero or more options associated with it.
Options may consist of SELinux roles and/or types, start
and/or end dates and command timeouts. Once an option is set
for a Cmnd, subsequent Cmnds in the Cmnd_Spec_List, inherit
that option unless it is overridden by another option. Note
that the option names are reserved words in <i>sudoers</i>.
This means that none of the valid option names (see below)
can be used when declaring an alias.</p>


<p style="margin-left:6%; margin-top: 1em"><b>SELinux_Spec</b>
<br>
On systems with SELinux support, <i>sudoers</i> file entries
may optionally have an SELinux role and/or type associated
with a command. This can be used to implement a form of
role-based access control (RBAC). If a role or type is
specified with the command it will override any default
values specified in <i>sudoers</i>. A role or type specified
on the command line, however, will supersede the values in
<i>sudoers</i>.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Date_Spec
<br>
sudoers</b> rules can be specified with a start and end date
via the NOTBEFORE and NOTAFTER settings. The time stamp must
be specified in <i>Generalized Time</i> as defined by RFC
4517. The format is effectively yyyymmddHHMMSSZ where the
minutes and seconds are optional. The &rsquo;Z&rsquo; suffix
indicates that the time stamp is in Coordinated Universal
Time (UTC). It is also possible to specify a timezone offset
from UTC in hours and minutes instead of a &rsquo;Z&rsquo;.
For example, &rsquo;-0500&rsquo; would correspond to Eastern
Standard time in the US. As an extension, if no
&rsquo;Z&rsquo; or timezone offset is specified, local time
will be used.</p>

<p style="margin-left:6%; margin-top: 1em">The following
are all valid time stamps:</p>


<p style="margin-left:12%; margin-top: 1em">20170214083000Z
<br>
2017021408Z <br>
20160315220000-0500 <br>
20151201235900</p>


<p style="margin-left:6%; margin-top: 1em"><b>Timeout_Spec</b>
<br>
A command may have a timeout associated with it. If the
timeout expires before the command has exited, the command
will be terminated. The timeout may be specified in
combinations of days, hours, minutes, and seconds with a
single-letter case-insensitive suffix that indicates the
unit of time. For example, a timeout of 7 days, 8 hours, 30
minutes, and 10 seconds would be written as 7d8h30m10s. If a
number is specified without a unit, seconds are assumed. Any
of the days, minutes, hours, or seconds may be omitted. The
order must be from largest to smallest unit and a unit may
not be specified more than once.</p>

<p style="margin-left:6%; margin-top: 1em">The following
are all <i>valid</i> timeout values: 7d8h30m10s, 14d, 8h30m,
600s, 3600. The following are <i>invalid</i> timeout values:
12m2w1d, 30s10m4h, 1d2d3h.</p>

<p style="margin-left:6%; margin-top: 1em">This setting is
only supported by version 1.8.20 or higher.</p>


<p style="margin-left:6%; margin-top: 1em"><b>Chdir_Spec</b>
<br>
The working directory that the command will be run in can be
specified using the CWD setting. The <i>directory</i> must
be a fully-qualified path name beginning with a
&rsquo;/&rsquo; or &rsquo;~&rsquo; character, or the special
value &ldquo;*&rdquo;. A value of &ldquo;*&rdquo; indicates
that the user may specify the working directory by running
<b>sudo</b> with the <b>-D</b> option. By default, commands
are run from the invoking user&rsquo;s current working
directory, unless the <b>-i</b> option is given. Path names
of the form ~user/path/name are interpreted as being
relative to the named user&rsquo;s home directory. If the
user name is omitted, the path will be relative to the runas
user&rsquo;s home directory.</p>

<p style="margin-left:6%; margin-top: 1em">This setting is
only supported by version 1.9.3 or higher.</p>


<p style="margin-left:6%; margin-top: 1em"><b>Chroot_Spec</b>
<br>
The root directory that the command will be run in can be
specified using the CHROOT setting. The <i>directory</i>
must be a fully-qualified path name beginning with a
&rsquo;/&rsquo; or &rsquo;~&rsquo; character, or the special
value &ldquo;*&rdquo;. A value of &ldquo;*&rdquo; indicates
that the user may specify the root directory by running
<b>sudo</b> with the <b>-R</b> option. This setting can be
used to run the command in a chroot(2) &ldquo;sandbox&rdquo;
similar to the chroot(8) utility. Path names of the form
~user/path/name are interpreted as being relative to the
named user&rsquo;s home directory. If the user name is
omitted, the path will be relative to the runas user&rsquo;s
home directory.</p>

<p style="margin-left:6%; margin-top: 1em">This setting is
only supported by version 1.9.3 or higher.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Tag_Spec</b>
<br>
A command may have zero or more tags associated with it. The
following tag values are supported: EXEC, NOEXEC, FOLLOW,
NOFOLLOW, LOG_INPUT, NOLOG_INPUT, LOG_OUTPUT, NOLOG_OUTPUT,
MAIL, NOMAIL, INTERCEPT, NOINTERCEPT, PASSWD, NOPASSWD,
SETENV, and NOSETENV. Once a tag is set on a Cmnd,
subsequent Cmnds in the Cmnd_Spec_List, inherit the tag
unless it is overridden by the opposite tag (in other words,
PASSWD overrides NOPASSWD and NOEXEC overrides EXEC).</p>

<p style="margin-top: 1em"><i>EXEC</i> and
<i>NOEXEC</i></p>

<p style="margin-left:9%; margin-top: 1em">If <b>sudo</b>
has been compiled with <i>noexec</i> support and the
underlying operating system supports it, the NOEXEC tag can
be used to prevent a dynamically-linked executable from
running further commands itself.</p>

<p style="margin-left:9%; margin-top: 1em">In the following
example, user <b>aaron</b> may run <i>/usr/bin/more</i> and
<i>/usr/bin/vi</i> but shell escapes will be disabled.</p>

<p style="margin-left:9%; margin-top: 1em">aaron shanty =
NOEXEC: /usr/bin/more, /usr/bin/vi</p>

<p style="margin-left:9%; margin-top: 1em">See the
<i>Preventing shell escapes</i> section below for more
details on how NOEXEC works and whether or not it will work
on your system.</p>

<p style="margin-top: 1em"><i>FOLLOW</i> and
<i>NOFOLLOW</i></p>

<p style="margin-left:9%;">Starting with version 1.8.15,
<b>sudoedit</b> will not open a file that is a symbolic link
unless the <i>sudoedit_follow</i> flag is enabled. The
<i>FOLLOW</i> and <i>NOFOLLOW</i> tags override the value of
<i>sudoedit_follow</i> and can be used to permit (or deny)
the editing of symbolic links on a per-command basis. These
tags are only effective for the <i>sudoedit</i> command and
are ignored for all other commands.</p>

<p style="margin-top: 1em"><i>LOG_INPUT</i> and
<i>NOLOG_INPUT</i></p>

<p style="margin-left:9%; margin-top: 1em">These tags
override the value of the <i>log_input</i> flag on a
per-command basis. For more information, see the description
of <i>log_input</i> in the <i>SUDOERS OPTIONS</i> section
below.</p>

<p style="margin-top: 1em"><i>LOG_OUTPUT</i> and
<i>NOLOG_OUTPUT</i></p>

<p style="margin-left:9%; margin-top: 1em">These tags
override the value of the <i>log_output</i> flag on a
per-command basis. For more information, see the description
of <i>log_output</i> in the <i>SUDOERS OPTIONS</i> section
below.</p>

<p style="margin-top: 1em"><i>MAIL</i> and
<i>NOMAIL</i></p>

<p style="margin-left:9%; margin-top: 1em">These tags
provide fine-grained control over whether mail will be sent
when a user runs a command by overriding the value of the
<i>mail_all_cmnds</i> flag on a per-command basis. They have
no effect when <b>sudo</b> is run with the <b>-l</b> or
<b>-v</b> options. A <i>NOMAIL</i> tag will also override
the <i>mail_always</i> and <i>mail_no_perms</i> options. For
more information, see the descriptions of
<i>mail_all_cmnds</i>, <i>mail_always</i>, and
<i>mail_no_perms</i> in the <i>SUDOERS OPTIONS</i> section
below.</p>

<p style="margin-top: 1em"><i>PASSWD</i> and
<i>NOPASSWD</i></p>

<p style="margin-left:9%; margin-top: 1em">By default,
<b>sudo</b> requires that a user authenticate before running
a command. This behavior can be modified via the NOPASSWD
tag. Like a Runas_Spec, the NOPASSWD tag sets a default for
the commands that follow it in the Cmnd_Spec_List.
Conversely, the PASSWD tag can be used to reverse things.
For example:</p>

<p style="margin-left:9%; margin-top: 1em">ray rushmore =
NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm</p>

<p style="margin-left:9%; margin-top: 1em">would allow the
user <b>ray</b> to run <i>/bin/kill</i>, <i>/bin/ls</i>, and
<i>/usr/bin/lprm</i> as <b>root</b> on the machine
&ldquo;rushmore&rdquo; without authenticating himself. If we
only want <b>ray</b> to be able to run <i>/bin/kill</i>
without a password the entry would be:</p>

<p style="margin-left:9%; margin-top: 1em">ray rushmore =
NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm</p>

<p style="margin-left:9%; margin-top: 1em">Note, however,
that the PASSWD tag has no effect on users who are in the
group specified by the <i>exempt_group</i> setting.</p>

<p style="margin-left:9%; margin-top: 1em">By default, if
the NOPASSWD tag is applied to any of a user&rsquo;s entries
for the current host, the user will be able to run
&ldquo;sudo -l&rdquo; without a password. Additionally, a
user may only run &ldquo;sudo -v&rdquo; without a password
if all of the user&rsquo;s entries for the current host have
the NOPASSWD tag. This behavior may be overridden via the
<i>verifypw</i> and <i>listpw</i> options.</p>

<p style="margin-top: 1em"><i>SETENV</i> and
<i>NOSETENV</i></p>

<p style="margin-left:9%; margin-top: 1em">These tags
override the value of the <i>setenv</i> flag on a
per-command basis. Note that if SETENV has been set for a
command, the user may disable the <i>env_reset</i> flag from
the command line via the <b>-E</b> option. Additionally,
environment variables set on the command line are not
subject to the restrictions imposed by <i>env_check</i>,
<i>env_delete</i>, or <i>env_keep</i>. As such, only trusted
users should be allowed to set variables in this manner. If
the command matched is <b>ALL</b>, the SETENV tag is implied
for that command; this default may be overridden by use of
the NOSETENV tag.</p>

<p style="margin-top: 1em"><i>INTERCEPT</i> and
<i>NOINTERCEPT</i></p>

<p style="margin-left:9%; margin-top: 1em">If <b>sudo</b>
has been compiled with <i>intercept</i> support and the
underlying operating system supports it, the INTERCEPT tag
can be used to cause programs spawned by a command to be
validated against <i>sudoers</i> and logged just like they
would be if run through <b>sudo</b> directly. This is useful
in conjunction with commands that allow shell escapes such
as editors, shells, and paginators.</p>

<p style="margin-left:9%; margin-top: 1em">In the following
example, user <b>chuck</b> may run any command on the
machine &ldquo;research&rdquo; in intercept mode.</p>

<p style="margin-left:9%; margin-top: 1em">chuck research =
INTERCEPT: ALL</p>

<p style="margin-left:9%; margin-top: 1em">See the
<i>Preventing shell escapes</i> section below for more
details on how INTERCEPT works and whether or not it will
work on your system.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Wildcards
<br>
sudo</b> allows shell-style <i>wildcards</i> (aka meta or
glob characters) to be used in host names, path names, and
command line arguments in the <i>sudoers</i> file. Wildcard
matching is done via the glob(3) and fnmatch(3) functions as
specified by IEEE Std 1003.1 (&ldquo;POSIX.1&rdquo;).</p>

<p style="margin-top: 1em">*</p>

<p style="margin-left:19%; margin-top: 1em">Matches any set
of zero or more characters (including white space).</p>

<p style="margin-top: 1em">?</p>

<p style="margin-left:19%; margin-top: 1em">Matches any
single character (including white space).</p>

<p style="margin-top: 1em">[...]</p>

<p style="margin-left:19%; margin-top: 1em">Matches any
character in the specified range.</p>

<p style="margin-top: 1em">[!...]</p>

<p style="margin-left:19%; margin-top: 1em">Matches any
character <i>not</i> in the specified range.</p>

<p style="margin-top: 1em">\x</p>

<p style="margin-left:19%; margin-top: 1em">For any
character &rsquo;x&rsquo;, evaluates to &rsquo;x&rsquo;.
This is used to escape special characters such as:
&rsquo;*&rsquo;, &rsquo;?&rsquo;, &rsquo;[&rsquo;, and
&rsquo;]&rsquo;.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note that
these are not regular expressions.</b> Unlike a regular
expression there is no way to match one or more characters
within a range.</p>

<p style="margin-left:6%; margin-top: 1em">Character
classes may be used if your system&rsquo;s glob(3) and
fnmatch(3) functions support them. However, because the
&rsquo;:&rsquo; character has special meaning in
<i>sudoers</i>, it must be escaped. For example:</p>

<p style="margin-left:12%; margin-top: 1em">/bin/ls
[[\:alpha\:]]*</p>

<p style="margin-left:6%; margin-top: 1em">Would match any
file name beginning with a letter.</p>

<p style="margin-left:6%; margin-top: 1em">Note that a
forward slash (&rsquo;/&rsquo;) will <i>not</i> be matched
by wildcards used in the file name portion of the command.
This is to make a path like:</p>

<p style="margin-left:12%; margin-top: 1em">/usr/bin/*</p>

<p style="margin-left:6%; margin-top: 1em">match
<i>/usr/bin/who</i> but not <i>/usr/bin/X11/xterm</i>.</p>

<p style="margin-left:6%; margin-top: 1em">When matching
the command line arguments, however, a slash <i>does</i> get
matched by wildcards since command line arguments may
contain arbitrary strings and not just path names.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Wildcards in
command line arguments should be used with care.</b> <br>
Command line arguments are matched as a single, concatenated
string. This mean a wildcard character such as
&rsquo;?&rsquo; or &rsquo;*&rsquo; will match across word
boundaries, which may be unexpected. For example, while a
sudoers entry like:</p>

<p style="margin-left:12%; margin-top: 1em">%operator ALL =
/bin/cat /var/log/messages*</p>

<p style="margin-left:6%; margin-top: 1em">will allow
command like:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo cat
/var/log/messages.1</p>

<p style="margin-left:6%; margin-top: 1em">It will also
allow:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo cat
/var/log/messages /etc/shadow</p>

<p style="margin-left:6%; margin-top: 1em">which is
probably not what was intended. In most cases it is better
to do command line processing outside of the <i>sudoers</i>
file in a scripting language.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Exceptions to
wildcard rules</b> <br>
The following exceptions apply to the above rules:</p>

<p style="margin-top: 1em">&quot;&quot;</p>

<p style="margin-left:19%; margin-top: 1em">If the empty
string &quot;&quot; is the only command line argument in the
<i>sudoers</i> file entry it means that command is not
allowed to be run with <i>any</i> arguments.</p>

<p style="margin-top: 1em">sudoedit</p>

<p style="margin-left:19%; margin-top: 1em">Command line
arguments to the <i>sudoedit</i> built-in command should
always be path names, so a forward slash (&rsquo;/&rsquo;)
will not be matched by a wildcard.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Including
other files from within sudoers</b> <br>
It is possible to include other <i>sudoers</i> files from
within the <i>sudoers</i> file currently being parsed using
the @include and @includedir directives. For compatibility
with sudo versions prior to 1.9.1, #include and #includedir
are also accepted.</p>

<p style="margin-left:6%; margin-top: 1em">An include file
can be used, for example, to keep a site-wide <i>sudoers</i>
file in addition to a local, per-machine file. For the sake
of this example the site-wide <i>sudoers</i> file will be
<i>/etc/sudoers</i> and the per-machine one will be
<i>/etc/sudoers.local</i>. To include
<i>/etc/sudoers.local</i> from within <i>/etc/sudoers</i>
one would use the following line in <i>/etc/sudoers</i>:</p>

<p style="margin-left:12%; margin-top: 1em">@include
/etc/sudoers.local</p>

<p style="margin-left:6%; margin-top: 1em">When <b>sudo</b>
reaches this line it will suspend processing of the current
file (<i>/etc/sudoers</i>) and switch to
<i>/etc/sudoers.local</i>. Upon reaching the end of
<i>/etc/sudoers.local</i>, the rest of <i>/etc/sudoers</i>
will be processed. Files that are included may themselves
include other files. A hard limit of 128 nested include
files is enforced to prevent include file loops.</p>

<p style="margin-left:6%; margin-top: 1em">Starting with
version 1.9.1, the path to the include file may contain
white space if it is escaped with a backslash
(&rsquo;\&rsquo;). Alternately, the entire path may be
enclosed in double quotes (&quot;&quot;), in which case no
escaping is necessary. To include a literal backslash in the
path, &rsquo;\\&rsquo; should be used.</p>

<p style="margin-left:6%; margin-top: 1em">If the path to
the include file is not fully-qualified (does not begin with
a &rsquo;/&rsquo;), it must be located in the same directory
as the sudoers file it was included from. For example, if
<i>/etc/sudoers</i> contains the line:</p>

<p style="margin-left:12%; margin-top: 1em">@include
sudoers.local</p>

<p style="margin-left:6%; margin-top: 1em">the file that
will be included is <i>/etc/sudoers.local</i>.</p>

<p style="margin-left:6%; margin-top: 1em">The file name
may also include the %h escape, signifying the short form of
the host name. In other words, if the machine&rsquo;s host
name is &ldquo;xerxes&rdquo;, then</p>

<p style="margin-left:12%; margin-top: 1em">@include
/etc/sudoers.%h</p>

<p style="margin-left:6%; margin-top: 1em">will cause
<b>sudo</b> to include the file
<i>/etc/sudoers.xerxes</i>.</p>

<p style="margin-left:6%; margin-top: 1em">The @includedir
directive can be used to create a <i>sudoers.d</i> directory
that the system package manager can drop <i>sudoers</i> file
rules into as part of package installation. For example,
given:</p>

<p style="margin-left:12%; margin-top: 1em">@includedir
/etc/sudoers.d</p>

<p style="margin-left:6%; margin-top: 1em"><b>sudo</b> will
suspend processing of the current file and read each file in
<i>/etc/sudoers.d</i>, skipping file names that end in
&rsquo;~&rsquo; or contain a &rsquo;.&rsquo; character to
avoid causing problems with package manager or editor
temporary/backup files. Files are parsed in sorted lexical
order. That is, <i>/etc/sudoers.d/01_first</i> will be
parsed before <i>/etc/sudoers.d/10_second</i>. Be aware that
because the sorting is lexical, not numeric,
<i>/etc/sudoers.d/1_whoops</i> would be loaded <i>after
/etc/sudoers.d/10_second</i>. Using a consistent number of
leading zeroes in the file names can be used to avoid such
problems. After parsing the files in the directory, control
returns to the file that contained the @includedir
directive.</p>

<p style="margin-left:6%; margin-top: 1em">Note that unlike
files included via @include, <b>visudo</b> will not edit the
files in a @includedir directory unless one of them contains
a syntax error. It is still possible to run <b>visudo</b>
with the <b>-f</b> flag to edit the files directly, but this
will not catch the redefinition of an <i>alias</i> that is
also present in a different file.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Other special
characters and reserved words</b> <br>
The pound sign (&rsquo;#&rsquo;) is used to indicate a
comment (unless it is part of a #include directive or unless
it occurs in the context of a user name and is followed by
one or more digits, in which case it is treated as a
user-ID). Both the comment character and any text after it,
up to the end of the line, are ignored.</p>

<p style="margin-left:6%; margin-top: 1em">The reserved
word <b>ALL</b> is a built-in <i>alias</i> that always
causes a match to succeed. It can be used wherever one might
otherwise use a Cmnd_Alias, User_Alias, Runas_Alias, or
Host_Alias. Attempting to define an <i>alias</i> named
<b>ALL</b> will result in a syntax error. Please note that
using <b>ALL</b> can be dangerous since in a command
context, it allows the user to run <i>any</i> command on the
system.</p>

<p style="margin-left:6%; margin-top: 1em">The following
option names permitted in an Option_Spec are also considered
reserved words: CHROOT, ROLE, TYPE, TIMEOUT, CWD, NOTBEFORE
and NOTAFTER. Attempting to define an <i>alias</i> with the
same name as one of the options will result in a syntax
error.</p>

<p style="margin-left:6%; margin-top: 1em">An exclamation
point (&rsquo;!&rsquo;) can be used as a logical <i>not</i>
operator in a list or <i>alias</i> as well as in front of a
Cmnd. This allows one to exclude certain values. For the
&rsquo;!&rsquo; operator to be effective, there must be
something for it to exclude. For example, to match all users
except for root one would use:</p>

<p style="margin-left:12%; margin-top: 1em">ALL,!root</p>

<p style="margin-left:6%; margin-top: 1em">If the
<b>ALL</b>, is omitted, as in:</p>

<p style="margin-left:12%; margin-top: 1em">!root</p>

<p style="margin-left:6%; margin-top: 1em">it would
explicitly deny root but not match any other users. This is
different from a true &ldquo;negation&rdquo; operator.</p>

<p style="margin-left:6%; margin-top: 1em">Note, however,
that using a &rsquo;!&rsquo; in conjunction with the
built-in <b>ALL</b> alias to allow a user to run &ldquo;all
but a few&rdquo; commands rarely works as intended (see
<i>SECURITY NOTES</i> below).</p>

<p style="margin-left:6%; margin-top: 1em">Long lines can
be continued with a backslash (&rsquo;\&rsquo;) as the last
character on the line.</p>

<p style="margin-left:6%; margin-top: 1em">White space
between elements in a list as well as special syntactic
characters in a <i>User Specification</i> (</p>

<p>&rsquo;=&rsquo;, &rsquo;:&rsquo;, &rsquo;(&rsquo;,
&rsquo;)&rsquo; ) is optional.</p>

<p style="margin-left:6%; margin-top: 1em">The following
characters must be escaped with a backslash
(&rsquo;\&rsquo;) when used as part of a word (e.g., a user
name or host name): &rsquo;!&rsquo;, &rsquo;=&rsquo;,
&rsquo;:&rsquo;, &rsquo;,&rsquo;, &rsquo;(&rsquo;,
&rsquo;)&rsquo;, &rsquo;\&rsquo;.</p>

<p style="margin-top: 1em"><b>SUDOERS OPTIONS</b></p>

<p style="margin-left:6%;"><b>sudo</b>&rsquo;s behavior can
be modified by Default_Entry lines, as explained earlier. A
list of all supported Defaults parameters, grouped by type,
are listed below.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Boolean
Flags</b>:</p>

<p style="margin-top: 1em">always_query_group_plugin</p>

<p style="margin-left:29%;">If a <i>group_plugin</i> is
configured, use it to resolve groups of the form %group as
long as there is not also a system group of the same name.
Normally, only groups of the form %:group are passed to the
<i>group_plugin</i>. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">always_set_home</p>

<p style="margin-left:29%; margin-top: 1em">If enabled,
<b>sudo</b> will set the HOME environment variable to the
home directory of the target user (which is the root user
unless the <b>-u</b> option is used). This flag is largely
obsolete and has no effect unless the <i>env_reset</i> flag
has been disabled or HOME is present in the <i>env_keep</i>
list, both of which are strongly discouraged. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">authenticate</p>

<p style="margin-left:29%; margin-top: 1em">If set, users
must authenticate themselves via a password (or other means
of authentication) before they may run commands. This
default may be overridden via the PASSWD and NOPASSWD tags.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">case_insensitive_group</p>

<p style="margin-left:29%;">If enabled, group names in
<i>sudoers</i> will be matched in a case insensitive manner.
This may be necessary when users are stored in LDAP or AD.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">case_insensitive_user</p>

<p style="margin-left:29%;">If enabled, user names in
<i>sudoers</i> will be matched in a case insensitive manner.
This may be necessary when groups are stored in LDAP or AD.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">closefrom_override</p>

<p style="margin-left:29%;">If set, the user may use the
<b>-C</b> option which overrides the default starting point
at which <b>sudo</b> begins closing open file descriptors.
This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">compress_io</p>

<p style="margin-left:29%; margin-top: 1em">If set, and
<b>sudo</b> is configured to log a command&rsquo;s input or
output, the I/O logs will be compressed using <b>zlib</b>.
This flag is <i>on</i> by default when <b>sudo</b> is
compiled with <b>zlib</b> support.</p>

<p style="margin-top: 1em">exec_background</p>

<p style="margin-left:29%; margin-top: 1em">By default,
<b>sudo</b> runs a command as the foreground process as long
as <b>sudo</b> itself is running in the foreground. When the
<i>exec_background</i> flag is enabled and the command is
being run in a pseudo-terminal (due to I/O logging or the
<i>use_pty</i> flag), the command will be run as a
background process. Attempts to read from the controlling
terminal (or to change terminal settings) will result in the
command being suspended with the SIGTTIN signal (or SIGTTOU
in the case of terminal settings). If this happens when
<b>sudo</b> is a foreground process, the command will be
granted the controlling terminal and resumed in the
foreground with no user intervention required. The advantage
of initially running the command in the background is that
<b>sudo</b> need not read from the terminal unless the
command explicitly requests it. Otherwise, any terminal
input must be passed to the command, whether it has required
it or not (the kernel buffers terminals so it is not
possible to tell whether the command really wants the
input). This is different from historic <i>sudo</i> behavior
or when the command is not being run in a
pseudo-terminal.</p>

<p style="margin-left:29%; margin-top: 1em">For this to
work seamlessly, the operating system must support the
automatic restarting of system calls. Unfortunately, not all
operating systems do this by default, and even those that do
may have bugs. For example, macOS fails to restart the
<b>tcgetattr</b>() and <b>tcsetattr</b>() system calls (this
is a bug in macOS). Furthermore, because this behavior
depends on the command stopping with the SIGTTIN or SIGTTOU
signals, programs that catch these signals and suspend
themselves with a different signal (usually SIGTOP) will not
be automatically foregrounded. Some versions of the linux
su(1) command behave this way. This flag is <i>off</i> by
default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.7 or higher. It has no effect
unless I/O logging is enabled or the <i>use_pty</i> flag is
enabled.</p>

<p style="margin-top: 1em">env_editor</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>visudo</b> will use the value of the SUDO_EDITOR, VISUAL
or EDITOR environment variables before falling back on the
default editor list. Note that <b>visudo</b> is typically
run as root so this flag may allow a user with <b>visudo</b>
privileges to run arbitrary commands as root without
logging. An alternative is to place a colon-separated list
of &ldquo;safe&rdquo; editors int the <i>editor</i> setting.
<b>visudo</b> will then only use SUDO_EDITOR, VISUAL or
EDITOR if they match a value specified in <i>editor</i>. If
the <i>env_reset</i> flag is enabled, the SUDO_EDITOR,
VISUAL and/or EDITOR environment variables must be present
in the <i>env_keep</i> list for the <i>env_editor</i> flag
to function when <b>visudo</b> is invoked via <b>sudo</b>.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">env_reset</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will run the command in a minimal environment
containing the TERM, PATH, HOME, MAIL, SHELL, LOGNAME, USER
and SUDO_* variables. Any variables in the caller&rsquo;s
environment or in the file specified by the
<i>restricted_env_file</i> setting that match the env_keep
and env_check lists are then added, followed by any
variables present in the file specified by the
<i>env_file</i> setting (if any). The contents of the
env_keep and env_check lists, as modified by global Defaults
parameters in <i>sudoers</i>, are displayed when <b>sudo</b>
is run by root with the <b>-V</b> option. If the
<i>secure_path</i> setting is enabled, its value will be
used for the PATH environment variable. This flag is
<i>on</i> by default.</p>

<p style="margin-top: 1em">fast_glob</p>

<p style="margin-left:29%; margin-top: 1em">Normally,
<b>sudo</b> uses the glob(3) function to do shell-style
globbing when matching path names. However, since it
accesses the file system, glob(3) can take a long time to
complete for some patterns, especially when the pattern
references a network file system that is mounted on demand
(auto mounted). The <i>fast_glob</i> flag causes <b>sudo</b>
to use the fnmatch(3) function, which does not access the
file system to do its matching. The disadvantage of
<i>fast_glob</i> is that it is unable to match relative path
names such as <i>./ls</i> or <i>../bin/ls</i>. This has
security implications when path names that include globbing
characters are used with the negation operator,
&rsquo;!&rsquo;, as such rules can be trivially bypassed. As
such, this flag should not be used when the <i>sudoers</i>
file contains rules that contain negated path names which
include globbing characters. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">fqdn</p>

<p style="margin-left:29%; margin-top: 1em">Set this flag
if you want to put fully qualified host names in the
<i>sudoers</i> file when the local host name (as returned by
the hostname command) does not contain the domain name. In
other words, instead of myhost you would use
myhost.mydomain.edu. You may still use the short form if you
wish (and even mix the two). This flag is only effective
when the &ldquo;canonical&rdquo; host name, as returned by
the <b>getaddrinfo</b>() or <b>gethostbyname</b>() function,
is a fully-qualified domain name. This is usually the case
when the system is configured to use DNS for host name
resolution.</p>

<p style="margin-left:29%; margin-top: 1em">If the system
is configured to use the <i>/etc/hosts</i> file in
preference to DNS, the &ldquo;canonical&rdquo; host name may
not be fully-qualified. The order that sources are queried
for host name resolution is usually specified in the
<i>/etc/nsswitch.conf</i>, <i>/etc/netsvc.conf</i>,
<i>/etc/host.conf</i>, or, in some cases,
<i>/etc/resolv.conf</i> file. In the <i>/etc/hosts</i> file,
the first host name of the entry is considered to be the
&ldquo;canonical&rdquo; name; subsequent names are aliases
that are not used by <b>sudoers</b>. For example, the
following hosts file line for the machine
&ldquo;xyzzy&rdquo; has the fully-qualified domain name as
the &ldquo;canonical&rdquo; host name, and the short version
as an alias.</p>

<p style="margin-left:37%; margin-top: 1em">192.168.1.1
xyzzy.sudo.ws xyzzy</p>

<p style="margin-left:29%; margin-top: 1em">If the
machine&rsquo;s hosts file entry is not formatted properly,
the <i>fqdn</i> flag will not be effective if it is queried
before DNS.</p>

<p style="margin-left:29%; margin-top: 1em">Beware that
when using DNS for host name resolution, turning on
<i>fqdn</i> requires <b>sudoers</b> to make DNS lookups
which renders <b>sudo</b> unusable if DNS stops working (for
example if the machine is disconnected from the network).
Also note that just like with the hosts file, you must use
the &ldquo;canonical&rdquo; name as DNS knows it. That is,
you may not use a host alias (</p>

<p>CNAME entry ) due to performance issues and the fact
that there is no way to get all aliases from DNS.</p>

<p style="margin-left:29%; margin-top: 1em">This flag is
<i>on</i> by default.</p>

<p style="margin-top: 1em">ignore_audit_errors</p>

<p style="margin-left:29%;">Allow commands to be run even
if <b>sudoers</b> cannot write to the audit log. If enabled,
an audit log write failure is not treated as a fatal error.
If disabled, a command may only be run after the audit event
is successfully written. This flag is only effective on
systems for which <b>sudoers</b> supports audit logging,
including FreeBSD, Linux, macOS, and Solaris. This flag is
<i>on</i> by default.</p>

<p style="margin-top: 1em">ignore_dot</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will ignore &quot;.&quot; or &quot;&quot; (both
denoting current directory) in the PATH environment
variable; the PATH itself is not modified. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">ignore_iolog_errors</p>

<p style="margin-left:29%;">Allow commands to be run even
if <b>sudoers</b> cannot write to the I/O log (local or
remote). If enabled, an I/O log write failure is not treated
as a fatal error. If disabled, the command will be
terminated if the I/O log cannot be written to. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">ignore_logfile_errors</p>

<p style="margin-left:29%;">Allow commands to be run even
if <b>sudoers</b> cannot write to the log file. If enabled,
a log file write failure is not treated as a fatal error. If
disabled, a command may only be run after the log file entry
is successfully written. This flag only has an effect when
<b>sudoers</b> is configured to use file-based logging via
the <i>logfile</i> setting. This flag is <i>on</i> by
default.</p>

<p style="margin-top: 1em">ignore_local_sudoers</p>

<p style="margin-left:29%;">If set via LDAP, parsing of
<i>/etc/sudoers</i> will be skipped. This is intended for
Enterprises that wish to prevent the usage of local sudoers
files so that only LDAP is used. This thwarts the efforts of
rogue operators who would attempt to add roles to
<i>/etc/sudoers</i>. When this flag is enabled,
<i>/etc/sudoers</i> does not even need to exist. Since this
flag tells <b>sudo</b> how to behave when no specific LDAP
entries have been matched, this sudoOption is only
meaningful for the cn=defaults section. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">ignore_unknown_defaults</p>

<p style="margin-left:29%;">If set, <b>sudo</b> will not
produce a warning if it encounters an unknown Defaults entry
in the <i>sudoers</i> file or an unknown sudoOption in LDAP.
This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">insults</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will insult users when they enter an incorrect
password. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">log_allowed</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudoers</b> will log commands allowed by the policy to
the system audit log (where supported) as well as to syslog
and/or a log file. This flag is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.29 or higher.</p>

<p style="margin-top: 1em">log_denied</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudoers</b> will log commands denied by the policy to the
system audit log (where supported) as well as to syslog
and/or a log file. This flag is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.29 or higher.</p>

<p style="margin-top: 1em">log_exit_status</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudoers</b> will log the exit value of commands that are
run to syslog and/or a log file. If a command was terminated
by a signal, the signal name is logged as well. This flag is
<i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.8 or higher.</p>

<p style="margin-top: 1em">log_host</p>

<p style="margin-left:29%; margin-top: 1em">If set, the
host name will be included in log entries written to the
file configured by the <i>logfile</i> setting. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">log_input</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will run the command in a pseudo-terminal and
log all user input. If the standard input is not connected
to the user&rsquo;s tty, due to I/O redirection or because
the command is part of a pipeline, that input is also
captured and stored in a separate log file. Anything sent to
the standard input will be consumed, regardless of whether
or not the command run via <b>sudo</b> is actually reading
the standard input. This may have unexpected results when
using <b>sudo</b> in a shell script that expects to process
the standard input. For more information about I/O logging,
see the <i>I/O LOG FILES</i> section. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">log_output</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will run the command in a pseudo-terminal and
log all output that is sent to the screen, similar to the
script(1) command. For more information about I/O logging,
see the <i>I/O LOG FILES</i> section. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">log_server_keepalive</p>

<p style="margin-left:29%;">If set, <b>sudo</b> will enable
the TCP keepalive socket option on the connection to the log
server. This enables the periodic transmission of keepalive
messages to the server. If the server does not respond to a
message, the connection will be closed and the running
command will be terminated unless the
<i>ignore_iolog_errors</i> flag (I/O logging enabled) or the
<i>ignore_log_errors</i> flag (I/O logging disabled) is set.
This flag is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">log_server_verify</p>

<p style="margin-left:29%;">If set, the server certificate
received during the TLS handshake must be valid and it must
contain either the server name (from <i>log_servers</i>) or
its IP address. If either of these conditions is not met,
the TLS handshake will fail. This flag is <i>on</i> by
default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">log_subcmds</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudoers</b> will log when a command spawns a child
process and executes a program using the <b>execl</b>(),
<b>execle</b>(), <b>execlp</b>(), <b>execv</b>(),
<b>execve</b>(), <b>execvp</b>(), or <b>execvpe</b>()
library functions. For example, if a shell is run by
<b>sudo</b>, the individual commands run via the shell will
be logged. This flag is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">The
<i>log_subcmds</i> flag uses the same underlying mechanism
as the <i>intercept</i> setting. See <i>Preventing shell
escapes</i> for more information on what systems support
this option and its limitations. This setting is only
supported by version 1.9.8 or higher and is incompatible
with SELinux RBAC support.</p>

<p style="margin-top: 1em">log_year</p>

<p style="margin-left:29%; margin-top: 1em">If set, the
four-digit year will be logged in the (non-syslog)
<b>sudo</b> log file. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">long_otp_prompt</p>

<p style="margin-left:29%; margin-top: 1em">When validating
with a One Time Password (OTP) scheme such as <b>S/Key</b>
or <b>OPIE</b>, a two-line prompt is used to make it easier
to cut and paste the challenge to a local window. It&rsquo;s
not as pretty as the default but some people find it more
convenient. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">mail_all_cmnds</p>

<p style="margin-left:29%; margin-top: 1em">Send mail to
the <i>mailto</i> user every time a user attempts to run a
command via <b>sudo</b> (this includes <b>sudoedit</b>). No
mail will be sent if the user runs <b>sudo</b> with the
<b>-l</b> or <b>-v</b> option unless there is an
authentication error and the <i>mail_badpass</i> flag is
also set. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">mail_always</p>

<p style="margin-left:29%; margin-top: 1em">Send mail to
the <i>mailto</i> user every time a user runs <b>sudo</b>.
This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">mail_badpass</p>

<p style="margin-left:29%; margin-top: 1em">Send mail to
the <i>mailto</i> user if the user running <b>sudo</b> does
not enter the correct password. If the command the user is
attempting to run is not permitted by <b>sudoers</b> and one
of the <i>mail_all_cmnds</i>, <i>mail_always</i>,
<i>mail_no_host</i>, <i>mail_no_perms</i> or
<i>mail_no_user</i> flags are set, this flag will have no
effect. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">mail_no_host</p>

<p style="margin-left:29%; margin-top: 1em">If set, mail
will be sent to the <i>mailto</i> user if the invoking user
exists in the <i>sudoers</i> file, but is not allowed to run
commands on the current host. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">mail_no_perms</p>

<p style="margin-left:29%; margin-top: 1em">If set, mail
will be sent to the <i>mailto</i> user if the invoking user
is allowed to use <b>sudo</b> but the command they are
trying is not listed in their <i>sudoers</i> file entry or
is explicitly denied. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">mail_no_user</p>

<p style="margin-left:29%; margin-top: 1em">If set, mail
will be sent to the <i>mailto</i> user if the invoking user
is not in the <i>sudoers</i> file. This flag is <i>on</i> by
default.</p>

<p style="margin-top: 1em">match_group_by_gid</p>

<p style="margin-left:29%;">By default, <b>sudoers</b> will
look up each group the user is a member of by group-ID to
determine the group name (this is only done once). The
resulting list of the user&rsquo;s group names is used when
matching groups listed in the <i>sudoers</i> file. This
works well on systems where the number of groups listed in
the <i>sudoers</i> file is larger than the number of groups
a typical user belongs to. On systems where group lookups
are slow, where users may belong to a large number of
groups, and where the number of groups listed in the
<i>sudoers</i> file is relatively small, it may be
prohibitively expensive and running commands via <b>sudo</b>
may take longer than normal. On such systems it may be
faster to use the <i>match_group_by_gid</i> flag to avoid
resolving the user&rsquo;s group-IDs to group names. In this
case, <b>sudoers</b> must look up any group name listed in
the <i>sudoers</i> file and use the group-ID instead of the
group name when determining whether the user is a member of
the group.</p>

<p style="margin-left:29%; margin-top: 1em">Note that if
<i>match_group_by_gid</i> is enabled, group database lookups
performed by <b>sudoers</b> will be keyed by group name as
opposed to group-ID. On systems where there are multiple
sources for the group database, it is possible to have
conflicting group names or group-IDs in the local
<i>/etc/group</i> file and the remote group database. On
such systems, enabling or disabling
<i>match_group_by_gid</i> can be used to choose whether
group database queries are performed by name (enabled) or ID
(disabled), which may aid in working around group entry
conflicts.</p>

<p style="margin-left:29%; margin-top: 1em">The
<i>match_group_by_gid</i> flag has no effect when
<i>sudoers</i> data is stored in LDAP. This flag is
<i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.18 or higher.</p>

<p style="margin-top: 1em">intercept</p>

<p style="margin-left:29%; margin-top: 1em">If set, all
commands run via <b>sudo</b> will behave as if the INTERCEPT
tag has been set, unless overridden by an NOINTERCEPT tag.
See the description of <i>INTERCEPT and NOINTERCEPT</i>
above as well as the <i>Preventing shell escapes</i> section
at the end of this manual. This flag is <i>off</i> by
default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.8 or higher and is
incompatible with SELinux RBAC support.</p>

<p style="margin-top: 1em">intercept_allow_setid</p>

<p style="margin-left:29%;">On most systems, the dynamic
loader will ignore LD_PRELOAD (or the equivalent) when
running set-user-ID and set-group-ID programs, effectively
disabling intercept mode. To prevent this from happening,
<b>sudoers</b> will not permit a set-user-ID or set-group-ID
program to be run in intercept mode unless
<i>intercept_allow_setid</i> is set. This flag has no effect
unless the <i>intercept</i> flag is enabled or the
<i>INTERCEPT</i> tag has been set for the command. This flag
is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.8 or higher.</p>

<p style="margin-top: 1em">intercept_authenticate</p>

<p style="margin-left:29%;">If set, commands run by an
intercepted process must be authenticated when the
user&rsquo;s time stamp is not current. For example, if a
shell is run with <i>intercept</i> enabled, as soon as the
invoking user&rsquo;s time stamp is out of date, subsequent
commands will need to be authenticated. This flag has no
effect unless the <i>intercept</i> flag is enabled or the
<i>INTERCEPT</i> tag has been set for the command. This flag
is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.8 or higher.</p>

<p style="margin-top: 1em">netgroup_tuple</p>

<p style="margin-left:29%; margin-top: 1em">If set,
netgroup lookups will be performed using the full netgroup
tuple: host name, user name, and domain (if one is set).
Historically, <b>sudo</b> only matched the user name and
domain for netgroups used in a User_List and only matched
the host name and domain for netgroups used in a Host_List.
This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">noexec</p>

<p style="margin-left:29%; margin-top: 1em">If set, all
commands run via <b>sudo</b> will behave as if the NOEXEC
tag has been set, unless overridden by an EXEC tag. See the
description of <i>EXEC and NOEXEC</i> above as well as the
<i>Preventing shell escapes</i> section at the end of this
manual. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">pam_acct_mgmt</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <b>sudo</b> will perform PAM
account validation for the invoking user by default. The
actual checks performed depend on which PAM modules are
configured. If enabled, account validation will be performed
regardless of whether or not a password is required. This
flag is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.28 or higher.</p>

<p style="margin-top: 1em">pam_rhost</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <b>sudo</b> will set the PAM
remote host value to the name of the local host when the
<i>pam_rhost</i> flag is enabled. On Linux systems, enabling
<i>pam_rhost</i> may result in DNS lookups of the local host
name when PAM is initialized. On Solaris versions prior to
Solaris 8, <i>pam_rhost</i> must be enabled if
<i>pam_ruser</i> is also enabled to avoid a crash in the
Solaris PAM implementation.</p>

<p style="margin-left:29%; margin-top: 1em">This flag is
<i>off</i> by default on systems other than Solaris.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">pam_ruser</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <b>sudo</b> will set the PAM
remote user value to the name of the user that invoked sudo
when the <i>pam_ruser</i> flag is enabled. This flag is
<i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">pam_session</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <b>sudo</b> will create a new
PAM session for the command to be run in. Unless <b>sudo</b>
is given the <b>-i</b> or <b>-s</b> options, PAM session
modules are run with the &ldquo;silent&rdquo; flag enabled.
This prevents last login information from being displayed
for every command on some systems. Disabling
<i>pam_session</i> may be needed on older PAM
implementations or on operating systems where opening a PAM
session changes the utmp or wtmp files. If PAM session
support is disabled, resource limits may not be updated for
the command being run. If <i>pam_session</i>,
<i>pam_setcred</i>, and <i>use_pty</i> are disabled,
<i>log_servers</i> has not been set and I/O logging has not
been configured, <b>sudo</b> will execute the command
directly instead of running it as a child process. This flag
is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.7 or higher.</p>

<p style="margin-top: 1em">pam_setcred</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <b>sudo</b> will attempt to
establish credentials for the target user by default, if
supported by the underlying authentication system. One
example of a credential is a Kerberos ticket. If
<i>pam_session</i>, <i>pam_setcred</i>, and <i>use_pty</i>
are disabled, <i>log_servers</i> has not been set and I/O
logging has not been configured, <b>sudo</b> will execute
the command directly instead of running it as a child
process. This flag is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.8 or higher.</p>

<p style="margin-top: 1em">passprompt_override</p>

<p style="margin-left:29%;">If set, the prompt specified by
<i>passprompt</i> or the SUDO_PROMPT environment variable
will always be used and will replace the prompt provided by
a PAM module or other authentication method. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">path_info</p>

<p style="margin-left:29%; margin-top: 1em">Normally,
<b>sudo</b> will tell the user when a command could not be
found in their PATH environment variable. Some sites may
wish to disable this as it could be used to gather
information on the location of executables that the normal
user does not have access to. The disadvantage is that if
the executable is simply not in the user&rsquo;s PATH,
<b>sudo</b> will tell the user that they are not allowed to
run it, which can be confusing. This flag is <i>on</i> by
default.</p>

<p style="margin-top: 1em">preserve_groups</p>

<p style="margin-left:29%; margin-top: 1em">By default,
<b>sudo</b> will initialize the group vector to the list of
groups the target user is in. When <i>preserve_groups</i> is
set, the user&rsquo;s existing group vector is left
unaltered. The real and effective group-IDs, however, are
still set to match the target user. This flag is <i>off</i>
by default.</p>

<p style="margin-top: 1em">pwfeedback</p>

<p style="margin-left:29%; margin-top: 1em">By default,
<b>sudo</b> reads the password like most other Unix
programs, by turning off echo until the user hits the return
(or enter) key. Some users become confused by this as it
appears to them that <b>sudo</b> has hung at this point.
When <i>pwfeedback</i> is set, <b>sudo</b> will provide
visual feedback when the user presses a key. Note that this
does have a security impact as an onlooker may be able to
determine the length of the password being entered. This
flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">requiretty</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will only run when the user is logged in to a
real tty. When this flag is set, <b>sudo</b> can only be run
from a login session and not via other means such as cron(8)
or cgi-bin scripts. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">root_sudo</p>

<p style="margin-left:29%; margin-top: 1em">If set, root is
allowed to run <b>sudo</b> too. Disabling this prevents
users from &ldquo;chaining&rdquo; <b>sudo</b> commands to
get a root shell by doing something like &ldquo;sudo sudo
/bin/sh&rdquo;. Note, however, that turning off
<i>root_sudo</i> will also prevent root from running
<b>sudoedit</b>. Disabling <i>root_sudo</i> provides no real
additional security; it exists purely for historical
reasons. This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">rootpw</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will prompt for the root password instead of the
password of the invoking user when running a command or
editing a file. This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">runas_allow_unknown_id</p>

<p style="margin-left:29%;">If enabled, allow matching of
runas user and group IDs that are not present in the
password or group databases. In addition to explicitly
matching unknown user or group IDs in a Runas_List, this
option also allows the <b>ALL</b> alias to match unknown
IDs. This flag is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.30 or higher. Older versions
of <b>sudo</b> always allowed matching of unknown user and
group IDs.</p>

<p style="margin-top: 1em">runas_check_shell</p>

<p style="margin-left:29%;">If enabled, <b>sudo</b> will
only run commands as a user whose shell appears in the
<i>/etc/shells</i> file, even if the invoking user&rsquo;s
Runas_List would otherwise permit it. If no
<i>/etc/shells</i> file is present, a system-dependent list
of built-in default shells is used. On many operating
systems, system users such as &ldquo;bin&rdquo;, do not have
a valid shell and this flag can be used to prevent commands
from being run as those users. This flag is <i>off</i> by
default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.30 or higher.</p>

<p style="margin-top: 1em">runaspw</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will prompt for the password of the user defined
by the <i>runas_default</i> option (defaults to root)
instead of the password of the invoking user when running a
command or editing a file. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">selinux</p>

<p style="margin-left:29%; margin-top: 1em">If enabled, the
user may specify an SELinux role and/or type to use when
running the command, as permitted by the SELinux policy. If
SELinux is disabled on the system, this flag has no effect.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">set_home</p>

<p style="margin-left:29%; margin-top: 1em">If enabled and
<b>sudo</b> is invoked with the <b>-s</b> option, the HOME
environment variable will be set to the home directory of
the target user (which is the root user unless the <b>-u</b>
option is used). This flag is largely obsolete and has no
effect unless the <i>env_reset</i> flag has been disabled or
HOME is present in the <i>env_keep</i> list, both of which
are strongly discouraged. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">set_logname</p>

<p style="margin-left:29%; margin-top: 1em">Normally,
<b>sudo</b> will set the LOGNAME and USER environment
variables to the name of the target user (usually root
unless the <b>-u</b> option is given). However, since some
programs (including the RCS revision control system) use
LOGNAME to determine the real identity of the user, it may
be desirable to change this behavior. This can be done by
negating the set_logname option. Note that
<i>set_logname</i> will have no effect if the
<i>env_reset</i> option has not been disabled and the
<i>env_keep</i> list contains LOGNAME or USER. This flag is
<i>on</i> by default.</p>

<p style="margin-top: 1em">set_utmp</p>

<p style="margin-left:29%; margin-top: 1em">When enabled,
<b>sudo</b> will create an entry in the utmp (or utmpx) file
when a pseudo-terminal is allocated. A pseudo-terminal is
allocated by <b>sudo</b> when it is running in a terminal
and one or more of the <i>log_input</i>, <i>log_output</i>,
or <i>use_pty</i> flags is enabled. By default, the new
entry will be a copy of the user&rsquo;s existing utmp entry
(if any), with the tty, time, type, and pid fields updated.
This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">setenv</p>

<p style="margin-left:29%; margin-top: 1em">Allow the user
to disable the <i>env_reset</i> option from the command line
via the <b>-E</b> option. Additionally, environment
variables set via the command line are not subject to the
restrictions imposed by <i>env_check</i>, <i>env_delete</i>,
or <i>env_keep</i>. As such, only trusted users should be
allowed to set variables in this manner. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">shell_noargs</p>

<p style="margin-left:29%; margin-top: 1em">If set and
<b>sudo</b> is invoked with no arguments it acts as if the
<b>-s</b> option had been given. That is, it runs a shell as
root (the shell is determined by the SHELL environment
variable if it is set, falling back on the shell listed in
the invoking user&rsquo;s /etc/passwd entry if not). This
flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">stay_setuid</p>

<p style="margin-left:29%; margin-top: 1em">Normally, when
<b>sudo</b> executes a command the real and effective
user-IDs are set to the target user (root by default). This
option changes that behavior such that the real user-ID is
left as the invoking user&rsquo;s user-ID. In other words,
this makes <b>sudo</b> act as a set-user-ID wrapper. This
can be useful on systems that disable some potentially
dangerous functionality when a program is run set-user-ID.
This option is only effective on systems that support either
the setreuid(2) or setresuid(2) system call. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">sudoedit_checkdir</p>

<p style="margin-left:29%;">If set, <b>sudoedit</b> will
check all directory components of the path to be edited for
writability by the invoking user. Symbolic links will not be
followed in writable directories and <b>sudoedit</b> will
refuse to edit a file located in a writable directory. These
restrictions are not enforced when <b>sudoedit</b> is run by
root. On some systems, if all directory components of the
path to be edited are not readable by the target user,
<b>sudoedit</b> will be unable to edit the file. This flag
is <i>on</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting
was first introduced in version 1.8.15 but initially
suffered from a race condition. The check for symbolic links
in writable intermediate directories was added in version
1.8.16.</p>

<p style="margin-top: 1em">sudoedit_follow</p>

<p style="margin-left:29%; margin-top: 1em">By default,
<b>sudoedit</b> will not follow symbolic links when opening
files. The <i>sudoedit_follow</i> option can be enabled to
allow <b>sudoedit</b> to open symbolic links. It may be
overridden on a per-command basis by the <i>FOLLOW</i> and
<i>NOFOLLOW</i> tags. This flag is <i>off</i> by
default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.15 or higher.</p>

<p style="margin-top: 1em">syslog_pid</p>

<p style="margin-left:29%; margin-top: 1em">When logging
via syslog(3), include the process ID in the log entry. This
flag is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.21 or higher.</p>

<p style="margin-top: 1em">targetpw</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will prompt for the password of the user
specified by the <b>-u</b> option (defaults to root) instead
of the password of the invoking user when running a command
or editing a file. Note that this flag precludes the use of
a user-ID not listed in the passwd database as an argument
to the <b>-u</b> option. This flag is <i>off</i> by
default.</p>

<p style="margin-top: 1em">tty_tickets</p>

<p style="margin-left:29%; margin-top: 1em">If set, users
must authenticate on a per-tty basis. With this flag
enabled, <b>sudo</b> will use a separate record in the time
stamp file for each terminal. If disabled, a single record
is used for all login sessions.</p>

<p style="margin-left:29%; margin-top: 1em">This option has
been superseded by the <i>timestamp_type</i> option.</p>

<p style="margin-top: 1em">umask_override</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will set the umask as specified in the
<i>sudoers</i> file without modification. This makes it
possible to specify a umask in the <i>sudoers</i> file that
is more permissive than the user&rsquo;s own umask and
matches historical behavior. If <i>umask_override</i> is not
set, <b>sudo</b> will set the umask to be the union of the
user&rsquo;s umask and what is specified in <i>sudoers</i>.
This flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">use_netgroups</p>

<p style="margin-left:29%; margin-top: 1em">If set,
netgroups (prefixed with &rsquo;+&rsquo;), may be used in
place of a user or host. For LDAP-based sudoers, netgroup
support requires an expensive sub-string match on the server
unless the <b>NETGROUP_BASE</b> directive is present in the
<i>/etc/ldap.conf</i> file. If netgroups are not needed,
this option can be disabled to reduce the load on the LDAP
server. This flag is <i>on</i> by default.</p>

<p style="margin-top: 1em">use_pty</p>

<p style="margin-left:29%; margin-top: 1em">If set, and
<b>sudo</b> is running in a terminal, the command will be
run in a pseudo-terminal (even if no I/O logging is being
done). If the <b>sudo</b> process is not attached to a
terminal, <i>use_pty</i> has no effect.</p>

<p style="margin-left:29%; margin-top: 1em">A malicious
program run under <b>sudo</b> may be capable of injecting
commands into the user&rsquo;s terminal or running a
background process that retains access to the user&rsquo;s
terminal device even after the main program has finished
executing. By running the command in a separate
pseudo-terminal, this attack is no longer possible. This
flag is <i>off</i> by default.</p>

<p style="margin-top: 1em">user_command_timeouts</p>

<p style="margin-left:29%;">If set, the user may specify a
timeout on the command line. If the timeout expires before
the command has exited, the command will be terminated. If a
timeout is specified both in the <i>sudoers</i> file and on
the command line, the smaller of the two timeouts will be
used. See the Timeout_Spec section for a description of the
timeout syntax. This flag is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.20 or higher.</p>

<p style="margin-top: 1em">utmp_runas</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will store the name of the runas user when
updating the utmp (or utmpx) file. By default, <b>sudo</b>
stores the name of the invoking user. This flag is
<i>off</i> by default.</p>

<p style="margin-top: 1em">visiblepw</p>

<p style="margin-left:29%; margin-top: 1em">By default,
<b>sudo</b> will refuse to run if the user must enter a
password but it is not possible to disable echo on the
terminal. If the <i>visiblepw</i> flag is set, <b>sudo</b>
will prompt for a password even when it would be visible on
the screen. This makes it possible to run things like
&ldquo;ssh somehost sudo ls&rdquo; since by default, ssh(1)
does not allocate a tty when running a command. This flag is
<i>off</i> by default.</p>


<p style="margin-left:6%; margin-top: 1em"><b>Integers</b>:</p>

<p style="margin-top: 1em">closefrom</p>

<p style="margin-left:29%; margin-top: 1em">Before it
executes a command, <b>sudo</b> will close all open file
descriptors other than standard input, standard output, and
standard error (file descriptors 0-2). The <i>closefrom</i>
option can be used to specify a different file descriptor at
which to start closing. The default is 3.</p>

<p style="margin-top: 1em">command_timeout</p>

<p style="margin-left:29%; margin-top: 1em">The maximum
amount of time a command is allowed to run before it is
terminated. See the Timeout_Spec section for a description
of the timeout syntax.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.20 or higher.</p>

<p style="margin-top: 1em">log_server_timeout</p>

<p style="margin-left:29%;">The maximum amount of time to
wait when connecting to a log server or waiting for a server
response. See the Timeout_Spec section for a description of
the timeout syntax. The default value is 30 seconds.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">maxseq</p>

<p style="margin-left:29%; margin-top: 1em">The maximum
sequence number that will be substituted for the
&ldquo;%{seq}&rdquo; escape in the I/O log file (see the
<i>iolog_dir</i> description below for more information).
While the value substituted for &ldquo;%{seq}&rdquo; is in
base 36, <i>maxseq</i> itself should be expressed in
decimal. Values larger than 2176782336 (which corresponds to
the base 36 sequence number &ldquo;ZZZZZZ&rdquo;) will be
silently truncated to 2176782336. The default value is
2176782336.</p>

<p style="margin-left:29%; margin-top: 1em">Once the local
sequence number reaches the value of <i>maxseq</i>, it will
&ldquo;roll over&rdquo; to zero, after which <b>sudoers</b>
will truncate and re-use any existing I/O log path
names.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.7 or higher.</p>

<p style="margin-top: 1em">passwd_tries</p>

<p style="margin-left:29%; margin-top: 1em">The number of
tries a user gets to enter his/her password before
<b>sudo</b> logs the failure and exits. The default is
3.</p>

<p style="margin-top: 1em">syslog_maxlen</p>

<p style="margin-left:29%; margin-top: 1em">On many
systems, syslog(3) has a relatively small log buffer. IETF
RFC 5424 states that syslog servers must support messages of
at least 480 bytes and should support messages up to 2048
bytes. By default, <b>sudoers</b> creates log messages up to
980 bytes which corresponds to the historic BSD syslog
implementation which used a 1024 byte buffer to store the
message, date, hostname, and program name. To prevent syslog
messages from being truncated, <b>sudoers</b> will split up
log messages that are larger than <i>syslog_maxlen</i>
bytes. When a message is split, additional parts will
include the string &ldquo;(command continued)&rdquo; after
the user name and before the continued command line
arguments.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.19 or higher.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Integers that
can be used in a boolean context</b>:</p>

<p style="margin-top: 1em">loglinelen</p>

<p style="margin-left:29%; margin-top: 1em">Number of
characters per line for the file log. This value is used to
decide when to wrap lines for nicer log files. This has no
effect on the syslog log file, only the file log. The
default is 80 (use 0 or negate the option to disable word
wrap).</p>

<p style="margin-top: 1em">passwd_timeout</p>

<p style="margin-left:29%; margin-top: 1em">Number of
minutes before the <b>sudo</b> password prompt times out, or
0 for no timeout. The timeout may include a fractional
component if minute granularity is insufficient, for example
2.5. The default is 0.</p>

<p style="margin-top: 1em">timestamp_timeout</p>

<p style="margin-left:29%;">Number of minutes that can
elapse before <b>sudo</b> will ask for a passwd again. The
timeout may include a fractional component if minute
granularity is insufficient, for example 2.5. The default is
15. Set this to 0 to always prompt for a password. If set to
a value less than 0 the user&rsquo;s time stamp will not
expire until the system is rebooted. This can be used to
allow users to create or delete their own time stamps via
&ldquo;sudo -v&rdquo; and &ldquo;sudo -k&rdquo;
respectively.</p>

<p style="margin-top: 1em">umask</p>

<p style="margin-left:29%; margin-top: 1em">File mode
creation mask to use when running the command. Negate this
option or set it to 0777 to prevent <b>sudoers</b> from
changing the umask. Unless the <i>umask_override</i> flag is
set, the actual umask will be the union of the user&rsquo;s
umask and the value of the <i>umask</i> setting, which
defaults to 0022. This guarantees that <b>sudo</b> never
lowers the umask when running a command.</p>

<p style="margin-left:29%; margin-top: 1em">If <i>umask</i>
is explicitly set in <i>sudoers</i>, it will override any
umask setting in PAM or login.conf. If <i>umask</i> is not
set in <i>sudoers</i>, the umask specified by PAM or
login.conf will take precedence. The umask setting in PAM is
not used for <b>sudoedit</b>, which does not create a new
PAM session.</p>


<p style="margin-left:6%; margin-top: 1em"><b>Strings</b>:</p>

<p style="margin-top: 1em">authfail_message</p>

<p style="margin-left:29%; margin-top: 1em">Message that is
displayed after a user fails to authenticate. The message
may include the &rsquo;%d&rsquo; escape which will expand to
the number of failed password attempts. If set, it overrides
the default message, %d incorrect password attempt(s).</p>

<p style="margin-top: 1em">badpass_message</p>

<p style="margin-left:29%; margin-top: 1em">Message that is
displayed if a user enters an incorrect password. The
default is Sorry, try again. unless insults are enabled.</p>

<p style="margin-top: 1em">editor</p>

<p style="margin-left:29%; margin-top: 1em">A colon
(&rsquo;:&rsquo;) separated list of editors path names used
by <b>sudoedit</b> and <b>visudo</b>. For <b>sudoedit</b>,
this list is used to find an editor when none of the
SUDO_EDITOR, VISUAL or EDITOR environment variables are set
to an editor that exists and is executable. For
<b>visudo</b>, it is used as a white list of allowed
editors; <b>visudo</b> will choose the editor that matches
the user&rsquo;s SUDO_EDITOR, VISUAL or EDITOR environment
variable if possible, or the first editor in the list that
exists and is executable if not. Unless invoked as
<b>sudoedit</b>, <b>sudo</b> does not preserve the
SUDO_EDITOR, VISUAL or EDITOR environment variables unless
they are present in the <i>env_keep</i> list or the
<i>env_reset</i> option is disabled. The default is
<i>/usr/bin/editor</i>.</p>

<p style="margin-top: 1em">iolog_dir</p>

<p style="margin-left:29%; margin-top: 1em">The top-level
directory to use when constructing the path name for the
input/output log directory. Only used if the
<i>log_input</i> or <i>log_output</i> options are enabled or
when the LOG_INPUT or LOG_OUTPUT tags are present for a
command. The session sequence number, if any, is stored in
the directory. The default is <i>/var/log/sudo-io</i>.</p>

<p style="margin-left:29%; margin-top: 1em">The following
percent (&rsquo;%&rsquo;) escape sequences are
supported:</p>

<p style="margin-top: 1em">%{seq}</p>

<p style="margin-left:37%;">expanded to a monotonically
increasing base-36 sequence number, such as 0100A5, where
every two digits are used to form a new directory, e.g.,
<i>01/00/A5</i></p>

<p style="margin-top: 1em">%{user}</p>

<p style="margin-left:37%;">expanded to the invoking
user&rsquo;s login name</p>

<p style="margin-top: 1em">%{group}</p>

<p style="margin-left:37%;">expanded to the name of the
invoking user&rsquo;s real group-ID</p>

<p style="margin-top: 1em">%{runas_user}</p>

<p style="margin-left:37%;">expanded to the login name of
the user the command will be run as (e.g., root)</p>

<p style="margin-top: 1em">%{runas_group}</p>

<p style="margin-left:37%;">expanded to the group name of
the user the command will be run as (e.g., wheel)</p>

<p style="margin-top: 1em">%{hostname}</p>

<p style="margin-left:37%;">expanded to the local host name
without the domain name</p>

<p style="margin-top: 1em">%{command}</p>

<p style="margin-left:37%;">expanded to the base name of
the command being run</p>

<p style="margin-left:29%; margin-top: 1em">In addition,
any escape sequences supported by the system&rsquo;s
strftime(3) function will be expanded.</p>

<p style="margin-left:29%; margin-top: 1em">To include a
literal &rsquo;%&rsquo; character, the string
&rsquo;%%&rsquo; should be used.</p>

<p style="margin-top: 1em">iolog_file</p>

<p style="margin-left:29%; margin-top: 1em">The path name,
relative to <i>iolog_dir</i>, in which to store input/output
logs when the <i>log_input</i> or <i>log_output</i> options
are enabled or when the LOG_INPUT or LOG_OUTPUT tags are
present for a command. Note that <i>iolog_file</i> may
contain directory components. The default is
&ldquo;%{seq}&rdquo;.</p>

<p style="margin-left:29%; margin-top: 1em">See the
<i>iolog_dir</i> option above for a list of supported
percent (&rsquo;%&rsquo;) escape sequences.</p>

<p style="margin-left:29%; margin-top: 1em">In addition to
the escape sequences, path names that end in six or more Xs
will have the Xs replaced with a unique combination of
digits and letters, similar to the mktemp(3) function.</p>

<p style="margin-left:29%; margin-top: 1em">If the path
created by concatenating <i>iolog_dir</i> and
<i>iolog_file</i> already exists, the existing I/O log file
will be truncated and overwritten unless <i>iolog_file</i>
ends in six or more Xs.</p>

<p style="margin-top: 1em">iolog_flush</p>

<p style="margin-left:29%; margin-top: 1em">If set,
<b>sudo</b> will flush I/O log data to disk after each write
instead of buffering it. This makes it possible to view the
logs in real-time as the program is executing but may
significantly reduce the effectiveness of I/O log
compression. This flag is <i>off</i> by default.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.20 or higher.</p>

<p style="margin-top: 1em">iolog_group</p>

<p style="margin-left:29%; margin-top: 1em">The group name
to look up when setting the group-ID on new I/O log files
and directories. If <i>iolog_group</i> is not set, the
primary group-ID of the user specified by <i>iolog_user</i>
is used. If neither <i>iolog_group</i> nor <i>iolog_user</i>
are set, I/O log files and directories are created with
group-ID 0.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.19 or higher.</p>

<p style="margin-top: 1em">iolog_mode</p>

<p style="margin-left:29%; margin-top: 1em">The file mode
to use when creating I/O log files. Mode bits for read and
write permissions for owner, group, or other are honored,
everything else is ignored. The file permissions will always
include the owner read and write bits, even if they are not
present in the specified mode. When creating I/O log
directories, search (execute) bits are added to match the
read and write bits specified by <i>iolog_mode</i>. Defaults
to 0600 (read and write by user only).</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.19 or higher.</p>

<p style="margin-top: 1em">iolog_user</p>

<p style="margin-left:29%; margin-top: 1em">The user name
to look up when setting the user and group-IDs on new I/O
log files and directories. If <i>iolog_group</i> is set, it
will be used instead of the user&rsquo;s primary group-ID.
By default, I/O log files and directories are created with
user and group-ID 0.</p>

<p style="margin-left:29%; margin-top: 1em">This setting
can be useful when the I/O logs are stored on a Network File
System (NFS) share. Having a dedicated user own the I/O log
files means that <b>sudoers</b> does not write to the log
files as user-ID 0, which is usually not permitted by
NFS.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.19 or higher.</p>

<p style="margin-top: 1em">lecture_status_dir</p>

<p style="margin-left:29%;">The directory in which
<b>sudo</b> stores per-user lecture status files. Once a
user has received the lecture, a zero-length file is created
in this directory so that <b>sudo</b> will not lecture the
user again. This directory should <i>not</i> be cleared when
the system reboots. The default is
<i>/var/lib/sudo/lectured</i>.</p>

<p style="margin-top: 1em">log_server_cabundle</p>

<p style="margin-left:29%;">The path to a certificate
authority bundle file, in PEM format, to use instead of the
system&rsquo;s default certificate authority database when
authenticating the log server. The default is to use the
system&rsquo;s default certificate authority database. This
setting has no effect unless <i>log_servers</i> is set and
the remote log server is secured with TLS.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">log_server_peer_cert</p>

<p style="margin-left:29%;">The path to the <b>sudo</b>
client&rsquo;s certificate file, in PEM format. This setting
is required when the remote log server is secured with TLS
and client certificate validation is enabled. For
<b>sudo_logsrvd</b>, client certificate validation is
controlled by the <i>tls_checkpeer</i> option, which
defaults to <i>false</i>.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">log_server_peer_key</p>

<p style="margin-left:29%;">The path to the <b>sudo</b>
client&rsquo;s private key file, in PEM format. This setting
is required when the remote log server is secured with TLS
and client certificate validation is enabled. For
<b>sudo_logsrvd</b>, client certificate validation is
controlled by the <i>tls_checkpeer</i> option, which
defaults to <i>false</i>.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em">mailsub</p>

<p style="margin-left:29%; margin-top: 1em">Subject of the
mail sent to the <i>mailto</i> user. The escape %h will
expand to the host name of the machine. Default is
&ldquo;*** SECURITY information for %h ***&rdquo;.</p>

<p style="margin-top: 1em">noexec_file</p>

<p style="margin-left:29%; margin-top: 1em">As of
<b>sudo</b> version 1.8.1 this option is no longer
supported. The path to the noexec file should now be set in
the sudo.conf(5) file.</p>

<p style="margin-top: 1em">pam_askpass_service</p>

<p style="margin-left:29%;">On systems that use PAM for
authentication, this is the service name used when the
<b>-A</b> option is specified. The default value is either
&ldquo;@pam_service@&rdquo; or &ldquo;sudo-i&rdquo;,
depending on whether or not the <b>-i</b> option is also
specified. See the description of <i>pam_service</i> for
more information.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.9 or higher.</p>

<p style="margin-top: 1em">pam_login_service</p>

<p style="margin-left:29%;">On systems that use PAM for
authentication, this is the service name used when the
<b>-i</b> option is specified. The default value is
&ldquo;sudo-i&rdquo;. See the description of
<i>pam_service</i> for more information.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.8 or higher.</p>

<p style="margin-top: 1em">pam_service</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, the service name specifies the
PAM policy to apply. This usually corresponds to an entry in
the <i>pam.conf</i> file or a file in the <i>/etc/pam.d</i>
directory. The default value is &ldquo;sudo&rdquo;.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.8 or higher.</p>

<p style="margin-top: 1em">passprompt</p>

<p style="margin-left:29%; margin-top: 1em">The default
prompt to use when asking for a password; can be overridden
via the <b>-p</b> option or the SUDO_PROMPT environment
variable. The following percent (&rsquo;%&rsquo;) escape
sequences are supported:</p>

<p style="margin-top: 1em">%H</p>

<p style="margin-left:37%; margin-top: 1em">expanded to the
local host name including the domain name (only if the
machine&rsquo;s host name is fully qualified or the
<i>fqdn</i> option is set)</p>

<p style="margin-top: 1em">%h</p>

<p style="margin-left:37%; margin-top: 1em">expanded to the
local host name without the domain name</p>

<p style="margin-top: 1em">%p</p>

<p style="margin-left:37%; margin-top: 1em">expanded to the
user whose password is being asked for (respects the
<i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags in
<i>sudoers</i>)</p>

<p style="margin-top: 1em">%U</p>

<p style="margin-left:37%; margin-top: 1em">expanded to the
login name of the user the command will be run as (defaults
to root)</p>

<p style="margin-top: 1em">%u</p>

<p style="margin-left:37%; margin-top: 1em">expanded to the
invoking user&rsquo;s login name</p>

<p style="margin-top: 1em">%%</p>

<p style="margin-left:37%; margin-top: 1em">two consecutive
% characters are collapsed into a single % character</p>

<p style="margin-left:29%; margin-top: 1em">On systems that
use PAM for authentication, <i>passprompt</i> will only be
used if the prompt provided by the PAM module matches the
string &ldquo;Password: &rdquo; or &ldquo;username&rsquo;s
Password: &rdquo;. This ensures that the <i>passprompt</i>
setting does not interfere with challenge-response style
authentication. The <i>passprompt_override</i> flag can be
used to change this behavior.</p>

<p style="margin-left:29%; margin-top: 1em">The default
value is &ldquo;[sudo] password for %p: &rdquo;.</p>

<p style="margin-top: 1em">role</p>

<p style="margin-left:29%; margin-top: 1em">The default
SELinux role to use when constructing a new security context
to run the command. The default role may be overridden on a
per-command basis in the <i>sudoers</i> file or via command
line options. This option is only available when <b>sudo</b>
is built with SELinux support.</p>

<p style="margin-top: 1em">runas_default</p>

<p style="margin-left:29%; margin-top: 1em">The default
user to run commands as if the <b>-u</b> option is not
specified on the command line. This defaults to root.</p>

<p style="margin-top: 1em">sudoers_locale</p>

<p style="margin-left:29%; margin-top: 1em">Locale to use
when parsing the sudoers file, logging commands, and sending
email. Note that changing the locale may affect how sudoers
is interpreted. Defaults to &ldquo;C&rdquo;.</p>

<p style="margin-top: 1em">timestamp_type</p>

<p style="margin-left:29%; margin-top: 1em"><b>sudoers</b>
uses per-user time stamp files for credential caching. The
<i>timestamp_type</i> option can be used to specify the type
of time stamp record used. It has the following possible
values:</p>

<p style="margin-top: 1em">global</p>

<p style="margin-left:40%; margin-top: 1em">A single time
stamp record is used for all of a user&rsquo;s login
sessions, regardless of the terminal or parent process ID.
An additional record is used to serialize password prompts
when <b>sudo</b> is used multiple times in a pipeline, but
this does not affect authentication.</p>

<p style="margin-top: 1em">ppid</p>

<p style="margin-left:40%; margin-top: 1em">A single time
stamp record is used for all processes with the same parent
process ID (usually the shell). Commands run from the same
shell (or other common parent process) will not require a
password for <i>timestamp_timeout</i> minutes (</p>

<p>15 by default ). Commands run via <b>sudo</b> with a
different parent process ID, for example from a shell
script, will be authenticated separately.</p>

<p style="margin-top: 1em">tty</p>

<p style="margin-left:40%; margin-top: 1em">One time stamp
record is used for each terminal, which means that a
user&rsquo;s login sessions are authenticated separately. If
no terminal is present, the behavior is the same as
<i>ppid</i>. Commands run from the same terminal will not
require a password for <i>timestamp_timeout</i> minutes
(</p>

<p>15 by default ).</p>

<p style="margin-top: 1em">kernel</p>

<p style="margin-left:40%; margin-top: 1em">The time stamp
is stored in the kernel as an attribute of the terminal
device. If no terminal is present, the behavior is the same
as <i>ppid</i>. Negative <i>timestamp_timeout</i> values are
not supported and positive values are limited to a maximum
of 60 minutes. This is currently only supported on
OpenBSD.</p>

<p style="margin-left:29%; margin-top: 1em">The default
value is <i>tty</i>.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.8.21 or higher.</p>

<p style="margin-top: 1em">timestampdir</p>

<p style="margin-left:29%; margin-top: 1em">The directory
in which <b>sudo</b> stores its time stamp files. This
directory should be cleared when the system reboots. The
default is <i>/run/sudo/ts</i>.</p>

<p style="margin-top: 1em">timestampowner</p>

<p style="margin-left:29%; margin-top: 1em">The owner of
the lecture status directory, time stamp directory and all
files stored therein. The default is root.</p>

<p style="margin-top: 1em">type</p>

<p style="margin-left:29%; margin-top: 1em">The default
SELinux type to use when constructing a new security context
to run the command. The default type may be overridden on a
per-command basis in the <i>sudoers</i> file or via command
line options. This option is only available when <b>sudo</b>
is built with SELinux support.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Strings that
can be used in a boolean context</b>:</p>

<p style="margin-top: 1em">admin_flag</p>

<p style="margin-left:24%; margin-top: 1em">The
<i>admin_flag</i> option specifies the path to a file that
is created the first time a user that is a member of the
<i>sudo</i> or <i>admin</i> groups runs <b>sudo</b>. Only
available if <b>sudo</b> is configured with the
--enable-admin-flag option. The default value is
~/.sudo_as_admin_successful.</p>

<p style="margin-top: 1em">env_file</p>

<p style="margin-left:24%; margin-top: 1em">The
<i>env_file</i> option specifies the fully qualified path to
a file containing variables to be set in the environment of
the program being run. Entries in this file should either be
of the form &ldquo;VARIABLE=value&rdquo; or &ldquo;export
VARIABLE=value&rdquo;. The value may optionally be enclosed
in single or double quotes. Variables in this file are only
added if the variable does not already exist in the
environment. This file is considered to be part of the
security policy, its contents are not subject to other
<b>sudo</b> environment restrictions such as <i>env_keep</i>
and <i>env_check</i>.</p>

<p style="margin-top: 1em">exempt_group</p>

<p style="margin-left:24%; margin-top: 1em">Users in this
group are exempt from password and PATH requirements. The
group name specified should not include a % prefix. This is
not set by default.</p>

<p style="margin-top: 1em">fdexec</p>

<p style="margin-left:24%; margin-top: 1em">Determines
whether <b>sudo</b> will execute a command by its path or by
an open file descriptor. It has the following possible
values:</p>

<p style="margin-top: 1em">always</p>

<p style="margin-left:35%; margin-top: 1em">Always execute
by file descriptor.</p>

<p style="margin-top: 1em">never</p>

<p style="margin-left:35%; margin-top: 1em">Never execute
by file descriptor.</p>

<p style="margin-top: 1em">digest_only</p>

<p style="margin-left:35%;">Only execute by file descriptor
if the command has an associated digest in the
<i>sudoers</i> file.</p>

<p style="margin-left:24%; margin-top: 1em">The default
value is <i>digest_only</i>. This avoids a time of check
versus time of use race condition when the command is
located in a directory writable by the invoking user.</p>

<p style="margin-left:24%; margin-top: 1em">Note that
<i>fdexec</i> will change the first element of the argument
vector for scripts ($0 in the shell) due to the way the
kernel runs script interpreters. Instead of being a normal
path, it will refer to a file descriptor. For example,
<i>/dev/fd/4</i> on Solaris and <i>/proc/self/fd/4</i> on
Linux. A workaround is to use the SUDO_COMMAND environment
variable instead.</p>

<p style="margin-left:24%; margin-top: 1em">The
<i>fdexec</i> setting is only used when the command is
matched by path name. It has no effect if the command is
matched by the built-in <b>ALL</b> alias.</p>

<p style="margin-left:24%; margin-top: 1em">This setting is
only supported by version 1.8.20 or higher. If the operating
system does not support the <b>fexecve</b>() system call,
this setting has no effect.</p>

<p style="margin-top: 1em">group_plugin</p>

<p style="margin-left:24%; margin-top: 1em">A string
containing a <b>sudoers</b> group plugin with optional
arguments. The string should consist of the plugin path,
either fully-qualified or relative to the
<i>/usr/libexec/sudo</i> directory, followed by any
configuration arguments the plugin requires. These arguments
(if any) will be passed to the plugin&rsquo;s initialization
function. If arguments are present, the string must be
enclosed in double quotes (&quot;&quot;).</p>

<p style="margin-left:24%; margin-top: 1em">For more
information see <i>GROUP PROVIDER PLUGINS</i>.</p>

<p style="margin-top: 1em">lecture</p>

<p style="margin-left:24%; margin-top: 1em">This option
controls when a short lecture will be printed along with the
password prompt. It has the following possible values:</p>

<p style="margin-top: 1em">always</p>

<p style="margin-left:35%; margin-top: 1em">Always lecture
the user.</p>

<p style="margin-top: 1em">never</p>

<p style="margin-left:35%; margin-top: 1em">Never lecture
the user.</p>

<p style="margin-top: 1em">once</p>

<p style="margin-left:35%; margin-top: 1em">Only lecture
the user the first time they run <b>sudo</b>.</p>

<p style="margin-left:24%; margin-top: 1em">If no value is
specified, a value of <i>once</i> is implied. Negating the
option results in a value of <i>never</i> being used. The
default value is <i>never</i>.</p>

<p style="margin-top: 1em">lecture_file</p>

<p style="margin-left:24%; margin-top: 1em">Path to a file
containing an alternate <b>sudo</b> lecture that will be
used in place of the standard lecture if the named file
exists. By default, <b>sudo</b> uses a built-in lecture.</p>

<p style="margin-top: 1em">listpw</p>

<p style="margin-left:24%; margin-top: 1em">This option
controls when a password will be required when a user runs
<b>sudo</b> with the <b>-l</b> option. It has the following
possible values:</p>

<p style="margin-top: 1em">all</p>

<p style="margin-left:37%; margin-top: 1em">All the
user&rsquo;s <i>sudoers</i> file entries for the current
host must have the NOPASSWD flag set to avoid entering a
password.</p>

<p style="margin-top: 1em">always</p>

<p style="margin-left:37%; margin-top: 1em">The user must
always enter a password to use the <b>-l</b> option.</p>

<p style="margin-top: 1em">any</p>

<p style="margin-left:37%; margin-top: 1em">At least one of
the user&rsquo;s <i>sudoers</i> file entries for the current
host must have the NOPASSWD flag set to avoid entering a
password.</p>

<p style="margin-top: 1em">never</p>

<p style="margin-left:37%; margin-top: 1em">The user need
never enter a password to use the <b>-l</b> option.</p>

<p style="margin-left:24%; margin-top: 1em">If no value is
specified, a value of <i>any</i> is implied. Negating the
option results in a value of <i>never</i> being used. The
default value is <i>any</i>.</p>

<p style="margin-top: 1em">log_format</p>

<p style="margin-left:24%; margin-top: 1em">The event log
format. Supported log formats are:</p>

<p style="margin-top: 1em">json</p>

<p style="margin-left:37%; margin-top: 1em">Logs in JSON
format. JSON log entries contain the full user details as
well as the execution environment if the command was
allowed. Due to limitations of the protocol, JSON events
sent via <i>syslog</i> may be truncated.</p>

<p style="margin-top: 1em">sudo</p>

<p style="margin-left:37%; margin-top: 1em">Traditional
sudo-style logs, see <i>LOG FORMAT</i> for a description of
the log file format.</p>

<p style="margin-left:24%; margin-top: 1em">This setting
affects logs sent via syslog(3) as well as the file
specified by the <i>logfile</i> setting, if any. The default
value is <i>sudo</i>.</p>

<p style="margin-top: 1em">logfile</p>

<p style="margin-left:24%; margin-top: 1em">Path to the
<b>sudo</b> log file (not the syslog log file). Setting a
path turns on logging to a file; negating this option turns
it off. By default, <b>sudo</b> logs via syslog.</p>

<p style="margin-top: 1em">mailerflags</p>

<p style="margin-left:24%; margin-top: 1em">Flags to use
when invoking mailer. Defaults to <b>-t</b>.</p>

<p style="margin-top: 1em">mailerpath</p>

<p style="margin-left:24%; margin-top: 1em">Path to mail
program used to send warning mail. Defaults to the path to
sendmail found at configure time.</p>

<p style="margin-top: 1em">mailfrom</p>

<p style="margin-left:24%; margin-top: 1em">Address to use
for the &ldquo;from&rdquo; address when sending warning and
error mail. The address should be enclosed in double quotes
(&quot;&quot;) to protect against <b>sudo</b> interpreting
the @ sign. Defaults to the name of the user running
<b>sudo</b>.</p>

<p style="margin-top: 1em">mailto</p>

<p style="margin-left:24%; margin-top: 1em">Address to send
warning and error mail to. The address should be enclosed in
double quotes (&quot;&quot;) to protect against <b>sudo</b>
interpreting the @ sign. Defaults to root.</p>

<p style="margin-top: 1em">rlimit_as</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
size to which the process&rsquo;s address space may grow (in
bytes), if supported by the operating system. See
<i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">rlimit_core</p>

<p style="margin-left:24%; margin-top: 1em">The largest
size core dump file that may be created (in bytes). See
<i>Resource limits</i> for more information. Defaults to 0
(no core dump created).</p>

<p style="margin-top: 1em">rlimit_cpu</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
amount of CPU time that the process may use (in seconds).
See <i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">rlimit_data</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
size of the data segment for the process (in bytes). See
<i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">rlimit_fsize</p>

<p style="margin-left:24%; margin-top: 1em">The largest
size file that the process may create (in bytes). See
<i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">rlimit_locks</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
number of locks that the process may establish, if supported
by the operating system. See <i>Resource limits</i> for more
information.</p>

<p style="margin-top: 1em">rlimit_memlock</p>

<p style="margin-left:24%;">The maximum size that the
process may lock in memory (in bytes), if supported by the
operating system. See <i>Resource limits</i> for more
information.</p>

<p style="margin-top: 1em">rlimit_nofile</p>

<p style="margin-left:24%;">The maximum number of files
that the process may have open. See <i>Resource limits</i>
for more information.</p>

<p style="margin-top: 1em">rlimit_nproc</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
number of processes that the user may run simultaneously.
See <i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">rlimit_rss</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
size to which the process&rsquo;s resident set size may grow
(in bytes). See <i>Resource limits</i> for more
information.</p>

<p style="margin-top: 1em">rlimit_stack</p>

<p style="margin-left:24%; margin-top: 1em">The maximum
size to which the process&rsquo;s stack may grow (in bytes).
See <i>Resource limits</i> for more information.</p>

<p style="margin-top: 1em">restricted_env_file</p>

<p style="margin-left:24%;">The <i>restricted_env_file</i>
option specifies the fully qualified path to a file
containing variables to be set in the environment of the
program being run. Entries in this file should either be of
the form &ldquo;VARIABLE=value&rdquo; or &ldquo;export
VARIABLE=value&rdquo;. The value may optionally be enclosed
in single or double quotes. Variables in this file are only
added if the variable does not already exist in the
environment. Unlike <i>env_file</i>, the file&rsquo;s
contents are not trusted and are processed in a manner
similar to that of the invoking user&rsquo;s environment. If
<i>env_reset</i> is enabled, variables in the file will only
be added if they are matched by either the <i>env_check</i>
or <i>env_keep</i> list. If <i>env_reset</i> is disabled,
variables in the file are added as long as they are not
matched by the <i>env_delete</i> list. In either case, the
contents of <i>restricted_env_file</i> are processed before
the contents of <i>env_file</i>.</p>

<p style="margin-top: 1em">runchroot</p>

<p style="margin-left:24%; margin-top: 1em">If set,
<b>sudo</b> will use this value for the root directory when
running a command. The special value &ldquo;*&rdquo; will
allow the user to specify the root directory via
<b>sudo</b>&rsquo;s <b>-R</b> option. See the
<i>Chroot_Spec</i> section for more details.</p>

<p style="margin-left:24%; margin-top: 1em">It is only
possible to use <i>runchroot</i> as a command-specific
Defaults setting if the command exists with the same path
both inside and outside the chroot jail. This restriction
does not apply to generic, host, or user-based Defaults
settings or to a <i>Cmnd_Spec</i> that includes a
<i>Chroot_Spec</i>.</p>

<p style="margin-left:24%; margin-top: 1em">This setting is
only supported by version 1.9.3 or higher.</p>

<p style="margin-top: 1em">runcwd</p>

<p style="margin-left:24%; margin-top: 1em">If set,
<b>sudo</b> will use this value for the working directory
when running a command. The special value &ldquo;*&rdquo;
will allow the user to specify the working directory via
<b>sudo</b>&rsquo;s <b>-D</b> option. See the
<i>Chdir_Spec</i> section for more details.</p>

<p style="margin-left:24%; margin-top: 1em">This setting is
only supported by version 1.9.3 or higher.</p>

<p style="margin-top: 1em">secure_path</p>

<p style="margin-left:24%; margin-top: 1em">If set,
<b>sudo</b> will use this value in place of the user&rsquo;s
PATH environment variable. This option can be used to reset
the PATH to a known good value that contains directories for
system administrator commands such as <i>/usr/sbin</i>.</p>

<p style="margin-left:24%; margin-top: 1em">Users in the
group specified by the <i>exempt_group</i> option are not
affected by <i>secure_path</i>. This option is not set by
default.</p>

<p style="margin-top: 1em">syslog</p>

<p style="margin-left:24%; margin-top: 1em">Syslog facility
if syslog is being used for logging (negate to disable
syslog logging). Defaults to authpriv.</p>

<p style="margin-left:24%; margin-top: 1em">The following
syslog facilities are supported: <b>authpriv</b> (if your OS
supports it), <b>auth</b>, <b>daemon</b>, <b>user</b>,
<b>local0</b>, <b>local1</b>, <b>local2</b>, <b>local3</b>,
<b>local4</b>, <b>local5</b>, <b>local6</b>, and
<b>local7</b>.</p>

<p style="margin-top: 1em">syslog_badpri</p>

<p style="margin-left:24%;">Syslog priority to use when the
user is not allowed to run a command or when authentication
is unsuccessful. Defaults to alert.</p>

<p style="margin-left:24%; margin-top: 1em">The following
syslog priorities are supported: <b>alert</b>, <b>crit</b>,
<b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>,
<b>notice</b>, <b>warning</b>, and <b>none</b>. Negating the
option or setting it to a value of <b>none</b> will disable
logging of unsuccessful commands.</p>

<p style="margin-top: 1em">syslog_goodpri</p>

<p style="margin-left:24%;">Syslog priority to use when the
user is allowed to run a command and authentication is
successful. Defaults to notice.</p>

<p style="margin-left:24%; margin-top: 1em">See
<i>syslog_badpri</i> for the list of supported syslog
priorities. Negating the option or setting it to a value of
<b>none</b> will disable logging of successful commands.</p>

<p style="margin-top: 1em">verifypw</p>

<p style="margin-left:24%; margin-top: 1em">This option
controls when a password will be required when a user runs
<b>sudo</b> with the <b>-v</b> option. It has the following
possible values:</p>

<p style="margin-top: 1em">all</p>

<p style="margin-left:35%; margin-top: 1em">All the
user&rsquo;s <i>sudoers</i> file entries for the current
host must have the NOPASSWD flag set to avoid entering a
password.</p>

<p style="margin-top: 1em">always</p>

<p style="margin-left:35%; margin-top: 1em">The user must
always enter a password to use the <b>-v</b> option.</p>

<p style="margin-top: 1em">any</p>

<p style="margin-left:35%; margin-top: 1em">At least one of
the user&rsquo;s <i>sudoers</i> file entries for the current
host must have the NOPASSWD flag set to avoid entering a
password.</p>

<p style="margin-top: 1em">never</p>

<p style="margin-left:35%; margin-top: 1em">The user need
never enter a password to use the <b>-v</b> option.</p>

<p style="margin-left:24%; margin-top: 1em">If no value is
specified, a value of <i>all</i> is implied. Negating the
option results in a value of <i>never</i> being used. The
default value is <i>all</i>.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Lists that
can be used in a boolean context</b>:</p>

<p style="margin-top: 1em">env_check</p>

<p style="margin-left:29%; margin-top: 1em">Environment
variables to be removed from the user&rsquo;s environment
unless they are considered &ldquo;safe&rdquo;. For all
variables except TZ, &ldquo;safe&rdquo; means that the
variable&rsquo;s value does not contain any &rsquo;%&rsquo;
or &rsquo;/&rsquo; characters. This can be used to guard
against printf-style format vulnerabilities in
poorly-written programs. The TZ variable is considered
unsafe if any of the following are true:</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:33%;">It consists of a
fully-qualified path name, optionally prefixed with a colon
(&rsquo;:&rsquo;), that does not match the location of the
<i>zoneinfo</i> directory.</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:33%;">It contains a <i>..</i> path
element.</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:33%;">It contains white space or
non-printable characters.</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:33%;">It is longer than the value of
PATH_MAX.</p>

<p style="margin-left:29%; margin-top: 1em">The argument
may be a double-quoted, space-separated list or a single
value without double-quotes. The list can be replaced, added
to, deleted from, or disabled by using the =, +=, -=, and !
operators respectively. Regardless of whether the env_reset
option is enabled or disabled, variables specified by
env_check will be preserved in the environment if they pass
the aforementioned check. The global list of environment
variables to check is displayed when <b>sudo</b> is run by
root with the <b>-V</b> option.</p>

<p style="margin-top: 1em">env_delete</p>

<p style="margin-left:29%; margin-top: 1em">Environment
variables to be removed from the user&rsquo;s environment
when the <i>env_reset</i> option is not in effect. The
argument may be a double-quoted, space-separated list or a
single value without double-quotes. The list can be
replaced, added to, deleted from, or disabled by using the
=, +=, -=, and ! operators respectively. The global list of
environment variables to remove is displayed when
<b>sudo</b> is run by root with the <b>-V</b> option. Note
that many operating systems will remove potentially
dangerous variables from the environment of any set-user-ID
process (such as <b>sudo</b>).</p>

<p style="margin-top: 1em">env_keep</p>

<p style="margin-left:29%; margin-top: 1em">Environment
variables to be preserved in the user&rsquo;s environment
when the <i>env_reset</i> option is in effect. This allows
fine-grained control over the environment
<b>sudo</b>-spawned processes will receive. The argument may
be a double-quoted, space-separated list or a single value
without double-quotes. The list can be replaced, added to,
deleted from, or disabled by using the =, +=, -=, and !
operators respectively. The global list of variables to keep
is displayed when <b>sudo</b> is run by root with the
<b>-V</b> option.</p>

<p style="margin-left:29%; margin-top: 1em">Preserving the
HOME environment variable has security implications since
many programs use it when searching for configuration or
data files. Adding HOME to <i>env_keep</i> may enable a user
to run unrestricted commands via <b>sudo</b> and is strongly
discouraged. Users wishing to edit files with <b>sudo</b>
should run <b>sudoedit</b> (or <b>sudo -e</b>) to get their
accustomed editor configuration instead of invoking the
editor directly.</p>

<p style="margin-top: 1em">log_servers</p>

<p style="margin-left:29%; margin-top: 1em">A list of one
or more servers to use for remote event and I/O log storage,
separated by white space. Log servers must be running
<b>sudo_logsrvd</b> or another service that implements the
protocol described by sudo_logsrv.proto(5).</p>

<p style="margin-left:29%; margin-top: 1em">Server
addresses should be of the form &ldquo;host[</p>

<p>:port ][(tls)]&rdquo;. The host portion may be a host
name, an IPv4 address, or an IPv6 address in square
brackets.</p>

<p style="margin-left:29%; margin-top: 1em">If the optional
<i>tls</i> flag is present, the connection will be secured
with Transport Layer Security (TLS) version 1.2 or 1.3.
Versions of TLS prior to 1.2 are not supported.</p>

<p style="margin-left:29%; margin-top: 1em">If a port is
specified, it may either be a port number or a well-known
service name as defined by the system service name database.
If no port is specified, port 30343 will be used for
plaintext connections and port 30344 will be used for TLS
connections.</p>

<p style="margin-left:29%; margin-top: 1em">When
<i>log_servers</i> is set, event log data will be logged
both locally (see the <i>syslog</i> and <i>log_file</i>
settings) as well as remotely, but I/O log data will only be
logged remotely. If multiple hosts are specified, they will
be attempted in reverse order. If no log servers are
available, the user will not be able to run a command unless
either the <i>ignore_iolog_errors</i> flag (I/O logging
enabled) or the <i>ignore_log_errors</i> flag (I/O logging
disabled) is set. Likewise, if the connection to the log
server is interrupted while <b>sudo</b> is running, the
command will be terminated unless the
<i>ignore_iolog_errors</i> flag (I/O logging enabled) or the
<i>ignore_log_errors</i> flag (I/O logging disabled) is
set.</p>

<p style="margin-left:29%; margin-top: 1em">This setting is
only supported by version 1.9.0 or higher.</p>

<p style="margin-top: 1em"><b>GROUP PROVIDER
PLUGINS</b></p>

<p style="margin-left:6%;">The <b>sudoers</b> plugin
supports its own plugin interface to allow non-Unix group
lookups which can query a group source other than the
standard Unix group database. This can be used to implement
support for the nonunix_group syntax described earlier.</p>

<p style="margin-left:6%; margin-top: 1em">Group provider
plugins are specified via the <i>group_plugin</i> setting.
The argument to <i>group_plugin</i> should consist of the
plugin path, either fully-qualified or relative to the
<i>/usr/libexec/sudo</i> directory, followed by any
configuration options the plugin requires. These options (if
specified) will be passed to the plugin&rsquo;s
initialization function. If options are present, the string
must be enclosed in double quotes (&quot;&quot;).</p>

<p style="margin-left:6%; margin-top: 1em">The following
group provider plugins are installed by default:</p>

<p style="margin-top: 1em">group_file</p>

<p style="margin-left:19%;">The <i>group_file</i> plugin
supports an alternate group file that uses the same syntax
as the <i>/etc/group</i> file. The path to the group file
should be specified as an option to the plugin. For example,
if the group file to be used is <i>/etc/sudo-group</i>:</p>

<p style="margin-left:19%; margin-top: 1em">Defaults
group_plugin=&quot;group_file.so /etc/sudo-group&quot;</p>

<p style="margin-top: 1em">system_group</p>

<p style="margin-left:19%;">The <i>system_group</i> plugin
supports group lookups via the standard C library functions
<b>getgrnam</b>() and <b>getgrid</b>(). This plugin can be
used in instances where the user belongs to groups not
present in the user&rsquo;s supplemental group vector. This
plugin takes no options:</p>

<p style="margin-left:19%; margin-top: 1em">Defaults
group_plugin=system_group.so</p>

<p style="margin-left:6%; margin-top: 1em">The group
provider plugin API is described in detail in
sudo_plugin(5).</p>

<p style="margin-top: 1em"><b>LOG FORMAT</b></p>

<p style="margin-left:6%;"><b>sudoers</b> can log events in
either JSON or <i>sudo</i> format, this section describes
the <i>sudo</i> log format. Depending on <i>sudoers</i>
configuration, <b>sudoers</b> can log events via syslog(3),
to a local log file, or both. The log format is almost
identical in both cases.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Accepted
command log entries</b> <br>
Commands that sudo runs are logged using the following
format (split into multiple lines for readability):</p>

<p style="margin-left:12%; margin-top: 1em">date hostname
progname: username : TTY=ttyname ; PWD=cwd ; \ <br>
USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \ <br>
ENV=env_vars COMMAND=command</p>

<p style="margin-left:6%; margin-top: 1em">Where the fields
are as follows:</p>

<p style="margin-top: 1em">date</p>

<p style="margin-left:24%; margin-top: 1em">The date the
command was run. Typically, this is in the format
&ldquo;MMM, DD, HH:MM:SS&rdquo;. If logging via syslog(3),
the actual date format is controlled by the syslog daemon.
If logging to a file and the <i>log_year</i> option is
enabled, the date will also include the year.</p>

<p style="margin-top: 1em">hostname</p>

<p style="margin-left:24%; margin-top: 1em">The name of the
host <b>sudo</b> was run on. This field is only present when
logging via syslog(3).</p>

<p style="margin-top: 1em">progname</p>

<p style="margin-left:24%; margin-top: 1em">The name of the
program, usually <i>sudo</i> or <i>sudoedit</i>. This field
is only present when logging via syslog(3).</p>

<p style="margin-top: 1em">username</p>

<p style="margin-left:24%; margin-top: 1em">The login name
of the user who ran <b>sudo</b>.</p>

<p style="margin-top: 1em">ttyname</p>

<p style="margin-left:24%; margin-top: 1em">The short name
of the terminal (e.g., &ldquo;console&rdquo;,
&ldquo;tty01&rdquo;, or &ldquo;pts/0&rdquo;) <b>sudo</b> was
run on, or &ldquo;unknown&rdquo; if there was no terminal
present.</p>

<p style="margin-top: 1em">cwd</p>

<p style="margin-left:24%; margin-top: 1em">The current
working directory that <b>sudo</b> was run in.</p>

<p style="margin-top: 1em">runasuser</p>

<p style="margin-left:24%; margin-top: 1em">The user the
command was run as.</p>

<p style="margin-top: 1em">runasgroup</p>

<p style="margin-left:24%; margin-top: 1em">The group the
command was run as if one was specified on the command
line.</p>

<p style="margin-top: 1em">logid</p>

<p style="margin-left:24%; margin-top: 1em">An I/O log
identifier that can be used to replay the command&rsquo;s
output. This is only present when the <i>log_input</i> or
<i>log_output</i> option is enabled.</p>

<p style="margin-top: 1em">env_vars</p>

<p style="margin-left:24%; margin-top: 1em">A list of
environment variables specified on the command line, if
specified.</p>

<p style="margin-top: 1em">command</p>

<p style="margin-left:24%; margin-top: 1em">The actual
command that was executed.</p>

<p style="margin-left:6%; margin-top: 1em">Messages are
logged using the locale specified by <i>sudoers_locale</i>,
which defaults to the &ldquo;C&rdquo; locale.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Denied
command log entries</b> <br>
If the user is not allowed to run the command, the reason
for the denial will follow the user name. Possible reasons
include:</p>

<p style="margin-top: 1em">user NOT in sudoers</p>

<p style="margin-left:9%;">The user is not listed in the
<i>sudoers</i> file.</p>

<p style="margin-top: 1em">user NOT authorized on host</p>

<p style="margin-left:9%;">The user is listed in the
<i>sudoers</i> file but is not allowed to run commands on
the host.</p>

<p style="margin-top: 1em">command not allowed</p>

<p style="margin-left:9%;">The user is listed in the
<i>sudoers</i> file for the host but they are not allowed to
run the specified command.</p>

<p style="margin-top: 1em">3 incorrect password
attempts</p>

<p style="margin-left:9%;">The user failed to enter their
password after 3 tries. The actual number of tries will vary
based on the number of failed attempts and the value of the
<i>passwd_tries</i> option.</p>

<p style="margin-top: 1em">a password is required</p>

<p style="margin-left:9%;">The <b>-n</b> option was
specified but a password was required.</p>

<p style="margin-top: 1em">sorry, you are not allowed to
set the following environment variables</p>

<p style="margin-left:9%;">The user specified environment
variables on the command line that were not allowed by
<i>sudoers</i>.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Error log
entries</b> <br>
If an error occurs, <b>sudoers</b> will log a message and,
in most cases, send a message to the administrator via
email. Possible errors include:</p>

<p style="margin-top: 1em">parse error in /etc/sudoers near
line N</p>

<p style="margin-left:9%;"><b>sudoers</b> encountered an
error when parsing the specified file. In some cases, the
actual error may be one line above or below the line number
listed, depending on the type of error.</p>

<p style="margin-top: 1em">problem with defaults
entries</p>

<p style="margin-left:9%;">The <i>sudoers</i> file contains
one or more unknown Defaults settings. This does not prevent
<b>sudo</b> from running, but the <i>sudoers</i> file should
be checked using <b>visudo</b>.</p>

<p style="margin-top: 1em">timestamp owner (username): No
such user</p>

<p style="margin-left:9%;">The time stamp directory owner,
as specified by the <i>timestampowner</i> setting, could not
be found in the password database.</p>

<p style="margin-top: 1em">unable to open/read
/etc/sudoers</p>

<p style="margin-left:9%;">The <i>sudoers</i> file could
not be opened for reading. This can happen when the
<i>sudoers</i> file is located on a remote file system that
maps user-ID 0 to a different value. Normally,
<b>sudoers</b> tries to open the <i>sudoers</i> file using
group permissions to avoid this problem. Consider either
changing the ownership of <i>/etc/sudoers</i> or adding an
argument like &ldquo;sudoers_uid=N&rdquo; (where
&rsquo;N&rsquo; is the user-ID that owns the <i>sudoers</i>
file) to the end of the <b>sudoers</b> Plugin line in the
sudo.conf(5) file.</p>

<p style="margin-top: 1em">unable to stat /etc/sudoers</p>

<p style="margin-left:9%;">The <i>/etc/sudoers</i> file is
missing.</p>

<p style="margin-top: 1em">/etc/sudoers is not a regular
file</p>

<p style="margin-left:9%;">The <i>/etc/sudoers</i> file
exists but is not a regular file or symbolic link.</p>

<p style="margin-top: 1em">/etc/sudoers is owned by uid N,
should be 0</p>

<p style="margin-left:9%;">The <i>sudoers</i> file has the
wrong owner. If you wish to change the <i>sudoers</i> file
owner, please add &ldquo;sudoers_uid=N&rdquo; (where
&rsquo;N&rsquo; is the user-ID that owns the <i>sudoers</i>
file) to the <b>sudoers</b> Plugin line in the sudo.conf(5)
file.</p>

<p style="margin-top: 1em">/etc/sudoers is world
writable</p>

<p style="margin-left:9%;">The permissions on the
<i>sudoers</i> file allow all users to write to it. The
<i>sudoers</i> file must not be world-writable, the default
file mode is 0440 (readable by owner and group, writable by
none). The default mode may be changed via the
&ldquo;sudoers_mode&rdquo; option to the <b>sudoers</b>
Plugin line in the sudo.conf(5) file.</p>

<p style="margin-top: 1em">/etc/sudoers is owned by gid N,
should be 1</p>

<p style="margin-left:9%;">The <i>sudoers</i> file has the
wrong group ownership. If you wish to change the
<i>sudoers</i> file group ownership, please add
&ldquo;sudoers_gid=N&rdquo; (where &rsquo;N&rsquo; is the
group-ID that owns the <i>sudoers</i> file) to the
<b>sudoers</b> Plugin line in the sudo.conf(5) file.</p>

<p style="margin-top: 1em">unable to open
/run/sudo/ts/username</p>

<p style="margin-left:9%;"><b>sudoers</b> was unable to
read or create the user&rsquo;s time stamp file. This can
happen when <i>timestampowner</i> is set to a user other
than root and the mode on <i>/run/sudo</i> is not searchable
by group or other. The default mode for <i>/run/sudo</i> is
0711.</p>

<p style="margin-top: 1em">unable to write to
/run/sudo/ts/username</p>

<p style="margin-left:9%;"><b>sudoers</b> was unable to
write to the user&rsquo;s time stamp file.</p>

<p style="margin-top: 1em">/run/sudo/ts is owned by uid X,
should be Y</p>

<p style="margin-left:9%;">The time stamp directory is
owned by a user other than <i>timestampowner</i>. This can
occur when the value of <i>timestampowner</i> has been
changed. <b>sudoers</b> will ignore the time stamp directory
until the owner is corrected.</p>

<p style="margin-top: 1em">/run/sudo/ts is group
writable</p>

<p style="margin-left:9%;">The time stamp directory is
group-writable; it should be writable only by
<i>timestampowner</i>. The default mode for the time stamp
directory is 0700. <b>sudoers</b> will ignore the time stamp
directory until the mode is corrected.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Notes on
logging via syslog</b> <br>
By default, <b>sudoers</b> logs messages via syslog(3). The
<i>date</i>, <i>hostname</i>, and <i>progname</i> fields are
added by the system&rsquo;s <b>syslog</b>() function, not
<b>sudoers</b> itself. As such, they may vary in format on
different systems.</p>

<p style="margin-left:6%; margin-top: 1em">The maximum size
of syslog messages varies from system to system. The
<i>syslog_maxlen</i> setting can be used to change the
maximum syslog message size from the default value of 980
bytes. For more information, see the description of
<i>syslog_maxlen</i>.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Notes on
logging to a file</b> <br>
If the <i>logfile</i> option is set, <b>sudoers</b> will log
to a local file, such as <i>/var/log/sudo</i>. When logging
to a file, <b>sudoers</b> uses a format similar to
syslog(3), with a few important differences:</p>

<p style="margin-top: 1em">1.</p>

<p style="margin-left:13%;">The <i>progname</i> and
<i>hostname</i> fields are not present.</p>

<p style="margin-top: 1em">2.</p>

<p style="margin-left:13%;">If the <i>log_year</i> option
is enabled, the date will also include the year.</p>

<p style="margin-top: 1em">3.</p>

<p style="margin-left:13%;">Lines that are longer than
<i>loglinelen</i> characters (80 by default) are
word-wrapped and continued on the next line with a four
character indent. This makes entries easier to read for a
human being, but makes it more difficult to use grep(1) on
the log files. If the <i>loglinelen</i> option is set to 0
(or negated with a &rsquo;!&rsquo;), word wrap will be
disabled.</p>

<p style="margin-top: 1em"><b>I/O LOG FILES</b></p>

<p style="margin-left:6%;">When I/O logging is enabled,
<b>sudo</b> will run the command in a pseudo-terminal and
log all user input and/or output, depending on which options
are enabled. I/O can be logged either to the local machine
or to a remote log server. For local logs, I/O is logged to
the directory specified by the <i>iolog_dir</i> option (</p>

<p><i>/var/log/sudo-io</i> by default ) using a unique
session ID that is included in the <b>sudo</b> log line,
prefixed with &ldquo;TSID=&rdquo;. The <i>iolog_file</i>
option may be used to control the format of the session ID.
For remote logs, the <i>log_servers</i> setting is used to
specify one or more log servers running <b>sudo_logsrvd</b>
or another server that implements the protocol described by
sudo_logsrv.proto(5).</p>

<p style="margin-left:6%; margin-top: 1em">For both local
and remote I/O logs, each log is stored in a separate
directory that contains the following files:</p>

<p style="margin-top: 1em"><i>log</i></p>

<p style="margin-left:19%; margin-top: 1em">A text file
containing information about the command. The first line
consists of the following colon-delimited fields: the time
the command was run, the name of the user who ran
<b>sudo</b>, the name of the target user, the name of the
target group (optional), the terminal that <b>sudo</b> was
run from, and the number of lines and columns of the
terminal. The second and third lines contain the working
directory the command was run from and the path name of the
command itself (with arguments if present).</p>

<p style="margin-top: 1em"><i>log.json</i></p>

<p style="margin-left:19%; margin-top: 1em">A
JSON-formatted file containing information about the
command. This is similar to the <i>log</i> file but contains
additional information and is easily extensible. The
<i>log.json</i> file will be used by sudoreplay(8) in
preference to the <i>log</i> file if it exists. The file may
contain the following elements:</p>

<p style="margin-top: 1em">timestamp</p>

<p style="margin-left:32%;">A JSON object containing time
the command was run. It consists of two values,
<i>seconds</i> and <i>nanoseconds</i>.</p>

<p style="margin-top: 1em">columns</p>

<p style="margin-left:32%; margin-top: 1em">The number of
columns of the terminal the command ran on, or zero if no
terminal was present.</p>

<p style="margin-top: 1em">command</p>

<p style="margin-left:32%; margin-top: 1em">The
fully-qualified path of the command that was run.</p>

<p style="margin-top: 1em">lines</p>

<p style="margin-left:32%; margin-top: 1em">The number of
lines of the terminal the command ran on, or zero if no
terminal was present.</p>

<p style="margin-top: 1em">runargv</p>

<p style="margin-left:32%; margin-top: 1em">A JSON array
representing the command&rsquo;s argument vector as passed
to the <b>execve</b>() system call.</p>

<p style="margin-top: 1em">runenv</p>

<p style="margin-left:32%; margin-top: 1em">A JSON array
representing the command&rsquo;s environment as passed to
the <b>execve</b>() system call.</p>

<p style="margin-top: 1em">rungid</p>

<p style="margin-left:32%; margin-top: 1em">The group ID
the command ran as. This element is only present when the
user specifies a group on the command line.</p>

<p style="margin-top: 1em">rungroup</p>

<p style="margin-left:32%; margin-top: 1em">The name of the
group the command ran as. This element is only present when
the user specifies a group on the command line.</p>

<p style="margin-top: 1em">runuid</p>

<p style="margin-left:32%; margin-top: 1em">The user ID the
command ran as.</p>

<p style="margin-top: 1em">runuser</p>

<p style="margin-left:32%; margin-top: 1em">The name of the
user the command ran as.</p>

<p style="margin-top: 1em">submitcwd</p>

<p style="margin-left:32%;">The current working directory
at the time <b>sudo</b> was run.</p>

<p style="margin-top: 1em">submithost</p>

<p style="margin-left:32%;">The name of the host the
command was run on.</p>

<p style="margin-top: 1em">submituser</p>

<p style="margin-left:32%;">The name of the user who ran
the command via <b>sudo</b>.</p>

<p style="margin-top: 1em">ttyname</p>

<p style="margin-left:32%; margin-top: 1em">The path name
of the terminal the user invoked <b>sudo</b> from. If the
command was run in a pseudo-terminal, <i>ttyname</i> will be
different from the terminal the command actually ran in.</p>

<p style="margin-top: 1em"><i>timing</i></p>

<p style="margin-left:19%; margin-top: 1em">Timing
information used to replay the session. Each line consists
of the I/O log entry type and amount of time since the last
entry, followed by type-specific data. The I/O log entry
types and their corresponding type-specific data are:</p>

<p style="margin-top: 1em">0</p>

<p style="margin-left:27%; margin-top: 1em">standard input,
number of bytes in the entry</p>

<p>1</p>

<p style="margin-left:27%; margin-top: 1em">standard
output, number of bytes in the entry</p>

<p>2</p>

<p style="margin-left:27%; margin-top: 1em">standard error,
number of bytes in the entry</p>

<p>3</p>

<p style="margin-left:27%; margin-top: 1em">terminal input,
number of bytes in the entry</p>

<p>4</p>

<p style="margin-left:27%; margin-top: 1em">terminal
output, number of bytes in the entry</p>

<p>5</p>

<p style="margin-left:27%; margin-top: 1em">window change,
new number lines and columns</p>

<p>6</p>

<p style="margin-left:27%; margin-top: 1em">bug
compatibility for <b>sudo</b> 1.8.7 terminal output</p>

<p>7</p>

<p style="margin-left:27%; margin-top: 1em">command suspend
or resume, signal received</p>

<p style="margin-top: 1em"><i>ttyin</i></p>

<p style="margin-left:19%; margin-top: 1em">Raw input from
the user&rsquo;s terminal, exactly as it was received. No
post-processing is performed. For manual viewing, you may
wish to convert carriage return characters in the log to
line feeds. For example: &rsquo;gunzip -c ttyin | tr
&quot;\r&quot; &quot;\n&quot;&rsquo;</p>

<p style="margin-top: 1em"><i>stdin</i></p>

<p style="margin-left:19%; margin-top: 1em">The standard
input when no terminal is present, or input redirected from
a pipe or file.</p>

<p style="margin-top: 1em"><i>ttyout</i></p>

<p style="margin-left:19%; margin-top: 1em">Output from the
pseudo-terminal (what the command writes to the screen).
Note that terminal-specific post-processing is performed
before the data is logged. This means that, for example,
line feeds are usually converted to line feed/carriage
return pairs and tabs may be expanded to spaces.</p>

<p style="margin-top: 1em"><i>stdout</i></p>

<p style="margin-left:19%; margin-top: 1em">The standard
output when no terminal is present, or output redirected to
a pipe or file.</p>

<p style="margin-top: 1em"><i>stderr</i></p>

<p style="margin-left:19%; margin-top: 1em">The standard
error redirected to a pipe or file.</p>

<p style="margin-left:6%; margin-top: 1em">All files other
than <i>log</i> are compressed in gzip format unless the
<i>compress_io</i> flag has been disabled. Due to buffering,
it is not normally possible to display the I/O logs in
real-time as the program is executing. The I/O log data will
not be complete until the program run by <b>sudo</b> has
exited or has been terminated by a signal. The
<i>iolog_flush</i> flag can be used to disable buffering, in
which case I/O log data is written to disk as soon as it is
available. The output portion of an I/O log file can be
viewed with the sudoreplay(8) utility, which can also be
used to list or search the available logs.</p>

<p style="margin-left:6%; margin-top: 1em">Note that user
input may contain sensitive information such as passwords
(even if they are not echoed to the screen), which will be
stored in the log file unencrypted. In most cases, logging
the command output via <i>log_output</i> or LOG_OUTPUT is
all that is required.</p>

<p style="margin-left:6%; margin-top: 1em">Since each
session&rsquo;s I/O logs are stored in a separate directory,
traditional log rotation utilities cannot be used to limit
the number of I/O logs. The simplest way to limit the number
of I/O is by setting the <i>maxseq</i> option to the maximum
number of logs you wish to store. Once the I/O log sequence
number reaches <i>maxseq</i>, it will be reset to zero and
<b>sudoers</b> will truncate and re-use any existing I/O
logs.</p>

<p style="margin-top: 1em"><b>FILES</b> <br>
/etc/sudo.conf</p>

<p style="margin-left:40%; margin-top: 1em">Sudo front-end
configuration</p>

<p style="margin-top: 1em">/etc/sudoers</p>

<p style="margin-left:40%; margin-top: 1em">List of who can
run what</p>

<p style="margin-top: 1em">/etc/group</p>

<p style="margin-left:40%; margin-top: 1em">Local groups
file</p>

<p style="margin-top: 1em">/etc/netgroup</p>

<p style="margin-left:40%; margin-top: 1em">List of network
groups</p>

<p style="margin-top: 1em">/var/log/sudo-io</p>

<p style="margin-left:40%; margin-top: 1em">I/O log
files</p>

<p style="margin-top: 1em">/run/sudo/ts</p>

<p style="margin-left:40%; margin-top: 1em">Directory
containing time stamps for the <b>sudoers</b> security
policy</p>

<p style="margin-top: 1em">/var/lib/sudo/lectured</p>

<p style="margin-left:40%; margin-top: 1em">Directory
containing lecture status files for the <b>sudoers</b>
security policy</p>

<p style="margin-top: 1em">/etc/environment</p>

<p style="margin-left:40%; margin-top: 1em">Initial
environment for <b>-i</b> mode on AIX and Linux systems</p>

<p style="margin-top: 1em"><b>EXAMPLES</b></p>

<p style="margin-left:6%;">Below are example <i>sudoers</i>
file entries. Admittedly, some of these are a bit contrived.
First, we allow a few environment variables to pass and then
define our <i>aliases</i>:</p>

<p style="margin-left:6%; margin-top: 1em"># Run X
applications through sudo; HOME is used to find the <br>
# .Xauthority file. Note that other programs use HOME to
find <br>
# configuration files and this may lead to privilege
escalation! <br>
Defaults env_keep += &quot;DISPLAY HOME&quot;</p>

<p style="margin-left:6%; margin-top: 1em"># User alias
specification</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>User_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>FULLTIMERS = millert, mikef, dowdy</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>User_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>PARTTIMERS = bostley, jwfox, crawl</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>User_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>WEBADMIN = will, wendy, wim</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em"># Runas alias
specification</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Runas_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>OP = root, operator</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Runas_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>DB = oracle, sybase</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Runas_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>ADMINGRP = adm, oper</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em"># Host alias
specification</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Host_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>SPARC = bigtime, eclipse, moet, anchor :\</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>SGI = grolsch, dandelion, black :\</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>ALPHA = widget, thalamus, foobar :\</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>HPPA = boa, nag, python</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Host_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>CUNETS = 128.138.0.0/255.255.0.0</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Host_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>CSNETS = 128.138.243.0, 128.138.204.0/24,
128.138.242.0</p> </td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Host_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>SERVERS = primary, mail, www, ns</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Host_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>CDROM = orion, perseus, hercules</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em"># Cmnd alias
specification</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>DUMPS = /usr/bin/mt, /usr/sbin/dump,
/usr/sbin/rdump,\</p> </td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>/usr/sbin/restore, /usr/sbin/rrestore,\</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== \</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>/home/operator/bin/start_backups</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>KILL = /usr/bin/kill</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>PRINTING = /usr/sbin/lpc, /usr/bin/lprm</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>SHUTDOWN = /usr/sbin/shutdown</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>HALT = /usr/sbin/halt</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>REBOOT = /usr/sbin/reboot</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh,\</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>/usr/local/bin/tcsh, /usr/bin/rsh,\</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>/usr/local/bin/zsh</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>SU = /usr/bin/su</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Cmnd_Alias</p></td>
<td width="10%"></td>
<td width="10%">


<p>PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less</p></td>
<td width="10%"></td>
<td width="53%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Here we override
some of the compiled in default values. We want <b>sudo</b>
to log via syslog(3) using the <i>auth</i> facility in all
cases and for commands to be run with the target
user&rsquo;s home directory as the working directory. We
don&rsquo;t want to subject the full time staff to the
<b>sudo</b> lecture and we want to allow them to run
commands in a chroot(2) &ldquo;sandbox&rdquo; via the
<b>-R</b> option. User <b>millert</b> need not provide a
password and we don&rsquo;t want to reset the LOGNAME or
USER environment variables when running commands as root.
Additionally, on the machines in the <i>SERVERS</i>
Host_Alias, we keep an additional local log file and make
sure we log the year in each log line since the log entries
will be kept around for several years. Lastly, we disable
shell escapes for the commands in the PAGERS Cmnd_Alias
(</p>

<p><i>/usr/bin/more</i>, <i>/usr/bin/pg</i> and
<i>/usr/bin/less</i> ). Note that this will not effectively
constrain users with <b>sudo ALL</b> privileges.</p>

<p style="margin-left:6%; margin-top: 1em"># Override
built-in defaults</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults</p></td>
<td width="10%"></td>
<td width="10%">
</td>
<td width="10%">


<p>syslog=auth,runcwd=~</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults&gt;root</p></td>
<td width="10%"></td>
<td width="10%">
</td>
<td width="10%">


<p>!set_logname</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults:FULLTIMERS</p></td>
<td width="10%"></td>
<td width="10%"></td>
<td width="10%">


<p>!lecture,runchroot=*</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults:millert</p></td>
<td width="10%"></td>
<td width="10%"></td>
<td width="10%">


<p>!authenticate</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults@SERVERS</p></td>
<td width="10%"></td>
<td width="10%"></td>
<td width="10%">


<p>log_year, logfile=/var/log/sudo.log</p></td>
<td width="53%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>Defaults!PAGERS</p></td>
<td width="10%"></td>
<td width="10%">
</td>
<td width="10%">


<p>noexec</p></td>
<td width="53%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The <i>User
specification</i> is the part that actually determines who
may run what.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>root</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL = (ALL) ALL</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>%wheel</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL = (ALL) ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">We let
<b>root</b> and any user in group <b>wheel</b> run any
command on any host as any user.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>FULLTIMERS</p></td>
<td width="10%"></td>
<td width="10%">


<p>ALL = NOPASSWD: ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Full time
sysadmins (</p>

<p><b>millert</b>, <b>mikef</b>, and <b>dowdy</b> ) may run
any command on any host without authenticating
themselves.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>PARTTIMERS</p></td>
<td width="10%"></td>
<td width="10%">


<p>ALL = ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Part time
sysadmins <b>bostley</b>, <b>jwfox</b>, and <b>crawl</b>)
may run any command on any host but they must authenticate
themselves first (since the entry lacks the NOPASSWD
tag).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>jack</p></td>
<td width="10%">
</td>
<td width="10%">


<p>CSNETS = ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>jack</b> may run any command on the machines in the
<i>CSNETS</i> alias (the networks 128.138.243.0,
128.138.204.0, and 128.138.242.0). Of those networks, only
128.138.204.0 has an explicit netmask (in CIDR notation)
indicating it is a class C network. For the other networks
in <i>CSNETS</i>, the local machine&rsquo;s netmask will be
used during matching.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>lisa</p></td>
<td width="10%">
</td>
<td width="10%">


<p>CUNETS = ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>lisa</b> may run any command on any host in the
<i>CUNETS</i> alias (the class B network 128.138.0.0).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>operator</p></td>
<td width="10%"></td>
<td width="10%">


<p>ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT,
PRINTING,\</p> </td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>sudoedit /etc/printcap, /usr/oper/bin/</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The
<b>operator</b> user may run commands limited to simple
maintenance. Here, those are commands related to backups,
killing processes, the printing system, shutting down the
system, and any commands in the directory
<i>/usr/oper/bin/</i>. Note that one command in the DUMPS
Cmnd_Alias includes a sha224 digest,
<i>/home/operator/bin/start_backups</i>. This is because the
directory containing the script is writable by the operator
user. If the script is modified (resulting in a digest
mismatch) it will no longer be possible to run it via
<b>sudo</b>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>joe</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL = /usr/bin/su operator</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>joe</b> may only su(1) to operator.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>pete</p></td>
<td width="10%">
</td>
<td width="10%">


<p>HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd
*root*</p> </td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>%opers</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL = (: ADMINGRP) /usr/sbin/</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Users in the
<b>opers</b> group may run commands in <i>/usr/sbin/</i> as
themselves with any group in the <i>ADMINGRP</i> Runas_Alias
(the <b>adm</b> and <b>oper</b> groups).</p>

<p style="margin-left:6%; margin-top: 1em">The user
<b>pete</b> is allowed to change anyone&rsquo;s password
except for root on the <i>HPPA</i> machines. Because command
line arguments are matched as a single, concatenated string,
the &rsquo;*&rsquo; wildcard will match <i>multiple</i>
words. This example assumes that passwd(1) does not take
multiple user names on the command line. Note that on GNU
systems, options to passwd(1) may be specified after the
user argument. As a result, this rule will also allow:</p>

<p style="margin-left:12%; margin-top: 1em">passwd username
--expire</p>

<p style="margin-left:6%; margin-top: 1em">which may not be
desirable.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>bob</p></td>
<td width="10%">
</td>
<td width="10%">


<p>SPARC = (OP) ALL : SGI = (OP) ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>bob</b> may run anything on the <i>SPARC</i> and
<i>SGI</i> machines as any user listed in the <i>OP</i>
Runas_Alias (</p>

<p><b>root</b> and <b>operator</b>. )</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>jim</p></td>
<td width="10%">
</td>
<td width="10%">


<p>+biglab = ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>jim</b> may run any command on machines in the
<i>biglab</i> netgroup. <b>sudo</b> knows that
&ldquo;biglab&rdquo; is a netgroup due to the
&rsquo;+&rsquo; prefix.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>+secretaries</p></td>
<td width="10%"></td>
<td width="10%">


<p>ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Users in the
<b>secretaries</b> netgroup need to help manage the printers
as well as add and remove users, so they are allowed to run
those commands on all machines.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>fred</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL = (DB) NOPASSWD: ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>fred</b> can run commands as any user in the <i>DB</i>
Runas_Alias (</p>

<p><b>oracle</b> or <b>sybase</b> ) without giving a
password.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>john</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">On the
<i>ALPHA</i> machines, user <b>john</b> may su to anyone
except root but he is not allowed to specify any options to
the su(1) command.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>jen</p></td>
<td width="10%">
</td>
<td width="10%">


<p>ALL, !SERVERS = ALL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>jen</b> may run any command on any machine except for
those in the <i>SERVERS</i> Host_Alias (primary, mail, www,
and ns).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>jill</p></td>
<td width="10%">
</td>
<td width="10%">


<p>SERVERS = /usr/bin/, !SU, !SHELLS</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">For any machine
in the <i>SERVERS</i> Host_Alias, <b>jill</b> may run any
commands in the directory <i>/usr/bin/</i> except for those
commands belonging to the <i>SU</i> and <i>SHELLS</i>
Cmnd_Aliases. While not specifically mentioned in the rule,
the commands in the <i>PAGERS</i> Cmnd_Alias all reside in
<i>/usr/bin</i> and have the <i>noexec</i> option set.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>steve</p></td>
<td width="10%">
</td>
<td width="10%">


<p>CSNETS = (operator) /usr/local/op_commands/</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The user
<b>steve</b> may run any command in the directory
/usr/local/op_commands/ but only as user operator.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>matt</p></td>
<td width="10%">
</td>
<td width="10%">


<p>valkyrie = KILL</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">On his personal
workstation, valkyrie, <b>matt</b> needs to be able to kill
hung processes.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>WEBADMIN</p></td>
<td width="10%"></td>
<td width="10%">


<p>www = (www) ALL, (root) /usr/bin/su www</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">On the host www,
any user in the <i>WEBADMIN</i> User_Alias (will, wendy, and
wim), may run any command as user www (which owns the web
pages) or simply su(1) to www.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">


<p>ALL</p></td>
<td width="10%">
</td>
<td width="10%">


<p>CDROM = NOPASSWD: /sbin/umount /CDROM,\</p></td>
<td width="63%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="11%">
</td>
<td width="10%">
</td>
<td width="10%">


<p>/sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Any user may
mount or unmount a CD-ROM on the machines in the CDROM
Host_Alias (orion, perseus, hercules) without entering a
password. This is a bit tedious for users to type, so it is
a prime candidate for encapsulating in a shell script.</p>

<p style="margin-top: 1em"><b>SECURITY NOTES</b></p>

<p style="margin-left:6%;"><b>Limitations of the</b>
&rsquo;</p>

<p>! &rsquo; operator</p>

<p style="margin-left:6%;">It is generally not effective to
&ldquo;subtract&rdquo; commands from <b>ALL</b> using the
&rsquo;!&rsquo; operator. A user can trivially circumvent
this by copying the desired command to a different name and
then executing that. For example:</p>

<p style="margin-left:6%; margin-top: 1em">bill ALL = ALL,
!SU, !SHELLS</p>

<p style="margin-left:6%; margin-top: 1em">Doesn&rsquo;t
really prevent <b>bill</b> from running the commands listed
in <i>SU</i> or <i>SHELLS</i> since he can simply copy those
commands to a different name, or use a shell escape from an
editor or other program. Therefore, these kind of
restrictions should be considered advisory at best (and
reinforced by policy).</p>

<p style="margin-left:6%; margin-top: 1em">In general, if a
user has sudo <b>ALL</b> there is nothing to prevent them
from creating their own program that gives them a root shell
(or making their own copy of a shell) regardless of any
&rsquo;!&rsquo; elements in the user specification.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Security
implications of</b> <i>fast_glob</i> <br>
If the <i>fast_glob</i> option is in use, it is not possible
to reliably negate commands where the path name includes
globbing (aka wildcard) characters. This is because the C
library&rsquo;s fnmatch(3) function cannot resolve relative
paths. While this is typically only an inconvenience for
rules that grant privileges, it can result in a security
issue for rules that subtract or revoke privileges.</p>

<p style="margin-left:6%; margin-top: 1em">For example,
given the following <i>sudoers</i> file entry:</p>

<p style="margin-left:6%; margin-top: 1em">john ALL =
/usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,\
<br>
/usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root</p>

<p style="margin-left:6%; margin-top: 1em">User <b>john</b>
can still run /usr/bin/passwd root if <i>fast_glob</i> is
enabled by changing to <i>/usr/bin</i> and running ./passwd
root instead.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Preventing
shell escapes</b> <br>
Once <b>sudo</b> executes a program, that program is free to
do whatever it pleases, including run other programs. This
can be a security issue since it is not uncommon for a
program to allow shell escapes, which lets a user bypass
<b>sudo</b>&rsquo;s access control and logging. Common
programs that permit shell escapes include shells
(obviously), editors, paginators, mail, and terminal
programs.</p>

<p style="margin-left:6%; margin-top: 1em">There are four
basic approaches to this problem:</p>

<p style="margin-top: 1em">restrict</p>

<p style="margin-left:19%; margin-top: 1em">Avoid giving
users access to commands that allow the user to run
arbitrary commands. Many editors have a restricted mode
where shell escapes are disabled, though <b>sudoedit</b> is
a better solution to running editors via <b>sudo</b>. Due to
the large number of programs that offer shell escapes,
restricting users to the set of programs that do not is
often unworkable.</p>

<p style="margin-top: 1em">intercept</p>

<p style="margin-left:19%;">Many systems that support
shared libraries have the ability to override default
library functions by pointing an environment variable
(usually LD_PRELOAD) to an alternate shared library. On such
systems, <b>sudo</b>&rsquo;s <i>intercept</i> functionality
can be used to transparently intercept an attempt to run a
new command, allow or deny it based on <i>sudoers</i> rules,
and log the result. For example, this can be used to
restrict the commands run from within a privileged shell.
Note, however, that this applies only to dynamically-linked
executables. Statically-linked executables and executables
running under binary emulation are not affected. Also, most
shells support built-in commands and the ability to read or
write sensitive files that cannot be intercepted by
<b>sudo</b>.</p>

<p style="margin-left:19%; margin-top: 1em">Currently,
<b>sudo</b>&rsquo;s <i>intercept</i> functionality only
works for programs that use the <b>execl</b>(),
<b>execle</b>(), <b>execlp</b>(), <b>execv</b>(),
<b>execve</b>(), <b>execvp</b>(), or <b>execvpe</b>()
library functions to run the new command. This may be
expanded in a future release of <b>sudo</b>. Because most
dynamic loaders ignore LD_PRELOAD (or the equivalent) when
running set-user-ID and set-group-ID programs,
<b>sudoers</b> will not permit such programs to be run in
<i>intercept</i> mode.</p>

<p style="margin-left:19%; margin-top: 1em">The
<i>intercept</i> feature is known to work on Solaris, *BSD,
Linux, macOS, HP-UX 11.x and AIX 5.3 and above. It should be
supported on most operating systems that support the
LD_PRELOAD environment variable. Check your operating
system&rsquo;s manual pages for the dynamic linker (usually
ld.so, ld.so.1, dyld, dld.sl, rld, or loader) to see if
LD_PRELOAD is supported. It is <i>not</i> supported when
<b>sudo</b>&rsquo;s SELinux RBAC support is in use due to a
fundamental incompatibility.</p>

<p style="margin-left:19%; margin-top: 1em">To enable
intercept mode on a per-command basis, use the INTERCEPT tag
as documented in the User Specification section above. Here
is that example again:</p>

<p style="margin-left:19%; margin-top: 1em">chuck research
= INTERCEPT: ALL</p>

<p style="margin-left:19%; margin-top: 1em">This allows
user <b>chuck</b> to run any command on the machine
&ldquo;research&rdquo; in intercept mode. Any commands run
via shell escapes will be validated and logged by
<b>sudo</b>. If you are unsure whether or not your system is
capable of supporting <i>intercept</i>, you can always just
try it out and check whether or not external commands run
via a shell are logged when <i>intercept</i> is enabled.</p>

<p style="margin-top: 1em">log</p>

<p style="margin-left:19%; margin-top: 1em">There are two
separate but related ways to log additional commands. The
first is to enable I/O logging using the <i>log_output</i>
flag. This will log the command&rsquo;s output but will not
create an event log entry when the additional command is
run. The second is to enable the <i>log_subcmds</i> flag in
<i>sudoers</i> which will create an event log entry every
time a new command is run. If I/O logging is also enabled,
the log entry will include a time offset into the I/O log to
indicate when the command was run. This offset can be passed
to the sudoreplay(8) utility to replay the I/O log at the
exact moment when the command was run. The
<i>log_subcmds</i> flag uses the same mechanism as
<i>intercept</i> (see above) and has the same
limitations.</p>

<p style="margin-top: 1em">noexec</p>


<p style="margin-left:19%; margin-top: 1em"><b>sudo</b>&rsquo;s
<i>noexec</i> functionality can be used to prevent a program
run by <b>sudo</b> from executing any other programs. On
most systems, it uses the same mechanism as <i>intercept</i>
(see above) and thus the same caveats apply. The
<i>noexec</i> functionality is capable of blocking execution
of commands run via the <b>execl</b>(), <b>execle</b>(),
<b>execlp</b>(), <b>exect</b>(), <b>execv</b>(),
<b>execve</b>(), <b>execveat</b>(), <b>execvP</b>(),
<b>execvp</b>(), <b>execvpe</b>(), <b>fexecve</b>(),
<b>popen</b>(), <b>posix_spawn</b>(), <b>posix_spawnp</b>(),
<b>system</b>(), and <b>wordexp</b>() functions. On Linux, a
<b>seccomp</b>() filter is used to implement <i>noexec</i>.
On Solaris 10 and higher, <i>noexec</i> uses Solaris
privileges instead of the LD_PRELOAD environment
variable.</p>

<p style="margin-left:19%; margin-top: 1em">To enable
<i>noexec</i> for a command, use the NOEXEC tag as
documented in the User Specification section above. Here is
that example again:</p>

<p style="margin-left:19%; margin-top: 1em">aaron shanty =
NOEXEC: /usr/bin/more, /usr/bin/vi</p>

<p style="margin-left:19%; margin-top: 1em">This allows
user <b>aaron</b> to run <i>/usr/bin/more</i> and
<i>/usr/bin/vi</i> with <i>noexec</i> enabled. This will
prevent those two commands from executing other commands
(such as a shell). If you are unsure whether or not your
system is capable of supporting <i>noexec</i> you can always
just try it out and check whether shell escapes work when
<i>noexec</i> is enabled.</p>

<p style="margin-left:6%; margin-top: 1em">Note that
restricting shell escapes is not a panacea. Programs running
as root are still capable of many potentially hazardous
operations (such as changing or overwriting files) that
could lead to unintended privilege escalation. In the
specific case of an editor, a safer approach is to give the
user permission to run <b>sudoedit</b> (see below).</p>

<p style="margin-left:6%; margin-top: 1em"><b>Secure
editing</b> <br>
The <b>sudoers</b> plugin includes <b>sudoedit</b> support
which allows users to securely edit files with the editor of
their choice. As <b>sudoedit</b> is a built-in command, it
must be specified in the <i>sudoers</i> file without a
leading path. However, it may take command line arguments
just as a normal command does. Wildcards used in
<i>sudoedit</i> command line arguments are expected to be
path names, so a forward slash (&rsquo;/&rsquo;) will not be
matched by a wildcard.</p>

<p style="margin-left:6%; margin-top: 1em">Unlike other
<b>sudo</b> commands, the editor is run with the permissions
of the invoking user and with the environment unmodified.
More information may be found in the description of the
<b>-e</b> option in sudo(8).</p>

<p style="margin-left:6%; margin-top: 1em">For example, to
allow user operator to edit the &ldquo;message of the
day&rdquo; file:</p>

<p style="margin-left:14%; margin-top: 1em">operator
sudoedit /etc/motd</p>

<p style="margin-left:6%; margin-top: 1em">The operator
user then runs <b>sudoedit</b> as follows:</p>

<p style="margin-left:14%; margin-top: 1em">$ sudoedit
/etc/motd</p>

<p style="margin-left:6%; margin-top: 1em">The editor will
run as the operator user, not root, on a temporary copy of
<i>/etc/motd</i>. After the file has been edited,
<i>/etc/motd</i> will be updated with the contents of the
temporary copy.</p>

<p style="margin-left:6%; margin-top: 1em">Users should
<i>never</i> be granted <b>sudoedit</b> permission to edit a
file that resides in a directory the user has write access
to, either directly or via a wildcard. If the user has write
access to the directory it is possible to replace the
legitimate file with a link to another file, allowing the
editing of arbitrary files. To prevent this, starting with
version 1.8.16, symbolic links will not be followed in
writable directories and <b>sudoedit</b> will refuse to edit
a file located in a writable directory unless the
<i>sudoedit_checkdir</i> option has been disabled or the
invoking user is root. Additionally, in version 1.8.15 and
higher, <b>sudoedit</b> will refuse to open a symbolic link
unless either the <i>sudoedit_follow</i> option is enabled
or the <i>sudoedit</i> command is prefixed with the FOLLOW
tag in the <i>sudoers</i> file.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Time stamp
file checks <br>
sudoers</b> will check the ownership of its time stamp
directory (</p>

<p><i>/run/sudo/ts</i> by default ) and ignore the
directory&rsquo;s contents if it is not owned by root or if
it is writable by a user other than root. Older versions of
<b>sudo</b> stored time stamp files in <i>/tmp</i>; this is
no longer recommended as it may be possible for a user to
create the time stamp themselves on systems that allow
unprivileged users to change the ownership of files they
create.</p>

<p style="margin-left:6%; margin-top: 1em">While the time
stamp directory <i>should</i> be cleared at reboot time, not
all systems contain a <i>/run</i> or <i>/var/run</i>
directory. To avoid potential problems, <b>sudoers</b> will
ignore time stamp files that date from before the machine
booted on systems where the boot time is available.</p>

<p style="margin-left:6%; margin-top: 1em">Some systems
with graphical desktop environments allow unprivileged users
to change the system clock. Since <b>sudoers</b> relies on
the system clock for time stamp validation, it may be
possible on such systems for a user to run <b>sudo</b> for
longer than <i>timestamp_timeout</i> by setting the clock
back. To combat this, <b>sudoers</b> uses a monotonic clock
(which never moves backwards) for its time stamps if the
system supports it.</p>

<p style="margin-left:6%; margin-top: 1em"><b>sudoers</b>
will not honor time stamps set far in the future. Time
stamps with a date greater than current_time + 2 * TIMEOUT
will be ignored and <b>sudoers</b> will log and
complain.</p>

<p style="margin-left:6%; margin-top: 1em">If the
<i>timestamp_type</i> option is set to &ldquo;tty&rdquo;,
the time stamp record includes the device number of the
terminal the user authenticated with. This provides
per-terminal granularity but time stamp records may still
outlive the user&rsquo;s session.</p>

<p style="margin-left:6%; margin-top: 1em">Unless the
<i>timestamp_type</i> option is set to &ldquo;global&rdquo;,
the time stamp record also includes the session ID of the
process that last authenticated. This prevents processes in
different terminal sessions from using the same time stamp
record. On systems where a process&rsquo;s start time can be
queried, the start time of the session leader is recorded in
the time stamp record. If no terminal is present or the
<i>timestamp_type</i> option is set to &ldquo;ppid&rdquo;,
the start time of the parent process is used instead. In
most cases this will prevent a time stamp record from being
re-used without the user entering a password when logging
out and back in again.</p>

<p style="margin-top: 1em"><b>DEBUGGING</b></p>

<p style="margin-left:6%;">Versions 1.8.4 and higher of the
<b>sudoers</b> plugin support a flexible debugging framework
that can help track down what the plugin is doing internally
if there is a problem. This can be configured in the
sudo.conf(5) file.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>sudoers</b> plugin uses the same debug flag format as the
<b>sudo</b> front-end: <i>subsystem</i>@<i>priority</i>.</p>

<p style="margin-left:6%; margin-top: 1em">The priorities
used by <b>sudoers</b>, in order of decreasing severity,
are: <i>crit</i>, <i>err</i>, <i>warn</i>, <i>notice</i>,
<i>diag</i>, <i>info</i>, <i>trace</i>, and <i>debug</i>.
Each priority, when specified, also includes all priorities
higher than it. For example, a priority of <i>notice</i>
would include debug messages logged at <i>notice</i> and
higher.</p>

<p style="margin-left:6%; margin-top: 1em">The following
subsystems are used by the <b>sudoers</b> plugin:</p>

<p style="margin-top: 1em"><i>alias</i></p>

<p style="margin-left:19%; margin-top: 1em">User_Alias,
Runas_Alias, Host_Alias and Cmnd_Alias processing</p>

<p style="margin-top: 1em"><i>all</i></p>

<p style="margin-left:19%; margin-top: 1em">matches every
subsystem</p>

<p style="margin-top: 1em"><i>audit</i></p>

<p style="margin-left:19%; margin-top: 1em">BSM and Linux
audit code</p>

<p style="margin-top: 1em"><i>auth</i></p>

<p style="margin-left:19%; margin-top: 1em">user
authentication</p>

<p style="margin-top: 1em"><i>defaults</i></p>

<p style="margin-left:19%; margin-top: 1em"><i>sudoers</i>
file <i>Defaults</i> settings</p>

<p style="margin-top: 1em"><i>env</i></p>

<p style="margin-left:19%; margin-top: 1em">environment
handling</p>

<p style="margin-top: 1em"><i>ldap</i></p>

<p style="margin-left:19%; margin-top: 1em">LDAP-based
sudoers</p>

<p style="margin-top: 1em"><i>logging</i></p>

<p style="margin-left:19%; margin-top: 1em">logging
support</p>

<p style="margin-top: 1em"><i>match</i></p>

<p style="margin-left:19%; margin-top: 1em">matching of
users, groups, hosts, and netgroups in the <i>sudoers</i>
file</p>

<p style="margin-top: 1em"><i>netif</i></p>

<p style="margin-left:19%; margin-top: 1em">network
interface handling</p>

<p style="margin-top: 1em"><i>nss</i></p>

<p style="margin-left:19%; margin-top: 1em">network service
switch handling in <b>sudoers</b></p>

<p style="margin-top: 1em"><i>parser</i></p>

<p style="margin-left:19%; margin-top: 1em"><i>sudoers</i>
file parsing</p>

<p style="margin-top: 1em"><i>perms</i></p>

<p style="margin-left:19%; margin-top: 1em">permission
setting</p>

<p style="margin-top: 1em"><i>plugin</i></p>

<p style="margin-left:19%; margin-top: 1em">The equivalent
of <i>main</i> for the plugin.</p>

<p style="margin-top: 1em"><i>pty</i></p>


<p style="margin-left:19%; margin-top: 1em">pseudo-terminal
related code</p>

<p style="margin-top: 1em"><i>rbtree</i></p>

<p style="margin-left:19%; margin-top: 1em">redblack tree
internals</p>

<p style="margin-top: 1em"><i>sssd</i></p>

<p style="margin-left:19%; margin-top: 1em">SSSD-based
sudoers</p>

<p style="margin-top: 1em"><i>util</i></p>

<p style="margin-left:19%; margin-top: 1em">utility
functions</p>

<p style="margin-left:6%; margin-top: 1em">For example:</p>

<p style="margin-left:6%; margin-top: 1em">Debug sudoers.so
/var/log/sudoers_debug match@info,nss@info</p>

<p style="margin-left:6%; margin-top: 1em">For more
information, see the sudo.conf(5) manual.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">ssh(1), su(1), fnmatch(3),
glob(3), mktemp(3), strftime(3), sudo.conf(5),
sudo_plugin(5), sudoers.ldap(5), sudoers_timestamp(5),
sudo(8), visudo(8)</p>

<p style="margin-top: 1em"><b>AUTHORS</b></p>

<p style="margin-left:6%;">Many people have worked on
<b>sudo</b> over the years; this version consists of code
written primarily by:</p>

<p style="margin-left:14%; margin-top: 1em">Todd C.
Miller</p>

<p style="margin-left:6%; margin-top: 1em">See the
CONTRIBUTORS file in the <b>sudo</b> distribution
(https://www.sudo.ws/contributors.html) for an exhaustive
list of people who have contributed to <b>sudo</b>.</p>

<p style="margin-top: 1em"><b>CAVEATS</b></p>

<p style="margin-left:6%;">The <i>sudoers</i> file should
<b>always</b> be edited by the <b>visudo</b> utility which
locks the file and checks for syntax errors. If
<i>sudoers</i> contains syntax errors, <b>sudo</b> may
refuse to run, which is a serious problem if <b>sudo</b> is
your only method of obtaining superuser privileges. Recent
versions of <b>sudoers</b> will attempt to recover after a
syntax error by ignoring the rest of the line after
encountering an error. Older versions of <b>sudo</b> will
not run if <i>sudoers</i> contains a syntax error.</p>

<p style="margin-left:6%; margin-top: 1em">When using
netgroups of machines (as opposed to users), if you store
fully qualified host name in the netgroup (as is usually the
case), you either need to have the machine&rsquo;s host name
be fully qualified as returned by the hostname command or
use the <i>fqdn</i> option in <i>sudoers</i>.</p>

<p style="margin-top: 1em"><b>BUGS</b></p>

<p style="margin-left:6%;">If you feel you have found a bug
in <b>sudo</b>, please submit a bug report at
https://bugzilla.sudo.ws/</p>

<p style="margin-top: 1em"><b>SUPPORT</b></p>

<p style="margin-left:6%;">Limited free support is
available via the sudo-users mailing list, see
https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe
or search the archives.</p>

<p style="margin-top: 1em"><b>DISCLAIMER</b></p>

<p style="margin-left:6%;"><b>sudo</b> is provided
&ldquo;AS IS&rdquo; and any express or implied warranties,
including, but not limited to, the implied warranties of
merchantability and fitness for a particular purpose are
disclaimed. See the LICENSE file distributed with
<b>sudo</b> or https://www.sudo.ws/license.html for complete
details.</p>

<p style="margin-left:6%; margin-top: 1em">Sudo 1.9.9
January&nbsp;20, 2022 Sudo 1.9.9</p>
<hr>
</body>
</html>
