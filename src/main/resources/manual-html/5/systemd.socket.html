<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:38:57 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SYSTEMD.SOCKET</title>

</head>
<body>

<h1 align="center">SYSTEMD.SOCKET</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#AUTOMATIC DEPENDENCIES">AUTOMATIC DEPENDENCIES</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">systemd.socket
- Socket unit configuration</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>socket</i>.socket</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A unit
configuration file whose name ends in &quot;.socket&quot;
encodes information about an IPC or network socket or a file
system FIFO controlled and supervised by systemd, for
socket-based activation.</p>

<p style="margin-left:11%; margin-top: 1em">This man page
lists the configuration options specific to this unit type.
See <b>systemd.unit</b>(5) for the common options of all
unit configuration files. The common configuration items are
configured in the generic [Unit] and [Install] sections. The
socket specific configuration options are configured in the
[Socket] section.</p>

<p style="margin-left:11%; margin-top: 1em">Additional
options are listed in <b>systemd.exec</b>(5), which define
the execution environment the <b>ExecStartPre=</b>,
<b>ExecStartPost=</b>, <b>ExecStopPre=</b> and
<b>ExecStopPost=</b> commands are executed in, and in
<b>systemd.kill</b>(5), which define the way the processes
are terminated, and in <b>systemd.resource-control</b>(5),
which configure resource control settings for the processes
of the socket.</p>

<p style="margin-left:11%; margin-top: 1em">For each socket
unit, a matching service unit must exist, describing the
service to start on incoming traffic on the socket (see
<b>systemd.service</b>(5) for more information about
.service units). The name of the .service unit is by default
the same as the name of the .socket unit, but can be altered
with the <b>Service=</b> option described below. Depending
on the setting of the <b>Accept=</b> option described below,
this .service unit must either be named like the .socket
unit, but with the suffix replaced, unless overridden with
<b>Service=</b>; or it must be a template unit named the
same way. Example: a socket file foo.socket needs a matching
service foo.service if <b>Accept=no</b> is set. If
<b>Accept=yes</b> is set, a service template foo@.service
must exist from which services are instantiated for each
incoming connection.</p>

<p style="margin-left:11%; margin-top: 1em">No implicit
<i>WantedBy=</i> or <i>RequiredBy=</i> dependency from the
socket to the service is added. This means that the service
may be started without the socket, in which case it must be
able to open sockets by itself. To prevent this, an explicit
<i>Requires=</i> dependency may be added.</p>

<p style="margin-left:11%; margin-top: 1em">Socket units
may be used to implement on-demand starting of services, as
well as parallelized starting of services. See the blog
stories linked at the end for an introduction.</p>

<p style="margin-left:11%; margin-top: 1em">Note that the
daemon software configured for socket activation with socket
units needs to be able to accept sockets from systemd,
either via systemd's native socket passing interface (see
<a href="https://man.page/3/sd_listen_fds">sd_listen_fds(3)</a> for details about the precise
protocol used and the order in which the file descriptors
are passed) or via traditional <b>inetd</b>(8)-style socket
passing (i.e. sockets passed in via standard input and
output, using <i>StandardInput=socket</i> in the service
file).</p>

<p style="margin-left:11%; margin-top: 1em">All network
sockets allocated through .socket units are allocated in the
host's network namespace (see <a href="https://man.page/7/network_namespaces">network_namespaces(7)</a>).
This does not mean however that the service activated by a
configured socket unit has to be part of the host's network
namespace as well. It is supported and even good practice to
run services in their own network namespace (for example
through <i>PrivateNetwork=</i>, see <b>systemd.exec</b>(5)),
receiving only the sockets configured through
socket-activation from the host's namespace. In such a
set-up communication within the host's network namespace is
only permitted through the activation sockets passed in
while all sockets allocated from the service code itself
will be associated with the service's own namespace, and
thus possibly subject to a restrictive configuration.</p>

<h2>AUTOMATIC DEPENDENCIES
<a name="AUTOMATIC DEPENDENCIES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Implicit
Dependencies</b> <br>
The following dependencies are implicitly added:</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Socket
units automatically gain a <i>Before=</i> dependency on the
service units they activate.</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Socket
units referring to file system paths (such as <b>AF_UNIX</b>
sockets or FIFOs) implicitly gain <i>Requires=</i> and
<i>After=</i> dependencies on all mount units necessary to
access those paths.</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Socket
units using the <i>BindToDevice=</i> setting automatically
gain a <i>BindsTo=</i> and <i>After=</i> dependency on the
device unit encapsulating the specified network
interface.</p>

<p style="margin-left:11%; margin-top: 1em">Additional
implicit dependencies may be added as result of execution
and resource control parameters as documented in
<b>systemd.exec</b>(5) and
<b>systemd.resource-control</b>(5).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Default
Dependencies</b> <br>
The following dependencies are added unless
<i>DefaultDependencies=no</i> is set:</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Socket
units automatically gain a <i>Before=</i> dependency on
sockets.target.</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Socket
units automatically gain a pair of <i>After=</i> and
<i>Requires=</i> dependency on sysinit.target, and a pair of
<i>Before=</i> and <i>Conflicts=</i> dependencies on
shutdown.target. These dependencies ensure that the socket
unit is started before normal services at boot, and is
stopped on shutdown. Only sockets involved with early boot
or late system shutdown should disable
<i>DefaultDependencies=</i> option.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Socket files
must include a [Socket] section, which carries information
about the socket or FIFO it supervises. A number of options
that may be used in this section are shared with other unit
types. These options are documented in
<b>systemd.exec</b>(5) and <b>systemd.kill</b>(5). The
options specific to the [Socket] section of socket units are
the following:</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenStream=</i>,
<i>ListenDatagram=</i>, <i>ListenSequentialPacket=</i></p>

<p style="margin-left:17%;">Specifies an address to listen
on for a stream (<b>SOCK_STREAM</b>), datagram
(<b>SOCK_DGRAM</b>), or sequential packet
(<b>SOCK_SEQPACKET</b>) socket, respectively. The address
can be written in various formats:</p>

<p style="margin-left:17%; margin-top: 1em">If the address
starts with a slash (&quot;/&quot;), it is read as file
system socket in the <b>AF_UNIX</b> socket family.</p>

<p style="margin-left:17%; margin-top: 1em">If the address
starts with an at symbol (&quot;@&quot;), it is read as
abstract namespace socket in the <b>AF_UNIX</b> family. The
&quot;@&quot; is replaced with a <b>NUL</b> character before
binding. For details, see <a href="https://man.page/7/unix">unix(7)</a>.</p>

<p style="margin-left:17%; margin-top: 1em">If the address
string is a single number, it is read as port number to
listen on via IPv6. Depending on the value of
<i>BindIPv6Only=</i> (see below) this might result in the
service being available via both IPv6 and IPv4 (default) or
just via IPv6.</p>

<p style="margin-left:17%; margin-top: 1em">If the address
string is a string in the format
&quot;<i>v.w.x.y</i>:<i>z</i>&quot;, it is interpreted as
IPv4 address <i>v.w.x.y</i> and port <i>z</i>.</p>

<p style="margin-left:17%; margin-top: 1em">If the address
string is a string in the format
&quot;[<i>x</i>]:<i>y</i>&quot;, it is interpreted as IPv6
address <i>x</i> and port <i>y</i>. An optional interface
scope (interface name or number) may be specified after a
&quot;%&quot; symbol:
&quot;[<i>x</i>]:<i>y</i>%<i>dev</i>&quot;. Interface scopes
are only useful with link-local addresses, because the
kernel ignores them in other cases. Note that if an address
is specified as IPv6, it might still make the service
available via IPv4 too, depending on the
<i>BindIPv6Only=</i> setting (see below).</p>

<p style="margin-left:17%; margin-top: 1em">If the address
string is a string in the format
&quot;vsock:<i>x</i>:<i>y</i>&quot;, it is read as CID
<i>x</i> on a port <i>y</i> address in the <b>AF_VSOCK</b>
family. The CID is a unique 32-bit integer identifier in
<b>AF_VSOCK</b> analogous to an IP address. Specifying the
CID is optional, and may be set to the empty string.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
<b>SOCK_SEQPACKET</b> (i.e. <i>ListenSequentialPacket=</i>)
is only available for <b>AF_UNIX</b> sockets.
<b>SOCK_STREAM</b> (i.e. <i>ListenStream=</i>) when used for
IP sockets refers to TCP sockets, <b>SOCK_DGRAM</b> (i.e.
<i>ListenDatagram=</i>) to UDP.</p>

<p style="margin-left:17%; margin-top: 1em">These options
may be specified more than once, in which case incoming
traffic on any of the sockets will trigger service
activation, and all listed sockets will be passed to the
service, regardless of whether there is incoming traffic on
them or not. If the empty string is assigned to any of these
options, the list of addresses to listen on is reset, all
prior uses of any of these options will have no effect.</p>

<p style="margin-left:17%; margin-top: 1em">It is also
possible to have more than one socket unit for the same
service when using <i>Service=</i>, and the service will
receive all the sockets configured in all the socket units.
Sockets configured in one unit are passed in the order of
configuration, but no ordering between socket units is
specified.</p>

<p style="margin-left:17%; margin-top: 1em">If an IP
address is used here, it is often desirable to listen on it
before the interface it is configured on is up and running,
and even regardless of whether it will be up and running at
any point. To deal with this, it is recommended to set the
<i>FreeBind=</i> option described below.</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenFIFO=</i></p>

<p style="margin-left:17%;">Specifies a file system FIFO
(see <a href="https://man.page/7/fifo">fifo(7)</a> for details) to listen on. This expects
an absolute file system path as argument. Behavior otherwise
is very similar to the <i>ListenDatagram=</i> directive
above.</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenSpecial=</i></p>

<p style="margin-left:17%;">Specifies a special file in the
file system to listen on. This expects an absolute file
system path as argument. Behavior otherwise is very similar
to the <i>ListenFIFO=</i> directive above. Use this to open
character device nodes as well as special files in /proc/
and /sys/.</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenNetlink=</i></p>

<p style="margin-left:17%;">Specifies a Netlink family to
create a socket for to listen on. This expects a short
string referring to the <b>AF_NETLINK</b> family name (such
as <i>audit</i> or <i>kobject-uevent</i>) as argument,
optionally suffixed by a whitespace followed by a multicast
group integer. Behavior otherwise is very similar to the
<i>ListenDatagram=</i> directive above.</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenMessageQueue=</i></p>

<p style="margin-left:17%;">Specifies a POSIX message queue
name to listen on (see <a href="https://man.page/7/mq_overview">mq_overview(7)</a> for details).
This expects a valid message queue name (i.e. beginning with
&quot;/&quot;). Behavior otherwise is very similar to the
<i>ListenFIFO=</i> directive above. On Linux message queue
descriptors are actually file descriptors and can be
inherited between processes.</p>


<p style="margin-left:11%; margin-top: 1em"><i>ListenUSBFunction=</i></p>

<p style="margin-left:17%;">Specifies a
<b><font color="#0000FF">USB FunctionFS</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">endpoints location to listen on, for
implementation of USB gadget functions. This expects an
absolute file system path of a FunctionFS mount point as the
argument. Behavior otherwise is very similar to the
<i>ListenFIFO=</i> directive above. Use this to open the
FunctionFS endpoint ep0. When using this option, the
activated service has to have the
<i>USBFunctionDescriptors=</i> and
<i>USBFunctionStrings=</i> options set.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SocketProtocol=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of <b>udplite</b> or <b>sctp</b>. The socket will use the
UDP-Lite (<b>IPPROTO_UDPLITE</b>) or SCTP
(<b>IPPROTO_SCTP</b>) protocol, respectively.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>BindIPv6Only=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of <b>default</b>, <b>both</b> or <b>ipv6-only</b>. Controls
the IPV6_V6ONLY socket option (see <a href="https://man.page/7/ipv6">ipv6(7)</a> for
details). If <b>both</b>, IPv6 sockets bound will be
accessible via both IPv4 and IPv6. If <b>ipv6-only</b>, they
will be accessible via IPv6 only. If <b>default</b> (which
is the default, surprise!), the system wide default setting
is used, as controlled by /proc/sys/net/ipv6/bindv6only,
which in turn defaults to the equivalent of
<b>both</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Backlog=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
unsigned integer argument. Specifies the number of
connections to queue that have not been accepted yet. This
setting matters only for stream and sequential packet
sockets. See <a href="https://man.page/2/listen">listen(2)</a> for details. Defaults to
SOMAXCONN (128).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>BindToDevice=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Specifies
a network interface name to bind this socket to. If set,
traffic will only be accepted from the specified network
interfaces. This controls the <b>SO_BINDTODEVICE</b> socket
option (see <a href="https://man.page/7/socket">socket(7)</a> for details). If this option is
used, an implicit dependency from this socket unit on the
network interface device unit is created (see
<b>systemd.device</b>(5)). Note that setting this parameter
might result in additional dependencies to be added to the
unit (see above).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SocketUser=</i>,
<i>SocketGroup=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
UNIX user/group name. When specified, all <b>AF_UNIX</b>
sockets and FIFO nodes in the file system are owned by the
specified user and group. If unset (the default), the nodes
are owned by the root user/group (if run in system context)
or the invoking user/group (if run in user context). If only
a user is specified but no group, then the group is derived
from the user's default group.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SocketMode=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">If
listening on a file system socket or FIFO, this option
specifies the file system access mode used when creating the
file node. Takes an access mode in octal notation. Defaults
to 0666.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>DirectoryMode=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">If
listening on a file system socket or FIFO, the parent
directories are automatically created if needed. This option
specifies the file system access mode used when creating
these directories. Takes an access mode in octal notation.
Defaults to 0755.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Accept=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If yes, a service instance is spawned for
each incoming connection and only the connection socket is
passed to it. If no, all listening sockets themselves are
passed to the started service unit, and only one service
unit is spawned for all connections (also see above). This
value is ignored for datagram sockets and FIFOs where a
single service unit unconditionally handles all incoming
traffic. Defaults to <b>no</b>. For performance reasons, it
is recommended to write new daemons only in a way that is
suitable for <b>Accept=no</b>. A daemon listening on an
<b>AF_UNIX</b> socket may, but does not need to, call
<a href="https://man.page/2/close">close(2)</a> on the received socket before exiting.
However, it must not unlink the socket from a file system.
It should not invoke <a href="https://man.page/2/shutdown">shutdown(2)</a> on sockets it got
with <i>Accept=no</i>, but it may do so for sockets it got
with <i>Accept=yes</i> set. Setting <i>Accept=yes</i> is
mostly useful to allow daemons designed for usage with
<b>inetd</b>(8) to work unmodified with systemd socket
activation.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">For
IPv4 and IPv6 connections, the <i>REMOTE_ADDR</i>
environment variable will contain the remote IP address, and
<i>REMOTE_PORT</i> will contain the remote port. This is the
same as the format used by CGI. For <b>SOCK_RAW</b>, the
port is the IP protocol.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Writable=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. May only be used in conjunction with
<i>ListenSpecial=</i>. If true, the specified special file
is opened in read-write mode, if false, in read-only mode.
Defaults to false.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>FlushPending=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. May only be used when <b>Accept=no</b>. If
yes, the socket's buffers are cleared after the triggered
service exited. This causes any pending data to be flushed
and any pending incoming connections to be rejected. If no,
the socket's buffers won't be cleared, permitting the
service to handle any pending connections after restart,
which is the usually expected behaviour. Defaults to
<b>no</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MaxConnections=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
maximum number of connections to simultaneously run services
instances for, when <b>Accept=yes</b> is set. If more
concurrent connections are coming in, they will be refused
until at least one existing connection is terminated. This
setting has no effect on sockets configured with
<b>Accept=no</b> or datagram sockets. Defaults to
64.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MaxConnectionsPerSource=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
maximum number of connections for a service per source IP
address. This is very similar to the <i>MaxConnections=</i>
directive above. Disabled by default.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>KeepAlive=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, the TCP/IP stack will send a keep
alive message after 2h (depending on the configuration of
/proc/sys/net/ipv4/tcp_keepalive_time) for all TCP streams
accepted on this socket. This controls the
<b>SO_KEEPALIVE</b> socket option (see <a href="https://man.page/7/socket">socket(7)</a> and
the</font> <b><font color="#0000FF">TCP Keepalive
HOWTO</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">for details.) Defaults to
<b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>KeepAliveTimeSec=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes
time (in seconds) as argument. The connection needs to
remain idle before TCP starts sending keepalive probes. This
controls the TCP_KEEPIDLE socket option (see
<a href="https://man.page/7/socket">socket(7)</a> and the</font> <b><font color="#0000FF">TCP
Keepalive HOWTO</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">for details.) Defaults value is 7200
seconds (2 hours).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>KeepAliveIntervalSec=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes
time (in seconds) as argument between individual keepalive
probes, if the socket option <b>SO_KEEPALIVE</b> has been
set on this socket. This controls the <b>TCP_KEEPINTVL</b>
socket option (see <a href="https://man.page/7/socket">socket(7)</a> and the</font>
<b><font color="#0000FF">TCP Keepalive HOWTO</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">for details.) Defaults value is 75
seconds.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>KeepAliveProbes=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer as argument. It is the number of unacknowledged
probes to send before considering the connection dead and
notifying the application layer. This controls the
TCP_KEEPCNT socket option (see <a href="https://man.page/7/socket">socket(7)</a> and
the</font> <b><font color="#0000FF">TCP Keepalive
HOWTO</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">for details.) Defaults value is
9.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>NoDelay=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. TCP Nagle's algorithm works by combining a
number of small outgoing messages, and sending them all at
once. This controls the TCP_NODELAY socket option (see
<a href="https://man.page/7/tcp">tcp(7)</a>). Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Priority=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer argument controlling the priority for all traffic
sent from this socket. This controls the <b>SO_PRIORITY</b>
socket option (see <a href="https://man.page/7/socket">socket(7)</a> for
details.).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>DeferAcceptSec=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes
time (in seconds) as argument. If set, the listening process
will be awakened only when data arrives on the socket, and
not immediately when connection is established. When this
option is set, the <b>TCP_DEFER_ACCEPT</b> socket option
will be used (see <a href="https://man.page/7/tcp">tcp(7)</a>), and the kernel will ignore
initial ACK packets without any data. The argument specifies
the approximate amount of time the kernel should wait for
incoming data before falling back to the normal behavior of
honoring empty ACK packets. This option is beneficial for
protocols where the client sends the data first (e.g. HTTP,
in contrast to SMTP), because the server process will not be
woken up unnecessarily before it can take any
action.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the client also uses the <b>TCP_DEFER_ACCEPT</b> option, the
latency of the initial connection may be reduced, because
the kernel will send data in the final packet establishing
the connection (the third packet in the &quot;three-way
handshake&quot;).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Disabled
by default.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ReceiveBuffer=</i>,
<i>SendBuffer=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer argument controlling the receive or send buffer
sizes of this socket, respectively. This controls the
<b>SO_RCVBUF</b> and <b>SO_SNDBUF</b> socket options (see
<a href="https://man.page/7/socket">socket(7)</a> for details.). The usual suffixes K, M, G
are supported and are understood to the base of
1024.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IPTOS=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer argument controlling the IP Type-Of-Service field
for packets generated from this socket. This controls the
<b>IP_TOS</b> socket option (see <a href="https://man.page/7/ip">ip(7)</a> for details.).
Either a numeric string or one of <b>low-delay</b>,
<b>throughput</b>, <b>reliability</b> or <b>low-cost</b> may
be specified.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IPTTL=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer argument controlling the IPv4 Time-To-Live/IPv6
Hop-Count field for packets generated from this socket. This
sets the <b>IP_TTL</b>/<b>IPV6_UNICAST_HOPS</b> socket
options (see <a href="https://man.page/7/ip">ip(7)</a> and <a href="https://man.page/7/ipv6">ipv6(7)</a> for
details.)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Mark=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
integer value. Controls the firewall mark of packets
generated by this socket. This can be used in the firewall
logic to filter packets from this socket. This sets the
<b>SO_MARK</b> socket option. See <b>iptables</b>(8) for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ReusePort=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. If true, allows multiple <a href="https://man.page/2/bind">bind(2)</a>s to
this TCP or UDP port. This controls the <b>SO_REUSEPORT</b>
socket option. See <a href="https://man.page/7/socket">socket(7)</a> for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SmackLabel=</i>,
<i>SmackLabelIPIn=</i>, <i>SmackLabelIPOut=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
string value. Controls the extended attributes
&quot;security.SMACK64&quot;,
&quot;security.SMACK64IPIN&quot; and
&quot;security.SMACK64IPOUT&quot;, respectively, i.e. the
security label of the FIFO, or the security label for the
incoming or outgoing connections of the socket,
respectively. See</font>
<b><font color="#0000FF">Smack.txt</font></b>
<small><font color="#000000">[3]</font></small>
<font color="#000000">for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SELinuxContextFromNet=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. When true, systemd will attempt to figure
out the SELinux label used for the instantiated service from
the information handed by the peer over the network. Note
that only the security level is used from the information
provided by the peer. Other parts of the resulting SELinux
context originate from either the target binary that is
effectively triggered by socket unit or from the value of
the <i>SELinuxContext=</i> option. This configuration option
applies only when activated service is passed in single
socket file descriptor, i.e. service instances that have
standard input connected to a socket or services triggered
by exactly one socket unit. Also note that this option is
useful only when MLS/MCS SELinux policy is deployed.
Defaults to &quot;false&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PipeSize=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
size in bytes. Controls the pipe buffer size of FIFOs
configured in this socket unit. See <a href="https://man.page/2/fcntl">fcntl(2)</a> for
details. The usual suffixes K, M, G are supported and are
understood to the base of 1024.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MessageQueueMaxMessages=</i>,
<i>MessageQueueMessageSize=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">These two
settings take integer values and control the mq_maxmsg field
or the mq_msgsize field, respectively, when creating the
message queue. Note that either none or both of these
variables need to be set. See <a href="https://man.page/3/mq_setattr">mq_setattr(3)</a> for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>FreeBind=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. Controls whether the socket can be bound to
non-local IP addresses. This is useful to configure sockets
listening on specific IP addresses before those IP addresses
are successfully configured on a network interface. This
sets the <b>IP_FREEBIND</b>/<b>IPV6_FREEBIND</b> socket
option. For robustness reasons it is recommended to use this
option whenever you bind a socket to a specific IP address.
Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Transparent=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. Controls the
<b>IP_TRANSPARENT</b>/<b>IPV6_TRANSPARENT</b> socket option.
Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Broadcast=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. This controls the <b>SO_BROADCAST</b> socket
option, which allows broadcast datagrams to be sent from
this socket. Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PassCredentials=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. This controls the <b>SO_PASSCRED</b> socket
option, which allows <b>AF_UNIX</b> sockets to receive the
credentials of the sending process in an ancillary message.
Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PassSecurity=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. This controls the <b>SO_PASSSEC</b> socket
option, which allows <b>AF_UNIX</b> sockets to receive the
security context of the sending process in an ancillary
message. Defaults to <b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PassPacketInfo=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean value. This controls the <b>IP_PKTINFO</b>,
<b>IPV6_RECVPKTINFO</b>, <b>NETLINK_PKTINFO</b> or
<b>PACKET_AUXDATA</b> socket options, which enable reception
of additional per-packet metadata as ancillary message, on
<b>AF_INET</b>, <b>AF_INET6</b>, <b>AF_UNIX</b> and
<b>AF_PACKET</b> sockets. Defaults to
<b>false</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Timestamping=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of &quot;off&quot;, &quot;us&quot; (alias: &quot;usec&quot;,
&quot;&micro;s&quot;) or &quot;ns&quot; (alias:
&quot;nsec&quot;). This controls the <b>SO_TIMESTAMP</b> or
<b>SO_TIMESTAMPNS</b> socket options, and enables whether
ingress network traffic shall carry timestamping metadata.
Defaults to <b>off</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TCPCongestion=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
string value. Controls the TCP congestion algorithm used by
this socket. Should be one of &quot;westwood&quot;,
&quot;veno&quot;, &quot;cubic&quot;, &quot;lp&quot; or any
other available algorithm supported by the IP stack. This
setting applies only to stream sockets.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ExecStartPre=</i>,
<i>ExecStartPost=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
or more command lines, which are executed before or after
the listening sockets/FIFOs are created and bound,
respectively. The first token of the command line must be an
absolute filename, then followed by arguments for the
process. Multiple command lines may be specified following
the same scheme as used for <i>ExecStartPre=</i> of service
unit files.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ExecStopPre=</i>,
<i>ExecStopPost=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Additional
commands that are executed before or after the listening
sockets/FIFOs are closed and removed, respectively. Multiple
command lines may be specified following the same scheme as
used for <i>ExecStartPre=</i> of service unit
files.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TimeoutSec=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
the time to wait for the commands specified in
<i>ExecStartPre=</i>, <i>ExecStartPost=</i>,
<i>ExecStopPre=</i> and <i>ExecStopPost=</i> to finish. If a
command does not exit within the configured time, the socket
will be considered failed and be shut down again. All
commands still running will be terminated forcibly via
<b>SIGTERM</b>, and after another delay of this time with
<b>SIGKILL</b>. (See <b>KillMode=</b> in
<b>systemd.kill</b>(5).) Takes a unit-less value in seconds,
or a time span value such as &quot;5min 20s&quot;. Pass
&quot;0&quot; to disable the timeout logic. Defaults to
<i>DefaultTimeoutStartSec=</i> from the manager
configuration file (see
<b>systemd-system.conf</b>(5)).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Service=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Specifies
the service unit name to activate on incoming traffic. This
setting is only allowed for sockets with <i>Accept=no</i>.
It defaults to the service that bears the same name as the
socket (with the suffix replaced). In most cases, it should
not be necessary to use this option. Note that setting this
parameter might result in additional dependencies to be
added to the unit (see above).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RemoveOnStop=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If enabled, any file nodes created by this
socket unit are removed when it is stopped. This applies to
<b>AF_UNIX</b> sockets in the file system, POSIX message
queues, FIFOs, as well as any symlinks to them configured
with <i>Symlinks=</i>. Normally, it should not be necessary
to use this option, and is not recommended as services might
continue to run after the socket unit has been terminated
and it should still be possible to communicate with them via
their file system node. Defaults to off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Symlinks=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
list of file system paths. The specified paths will be
created as symlinks to the <b>AF_UNIX</b> socket path or
FIFO path of this socket unit. If this setting is used, only
one <b>AF_UNIX</b> socket in the file system or one FIFO may
be configured for the socket unit. Use this option to manage
one or more symlinked alias names for a socket, binding
their lifecycle together. Note that if creation of a symlink
fails this is not considered fatal for the socket unit, and
the socket unit may still start. If an empty string is
assigned, the list of paths is reset. Defaults to an empty
list.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>FileDescriptorName=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Assigns a
name to all file descriptors this socket unit encapsulates.
This is useful to help activated services identify specific
file descriptors, if multiple fds are passed. Services may
use the <a href="https://man.page/3/sd_listen_fds_with_names">sd_listen_fds_with_names(3)</a> call to acquire
the names configured for the received file descriptors.
Names may contain any ASCII character, but must exclude
control characters and &quot;:&quot;, and must be at most
255 characters in length. If this setting is not used, the
file descriptor name defaults to the name of the socket
unit, including its .socket suffix.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TriggerLimitIntervalSec=</i>,
<i>TriggerLimitBurst=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
a limit on how often this socket unit my be activated within
a specific time interval. The
<i>TriggerLimitIntervalSec=</i> may be used to configure the
length of the time interval in the usual time units
&quot;us&quot;, &quot;ms&quot;, &quot;s&quot;,
&quot;min&quot;, &quot;h&quot;, ... and defaults to 2s (See
<b>systemd.time</b>(7) for details on the various time units
understood). The <i>TriggerLimitBurst=</i> setting takes a
positive integer value and specifies the number of permitted
activations per time interval, and defaults to 200 for
<i>Accept=yes</i> sockets (thus by default permitting 200
activations per 2s), and 20 otherwise (20 activations per
2s). Set either to 0 to disable any form of trigger rate
limiting. If the limit is hit, the socket unit is placed
into a failure mode, and will not be connectible anymore
until restarted. Note that this limit is enforced before the
service activation is enqueued.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Check
<b>systemd.exec</b>(5) and <b>systemd.kill</b>(5) for more
settings.</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><a href="https://man.page/1/systemd">systemd(1)</a>,
<a href="https://man.page/1/systemctl">systemctl(1)</a>, <b>systemd-system.conf</b>(5),
<b>systemd.unit</b>(5), <b>systemd.exec</b>(5),
<b>systemd.kill</b>(5), <b>systemd.resource-control</b>(5),
<b>systemd.service</b>(5), <b>systemd.directives</b>(7),
<a href="https://man.page/3/sd_listen_fds">sd_listen_fds(3)</a>,
<a href="https://man.page/3/sd_listen_fds_with_names">sd_listen_fds_with_names(3)</a></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
more extensive descriptions see the &quot;systemd for
Developers&quot; series:</font>
<b><font color="#0000FF">Socket Activation</font></b>
<small><font color="#000000">[4]</font></small>
<font color="#000000">,</font>
<b><font color="#0000FF">Socket Activation, part
II</font></b>
<small><font color="#000000">[5]</font></small>
<font color="#000000">,</font>
<b><font color="#0000FF">Converting inetd
Services</font></b>
<small><font color="#000000">[6]</font></small>
<font color="#000000">,</font>
<b><font color="#0000FF">Socket Activated Internet Services
and OS Containers</font></b>
<small><font color="#000000">[7]</font></small>
<font color="#000000">.</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="21%">


<p style="margin-top: 1em"><font color="#000000">USB
FunctionFS</font></p> </td>
<td width="62%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://www.kernel.org/doc/Documentation/usb/functionfs.txt</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">2.</font></p> </td>
<td width="2%"></td>
<td width="29%">


<p style="margin-top: 1em"><font color="#000000">TCP
Keepalive HOWTO</font></p></td>
<td width="54%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://www.tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">3.</font></p> </td>
<td width="2%"></td>
<td width="14%">



<p style="margin-top: 1em"><font color="#000000">Smack.txt</font></p> </td>
<td width="69%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://www.kernel.org/doc/Documentation/security/Smack.txt</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">4.</font></p> </td>
<td width="2%"></td>
<td width="26%">


<p style="margin-top: 1em"><font color="#000000">Socket
Activation</font></p> </td>
<td width="57%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://0pointer.de/blog/projects/socket-activation.html</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">5.</font></p> </td>
<td width="2%"></td>
<td width="40%">


<p style="margin-top: 1em"><font color="#000000">Socket
Activation, part II</font></p></td>
<td width="43%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://0pointer.de/blog/projects/socket-activation2.html</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">6.</font></p> </td>
<td width="2%"></td>
<td width="38%">



<p style="margin-top: 1em"><font color="#000000">Converting
inetd Services</font></p></td>
<td width="45%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://0pointer.de/blog/projects/inetd.html</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">7.</font></p> </td>
<td width="2%"></td>
<td width="80%">


<p style="margin-top: 1em"><font color="#000000">Socket
Activated Internet Services and OS Containers</font></p></td>
<td width="3%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://0pointer.de/blog/projects/socket-activated-containers.html</font></p>
<hr>
</body>
</html>
