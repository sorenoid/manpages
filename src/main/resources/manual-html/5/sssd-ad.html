<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:39:12 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SSSD-AD</title>

</head>
<body>

<h1 align="center">SSSD-AD</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFIGURATION OPTIONS">CONFIGURATION OPTIONS</a><br>
<a href="#MODIFIED DEFAULT OPTIONS">MODIFIED DEFAULT OPTIONS</a><br>
<a href="#FAILOVER">FAILOVER</a><br>
<a href="#SERVICE DISCOVERY">SERVICE DISCOVERY</a><br>
<a href="#ID MAPPING">ID MAPPING</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">sssd-ad - SSSD
Active Directory provider</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page describes the configuration of the AD provider for
<b>sssd</b>(8). For a detailed syntax reference, refer to
the &ldquo;FILE FORMAT&rdquo; section of the
<b>sssd.conf</b>(5) manual page.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
is a back end used to connect to an Active Directory server.
This provider requires that the machine be joined to the AD
domain and a keytab is available. Back end communication
occurs over a GSSAPI-encrypted channel, SSL/TLS options
should not be used with the AD provider and will be
superseded by Kerberos usage.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
supports connecting to Active Directory 2008 R2 or later.
Earlier versions may work, but are unsupported.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
can be used to get user information and authenticate users
from trusted domains. Currently only trusted domains in the
same forest are recognized. In addition servers from trusted
domains are always auto-discovered.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
enables SSSD to use the <a href="https://man.page/5/sssd-ldap">sssd-ldap(5)</a> identity
provider and the <a href="https://man.page/5/sssd-krb5">sssd-krb5(5)</a> authentication provider
with optimizations for Active Directory environments. The AD
provider accepts the same options used by the sssd-ldap and
sssd-krb5 providers with some exceptions. However, it is
neither necessary nor recommended to set these options.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
primarily copies the traditional ldap and krb5 provider
default options with some exceptions, the differences are
listed in the &ldquo;MODIFIED DEFAULT OPTIONS&rdquo;
section.</p>

<p style="margin-left:11%; margin-top: 1em">The AD provider
can also be used as an access, chpass, sudo and autofs
provider. No configuration of the access provider is
required on the client side.</p>

<p style="margin-left:11%; margin-top: 1em">If
&ldquo;auth_provider=ad&rdquo; or
&ldquo;access_provider=ad&rdquo; is configured in sssd.conf
then the id_provider must also be set to
&ldquo;ad&rdquo;.</p>

<p style="margin-left:11%; margin-top: 1em">By default, the
AD provider will map UID and GID values from the objectSID
parameter in Active Directory. For details on this, see the
&ldquo;ID MAPPING&rdquo; section below. If you want to
disable ID mapping and instead rely on POSIX attributes
defined in Active Directory, you should set</p>


<p style="margin-left:17%; margin-top: 1em">ldap_id_mapping
= False</p>

<p style="margin-left:11%; margin-top: 1em">If POSIX
attributes should be used, it is recommended for performance
reasons that the attributes are also replicated to the
Global Catalog. If POSIX attributes are replicated, SSSD
will attempt to locate the domain of a requested numerical
ID with the help of the Global Catalog and only search that
domain. In contrast, if POSIX attributes are not replicated
to the Global Catalog, SSSD must search all the domains in
the forest sequentially. Please note that the
&ldquo;cache_first&rdquo; option might be also helpful in
speeding up domainless searches. Note that if only a subset
of POSIX attributes is present in the Global Catalog, the
non-replicated attributes are currently not read from the
LDAP port.</p>

<p style="margin-left:11%; margin-top: 1em">Users, groups
and other entities served by SSSD are always treated as
case-insensitive in the AD provider for compatibility with
Active Directory's LDAP implementation.</p>

<h2>CONFIGURATION OPTIONS
<a name="CONFIGURATION OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Refer to the
section &ldquo;DOMAIN SECTIONS&rdquo; of the
<b>sssd.conf</b>(5) manual page for details on the
configuration of an SSSD domain.</p>

<p style="margin-left:11%; margin-top: 1em">ad_domain
(string)</p>

<p style="margin-left:17%;">Specifies the name of the
Active Directory domain. This is optional. If not provided,
the configuration domain name is used.</p>

<p style="margin-left:17%; margin-top: 1em">For proper
operation, this option should be specified as the lower-case
version of the long version of the Active Directory
domain.</p>

<p style="margin-left:17%; margin-top: 1em">The short
domain name (also known as the NetBIOS or the flat name) is
autodetected by the SSSD.</p>


<p style="margin-left:11%; margin-top: 1em">ad_enabled_domains
(string)</p>

<p style="margin-left:17%;">A comma-separated list of
enabled Active Directory domains. If provided, SSSD will
ignore any domains not listed in this option. If left unset,
all domains from the AD forest will be available.</p>

<p style="margin-left:17%; margin-top: 1em">For proper
operation, this option must be specified in all lower-case
and as the fully qualified domain name of the Active
Directory domain. For example:</p>


<p style="margin-left:23%; margin-top: 1em">ad_enabled_domains
= sales.example.com, eng.example.com</p>

<p style="margin-left:17%; margin-top: 1em">The short
domain name (also known as the NetBIOS or the flat name)
will be autodetected by SSSD.</p>

<p style="margin-left:17%; margin-top: 1em">Default: Not
set</p>

<p style="margin-left:11%; margin-top: 1em">ad_server,
ad_backup_server (string)</p>

<p style="margin-left:17%;">The comma-separated list of
hostnames of the AD servers to which SSSD should connect in
order of preference. For more information on failover and
server redundancy, see the &ldquo;FAILOVER&rdquo;
section.</p>

<p style="margin-left:17%; margin-top: 1em">This is
optional if autodiscovery is enabled. For more information
on service discovery, refer to the &ldquo;SERVICE
DISCOVERY&rdquo; section.</p>

<p style="margin-left:17%; margin-top: 1em">Note: Trusted
domains will always auto-discover servers even if the
primary server is explicitly defined in the ad_server
option.</p>

<p style="margin-left:11%; margin-top: 1em">ad_hostname
(string)</p>

<p style="margin-left:17%;">Optional. On machines where the
hostname(5) does not reflect the fully qualified name, sssd
will try to expand the short name. If it is not possible or
the short name should be really used instead, set this
parameter explicitly.</p>

<p style="margin-left:17%; margin-top: 1em">This field is
used to determine the host principal in use in the keytab
and to perform dynamic DNS updates. It must match the
hostname for which the keytab was issued.</p>


<p style="margin-left:11%; margin-top: 1em">ad_enable_dns_sites
(boolean)</p>

<p style="margin-left:17%;">Enables DNS sites - location
based service discovery.</p>

<p style="margin-left:17%; margin-top: 1em">If true and
service discovery (see Service Discovery paragraph at the
bottom of the man page) is enabled, the SSSD will first
attempt to discover the Active Directory server to connect
to using the Active Directory Site Discovery and fall back
to the DNS SRV records if no AD site is found. The DNS SRV
configuration, including the discovery domain, is used
during site discovery as well.</p>

<p style="margin-left:17%; margin-top: 1em">Default:
true</p>


<p style="margin-left:11%; margin-top: 1em">ad_access_filter
(string)</p>

<p style="margin-left:17%;">This option specifies LDAP
access control filter that the user must match in order to
be allowed access. Please note that the
&ldquo;access_provider&rdquo; option must be explicitly set
to &ldquo;ad&rdquo; in order for this option to have an
effect.</p>

<p style="margin-left:17%; margin-top: 1em">The option also
supports specifying different filters per domain or forest.
This extended filter would consist of:
&ldquo;KEYWORD:NAME:FILTER&rdquo;. The keyword can be either
&ldquo;DOM&rdquo;, &ldquo;FOREST&rdquo; or missing.</p>

<p style="margin-left:17%; margin-top: 1em">If the keyword
equals to &ldquo;DOM&rdquo; or is missing, then
&ldquo;NAME&rdquo; specifies the domain or subdomain the
filter applies to. If the keyword equals to
&ldquo;FOREST&rdquo;, then the filter equals to all domains
from the forest specified by &ldquo;NAME&rdquo;.</p>

<p style="margin-left:17%; margin-top: 1em">Multiple
filters can be separated with the &ldquo;?&rdquo; character,
similarly to how search bases work.</p>

<p style="margin-left:17%; margin-top: 1em">Nested group
membership must be searched for using a special OID
&ldquo;:1.2.840.113556.1.4.1941:&rdquo; in addition to the
full DOM:domain.example.org: syntax to ensure the parser
does not attempt to interpret the colon characters
associated with the OID. If you do not use this OID then
nested group membership will not be resolved. See usage
example below and refer here for further information about
the OID: <b><font color="#0000FF">[MS-ADTS] section LDAP
extensions</font></b>
<small><font color="#000000">[1]</font></small></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
most specific match is always used. For example, if the
option specified filter for a domain the user is a member of
and a global filter, the per-domain filter would be applied.
If there are more matches with the same specification, the
first one is used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Examples:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">#
apply filter on domain called dom1 only: <br>

dom1:(memberOf=cn=admins,ou=groups,dc=dom1,dc=com)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">#
apply filter on domain called dom2 only: <br>

DOM:dom2:(memberOf=cn=admins,ou=groups,dc=dom2,dc=com)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">#
apply filter on forest called EXAMPLE.COM only: <br>

FOREST:EXAMPLE.COM:(memberOf=cn=admins,ou=groups,dc=example,dc=com)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">#
apply filter for a member of a nested group in dom1: <br>

DOM:dom1:(memberOf:1.2.840.113556.1.4.1941:=cn=nestedgroup,ou=groups,dc=example,dc=com)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
Not set</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_site
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
AD site to which client should try to connect. If this
option is not provided, the AD site will be
auto-discovered.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
Not set</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_enable_gc
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">By
default, the SSSD connects to the Global Catalog first to
retrieve users from trusted domains and uses the LDAP port
to retrieve group memberships or as a fallback. Disabling
this option makes the SSSD only connect to the LDAP port of
the current AD server.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note that disabling Global Catalog support does not disable
retrieving users from trusted domains. The SSSD would
connect to the LDAP port of trusted domains instead.
However, Global Catalog must be used in order to resolve
cross-domain group memberships.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
true</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_access_control
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the operation mode for GPO-based access
control functionality: whether it operates in disabled mode,
enforcing mode, or permissive mode. Please note that the
&ldquo;access_provider&rdquo; option must be explicitly set
to &ldquo;ad&rdquo; in order for this option to have an
effect.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">GPO-based
access control functionality uses GPO policy settings to
determine whether or not a particular user is allowed to
logon to the host. For more information on the supported
policy settings please refer to the &ldquo;ad_gpo_map&rdquo;
options.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note that current version of SSSD does not support Active
Directory's built-in groups. Built-in groups (such as
Administrators with SID S-1-5-32-544) in GPO access control
rules will be ignored by SSSD. See upstream issue tracker
https://github.com/SSSD/sssd/issues/5063 .</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Before
performing access control SSSD applies group policy security
filtering on the GPOs. For every single user login, the
applicability of the GPOs that are linked to the host is
checked. In order for a GPO to apply to a user, the user or
at least one of the groups to which it belongs must have
following permissions on the GPO:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
Read: The user or one of its groups must have read access to
the properties of the GPO
(RIGHT_DS_READ_PROPERTY)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
Apply Group Policy: The user or at least one of its groups
must be allowed to apply the GPO
(RIGHT_DS_CONTROL_ACCESS).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">By
default, the Authenticated Users group is present on a GPO
and this group has both Read and Apply Group Policy access
rights. Since authentication of a user must have been
completed successfully before GPO security filtering and
access control are started, the Authenticated Users group
permissions on the GPO always apply also to the
user.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">NOTE:
If the operation mode is set to enforcing, it is possible
that users that were previously allowed logon access will
now be denied logon access (as dictated by the GPO policy
settings). In order to facilitate a smooth transition for
administrators, a permissive mode is available that will not
enforce the access control rules, but will evaluate them and
will output a syslog message if access would have been
denied. By examining the logs, administrators can then make
the necessary changes before setting the mode to enforcing.
For logging GPO-based access control debug level 'trace
functions' is required (see <b>sssctl</b>(8) manual
page).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">There
are three supported values for this option:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
disabled: GPO-based access control rules are neither
evaluated nor enforced.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
enforcing: GPO-based access control rules are evaluated and
enforced.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
permissive: GPO-based access control rules are evaluated,
but not enforced. Instead, a syslog message will be emitted
indicating that the user would have been denied access if
this option's value were set to enforcing.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
enforcing</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_implicit_deny
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">Normally
when no applicable GPOs are found the users are allowed
access. When this option is set to True users will be
allowed access only when explicitly allowed by a GPO rule.
Otherwise users will be denied access. This can be used to
harden security but be careful when using this option
because it can deny access even to users in the built-in
Administrators group if no GPO rules apply to
them.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
False</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
following 2 tables should illustrate when a user is allowed
or rejected based on the allow and deny login rights defined
on the server-side and the setting of
ad_gpo_implicit_deny.</font></p>


<p align="center" style="margin-top: 1em"><font color="#000000"><img src="grohtml-3470561.png" alt="Image grohtml-3470561.png"></font></p>


<p align="center" style="margin-top: 1em"><font color="#000000"><img src="grohtml-3470562.png" alt="Image grohtml-3470562.png"></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_ignore_unreadable
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">Normally
when some group policy containers (AD object) of applicable
group policy objects are not readable by SSSD then users are
denied access. This option allows to ignore group policy
containers and with them associated policies if their
attributes in group policy containers are not readable for
SSSD.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
False</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_cache_timeout
(integer)</font></p>

<p style="margin-left:17%;"><font color="#000000">The
amount of time between lookups of GPO policy files against
the AD server. This will reduce the latency and load on the
AD server if there are many access-control requests made in
a short period.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
5 (seconds)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_interactive
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access control is evaluated based on the
InteractiveLogonRight and DenyInteractiveLogonRight policy
settings. Only those GPOs are evaluated for which the user
has Read and Apply Group Policy permission (see option
&ldquo;ad_gpo_access_control&rdquo;). If an evaluated GPO
contains the deny interactive logon setting for the user or
one of its groups, the user is denied local access. If none
of the evaluated GPOs has an interactive logon right
defined, the user is granted local access. If at least one
evaluated GPO contains interactive logon right settings, the
user is granted local access only, if it or at least one of
its groups is part of the policy settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Using the Group Policy Management Editor this value is
called &quot;Allow log on locally&quot; and &quot;Deny log
on locally&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add another PAM service name to the default
set by using &ldquo;+service_name&rdquo; or to explicitly
remove a PAM service name from the default set by using
&ldquo;-service_name&rdquo;. For example, in order to
replace a default PAM service name for this logon right
(e.g. &ldquo;login&rdquo;) with a custom pam service name
(e.g. &ldquo;my_pam_service&rdquo;), you would use the
following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_interactive
= +my_pam_service, -login</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
the default set of PAM service names includes:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
login</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
su</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
su-l</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
gdm-fingerprint</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
gdm-password</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
gdm-smartcard</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
kdm</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
lightdm</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
lxdm</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
sddm</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
unity</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
xdm</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_remote_interactive
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access control is evaluated based on the
RemoteInteractiveLogonRight and
DenyRemoteInteractiveLogonRight policy settings. Only those
GPOs are evaluated for which the user has Read and Apply
Group Policy permission (see option
&ldquo;ad_gpo_access_control&rdquo;). If an evaluated GPO
contains the deny remote logon setting for the user or one
of its groups, the user is denied remote interactive access.
If none of the evaluated GPOs has a remote interactive logon
right defined, the user is granted remote access. If at
least one evaluated GPO contains remote interactive logon
right settings, the user is granted remote access only, if
it or at least one of its groups is part of the policy
settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Using the Group Policy Management Editor this value is
called &quot;Allow log on through Remote Desktop
Services&quot; and &quot;Deny log on through Remote Desktop
Services&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add another PAM service name to the default
set by using &ldquo;+service_name&rdquo; or to explicitly
remove a PAM service name from the default set by using
&ldquo;-service_name&rdquo;. For example, in order to
replace a default PAM service name for this logon right
(e.g. &ldquo;sshd&rdquo;) with a custom pam service name
(e.g. &ldquo;my_pam_service&rdquo;), you would use the
following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_remote_interactive
= +my_pam_service, -sshd</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
the default set of PAM service names includes:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
sshd</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
cockpit</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_network
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access control is evaluated based on the
NetworkLogonRight and DenyNetworkLogonRight policy settings.
Only those GPOs are evaluated for which the user has Read
and Apply Group Policy permission (see option
&ldquo;ad_gpo_access_control&rdquo;). If an evaluated GPO
contains the deny network logon setting for the user or one
of its groups, the user is denied network logon access. If
none of the evaluated GPOs has a network logon right
defined, the user is granted logon access. If at least one
evaluated GPO contains network logon right settings, the
user is granted logon access only, if it or at least one of
its groups is part of the policy settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Using the Group Policy Management Editor this value is
called &quot;Access this computer from the network&quot; and
&quot;Deny access to this computer from the
network&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add another PAM service name to the default
set by using &ldquo;+service_name&rdquo; or to explicitly
remove a PAM service name from the default set by using
&ldquo;-service_name&rdquo;. For example, in order to
replace a default PAM service name for this logon right
(e.g. &ldquo;ftp&rdquo;) with a custom pam service name
(e.g. &ldquo;my_pam_service&rdquo;), you would use the
following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_network
= +my_pam_service, -ftp</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
the default set of PAM service names includes:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
ftp</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
samba</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_batch
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access control is evaluated based on the
BatchLogonRight and DenyBatchLogonRight policy settings.
Only those GPOs are evaluated for which the user has Read
and Apply Group Policy permission (see option
&ldquo;ad_gpo_access_control&rdquo;). If an evaluated GPO
contains the deny batch logon setting for the user or one of
its groups, the user is denied batch logon access. If none
of the evaluated GPOs has a batch logon right defined, the
user is granted logon access. If at least one evaluated GPO
contains batch logon right settings, the user is granted
logon access only, if it or at least one of its groups is
part of the policy settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Using the Group Policy Management Editor this value is
called &quot;Allow log on as a batch job&quot; and
&quot;Deny log on as a batch job&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add another PAM service name to the default
set by using &ldquo;+service_name&rdquo; or to explicitly
remove a PAM service name from the default set by using
&ldquo;-service_name&rdquo;. For example, in order to
replace a default PAM service name for this logon right
(e.g. &ldquo;crond&rdquo;) with a custom pam service name
(e.g. &ldquo;my_pam_service&rdquo;), you would use the
following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_batch
= +my_pam_service, -crond</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Cron service name may differ depending on Linux distribution
used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
the default set of PAM service names includes:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
crond</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_service
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access control is evaluated based on the
ServiceLogonRight and DenyServiceLogonRight policy settings.
Only those GPOs are evaluated for which the user has Read
and Apply Group Policy permission (see option
&ldquo;ad_gpo_access_control&rdquo;). If an evaluated GPO
contains the deny service logon setting for the user or one
of its groups, the user is denied service logon access. If
none of the evaluated GPOs has a service logon right
defined, the user is granted logon access. If at least one
evaluated GPO contains service logon right settings, the
user is granted logon access only, if it or at least one of
its groups is part of the policy settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note:
Using the Group Policy Management Editor this value is
called &quot;Allow log on as a service&quot; and &quot;Deny
log on as a service&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add a PAM service name to the default set by
using &ldquo;+service_name&rdquo;. Since the default set is
empty, it is not possible to remove a PAM service name from
the default set. For example, in order to add a custom pam
service name (e.g. &ldquo;my_pam_service&rdquo;), you would
use the following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_service
= +my_pam_service</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
not set</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_permit
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access is always granted, regardless of any GPO
Logon Rights.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add another PAM service name to the default
set by using &ldquo;+service_name&rdquo; or to explicitly
remove a PAM service name from the default set by using
&ldquo;-service_name&rdquo;. For example, in order to
replace a default PAM service name for unconditionally
permitted access (e.g. &ldquo;sudo&rdquo;) with a custom pam
service name (e.g. &ldquo;my_pam_service&rdquo;), you would
use the following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_permit
= +my_pam_service, -sudo</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
the default set of PAM service names includes:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
polkit-1</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
sudo</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
sudo-i</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
systemd-user</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_map_deny
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">A
comma-separated list of PAM service names for which
GPO-based access is always denied, regardless of any GPO
Logon Rights.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is possible to add a PAM service name to the default set by
using &ldquo;+service_name&rdquo;. Since the default set is
empty, it is not possible to remove a PAM service name from
the default set. For example, in order to add a custom pam
service name (e.g. &ldquo;my_pam_service&rdquo;), you would
use the following configuration:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">ad_gpo_map_deny
= +my_pam_service</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
not set</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_gpo_default_right
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option defines how access control is evaluated for PAM
service names that are not explicitly listed in one of the
ad_gpo_map_* options. This option can be set in two
different manners. First, this option can be set to use a
default logon right. For example, if this option is set to
'interactive', it means that unmapped PAM service names will
be processed based on the InteractiveLogonRight and
DenyInteractiveLogonRight policy settings. Alternatively,
this option can be set to either always permit or always
deny access for unmapped PAM service names.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Supported
values for this option include:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
interactive</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
remote_interactive</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
network</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
batch</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
service</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
permit</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
deny</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
deny</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_maximum_machine_account_password_age
(integer)</font></p>

<p style="margin-left:17%;"><font color="#000000">SSSD will
check once a day if the machine account password is older
than the given age in days and try to renew it. A value of 0
will disable the renewal attempt.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
30 days</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_machine_account_password_renewal_opts
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option should only be used to test the machine account
renewal task. The option expects 2 integers separated by a
colon (':'). The first integer defines the interval in
seconds how often the task is run. The second specifies the
initial timeout in seconds before the task is run for the
first time after startup.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
86400:750 (24h and 15m)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_update_samba_machine_account_password
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">If
enabled, when SSSD renews the machine account password, it
will also be updated in Samba's database. This prevents
Samba's copy of the machine account password from getting
out of date when it is set up to use AD for
authentication.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
false</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_use_ldaps
(bool)</font></p>

<p style="margin-left:17%;"><font color="#000000">By
default SSSD uses the plain LDAP port 389 and the Global
Catalog port 3628. If this option is set to True SSSD will
use the LDAPS port 636 and Global Catalog port 3629 with
LDAPS protection. Since AD does not allow to have multiple
encryption layers on a single connection and we still want
to use SASL/GSSAPI or SASL/GSS-SPNEGO for authentication the
SASL security property maxssf is set to 0 (zero) for those
connections.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
False</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ad_allow_remote_domain_local_groups
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">If this
option is set to &ldquo;true&rdquo; SSSD will not filter out
Domain Local groups from remote domains in the AD forest. By
default they are filtered out e.g. when following a nested
group hierarchy in remote domains because they are not valid
in the local domain. To be compatible with other solutions
which make AD users and groups available on Linux client
this option was added.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note that setting this option to &ldquo;true&rdquo; will be
against the intention of Domain Local group in Active
Directory and <i>SHOULD ONLY BE USED TO FACILITATE MIGRATION
FROM OTHER SOLUTIONS</i>. Although the group exists and user
can be member of the group the intention is that the group
should be only used in the domain it is defined and in no
others. Since there is only one type of POSIX groups the
only way to achieve this on the Linux side is to ignore
those groups. This is also done by Active Directory as can
be seen in the PAC of the Kerberos ticket for a local
service or in tokenGroups requests where remote Domain Local
groups are missing as well.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Given
the comments above, if this option is set to
&ldquo;true&rdquo; the tokenGroups request must be disabled
by setting &ldquo;ldap_use_tokengroups&rdquo; to
&ldquo;false&rdquo; to get consistent group-memberships of a
users. Additionally the Global Catalog lookup should be
skipped as well by setting &ldquo;ad_enable_gc&rdquo; to
&ldquo;false&rdquo;. Finally it might be necessary to modify
&ldquo;ldap_group_nesting_level&rdquo; if the remote Domain
Local groups can only be found with a deeper nesting
level.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
False</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_update
(boolean)</font></p>


<p style="margin-left:17%;"><font color="#000000">Optional.
This option tells SSSD to automatically update the Active
Directory DNS server with the IP address of this client. The
update is secured using GSS-TSIG. As a consequence, the
Active Directory administrator only needs to allow secure
updates for the DNS zone. The IP address of the AD LDAP
connection is used for the updates, if it is not otherwise
specified by using the &ldquo;dyndns_iface&rdquo;
option.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">NOTE:
On older systems (such as RHEL 5), for this behavior to work
reliably, the default Kerberos realm must be set properly in
/etc/krb5.conf</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
true</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_ttl
(integer)</font></p>

<p style="margin-left:17%;"><font color="#000000">The TTL
to apply to the client DNS record when updating it. If
dyndns_update is false this has no effect. This will
override the TTL serverside if set by an
administrator.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
3600 (seconds)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_iface
(string)</font></p>


<p style="margin-left:17%;"><font color="#000000">Optional.
Applicable only when dyndns_update is true. Choose the
interface or a list of interfaces whose IP addresses should
be used for dynamic DNS updates. Special value
&ldquo;*&rdquo; implies that IPs from all interfaces should
be used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
Use the IP addresses of the interface which is used for AD
LDAP connection</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
dyndns_iface = em1, vnet1, vnet2</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_refresh_interval
(integer)</font></p>

<p style="margin-left:17%;"><font color="#000000">How often
should the back end perform periodic DNS update in addition
to the automatic update performed when the back end goes
online. This option is optional and applicable only when
dyndns_update is true. Note that the lowest possible value
is 60 seconds in-case if value is provided less than 60,
parameter will assume lowest value only.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
86400 (24 hours)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_update_ptr
(bool)</font></p>

<p style="margin-left:17%;"><font color="#000000">Whether
the PTR record should also be explicitly updated when
updating the client's DNS records. Applicable only when
dyndns_update is true.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
True</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_force_tcp
(bool)</font></p>

<p style="margin-left:17%;"><font color="#000000">Whether
the nsupdate utility should default to using TCP for
communicating with the DNS server.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
False (let nsupdate choose the protocol)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_auth
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">Whether
the nsupdate utility should use GSS-TSIG authentication for
secure updates with the DNS server, insecure updates can be
sent by setting this option to 'none'.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
GSS-TSIG</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_auth_ptr
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">Whether
the nsupdate utility should use GSS-TSIG authentication for
secure PTR updates with the DNS server, insecure updates can
be sent by setting this option to 'none'.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
Same as dyndns_auth</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_server
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">The DNS
server to use when performing a DNS update. In most setups,
it's recommended to leave this option unset.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Setting
this option makes sense for environments where the DNS
server is different from the identity server.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note that this option will be only used in fallback attempt
when previous attempt using autodetected settings
failed.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
None (let nsupdate choose the server)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dyndns_update_per_family
(boolean)</font></p>

<p style="margin-left:17%;"><font color="#000000">DNS
update is by default performed in two steps - IPv4 update
and then IPv6 update. In some cases it might be desirable to
perform IPv4 and IPv6 update in single step.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
true</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">override_homedir
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">Override
the user's home directory. You can either provide an
absolute value or a template. In the template, the following
sequences are substituted:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%u</font></p>

<p style="margin-left:23%;"><font color="#000000">login
name</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%U</font></p>

<p style="margin-left:23%;"><font color="#000000">UID
number</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%d</font></p>

<p style="margin-left:23%;"><font color="#000000">domain
name</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%f</font></p>

<p style="margin-left:23%;"><font color="#000000">fully
qualified user name (user@domain)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%l</font></p>

<p style="margin-left:23%;"><font color="#000000">The first
letter of the login name.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%P</font></p>

<p style="margin-left:23%;"><font color="#000000">UPN -
User Principal Name (name@REALM)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%o</font></p>

<p style="margin-left:23%;"><font color="#000000">The
original home directory retrieved from the identity
provider.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%H</font></p>

<p style="margin-left:23%;"><font color="#000000">The value
of configure option <i>homedir_substring</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">%%</font></p>

<p style="margin-left:23%;"><font color="#000000">a literal
'%'</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option can also be set per-domain.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">example:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">override_homedir
= /home/%u</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
Not set (SSSD will use the value retrieved from
LDAP)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note, the home directory from a specific override for the
user, either locally (see <b>sss_override</b>(8)) or
centrally managed IPA id-overrides, has a higher precedence
and will be used instead of the value given by
override_homedir.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">homedir_substring
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">The value
of this option will be used in the expansion of the
<i>override_homedir</i> option if the template contains the
format string <i>%H</i>. An LDAP directory entry can
directly contain this template so that this option can be
used to expand the home directory path for each client
machine (or operating system). It can be set per-domain or
globally in the [nss] section. A value specified in a domain
section will override one set in the [nss]
section.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
/home</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">krb5_confd_path
(string)</font></p>

<p style="margin-left:17%;"><font color="#000000">Absolute
path of a directory where SSSD should place Kerberos
configuration snippets.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">To
disable the creation of the configuration snippets set the
parameter to 'none'.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
not set (krb5.include.d subdirectory of SSSD's pubconf
directory)</font></p>

<h2>MODIFIED DEFAULT OPTIONS
<a name="MODIFIED DEFAULT OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Certain
option defaults do not match their respective backend
provider defaults, these option names and AD
provider-specific defaults are listed below:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>KRB5
Provider</b></font></p>

<p style="margin-left:17%;"><font color="#000000">&bull;
krb5_validate = true</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
krb5_use_enterprise_principal = true</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>LDAP
Provider</b></font></p>

<p style="margin-left:17%;"><font color="#000000">&bull;
ldap_schema = ad</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_force_upper_case_realm = true</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_id_mapping = true</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_sasl_mech = GSS-SPNEGO</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_referrals = false</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_account_expire_policy = ad</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_use_tokengroups = true</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ldap_sasl_authid = sAMAccountName@REALM (typically
SHORTNAME$@REALM)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
AD provider looks for a different principal than the LDAP
provider by default, because in an Active Directory
environment the principals are divided into two groups -
User Principals and Service Principals. Only User Principal
can be used to obtain a TGT and by default, computer
object's principal is constructed from its sAMAccountName
and the AD realm. The well-known host/hostname@REALM
principal is a Service Principal and thus cannot be used to
get a TGT with.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>NSS
configuration</b></font></p>

<p style="margin-left:17%;"><font color="#000000">&bull;
fallback_homedir = /home/%d/%u</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
AD provider automatically sets &quot;fallback_homedir =
/home/%d/%u&quot; to provide personal home directories for
users without the homeDirectory attribute. If your AD Domain
is properly populated with Posix attributes, and you want to
avoid this fallback behavior, you can explicitly set
&quot;fallback_homedir = %o&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the system typically expects a home directory in
/home/%u folder. If you decide to use a different directory
structure, some other parts of your system may need
adjustments.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">For
example automated creation of home directories in
combination with selinux requires selinux adjustment,
otherwise the home directory will be created with wrong
selinux context.</font></p>

<h2>FAILOVER
<a name="FAILOVER"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
failover feature allows back ends to automatically switch to
a different server if the current server fails.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Failover
Syntax</b> <br>
The list of servers is given as a comma-separated list; any
number of spaces is allowed around the comma. The servers
are listed in order of preference. The list can contain any
number of servers.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
each failover-enabled config option, two variants exist:
<i>primary</i> and <i>backup</i>. The idea is that servers
in the primary list are preferred and backup servers are
only searched if no primary servers can be reached. If a
backup server is selected, a timeout of 31 seconds is set.
After this timeout SSSD will periodically try to reconnect
to one of the primary servers. If it succeeds, it will
replace the current active (backup) server.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>The
Failover Mechanism</b> <br>
The failover mechanism distinguishes between a machine and a
service. The back end first tries to resolve the hostname of
a given machine; if this resolution attempt fails, the
machine is considered offline. No further attempts are made
to connect to this machine for any other service. If the
resolution attempt succeeds, the back end tries to connect
to a service on this machine. If the service connection
attempt fails, then only this particular service is
considered offline and the back end automatically switches
over to the next service. The machine is still considered
online and might still be tried for another
service.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Further
connection attempts are made to machines or services marked
as offline after a specified period of time; this is
currently hard coded to 30 seconds.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">If
there are no more machines to try, the back end as a whole
switches to offline mode, and then attempts to reconnect
every 30 seconds.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Failover
time outs and tuning</b> <br>
Resolving a server to connect to can be as simple as running
a single DNS query or can involve several steps, such as
finding the correct site or trying out multiple host names
in case some of the configured servers are not reachable.
The more complex scenarios can take some time and SSSD needs
to balance between providing enough time to finish the
resolution process but on the other hand, not trying for too
long before falling back to offline mode. If the SSSD debug
logs show that the server resolution is timing out before a
live server is contacted, you can consider changing the time
outs.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">This
section lists the available tunables. Please refer to their
description in the <b>sssd.conf</b>(5), manual
page.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dns_resolver_server_timeout</font></p>

<p style="margin-left:17%;"><font color="#000000">Time in
milliseconds that sets how long would SSSD talk to a single
DNS server before trying next one.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
1000</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dns_resolver_op_timeout</font></p>

<p style="margin-left:17%;"><font color="#000000">Time in
seconds to tell how long would SSSD try to resolve single
DNS query (e.g. resolution of a hostname or an SRV record)
before trying the next hostname or discovery
domain.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
3</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">dns_resolver_timeout</font></p>

<p style="margin-left:17%;"><font color="#000000">How long
would SSSD try to resolve a failover service. This service
resolution internally might include several steps, such as
resolving DNS SRV queries or locating the site.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Default:
6</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
LDAP-based providers, the resolve operation is performed as
part of an LDAP connection operation. Therefore, also the
&ldquo;ldap_opt_timeout&rdquo; timeout should be set to a
larger value than &ldquo;dns_resolver_timeout&rdquo; which
in turn should be set to a larger value than
&ldquo;dns_resolver_op_timeout&rdquo; which should be larger
than &ldquo;dns_resolver_server_timeout&rdquo;.</font></p>

<h2>SERVICE DISCOVERY
<a name="SERVICE DISCOVERY"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
service discovery feature allows back ends to automatically
find the appropriate servers to connect to using a special
DNS query. This feature is not supported for backup
servers.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Configuration</b>
<br>
If no servers are specified, the back end automatically uses
service discovery to try to find a server. Optionally, the
user may choose to use both fixed server addresses and
service discovery by inserting a special keyword,
&ldquo;_srv_&rdquo;, in the list of servers. The order of
preference is maintained. This feature is useful if, for
example, the user prefers to use service discovery whenever
possible, and fall back to a specific server when no servers
can be discovered using DNS.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>The
domain name</b> <br>
Please refer to the &ldquo;dns_discovery_domain&rdquo;
parameter in the <b>sssd.conf</b>(5) manual page for more
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>The
protocol</b> <br>
The queries usually specify _tcp as the protocol. Exceptions
are documented in respective option description.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>See
Also</b> <br>
For more information on the service discovery mechanism,
refer to RFC 2782.</font></p>

<h2>ID MAPPING
<a name="ID MAPPING"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
ID-mapping feature allows SSSD to act as a client of Active
Directory without requiring administrators to extend user
attributes to support POSIX attributes for user and group
identifiers.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">NOTE:
When ID-mapping is enabled, the uidNumber and gidNumber
attributes are ignored. This is to avoid the possibility of
conflicts between automatically-assigned and
manually-assigned values. If you need to use
manually-assigned values, ALL values must be
manually-assigned.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Please
note that changing the ID mapping related configuration
options will cause user and group IDs to change. At the
moment, SSSD does not support changing IDs, so the SSSD
database must be removed. Because cached passwords are also
stored in the database, removing the database should only be
performed while the authentication servers are reachable,
otherwise users might get locked out. In order to cache the
password, an authentication must be performed. It is not
sufficient to use <b>sss_cache</b>(8) to remove the
database, rather the process consists of:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Making sure the remote servers are reachable</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Stopping the SSSD service</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Removing the database</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Starting the SSSD service</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Moreover,
as the change of IDs might necessitate the adjustment of
other system properties such as file and directory
ownership, it's advisable to plan ahead and test the ID
mapping configuration thoroughly.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Mapping
Algorithm</b> <br>
Active Directory provides an objectSID for every user and
group object in the directory. This objectSID can be broken
up into components that represent the Active Directory
domain identity and the relative identifier (RID) of the
user or group object.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
SSSD ID-mapping algorithm takes a range of available UIDs
and divides it into equally-sized component sections -
called &quot;slices&quot;-. Each slice represents the space
available to an Active Directory domain.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">When
a user or group entry for a particular domain is encountered
for the first time, the SSSD allocates one of the available
slices for that domain. In order to make this
slice-assignment repeatable on different client machines, we
select the slice based on the following
algorithm:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
SID string is passed through the murmurhash3 algorithm to
convert it to a 32-bit hashed value. We then take the
modulus of this value with the total number of available
slices to pick the slice.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">NOTE:
It is possible to encounter collisions in the hash and
subsequent modulus. In these situations, we will select the
next available slice, but it may not be possible to
reproduce the same exact set of slices on other machines
(since the order that they are encountered will determine
their slice). In this situation, it is recommended to either
switch to using explicit POSIX attributes in Active
Directory (disabling ID-mapping) or configure a default
domain to guarantee that at least one is always consistent.
See &ldquo;Configuration&rdquo; for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Configuration</b>
<br>
Minimum configuration (in the
&ldquo;[domain/DOMAINNAME]&rdquo; section):</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_id_mapping
= True <br>
ldap_schema = ad</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
default configuration results in configuring 10,000 slices,
each capable of holding up to 200,000 IDs, starting from
200,000 and going up to 2,000,200,000. This should be
sufficient for most deployments.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Advanced
Configuration</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">ldap_idmap_range_min
(integer)</font></p>


<p style="margin-left:23%;"><font color="#000000">Specifies
the lower (inclusive) bound of the range of POSIX IDs to use
for mapping Active Directory user and group SIDs. It is the
first POSIX ID which can be used for the mapping.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">NOTE:
This option is different from &ldquo;min_id&rdquo; in that
&ldquo;min_id&rdquo; acts to filter the output of requests
to this domain, whereas this option controls the range of ID
assignment. This is a subtle distinction, but the good
general advice would be to have &ldquo;min_id&rdquo; be
less-than or equal to
&ldquo;ldap_idmap_range_min&rdquo;</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
200000</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_range_max
(integer)</font></p>


<p style="margin-left:23%;"><font color="#000000">Specifies
the upper (exclusive) bound of the range of POSIX IDs to use
for mapping Active Directory user and group SIDs. It is the
first POSIX ID which cannot be used for the mapping anymore,
i.e. one larger than the last one which can be used for the
mapping.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">NOTE:
This option is different from &ldquo;max_id&rdquo; in that
&ldquo;max_id&rdquo; acts to filter the output of requests
to this domain, whereas this option controls the range of ID
assignment. This is a subtle distinction, but the good
general advice would be to have &ldquo;max_id&rdquo; be
greater-than or equal to
&ldquo;ldap_idmap_range_max&rdquo;</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
2000200000</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_range_size
(integer)</font></p>


<p style="margin-left:23%;"><font color="#000000">Specifies
the number of IDs available for each slice. If the range
size does not divide evenly into the min and max values, it
will create as many complete slices as it can.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">NOTE:
The value of this option must be at least as large as the
highest user RID planned for use on the Active Directory
server. User lookups and login will fail for any user whose
RID is greater than this value.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">For
example, if your most recently-added Active Directory user
has
objectSid=S-1-5-21-2153326666-2176343378-3404031434-1107,
&ldquo;ldap_idmap_range_size&rdquo; must be at least 1108 as
range size is equal to maximal SID minus minimal SID plus
one (e.g. 1108 = 1107 - 0 + 1).</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">It
is important to plan ahead for future expansion, as changing
this value will result in changing all of the ID mappings on
the system, leading to users with different local IDs than
they previously had.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
200000</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_default_domain_sid
(string)</font></p>

<p style="margin-left:23%;"><font color="#000000">Specify
the domain SID of the default domain. This will guarantee
that this domain will always be assigned to slice zero in
the ID map, bypassing the murmurhash algorithm described
above.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
not set</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_default_domain
(string)</font></p>

<p style="margin-left:23%;"><font color="#000000">Specify
the name of the default domain.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
not set</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_autorid_compat
(boolean)</font></p>

<p style="margin-left:23%;"><font color="#000000">Changes
the behavior of the ID-mapping algorithm to behave more
similarly to winbind's &ldquo;idmap_autorid&rdquo;
algorithm.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">When
this option is configured, domains will be allocated
starting with slice zero and increasing monatomically with
each additional domain.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">NOTE:
This algorithm is non-deterministic (it depends on the order
that users and groups are requested). If this mode is
required for compatibility with machines running winbind, it
is recommended to also use the
&ldquo;ldap_idmap_default_domain_sid&rdquo; option to
guarantee that at least one domain is consistently allocated
to slice zero.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
False</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ldap_idmap_helper_table_size
(integer)</font></p>

<p style="margin-left:23%;"><font color="#000000">Maximal
number of secondary slices that is tried when performing
mapping from UNIX id to SID.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Note:
Additional secondary slices might be generated when SID is
being mapped to UNIX id and RID part of SID is out of range
for secondary slices generated so far. If value of
ldap_idmap_helper_table_size is equal to 0 then no
additional secondary slices are generated.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Default:
10</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Well-Known
SIDs</b> <br>
SSSD supports to look up the names of Well-Known SIDs, i.e.
SIDs with a special hardcoded meaning. Since the generic
users and groups related to those Well-Known SIDs have no
equivalent in a Linux/UNIX environment no POSIX IDs are
available for those objects.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
SID name space is organized in authorities which can be seen
as different domains. The authorities for the Well-Known
SIDs are</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Null Authority</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
World Authority</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Local Authority</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Creator Authority</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
NT Authority</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Built-in</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
capitalized version of these names are used as domain names
when returning the fully qualified name of a Well-Known
SID.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Since
some utilities allow to modify SID based access control
information with the help of a name instead of using the SID
directly SSSD supports to look up the SID by the name as
well. To avoid collisions only the fully qualified names can
be used to look up Well-Known SIDs. As a result the domain
names &ldquo;NULL AUTHORITY&rdquo;, &ldquo;WORLD
AUTHORITY&rdquo;, &ldquo; LOCAL AUTHORITY&rdquo;,
&ldquo;CREATOR AUTHORITY&rdquo;, &ldquo;NT AUTHORITY&rdquo;
and &ldquo;BUILTIN&rdquo; should not be used as domain names
in sssd.conf.</font></p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following example assumes that SSSD is correctly configured
and example.com is one of the domains in the <i>[sssd]</i>
section. This example shows only the AD provider-specific
options.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">[domain/EXAMPLE]
<br>
id_provider = ad <br>
auth_provider = ad <br>
access_provider = ad <br>
chpass_provider = ad</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ad_server
= dc1.example.com <br>
ad_hostname = client.example.com <br>
ad_domain = example.com</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
AD access control provider checks if the account is expired.
It has the same effect as the following configuration of the
LDAP provider:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">access_provider
= ldap <br>
ldap_access_order = expire <br>
ldap_account_expire_policy = ad</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">However,
unless the &ldquo;ad&rdquo; access control provider is
explicitly configured, the default access provider is
&ldquo;permit&rdquo;. Please note that if you configure an
access provider other than &ldquo;ad&rdquo;, you need to set
all the connection parameters (such as LDAP URIs and
encryption details) manually.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">When
the autofs provider is set to &ldquo;ad&rdquo;, the RFC2307
schema attribute mapping (nisMap, nisObject, ...) is used,
because these attributes are included in the default Active
Directory schema.</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>sssd</b>(8),
<b>sssd.conf</b>(5), <a href="https://man.page/5/sssd-ldap">sssd-ldap(5)</a>,
<a href="https://man.page/5/sssd-krb5">sssd-krb5(5)</a>, <a href="https://man.page/5/sssd-simple">sssd-simple(5)</a>,
<a href="https://man.page/5/sssd-ipa">sssd-ipa(5)</a>, <a href="https://man.page/5/sssd-ad">sssd-ad(5)</a>, <a href="https://man.page/5/sssd-files">sssd-files(5)</a>,
<a href="https://man.page/5/sssd-sudo">sssd-sudo(5)</a>, <a href="https://man.page/5/sssd-session-recording">sssd-session-recording(5)</a>,
<b>sss_cache</b>(8), <b>sss_debuglevel</b>(8),
<b>sss_obfuscate</b>(8), <b>sss_seed</b>(8),
<b>sssd_krb5_locator_plugin</b>(8),
<b>sss_ssh_authorizedkeys</b>(8),
<b>sss_ssh_knownhostsproxy</b>(8), <a href="https://man.page/5/sssd-ifp">sssd-ifp(5)</a>,
<b>pam_sss</b>(8). <a href="https://man.page/5/sss_rpcidmapd">sss_rpcidmapd(5)</a>
<a href="https://man.page/5/sssd-systemtap">sssd-systemtap(5)</a></font></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>The
SSSD upstream - https://github.com/SSSD/sssd/</b></font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="51%">


<p style="margin-top: 1em"><font color="#000000">[MS-ADTS]
section LDAP extensions</font></p></td>
<td width="32%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://msdn.microsoft.com/en-us/library/cc223367.aspx</font></p>
<hr>
</body>
</html>
