<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:39:30 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SYSTEMD.EXEC</title>

</head>
<body>

<h1 align="center">SYSTEMD.EXEC</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#IMPLICIT DEPENDENCIES">IMPLICIT DEPENDENCIES</a><br>
<a href="#PATHS">PATHS</a><br>
<a href="#USER/GROUP IDENTITY">USER/GROUP IDENTITY</a><br>
<a href="#CAPABILITIES">CAPABILITIES</a><br>
<a href="#SECURITY">SECURITY</a><br>
<a href="#MANDATORY ACCESS CONTROL">MANDATORY ACCESS CONTROL</a><br>
<a href="#PROCESS PROPERTIES">PROCESS PROPERTIES</a><br>
<a href="#SCHEDULING">SCHEDULING</a><br>
<a href="#SANDBOXING">SANDBOXING</a><br>
<a href="#SYSTEM CALL FILTERING">SYSTEM CALL FILTERING</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#LOGGING AND STANDARD INPUT/OUTPUT">LOGGING AND STANDARD INPUT/OUTPUT</a><br>
<a href="#CREDENTIALS">CREDENTIALS</a><br>
<a href="#SYSTEM V COMPATIBILITY">SYSTEM V COMPATIBILITY</a><br>
<a href="#ENVIRONMENT VARIABLES IN SPAWNED PROCESSES">ENVIRONMENT VARIABLES IN SPAWNED PROCESSES</a><br>
<a href="#PROCESS EXIT CODES">PROCESS EXIT CODES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">systemd.exec -
Execution environment configuration</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>service</i>.service,
<i>socket</i>.socket, <i>mount</i>.mount,
<i>swap</i>.swap</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Unit
configuration files for services, sockets, mount points, and
swap devices share a subset of configuration options which
define the execution environment of spawned processes.</p>

<p style="margin-left:11%; margin-top: 1em">This man page
lists the configuration options shared by these four unit
types. See <b>systemd.unit</b>(5) for the common options of
all unit configuration files, and <b>systemd.service</b>(5),
<b>systemd.socket</b>(5), <b>systemd.swap</b>(5), and
<b>systemd.mount</b>(5) for more information on the specific
unit configuration files. The execution specific
configuration options are configured in the [Service],
[Socket], [Mount], or [Swap] sections, depending on the unit
type.</p>

<p style="margin-left:11%; margin-top: 1em">In addition,
options which control resources through Linux Control Groups
(cgroups) are listed in <b>systemd.resource-control</b>(5).
Those options complement options listed here.</p>

<h2>IMPLICIT DEPENDENCIES
<a name="IMPLICIT DEPENDENCIES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A few execution
parameters result in additional, automatic dependencies to
be added:</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Units
with <i>WorkingDirectory=</i>, <i>RootDirectory=</i>,
<i>RootImage=</i>, <i>RuntimeDirectory=</i>,
<i>StateDirectory=</i>, <i>CacheDirectory=</i>,
<i>LogsDirectory=</i> or <i>ConfigurationDirectory=</i> set
automatically gain dependencies of type <i>Requires=</i> and
<i>After=</i> on all mount units required to access the
specified paths. This is equivalent to having them listed
explicitly in <i>RequiresMountsFor=</i>.</p>

<p style="margin-left:17%; margin-top: 1em">&bull;
Similarly, units with <i>PrivateTmp=</i> enabled
automatically get mount unit dependencies for all mounts
required to access /tmp/ and /var/tmp/. They will also gain
an automatic <i>After=</i> dependency on
<b>systemd-tmpfiles-setup.service</b>(8).</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Units
whose standard output or error output is connected to
<b>journal</b> or <b>kmsg</b> (or their combinations with
console output, see below) automatically acquire
dependencies of type <i>After=</i> on
systemd-journald.socket.</p>

<p style="margin-left:17%; margin-top: 1em">&bull; Units
using <i>LogNamespace=</i> will automatically gain ordering
and requirement dependencies on the two socket units
associated with systemd-journald@.service instances.</p>

<h2>PATHS
<a name="PATHS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
settings may be used to change a service's view of the
filesystem. Please note that the paths must be absolute and
must not contain a &quot;..&quot; path component.</p>


<p style="margin-left:11%; margin-top: 1em"><i>WorkingDirectory=</i></p>

<p style="margin-left:17%;">Takes a directory path relative
to the service's root directory specified by
<i>RootDirectory=</i>, or the special value &quot;~&quot;.
Sets the working directory for executed processes. If set to
&quot;~&quot;, the home directory of the user specified in
<i>User=</i> is used. If not set, defaults to the root
directory when systemd is running as a system instance and
the respective user's home directory if run as user. If the
setting is prefixed with the &quot;-&quot; character, a
missing working directory is not considered fatal. If
<i>RootDirectory=</i>/<i>RootImage=</i> is not set, then
<i>WorkingDirectory=</i> is relative to the root of the
system running the service manager. Note that setting this
parameter might result in additional dependencies to be
added to the unit (see above).</p>


<p style="margin-left:11%; margin-top: 1em"><i>RootDirectory=</i></p>

<p style="margin-left:17%;">Takes a directory path relative
to the host's root directory (i.e. the root of the system
running the service manager). Sets the root directory for
executed processes, with the <b>chroot</b>(2) system call.
If this is used, it must be ensured that the process binary
and all its auxiliary files are available in the
<b>chroot()</b> jail. Note that setting this parameter might
result in additional dependencies to be added to the unit
(see above).</p>

<p style="margin-left:17%; margin-top: 1em">The
<i>MountAPIVFS=</i> and <i>PrivateUsers=</i> settings are
particularly useful in conjunction with
<i>RootDirectory=</i>. For details, see below.</p>

<p style="margin-left:17%; margin-top: 1em">If
<i>RootDirectory=</i>/<i>RootImage=</i> are used together
with <i>NotifyAccess=</i> the notification socket is
automatically mounted from the host into the root
environment, to ensure the notification interface can work
correctly.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
services using <i>RootDirectory=</i>/<i>RootImage=</i> will
not be able to log via the syslog or journal protocols to
the host logging infrastructure, unless the relevant sockets
are mounted from the host, specifically:</p>


<p style="margin-left:17%; margin-top: 1em"><b>Example&nbsp;1.&nbsp;Mounting
logging sockets into root environment</b></p>


<p style="margin-left:23%; margin-top: 1em">BindReadOnlyPaths=/dev/log
/run/systemd/journal/socket /run/systemd/journal/stdout</p>

<p style="margin-left:17%; margin-top: 1em">This option is
only available for system services and is not supported for
services running in per-user instances of the service
manager.</p>


<p style="margin-left:11%; margin-top: 1em"><i>RootImage=</i></p>

<p style="margin-left:17%;">Takes a path to a block device
node or regular file as argument. This call is similar to
<i>RootDirectory=</i> however mounts a file system hierarchy
from a block device node or loopback file instead of a
directory. The device node or file system image file needs
to contain a file system without a partition table, or a
file system within an MBR/MS-DOS or GPT partition table with
only a single Linux-compatible partition, or a set of file
systems within a GPT partition table that follows the
<b><font color="#0000FF">Discoverable Partitions
Specification</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
<i>DevicePolicy=</i> is set to &quot;closed&quot; or
&quot;strict&quot;, or set to &quot;auto&quot; and
<i>DeviceAllow=</i> is set, then this setting adds
/dev/loop-control with <b>rw</b> mode,
&quot;block-loop&quot; and &quot;block-blkext&quot; with
<b>rwm</b> mode to <i>DeviceAllow=</i>. See
<b>systemd.resource-control</b>(5) for the details about
<i>DevicePolicy=</i> or <i>DeviceAllow=</i>. Also, see
<i>PrivateDevices=</i> below, as it may change the setting
of <i>DevicePolicy=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Units
making use of <i>RootImage=</i> automatically gain an
<i>After=</i> dependency on
systemd-udevd.service.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RootImageOptions=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
comma-separated list of mount options that will be used on
disk images specified by <i>RootImage=</i>. Optionally a
partition name can be prefixed, followed by colon, in case
the image has multiple partitions, otherwise partition name
&quot;root&quot; is implied. Options for multiple partitions
can be specified in a single line with space separators.
Assigning an empty string removes previous assignments.
Duplicated options are ignored. For a list of valid mount
options, please refer to <b>mount</b>(8).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Valid
partition names follow the</font>
<b><font color="#0000FF">Discoverable Partitions
Specification</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">: <b>root</b>, <b>usr</b>,
<b>home</b>, <b>srv</b>, <b>esp</b>, <b>xbootldr</b>,
<b>tmp</b>, <b>var</b>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RootHash=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
data integrity (dm-verity) root hash specified in
hexadecimal, or the path to a file containing a root hash in
ASCII hexadecimal format. This option enables data integrity
checks using dm-verity, if the used image contains the
appropriate integrity data (see above) or if
<i>RootVerity=</i> is used. The specified hash must match
the root hash of integrity data, and is usually at least 256
bits (and hence 64 formatted hexadecimal characters) long
(in case of SHA256 for example). If this option is not
specified, but the image file carries the
&quot;user.verity.roothash&quot; extended file attribute
(see <b>xattr</b>(7)), then the root hash is read from it,
also as formatted hexadecimal characters. If the extended
file attribute is not found (or is not supported by the
underlying file system), but a file with the .roothash
suffix is found next to the image file, bearing otherwise
the same name (except if the image has the .raw suffix, in
which case the root hash file must not have it in its name),
the root hash is read from it and automatically used, also
as formatted hexadecimal characters.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the disk image contains a separate /usr/ partition it may
also be Verity protected, in which case the root hash may
configured via an extended attribute
&quot;user.verity.usrhash&quot; or a .usrhash file adjacent
to the disk image. There's currently no option to configure
the root hash for the /usr/ file system via the unit file
directly.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RootHashSignature=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
PKCS7 signature of the <i>RootHash=</i> option as a path to
a DER-encoded signature file, or as an ASCII base64 string
encoding of a DER-encoded signature prefixed by
&quot;base64:&quot;. The dm-verity volume will only be
opened if the signature of the root hash is valid and signed
by a public key present in the kernel keyring. If this
option is not specified, but a file with the .roothash.p7s
suffix is found next to the image file, bearing otherwise
the same name (except if the image has the .raw suffix, in
which case the signature file must not have it in its name),
the signature is read from it and automatically
used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the disk image contains a separate /usr/ partition it may
also be Verity protected, in which case the signature for
the root hash may configured via a .usrhash.p7s file
adjacent to the disk image. There's currently no option to
configure the root hash signature for the /usr/ via the unit
file directly.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RootVerity=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes the
path to a data integrity (dm-verity) file. This option
enables data integrity checks using dm-verity, if
<i>RootImage=</i> is used and a root-hash is passed and if
the used image itself does not contains the integrity data.
The integrity data must be matched by the root hash. If this
option is not specified, but a file with the .verity suffix
is found next to the image file, bearing otherwise the same
name (except if the image has the .raw suffix, in which case
the verity data file must not have it in its name), the
verity data is read from it and automatically
used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is supported only for disk images that contain a
single file system, without an enveloping partition table.
Images that contain a GPT partition table should instead
include both root file system and matching Verity data in
the same image, implementing the</font>
<b><font color="#0000FF">Discoverable Partitions
Specification</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MountAPIVFS=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If on, a private mount namespace for the
unit's processes is created and the API file systems /proc/,
/sys/, /dev/ and /run/ (as an empty &quot;tmpfs&quot;) are
mounted inside of it, unless they are already mounted. Note
that this option has no effect unless used in conjunction
with <i>RootDirectory=</i>/<i>RootImage=</i> as these four
mounts are generally mounted in the host anyway, and unless
the root directory is changed, the private mount namespace
will be a 1:1 copy of the host's, and include these four
mounts. Note that the /dev/ file system of the host is bind
mounted if this option is used without
<i>PrivateDevices=</i>. To run the service with a private,
minimal version of /dev/, combine this option with
<i>PrivateDevices=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">In
order to allow propagating mounts at runtime in a safe
manner, /run/systemd/propagate on the host will be used to
set up new mounts, and /run/host/incoming/ in the private
namespace will be used as an intermediate step to store them
before being moved to the final mount point.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectProc=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of &quot;noaccess&quot;, &quot;invisible&quot;,
&quot;ptraceable&quot; or &quot;default&quot; (which it
defaults to). When set, this controls the
&quot;hidepid=&quot; mount option of the &quot;procfs&quot;
instance for the unit that controls which directories with
process metainformation (/proc/<i>PID</i>) are visible and
accessible: when set to &quot;noaccess&quot; the ability to
access most of other users' process metadata in /proc/ is
taken away for processes of the service. When set to
&quot;invisible&quot; processes owned by other users are
hidden from /proc/. If &quot;ptraceable&quot; all processes
that cannot be <b>ptrace()</b>'ed by a process are hidden to
it. If &quot;default&quot; no restrictions on /proc/ access
or visibility are made. For further details see</font>
<b><font color="#0000FF">The /proc Filesystem</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">. It is generally recommended to run
most system services with this option set to
&quot;invisible&quot;. This option is implemented via file
system namespacing, and thus cannot be used with services
that shall be able to install mount points in the host file
system hierarchy. Note that the root user is unaffected by
this option, so to be effective it has to be used together
with <i>User=</i> or <i>DynamicUser=yes</i>, and also
without the &quot;CAP_SYS_PTRACE&quot; capability, which
also allows a process to bypass this feature. It cannot be
used for services that need to access metainformation about
other users' processes. This option implies
<i>MountAPIVFS=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the kernel doesn't support per-mount point <b>hidepid=</b>
mount options this setting remains without effect, and the
unit's processes will be able to access and see other
process as if the option was not used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProcSubset=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of &quot;all&quot; (the default) and &quot;pid&quot;. If
&quot;pid&quot;, all files and directories not directly
associated with process management and introspection are
made invisible in the /proc/ file system configured for the
unit's processes. This controls the &quot;subset=&quot;
mount option of the &quot;procfs&quot; instance for the
unit. For further details see</font>
<b><font color="#0000FF">The /proc Filesystem</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">. Note that Linux exposes various
kernel APIs via /proc/, which are made unavailable with this
setting. Since these APIs are used frequently this option is
useful only in a few, specific cases, and is not suitable
for most non-trivial programs.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Much
like <i>ProtectProc=</i> above, this is implemented via file
system mount namespacing, and hence the same restrictions
apply: it is only available to system services, it disables
mount propagation to the host mount table, and it implies
<i>MountAPIVFS=</i>. Also, like <i>ProtectProc=</i> this
setting is gracefully disabled if the used kernel does not
support the &quot;subset=&quot; mount option of
&quot;procfs&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>BindPaths=</i>,
<i>BindReadOnlyPaths=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
unit-specific bind mounts. A bind mount makes a particular
file or directory available at an additional place in the
unit's view of the file system. Any bind mounts created with
this option are specific to the unit, and are not visible in
the host's mount table. This option expects a whitespace
separated list of bind mount definitions. Each definition
consists of a colon-separated triple of source path,
destination path and option string, where the latter two are
optional. If only a source path is specified the source and
destination is taken to be the same. The option string may
be either &quot;rbind&quot; or &quot;norbind&quot; for
configuring a recursive or non-recursive bind mount. If the
destination path is omitted, the option string must be
omitted too. Each bind mount definition may be prefixed with
&quot;-&quot;, in which case it will be ignored when its
source path does not exist.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><i>BindPaths=</i>
creates regular writable bind mounts (unless the source file
system mount is already marked read-only), while
<i>BindReadOnlyPaths=</i> creates read-only bind mounts.
These settings may be used more than once, each usage
appends to the unit's list of bind mounts. If the empty
string is assigned to either of these two options the entire
list of bind mounts defined prior to this is reset. Note
that in this case both read-only and regular bind mounts are
reset, regardless which of the two settings is
used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is particularly useful when
<i>RootDirectory=</i>/<i>RootImage=</i> is used. In this
case the source path refers to a path on the host file
system, while the destination path refers to a path below
the root directory of the unit.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the destination directory must exist or systemd must be
able to create it. Thus, it is not possible to use those
options for mount points nested underneath paths specified
in <i>InaccessiblePaths=</i>, or under /home/ and other
protected directories if <i>ProtectHome=yes</i> is
specified. <i>TemporaryFileSystem=</i> with &quot;:ro&quot;
or <i>ProtectHome=tmpfs</i> should be used
instead.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MountImages=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">This
setting is similar to <i>RootImage=</i> in that it mounts a
file system hierarchy from a block device node or loopback
file, but the destination directory can be specified as well
as mount options. This option expects a whitespace separated
list of mount definitions. Each definition consists of a
colon-separated tuple of source path and destination
definitions, optionally followed by another colon and a list
of mount options.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Mount
options may be defined as a single comma-separated list of
options, in which case they will be implicitly applied to
the root partition on the image, or a series of
colon-separated tuples of partition name and mount options.
Valid partition names and mount options are the same as for
<i>RootImageOptions=</i> setting described above.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Each
mount definition may be prefixed with &quot;-&quot;, in
which case it will be ignored when its source path does not
exist. The source argument is a path to a block device node
or regular file. If source or destination contain a
&quot;:&quot;, it needs to be escaped as &quot;\:&quot;. The
device node or file system image file needs to follow the
same rules as specified for <i>RootImage=</i>. Any mounts
created with this option are specific to the unit, and are
not visible in the host's mount table.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">These
settings may be used more than once, each usage appends to
the unit's list of mount paths. If the empty string is
assigned, the entire list of mount paths defined prior to
this is reset.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the destination directory must exist or systemd must be
able to create it. Thus, it is not possible to use those
options for mount points nested underneath paths specified
in <i>InaccessiblePaths=</i>, or under /home/ and other
protected directories if <i>ProtectHome=yes</i> is
specified.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
<i>DevicePolicy=</i> is set to &quot;closed&quot; or
&quot;strict&quot;, or set to &quot;auto&quot; and
<i>DeviceAllow=</i> is set, then this setting adds
/dev/loop-control with <b>rw</b> mode,
&quot;block-loop&quot; and &quot;block-blkext&quot; with
<b>rwm</b> mode to <i>DeviceAllow=</i>. See
<b>systemd.resource-control</b>(5) for the details about
<i>DevicePolicy=</i> or <i>DeviceAllow=</i>. Also, see
<i>PrivateDevices=</i> below, as it may change the setting
of <i>DevicePolicy=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ExtensionImages=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">This
setting is similar to <i>MountImages=</i> in that it mounts
a file system hierarchy from a block device node or loopback
file, but instead of providing a destination path, an
overlay will be set up. This option expects a whitespace
separated list of mount definitions. Each definition
consists of a source path, optionally followed by a colon
and a list of mount options.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">A
read-only OverlayFS will be set up on top of /usr/ and /opt/
hierarchies. The order in which the images are listed will
determine the order in which the overlay is laid down:
images specified first to last will result in overlayfs
layers bottom to top.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Mount
options may be defined as a single comma-separated list of
options, in which case they will be implicitly applied to
the root partition on the image, or a series of
colon-separated tuples of partition name and mount options.
Valid partition names and mount options are the same as for
<i>RootImageOptions=</i> setting described above.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Each
mount definition may be prefixed with &quot;-&quot;, in
which case it will be ignored when its source path does not
exist. The source argument is a path to a block device node
or regular file. If the source path contains a
&quot;:&quot;, it needs to be escaped as &quot;\:&quot;. The
device node or file system image file needs to follow the
same rules as specified for <i>RootImage=</i>. Any mounts
created with this option are specific to the unit, and are
not visible in the host's mount table.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">These
settings may be used more than once, each usage appends to
the unit's list of image paths. If the empty string is
assigned, the entire list of mount paths defined prior to
this is reset.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
<i>DevicePolicy=</i> is set to &quot;closed&quot; or
&quot;strict&quot;, or set to &quot;auto&quot; and
<i>DeviceAllow=</i> is set, then this setting adds
/dev/loop-control with <b>rw</b> mode,
&quot;block-loop&quot; and &quot;block-blkext&quot; with
<b>rwm</b> mode to <i>DeviceAllow=</i>. See
<b>systemd.resource-control</b>(5) for the details about
<i>DevicePolicy=</i> or <i>DeviceAllow=</i>. Also, see
<i>PrivateDevices=</i> below, as it may change the setting
of <i>DevicePolicy=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>

<h2>USER/GROUP IDENTITY
<a name="USER/GROUP IDENTITY"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">These
options are only available for system services and are not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>User=</i>,
<i>Group=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Set the
UNIX user or group that the processes are executed as,
respectively. Takes a single user or group name, or a
numeric ID as argument. For system services (services run by
the system service manager, i.e. managed by PID 1) and for
user services of the root user (services managed by root's
instance of <b>systemd --user</b>), the default is
&quot;root&quot;, but <i>User=</i> may be used to specify a
different user. For user services of any other user,
switching user identity is not permitted, hence the only
valid setting is the same user the user's service manager is
running as. If no group is set, the default group of the
user is used. This setting does not affect commands whose
command line is prefixed with &quot;+&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that this enforces only weak restrictions on the user/group
name syntax, but will generate warnings in many cases where
user/group names do not adhere to the following rules: the
specified name should consist only of the characters a-z,
A-Z, 0-9, &quot;_&quot; and &quot;-&quot;, except for the
first character which must be one of a-z, A-Z and
&quot;_&quot; (i.e. digits and &quot;-&quot; are not
permitted as first character). The user/group name must have
at least one character, and at most 31. These restrictions
are made in order to avoid ambiguities and to ensure
user/group names and unit files remain portable among Linux
systems. For further details on the names accepted and the
names warned about see</font>
<b><font color="#0000FF">User/Group Name Syntax</font></b>
<small><font color="#000000">[3]</font></small>
<font color="#000000">.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
used in conjunction with <i>DynamicUser=</i> the user/group
name specified is dynamically allocated at the time the
service is started, and released at the time the service is
stopped &mdash; unless it is already allocated statically
(see below). If <i>DynamicUser=</i> is not used the
specified user and group must have been created statically
in the user database no later than the moment the service is
started, for example using the <b>sysusers.d</b>(5)
facility, which is applied at boot or package install time.
If the user does not exist by then program invocation will
fail.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the <i>User=</i> setting is used the supplementary group
list is initialized from the specified user's default group
list, as defined in the system's user and group database.
Additional groups may be configured through the
<i>SupplementaryGroups=</i> setting (see below).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>DynamicUser=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean parameter. If set, a UNIX user and group pair is
allocated dynamically when the unit is started, and released
as soon as it is stopped. The user and group will not be
added to /etc/passwd or /etc/group, but are managed
transiently during runtime. The <b>nss-systemd</b>(8) glibc
NSS module provides integration of these dynamic
users/groups into the system's user and group databases. The
user and group name to use may be configured via
<i>User=</i> and <i>Group=</i> (see above). If these options
are not used and dynamic user/group allocation is enabled
for a unit, the name of the dynamic user/group is implicitly
derived from the unit name. If the unit name without the
type suffix qualifies as valid user name it is used
directly, otherwise a name incorporating a hash of it is
used. If a statically allocated user or group of the
configured name already exists, it is used and no dynamic
user/group is allocated. Note that if <i>User=</i> is
specified and the static group with the name exists, then it
is required that the static user with the name already
exists. Similarly, if <i>Group=</i> is specified and the
static user with the name exists, then it is required that
the static group with the name already exists. Dynamic
users/groups are allocated from the UID/GID range
61184...65519. It is recommended to avoid this range for
regular system or login users. At any point in time each
UID/GID from this range is only assigned to zero or one
dynamically allocated users/groups in use. However, UID/GIDs
are recycled after a unit is terminated. Care should be
taken that any processes running as part of a unit for which
dynamic users/groups are enabled do not leave files or
directories owned by these users/groups around, as a
different unit might get the same UID/GID assigned later on,
and thus gain access to these files or directories. If
<i>DynamicUser=</i> is enabled, <i>RemoveIPC=</i> and
<i>PrivateTmp=</i> are implied (and cannot be turned off).
This ensures that the lifetime of IPC objects and temporary
files created by the executed processes is bound to the
runtime of the service, and hence the lifetime of the
dynamic user/group. Since /tmp/ and /var/tmp/ are usually
the only world-writable directories on a system this ensures
that a unit making use of dynamic user/group allocation
cannot leave files around after unit termination.
Furthermore <i>NoNewPrivileges=</i> and
<i>RestrictSUIDSGID=</i> are implicitly enabled (and cannot
be disabled), to ensure that processes invoked cannot take
benefit or create SUID/SGID files or directories. Moreover
<i>ProtectSystem=strict</i> and <i>ProtectHome=read-only</i>
are implied, thus prohibiting the service to write to
arbitrary file system locations. In order to allow the
service to write to certain directories, they have to be
allow-listed using <i>ReadWritePaths=</i>, but care must be
taken so that UID/GID recycling doesn't create security
issues involving files created by the service. Use
<i>RuntimeDirectory=</i> (see below) in order to assign a
writable runtime directory to a service, owned by the
dynamic user/group and removed automatically when the unit
is terminated. Use <i>StateDirectory=</i>,
<i>CacheDirectory=</i> and <i>LogsDirectory=</i> in order to
assign a set of writable directories for specific purposes
to the service in a way that they are protected from
vulnerabilities due to UID reuse (see below). If this option
is enabled, care should be taken that the unit's processes
do not get access to directories outside of these explicitly
configured and managed ones. Specifically, do not use
<i>BindPaths=</i> and be careful with <b>AF_UNIX</b> file
descriptor passing for directory file descriptors, as this
would permit processes to create files or directories owned
by the dynamic user/group that are not subject to the
lifecycle and access guarantees of the service. Defaults to
off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SupplementaryGroups=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
supplementary Unix groups the processes are executed as.
This takes a space-separated list of group names or IDs.
This option may be specified more than once, in which case
all listed groups are set as supplementary groups. When the
empty string is assigned, the list of supplementary groups
is reset, and all assignments prior to this one will have no
effect. In any way, this option does not override, but
extends the list of supplementary groups configured in the
system group database for the user. This does not affect
commands prefixed with &quot;+&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PAMName=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
PAM service name to set up a session as. If set, the
executed process will be registered as a PAM session under
the specified service name. This is only useful in
conjunction with the <i>User=</i> setting, and is otherwise
ignored. If not set, no PAM session will be opened for the
executed processes. See <b>pam</b>(8) for
details.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that for each unit making use of this option a PAM session
handler process will be maintained as part of the unit and
stays around as long as the unit is active, to ensure that
appropriate actions can be taken when the unit and hence the
PAM session terminates. This process is named
&quot;(sd-pam)&quot; and is an immediate child process of
the unit's main process.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that when this option is used for a unit it is very likely
(depending on PAM configuration) that the main unit process
will be migrated to its own session scope unit when it is
activated. This process will hence be associated with two
units: the unit it was originally started from (and for
which <i>PAMName=</i> was configured), and the session scope
unit. Any child processes of that process will however be
associated with the session scope unit only. This has
implications when used in combination with
<i>NotifyAccess=</i><b>all</b>, as these child processes
will not be able to affect changes in the original unit
through notification messages. These messages will be
considered belonging to the session scope unit and not the
original unit. It is hence not recommended to use
<i>PAMName=</i> in combination with
<i>NotifyAccess=</i><b>all</b>.</font></p>

<h2>CAPABILITIES
<a name="CAPABILITIES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">These
options are only available for system services and are not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CapabilityBoundingSet=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
which capabilities to include in the capability bounding set
for the executed process. See <b>capabilities</b>(7) for
details. Takes a whitespace-separated list of capability
names, e.g. <b>CAP_SYS_ADMIN</b>, <b>CAP_DAC_OVERRIDE</b>,
<b>CAP_SYS_PTRACE</b>. Capabilities listed will be included
in the bounding set, all others are removed. If the list of
capabilities is prefixed with &quot;~&quot;, all but the
listed capabilities will be included, the effect of the
assignment inverted. Note that this option also affects the
respective capabilities in the effective, permitted and
inheritable capability sets. If this option is not used, the
capability bounding set is not modified on process
execution, hence no limits on the capabilities of the
process are enforced. This option may appear more than once,
in which case the bounding sets are merged by <b>OR</b>, or
by <b>AND</b> if the lines are prefixed with &quot;~&quot;
(see below). If the empty string is assigned to this option,
the bounding set is reset to the empty capability set, and
all prior settings have no effect. If set to &quot;~&quot;
(without any further argument), the bounding set is reset to
the full set of available capabilities, also undoing any
previous settings. This does not affect commands prefixed
with &quot;+&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Use
<b>systemd-analyze</b>(1)'s <b>capability</b> command to
retrieve a list of capabilities defined on the local
system.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
if a unit has the following,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">CapabilityBoundingSet=CAP_A
CAP_B <br>
CapabilityBoundingSet=CAP_B CAP_C</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then
<b>CAP_A</b>, <b>CAP_B</b>, and <b>CAP_C</b> are set. If the
second line is prefixed with &quot;~&quot;, e.g.,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">CapabilityBoundingSet=CAP_A
CAP_B <br>
CapabilityBoundingSet=~CAP_B CAP_C</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then,
only <b>CAP_A</b> is set.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>AmbientCapabilities=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
which capabilities to include in the ambient capability set
for the executed process. Takes a whitespace-separated list
of capability names, e.g. <b>CAP_SYS_ADMIN</b>,
<b>CAP_DAC_OVERRIDE</b>, <b>CAP_SYS_PTRACE</b>. This option
may appear more than once in which case the ambient
capability sets are merged (see the above examples in
<i>CapabilityBoundingSet=</i>). If the list of capabilities
is prefixed with &quot;~&quot;, all but the listed
capabilities will be included, the effect of the assignment
inverted. If the empty string is assigned to this option,
the ambient capability set is reset to the empty capability
set, and all prior settings have no effect. If set to
&quot;~&quot; (without any further argument), the ambient
capability set is reset to the full set of available
capabilities, also undoing any previous settings. Note that
adding capabilities to ambient capability set adds them to
the process's inherited capability set.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Ambient
capability sets are useful if you want to execute a process
as a non-privileged user but still want to give it some
capabilities. Note that in this case option <b>keep-caps</b>
is automatically added to <i>SecureBits=</i> to retain the
capabilities over the user change.
<i>AmbientCapabilities=</i> does not affect commands
prefixed with &quot;+&quot;.</font></p>

<h2>SECURITY
<a name="SECURITY"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>NoNewPrivileges=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, ensures that the service process
and all its children can never gain new privileges through
<b>execve()</b> (e.g. via setuid or setgid bits, or
filesystem capabilities). This is the simplest and most
effective way to ensure that a process and its children can
never elevate privileges again. Defaults to false, but
certain settings override this and ignore the value of this
setting. This is the case when <i>DynamicUser=</i>,
<i>LockPersonality=</i>, <i>MemoryDenyWriteExecute=</i>,
<i>PrivateDevices=</i>, <i>ProtectClock=</i>,
<i>ProtectHostname=</i>, <i>ProtectKernelLogs=</i>,
<i>ProtectKernelModules=</i>, <i>ProtectKernelTunables=</i>,
<i>RestrictAddressFamilies=</i>, <i>RestrictNamespaces=</i>,
<i>RestrictRealtime=</i>, <i>RestrictSUIDSGID=</i>,
<i>SystemCallArchitectures=</i>, <i>SystemCallFilter=</i>,
or <i>SystemCallLog=</i> are specified. Note that even if
this setting is overridden by them, <b>systemctl show</b>
shows the original value of this setting. In case the
service will be run in a new mount namespace anyway and
SELinux is disabled, all file systems are mounted with
<b>MS_NOSUID</b> flag. Also see</font>
<b><font color="#0000FF">No New Privileges Flag</font></b>
<small><font color="#000000">[4]</font></small>
<font color="#000000">.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SecureBits=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the secure bits set for the executed process. Takes a
space-separated combination of options from the following
list: <b>keep-caps</b>, <b>keep-caps-locked</b>,
<b>no-setuid-fixup</b>, <b>no-setuid-fixup-locked</b>,
<b>noroot</b>, and <b>noroot-locked</b>. This option may
appear more than once, in which case the secure bits are
ORed. If the empty string is assigned to this option, the
bits are reset to 0. This does not affect commands prefixed
with &quot;+&quot;. See <b>capabilities</b>(7) for
details.</font></p>

<h2>MANDATORY ACCESS CONTROL
<a name="MANDATORY ACCESS CONTROL"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">These
options are only available for system services and are not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SELinuxContext=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Set the
SELinux security context of the executed process. If set,
this will override the automated domain transition. However,
the policy still needs to authorize the transition. This
directive is ignored if SELinux is disabled. If prefixed by
&quot;-&quot;, all errors will be ignored. This does not
affect commands prefixed with &quot;+&quot;. See
<b>setexeccon</b>(3) for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>AppArmorProfile=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
profile name as argument. The process executed by the unit
will switch to this profile when started. Profiles must
already be loaded in the kernel, or the unit will fail. If
prefixed by &quot;-&quot;, all errors will be ignored. This
setting has no effect if AppArmor is not enabled. This
setting does not affect commands prefixed with
&quot;+&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SmackProcessLabel=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
<b>SMACK64</b> security label as argument. The process
executed by the unit will be started under this label and
SMACK will decide whether the process is allowed to run or
not, based on it. The process will continue to run under the
label specified here unless the executable has its own
<b>SMACK64EXEC</b> label, in which case the process will
transition to run under that label. When not specified, the
label that systemd is running under is used. This directive
is ignored if SMACK is disabled.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
value may be prefixed by &quot;-&quot;, in which case all
errors will be ignored. An empty value may be specified to
unset previous assignments. This does not affect commands
prefixed with &quot;+&quot;.</font></p>

<h2>PROCESS PROPERTIES
<a name="PROCESS PROPERTIES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LimitCPU=</i>,
<i>LimitFSIZE=</i>, <i>LimitDATA=</i>, <i>LimitSTACK=</i>,
<i>LimitCORE=</i>, <i>LimitRSS=</i>, <i>LimitNOFILE=</i>,
<i>LimitAS=</i>, <i>LimitNPROC=</i>, <i>LimitMEMLOCK=</i>,
<i>LimitLOCKS=</i>, <i>LimitSIGPENDING=</i>,
<i>LimitMSGQUEUE=</i>, <i>LimitNICE=</i>,
<i>LimitRTPRIO=</i>, <i>LimitRTTIME=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Set soft
and hard limits on various resources for executed processes.
See <b>setrlimit</b>(2) for details on the resource limit
concept. Resource limits may be specified in two formats:
either as single value to set a specific soft and hard limit
to the same value, or as colon-separated pair
<b>soft:hard</b> to set both limits individually (e.g.
&quot;LimitAS=4G:16G&quot;). Use the string <b>infinity</b>
to configure no limit on a specific resource. The
multiplicative suffixes K, M, G, T, P and E (to the base
1024) may be used for resource limits measured in bytes
(e.g. &quot;LimitAS=16G&quot;). For the limits referring to
time values, the usual time units ms, s, min, h and so on
may be used (see <b>systemd.time</b>(7) for details). Note
that if no time unit is specified for <i>LimitCPU=</i> the
default unit of seconds is implied, while for
<i>LimitRTTIME=</i> the default unit of microseconds is
implied. Also, note that the effective granularity of the
limits might influence their enforcement. For example, time
limits specified for <i>LimitCPU=</i> will be rounded up
implicitly to multiples of 1s. For <i>LimitNICE=</i> the
value may be specified in two syntaxes: if prefixed with
&quot;+&quot; or &quot;-&quot;, the value is understood as
regular Linux nice value in the range -20...19. If not
prefixed like this the value is understood as raw resource
limit parameter in the range 0...40 (with 0 being equivalent
to 1).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that most process resource limits configured with these
options are per-process, and processes may fork in order to
acquire a new set of resources that are accounted
independently of the original process, and may thus escape
limits set. Also note that <i>LimitRSS=</i> is not
implemented on Linux, and setting it has no effect. Often it
is advisable to prefer the resource controls listed in
<b>systemd.resource-control</b>(5) over these per-process
limits, as they apply to services as a whole, may be altered
dynamically at runtime, and are generally more expressive.
For example, <i>MemoryMax=</i> is a more powerful (and
working) replacement for <i>LimitRSS=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Resource
limits not configured explicitly for a unit default to the
value configured in the various <i>DefaultLimitCPU=</i>,
<i>DefaultLimitFSIZE=</i>, ... options available in
<b>systemd-system.conf</b>(5), and &ndash; if not configured
there &ndash; the kernel or per-user defaults, as defined by
the OS (the latter only for user services, see
below).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">For
system units these resource limits may be chosen freely.
When these settings are configured in a user service (i.e. a
service run by the per-user instance of the service manager)
they cannot be used to raise the limits above those set for
the user manager itself when it was first invoked, as the
user's service manager generally lacks the privileges to do
so. In user context these configuration options are hence
only useful to lower the limits passed in or to raise the
soft limit to the maximum of the hard limit as configured
for the user. To raise the user's limits further, the
available configuration mechanisms differ between operating
systems, but typically require privileges. In most cases it
is possible to configure higher per-user resource limits via
PAM or by setting limits on the system service encapsulating
the user's service manager, i.e. the user's instance of
user@.service. After making such changes, make sure to
restart the user's service manager.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;1.&nbsp;Resource
limit directives, their equivalent ulimit shell commands and
the unit used</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495761.png" alt="Image grohtml-3495761.png"></b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>UMask=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the file mode creation mask. Takes an access mode in octal
notation. See <b>umask</b>(2) for details. Defaults to 0022
for system units. For user units the default value is
inherited from the per-user service manager (whose default
is in turn inherited from the system service manager, and
thus typically also is 0022 &mdash; unless overridden by a
PAM module). In order to change the per-user mask for all
user services, consider setting the <i>UMask=</i> setting of
the user's user@.service system service instance. The
per-user umask may also be set via the <i>umask</i> field of
a user's</font> <b><font color="#0000FF">JSON User
Record</font></b>
<small><font color="#000000">[5]</font></small>
<font color="#000000">(for users managed by
<b>systemd-homed.service</b>(8) this field may be controlled
via <b>homectl --umask=</b>). It may also be set via a PAM
module, such as <b>pam_umask</b>(8).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CoredumpFilter=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
which types of memory mappings will be saved if the process
dumps core (using the /proc/<i>pid</i>/coredump_filter
file). Takes a whitespace-separated combination of mapping
type names or numbers (with the default base 16). Mapping
type names are <b>private-anonymous</b>,
<b>shared-anonymous</b>, <b>private-file-backed</b>,
<b>shared-file-backed</b>, <b>elf-headers</b>,
<b>private-huge</b>, <b>shared-huge</b>, <b>private-dax</b>,
<b>shared-dax</b>, and the special values <b>all</b> (all
types) and <b>default</b> (the kernel default of
&quot;<b>private-anonymous shared-anonymous elf-headers
private-huge</b>&quot;). See <b>core</b>(5) for the meaning
of the mapping types. When specified multiple times, all
specified masks are ORed. When not set, or if the empty
value is assigned, the inherited value is not
changed.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Example&nbsp;2.&nbsp;Add
DAX pages to the dump filter</b></font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">CoredumpFilter=default
private-dax shared-dax</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>KeyringMode=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
how the kernel session keyring is set up for the service
(see <b>session-keyring</b>(7) for details on the session
keyring). Takes one of <b>inherit</b>, <b>private</b>,
<b>shared</b>. If set to <b>inherit</b> no special keyring
setup is done, and the kernel's default behaviour is
applied. If <b>private</b> is used a new session keyring is
allocated when a service process is invoked, and it is not
linked up with any user keyring. This is the recommended
setting for system services, as this ensures that multiple
services running under the same system user ID (in
particular the root user) do not share their key material
among each other. If <b>shared</b> is used a new session
keyring is allocated as for <b>private</b>, but the user
keyring of the user configured with <i>User=</i> is linked
into it, so that keys assigned to the user may be requested
by the unit's processes. In this modes multiple units
running processes under the same user ID may share key
material. Unless <b>inherit</b> is selected the unique
invocation ID for the unit (see below) is added as a
protected key by the name &quot;invocation_id&quot; to the
newly created session keyring. Defaults to <b>private</b>
for services of the system service manager and to
<b>inherit</b> for non-service units and for services of the
user service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>OOMScoreAdjust=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
adjustment value for the Linux kernel's Out-Of-Memory (OOM)
killer score for executed processes. Takes an integer
between -1000 (to disable OOM killing of processes of this
unit) and 1000 (to make killing of processes of this unit
under memory pressure very likely). See</font>
<b><font color="#0000FF">proc.txt</font></b>
<small><font color="#000000">[6]</font></small>
<font color="#000000">for details. If not specified defaults
to the OOM score adjustment level of the service manager
itself, which is normally at 0.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Use
the <i>OOMPolicy=</i> setting of service units to configure
how the service manager shall react to the kernel OOM killer
terminating a process of the service. See
<b>systemd.service</b>(5) for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TimerSlackNSec=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
timer slack in nanoseconds for the executed processes. The
timer slack controls the accuracy of wake-ups triggered by
timers. See <b>prctl</b>(2) for more information. Note that
in contrast to most other time span definitions this
parameter takes an integer value in nano-seconds if no unit
is specified. The usual time units are understood
too.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Personality=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
which kernel architecture <b>uname</b>(2) shall report, when
invoked by unit processes. Takes one of the architecture
identifiers <b>x86</b>, <b>x86-64</b>, <b>ppc</b>,
<b>ppc-le</b>, <b>ppc64</b>, <b>ppc64-le</b>, <b>s390</b> or
<b>s390x</b>. Which personality architectures are supported
depends on the system architecture. Usually the 64bit
versions of the various system architectures support their
immediate 32bit personality architecture counterpart, but no
others. For example, <b>x86-64</b> systems support the
<b>x86-64</b> and <b>x86</b> personalities but no others.
The personality feature is useful when running 32-bit
services on a 64-bit host system. If not specified, the
personality is left unmodified and thus reflects the
personality of the host system's kernel.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IgnoreSIGPIPE=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, causes <b>SIGPIPE</b> to be
ignored in the executed process. Defaults to true because
<b>SIGPIPE</b> generally is useful only in shell
pipelines.</font></p>

<h2>SCHEDULING
<a name="SCHEDULING"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Nice=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
default nice level (scheduling priority) for executed
processes. Takes an integer between -20 (highest priority)
and 19 (lowest priority). In case of resource contention,
smaller values mean more resources will be made available to
the unit's processes, larger values mean less resources will
be made available. See <b>setpriority</b>(2) for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CPUSchedulingPolicy=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
CPU scheduling policy for executed processes. Takes one of
<b>other</b>, <b>batch</b>, <b>idle</b>, <b>fifo</b> or
<b>rr</b>. See <b>sched_setscheduler</b>(2) for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CPUSchedulingPriority=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
CPU scheduling priority for executed processes. The
available priority range depends on the selected CPU
scheduling policy (see above). For real-time scheduling
policies an integer between 1 (lowest priority) and 99
(highest priority) can be used. In case of CPU resource
contention, smaller values mean less CPU time is made
available to the service, larger values mean more. See
<b>sched_setscheduler</b>(2) for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CPUSchedulingResetOnFork=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, elevated CPU scheduling
priorities and policies will be reset when the executed
processes call <b>fork</b>(2), and can hence not leak into
child processes. See <b>sched_setscheduler</b>(2) for
details. Defaults to false.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>CPUAffinity=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the CPU affinity of the executed processes. Takes a list of
CPU indices or ranges separated by either whitespace or
commas. Alternatively, takes a special &quot;numa&quot;
value in which case systemd automatically derives allowed
CPU range based on the value of <i>NUMAMask=</i> option. CPU
ranges are specified by the lower and upper CPU indices
separated by a dash. This option may be specified more than
once, in which case the specified CPU affinity masks are
merged. If the empty string is assigned, the mask is reset,
all assignments prior to this will have no effect. See
<b>sched_setaffinity</b>(2) for details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>NUMAPolicy=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the NUMA memory policy of the executed processes. Takes a
policy type, one of: <b>default</b>, <b>preferred</b>,
<b>bind</b>, <b>interleave</b> and <b>local</b>. A list of
NUMA nodes that should be associated with the policy must be
specified in <i>NUMAMask=</i>. For more details on each
policy please see, <b>set_mempolicy</b>(2). For overall
overview of NUMA support in Linux see,
<b>numa</b>(7).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>NUMAMask=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the NUMA node list which will be applied alongside with
selected NUMA policy. Takes a list of NUMA nodes and has the
same syntax as a list of CPUs for <i>CPUAffinity=</i> option
or special &quot;all&quot; value which will include all
available NUMA nodes in the mask. Note that the list of NUMA
nodes is not required for <b>default</b> and <b>local</b>
policies and for <b>preferred</b> policy we expect a single
NUMA node.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IOSchedulingClass=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
I/O scheduling class for executed processes. Takes one of
the strings <b>realtime</b>, <b>best-effort</b> or
<b>idle</b>. The kernel's default scheduling class is
<b>best-effort</b> at a priority of 4. If the empty string
is assigned to this option, all prior assignments to both
<i>IOSchedulingClass=</i> and <i>IOSchedulingPriority=</i>
have no effect. See <b>ioprio_set</b>(2) for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IOSchedulingPriority=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
I/O scheduling priority for executed processes. Takes an
integer between 0 (highest priority) and 7 (lowest
priority). In case of I/O contention, smaller values mean
more I/O bandwidth is made available to the unit's
processes, larger values mean less bandwidth. The available
priorities depend on the selected I/O scheduling class (see
above). If the empty string is assigned to this option, all
prior assignments to both <i>IOSchedulingClass=</i> and
<i>IOSchedulingPriority=</i> have no effect. For the
kernel's default scheduling class (<b>best-effort</b>) this
defaults to 4. See <b>ioprio_set</b>(2) for
details.</font></p>

<h2>SANDBOXING
<a name="SANDBOXING"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following sandboxing options are an effective way to limit
the exposure of the system towards the unit's processes. It
is recommended to turn on as many of these options for each
unit as is possible without negatively affecting the
process' ability to operate. Note that many of these
sandboxing features are gracefully turned off on systems
where the underlying security mechanism is not available.
For example, <i>ProtectSystem=</i> has no effect if the
kernel is built without file system namespacing or if the
service manager runs in a container manager that makes file
system namespacing unavailable to its payload. Similar,
<i>RestrictRealtime=</i> has no effect on systems that lack
support for SECCOMP system call filtering, or in containers
where support for this is turned off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Also
note that some sandboxing functionality is generally not
available in user services (i.e. services run by the
per-user service manager). Specifically, the various
settings requiring file system namespacing support (such as
<i>ProtectSystem=</i>) are not available, as the underlying
kernel functionality is only accessible to privileged
processes. However, most namespacing settings, that will not
work on their own in user services, will work when used in
conjunction with <i>PrivateUsers=</i><b>true</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectSystem=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument or the special values &quot;full&quot; or
&quot;strict&quot;. If true, mounts the /usr/ and the boot
loader directories (/boot and /efi) read-only for processes
invoked by this unit. If set to &quot;full&quot;, the /etc/
directory is mounted read-only, too. If set to
&quot;strict&quot; the entire file system hierarchy is
mounted read-only, except for the API file system subtrees
/dev/, /proc/ and /sys/ (protect these directories using
<i>PrivateDevices=</i>, <i>ProtectKernelTunables=</i>,
<i>ProtectControlGroups=</i>). This setting ensures that any
modification of the vendor-supplied operating system (and
optionally its configuration, and local mounts) is
prohibited for the service. It is recommended to enable this
setting for all long-running services, unless they are
involved with system updates or need to modify the operating
system in other ways. If this option is used,
<i>ReadWritePaths=</i> may be used to exclude specific
directories from being made read-only. This setting is
implied if <i>DynamicUser=</i> is set. This setting cannot
ensure protection in all cases. In general it has the same
limitations as <i>ReadOnlyPaths=</i>, see below. Defaults to
off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectHome=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument or the special values &quot;read-only&quot;
or &quot;tmpfs&quot;. If true, the directories /home/,
/root, and /run/user are made inaccessible and empty for
processes invoked by this unit. If set to
&quot;read-only&quot;, the three directories are made
read-only instead. If set to &quot;tmpfs&quot;, temporary
file systems are mounted on the three directories in
read-only mode. The value &quot;tmpfs&quot; is useful to
hide home directories not relevant to the processes invoked
by the unit, while still allowing necessary directories to
be made visible when listed in <i>BindPaths=</i> or
<i>BindReadOnlyPaths=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Setting
this to &quot;yes&quot; is mostly equivalent to set the
three directories in <i>InaccessiblePaths=</i>. Similarly,
&quot;read-only&quot; is mostly equivalent to
<i>ReadOnlyPaths=</i>, and &quot;tmpfs&quot; is mostly
equivalent to <i>TemporaryFileSystem=</i> with
&quot;:ro&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is recommended to enable this setting for all long-running
services (in particular network-facing ones), to ensure they
cannot get access to private user data, unless the services
actually require access to the user's private data. This
setting is implied if <i>DynamicUser=</i> is set. This
setting cannot ensure protection in all cases. In general it
has the same limitations as <i>ReadOnlyPaths=</i>, see
below.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RuntimeDirectory=</i>,
<i>StateDirectory=</i>, <i>CacheDirectory=</i>,
<i>LogsDirectory=</i>,
<i>ConfigurationDirectory=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">These
options take a whitespace-separated list of directory names.
The specified directory names must be relative, and may not
include &quot;..&quot;. If set, when the unit is started,
one or more directories by the specified names will be
created (including their parents) below the locations
defined in the following table. Also, the corresponding
environment variable will be defined with the full paths of
the directories. If multiple directories are set, then in
the environment variable the paths are concatenated with
colon (&quot;:&quot;).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;2.&nbsp;Automatic
directory creation and environment variables</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495762.png" alt="Image grohtml-3495762.png"></b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">In
case of <i>RuntimeDirectory=</i> the innermost
subdirectories are removed when the unit is stopped. It is
possible to preserve the specified directories in this case
if <i>RuntimeDirectoryPreserve=</i> is configured to
<b>restart</b> or <b>yes</b> (see below). The directories
specified with <i>StateDirectory=</i>,
<i>CacheDirectory=</i>, <i>LogsDirectory=</i>,
<i>ConfigurationDirectory=</i> are not removed when the unit
is stopped.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Except
in case of <i>ConfigurationDirectory=</i>, the innermost
specified directories will be owned by the user and group
specified in <i>User=</i> and <i>Group=</i>. If the
specified directories already exist and their owning user or
group do not match the configured ones, all files and
directories below the specified directories as well as the
directories themselves will have their file ownership
recursively changed to match what is configured. As an
optimization, if the specified directories are already owned
by the right user and group, files and directories below of
them are left as-is, even if they do not match what is
requested. The innermost specified directories will have
their access mode adjusted to the what is specified in
<i>RuntimeDirectoryMode=</i>, <i>StateDirectoryMode=</i>,
<i>CacheDirectoryMode=</i>, <i>LogsDirectoryMode=</i> and
<i>ConfigurationDirectoryMode=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">These
options imply <i>BindPaths=</i> for the specified paths.
When combined with <i>RootDirectory=</i> or
<i>RootImage=</i> these paths always reside on the host and
are mounted from there into the unit's file system
namespace.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
<i>DynamicUser=</i> is used, the logic for
<i>CacheDirectory=</i>, <i>LogsDirectory=</i> and
<i>StateDirectory=</i> is slightly altered: the directories
are created below /var/cache/private, /var/log/private and
/var/lib/private, respectively, which are host directories
made inaccessible to unprivileged users, which ensures that
access to these directories cannot be gained through dynamic
user ID recycling. Symbolic links are created to hide this
difference in behaviour. Both from perspective of the host
and from inside the unit, the relevant directories hence
always appear directly below /var/cache, /var/log and
/var/lib.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Use
<i>RuntimeDirectory=</i> to manage one or more runtime
directories for the unit and bind their lifetime to the
daemon runtime. This is particularly useful for unprivileged
daemons that cannot create runtime directories in /run/ due
to lack of privileges, and to make sure the runtime
directory is cleaned up automatically after use. For runtime
directories that require more complex or different
configuration or lifetime guarantees, please consider using
<b>tmpfiles.d</b>(5).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
directories defined by these options are always created
under the standard paths used by systemd (/var/, /run/,
/etc/, ...). If the service needs directories in a different
location, a different mechanism has to be used to create
them.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>tmpfiles.d</b>(5)
provides functionality that overlaps with these options.
Using these options is recommended, because the lifetime of
the directories is tied directly to the lifetime of the
unit, and it is not necessary to ensure that the tmpfiles.d
configuration is executed before the unit is
started.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">To
remove any of the directories created by these settings, use
the <b>systemctl clean ...</b> command on the relevant
units, see <b>systemctl</b>(1) for details.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
if a system service unit has the following,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">RuntimeDirectory=foo/bar
baz</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">the
service manager creates /run/foo (if it does not exist),
/run/foo/bar, and /run/baz. The directories /run/foo/bar and
/run/baz except /run/foo are owned by the user and group
specified in <i>User=</i> and <i>Group=</i>, and removed
when the service is stopped.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
if a system service unit has the following,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">RuntimeDirectory=foo/bar
<br>
StateDirectory=aaa/bbb ccc</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then
the environment variable &quot;RUNTIME_DIRECTORY&quot; is
set with &quot;/run/foo/bar&quot;, and
&quot;STATE_DIRECTORY&quot; is set with
&quot;/var/lib/aaa/bbb:/var/lib/ccc&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RuntimeDirectoryMode=</i>,
<i>StateDirectoryMode=</i>, <i>CacheDirectoryMode=</i>,
<i>LogsDirectoryMode=</i>,
<i>ConfigurationDirectoryMode=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Specifies
the access mode of the directories specified in
<i>RuntimeDirectory=</i>, <i>StateDirectory=</i>,
<i>CacheDirectory=</i>, <i>LogsDirectory=</i>, or
<i>ConfigurationDirectory=</i>, respectively, as an octal
number. Defaults to <b>0755</b>. See &quot;Permissions&quot;
in <b>path_resolution</b>(7) for a discussion of the meaning
of permission bits.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RuntimeDirectoryPreserve=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument or <b>restart</b>. If set to <b>no</b> (the
default), the directories specified in
<i>RuntimeDirectory=</i> are always removed when the service
stops. If set to <b>restart</b> the directories are
preserved when the service is both automatically and
manually restarted. Here, the automatic restart means the
operation specified in <i>Restart=</i>, and manual restart
means the one triggered by <b>systemctl restart
foo.service</b>. If set to <b>yes</b>, then the directories
are not removed when the service is stopped. Note that since
the runtime directory /run/ is a mount point of
&quot;tmpfs&quot;, then for system services the directories
specified in <i>RuntimeDirectory=</i> are removed when the
system is rebooted.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TimeoutCleanSec=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
a timeout on the clean-up operation requested through
<b>systemctl clean ...</b>, see <b>systemctl</b>(1) for
details. Takes the usual time values and defaults to
<b>infinity</b>, i.e. by default no timeout is applied. If a
timeout is configured the clean operation will be aborted
forcibly when the timeout is reached, potentially leaving
resources on disk.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ReadWritePaths=</i>,
<i>ReadOnlyPaths=</i>, <i>InaccessiblePaths=</i>,
<i>ExecPaths=</i>, <i>NoExecPaths=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets up a
new file system namespace for executed processes. These
options may be used to limit access a process has to the
file system. Each setting takes a space-separated list of
paths relative to the host's root directory (i.e. the system
running the service manager). Note that if paths contain
symlinks, they are resolved relative to the root directory
set with <i>RootDirectory=</i>/<i>RootImage=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Paths
listed in <i>ReadWritePaths=</i> are accessible from within
the namespace with the same access modes as from outside of
it. Paths listed in <i>ReadOnlyPaths=</i> are accessible for
reading only, writing will be refused even if the usual file
access controls would permit this. Nest
<i>ReadWritePaths=</i> inside of <i>ReadOnlyPaths=</i> in
order to provide writable subdirectories within read-only
directories. Use <i>ReadWritePaths=</i> in order to
allow-list specific paths for write access if
<i>ProtectSystem=strict</i> is used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Paths
listed in <i>InaccessiblePaths=</i> will be made
inaccessible for processes inside the namespace along with
everything below them in the file system hierarchy. This may
be more restrictive than desired, because it is not possible
to nest <i>ReadWritePaths=</i>, <i>ReadOnlyPaths=</i>,
<i>BindPaths=</i>, or <i>BindReadOnlyPaths=</i> inside it.
For a more flexible option, see
<i>TemporaryFileSystem=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Content
in paths listed in <i>NoExecPaths=</i> are not executable
even if the usual file access controls would permit this.
Nest <i>ExecPaths=</i> inside of <i>NoExecPaths=</i> in
order to provide executable content within non-executable
directories.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Non-directory
paths may be specified as well. These options may be
specified more than once, in which case all paths listed
will have limited access from within the namespace. If the
empty string is assigned to this option, the specific list
is reset, and all prior assignments have no
effect.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Paths
in <i>ReadWritePaths=</i>, <i>ReadOnlyPaths=</i>,
<i>InaccessiblePaths=</i>, <i>ExecPaths=</i> and
<i>NoExecPaths=</i> may be prefixed with &quot;-&quot;, in
which case they will be ignored when they do not exist. If
prefixed with &quot;+&quot; the paths are taken relative to
the root directory of the unit, as configured with
<i>RootDirectory=</i>/<i>RootImage=</i>, instead of relative
to the root directory of the host (see above). When
combining &quot;-&quot; and &quot;+&quot; on the same path
make sure to specify &quot;-&quot; first, and &quot;+&quot;
second.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that these settings will disconnect propagation of mounts
from the unit's processes to the host. This means that this
setting may not be used for services which shall be able to
install mount points in the main mount namespace. For
<i>ReadWritePaths=</i> and <i>ReadOnlyPaths=</i> propagation
in the other direction is not affected, i.e. mounts created
on the host generally appear in the unit processes'
namespace, and mounts removed on the host also disappear
there too. In particular, note that mount propagation from
host to unit will result in unmodified mounts to be created
in the unit's namespace, i.e. writable mounts appearing on
the host will be writable in the unit's namespace too, even
when propagated below a path marked with
<i>ReadOnlyPaths=</i>! Restricting access with these options
hence does not extend to submounts of a directory that are
created later on. This means the lock-down offered by that
setting is not complete, and does not offer full
protection.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the effect of these settings may be undone by
privileged processes. In order to set up an effective
sandboxed environment for a unit it is thus recommended to
combine these settings with either
<i>CapabilityBoundingSet=~CAP_SYS_ADMIN</i> or
<i>SystemCallFilter=~@mount</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Simple
allow-list example using these directives:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">[Service]
<br>
ReadOnlyPaths=/ <br>
ReadWritePaths=/var /run <br>
InaccessiblePaths=-/lost+found <br>
NoExecPaths=/ <br>
ExecPaths=/usr/sbin/my_daemon /lib /lib64</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">These
options are only available for system services and are not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TemporaryFileSystem=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
space-separated list of mount points for temporary file
systems (tmpfs). If set, a new file system namespace is set
up for executed processes, and a temporary file system is
mounted on each mount point. This option may be specified
more than once, in which case temporary file systems are
mounted on all listed mount points. If the empty string is
assigned to this option, the list is reset, and all prior
assignments have no effect. Each mount point may optionally
be suffixed with a colon (&quot;:&quot;) and mount options
such as &quot;size=10%&quot; or &quot;ro&quot;. By default,
each temporary file system is mounted with
&quot;nodev,strictatime,mode=0755&quot;. These can be
disabled by explicitly specifying the corresponding mount
options, e.g., &quot;dev&quot; or
&quot;nostrictatime&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
is useful to hide files or directories not relevant to the
processes invoked by the unit, while necessary files or
directories can be still accessed by combining with
<i>BindPaths=</i> or <i>BindReadOnlyPaths=</i>:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
if a unit has the following,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">TemporaryFileSystem=/var:ro
<br>
BindReadOnlyPaths=/var/lib/systemd</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then
the invoked processes by the unit cannot see any files or
directories under /var/ except for /var/lib/systemd or its
contents.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateTmp=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, sets up a new file system
namespace for the executed processes and mounts private
/tmp/ and /var/tmp/ directories inside it that are not
shared by processes outside of the namespace. This is useful
to secure access to temporary files of the process, but
makes sharing between processes via /tmp/ or /var/tmp/
impossible. If true, all temporary files created by a
service in these directories will be removed after the
service is stopped. Defaults to false. It is possible to run
two or more units within the same private /tmp/ and
/var/tmp/ namespace by using the <i>JoinsNamespaceOf=</i>
directive, see <b>systemd.unit</b>(5) for details. This
setting is implied if <i>DynamicUser=</i> is set. For this
setting the same restrictions regarding mount propagation
and privileges apply as for <i>ReadOnlyPaths=</i> and
related calls, see above. Enabling this setting has the side
effect of adding <i>Requires=</i> and <i>After=</i>
dependencies on all mount units necessary to access /tmp/
and /var/tmp/. Moreover an implicitly <i>After=</i> ordering
on <b>systemd-tmpfiles-setup.service</b>(8) is
added.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if mount namespaces are not available), and the
unit should be written in a way that does not solely rely on
this setting for security.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateDevices=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, sets up a new /dev/ mount for the
executed processes and only adds API pseudo devices such as
/dev/null, /dev/zero or /dev/random (as well as the pseudo
TTY subsystem) to it, but no physical devices such as
/dev/sda, system memory /dev/mem, system ports /dev/port and
others. This is useful to securely turn off physical device
access by the executed process. Defaults to false. Enabling
this option will install a system call filter to block
low-level I/O system calls that are grouped in the
<i>@raw-io</i> set, will also remove <b>CAP_MKNOD</b> and
<b>CAP_SYS_RAWIO</b> from the capability bounding set for
the unit (see above), and set <i>DevicePolicy=closed</i>
(see <b>systemd.resource-control</b>(5) for details). Note
that using this setting will disconnect propagation of
mounts from the service to the host (propagation in the
opposite direction continues to work). This means that this
setting may not be used for services which shall be able to
install mount points in the main mount namespace. The new
/dev/ will be mounted read-only and 'noexec'. The latter may
break old programs which try to set up executable memory by
using <b>mmap</b>(2) of /dev/zero instead of using
<b>MAP_ANON</b>. For this setting the same restrictions
regarding mount propagation and privileges apply as for
<i>ReadOnlyPaths=</i> and related calls, see above. If
turned on and if running in user mode, or in system mode,
but without the <b>CAP_SYS_ADMIN</b> capability (e.g.
setting <i>User=</i>), <i>NoNewPrivileges=yes</i> is
implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if mount namespaces are not available), and the
unit should be written in a way that does not solely rely on
this setting for security.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateNetwork=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, sets up a new network namespace
for the executed processes and configures only the loopback
network device &quot;lo&quot; inside it. No other network
devices will be available to the executed process. This is
useful to turn off network access by the executed process.
Defaults to false. It is possible to run two or more units
within the same private network namespace by using the
<i>JoinsNamespaceOf=</i> directive, see
<b>systemd.unit</b>(5) for details. Note that this option
will disconnect all socket families from the host, including
<b>AF_NETLINK</b> and <b>AF_UNIX</b>. Effectively, for
<b>AF_NETLINK</b> this means that device configuration
events received from <b>systemd-udevd.service</b>(8) are not
delivered to the unit's processes. And for <b>AF_UNIX</b>
this has the effect that <b>AF_UNIX</b> sockets in the
abstract socket namespace of the host will become
unavailable to the unit's processes (however, those located
in the file system will continue to be
accessible).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if network namespaces are not available), and
the unit should be written in a way that does not solely
rely on this setting for security.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
this option is used on a socket unit any sockets bound on
behalf of this unit will be bound within a private network
namespace. This may be combined with
<i>JoinsNamespaceOf=</i> to listen on sockets inside of
network namespaces of other services.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>NetworkNamespacePath=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
absolute file system path refererring to a Linux network
namespace pseudo-file (i.e. a file like /proc/$PID/ns/net or
a bind mount or symlink to one). When set the invoked
processes are added to the network namespace referenced by
that path. The path has to point to a valid namespace file
at the moment the processes are forked off. If this option
is used <i>PrivateNetwork=</i> has no effect. If this option
is used together with <i>JoinsNamespaceOf=</i> then it only
has an effect if this unit is started before any of the
listed units that have <i>PrivateNetwork=</i> or
<i>NetworkNamespacePath=</i> configured, as otherwise the
network namespace of those units is reused.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
this option is used on a socket unit any sockets bound on
behalf of this unit will be bound within the specified
network namespace.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateIPC=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, sets up a new IPC namespace for
the executed processes. Each IPC namespace has its own set
of System V IPC identifiers and its own POSIX message queue
file system. This is useful to avoid name clash of IPC
identifiers. Defaults to false. It is possible to run two or
more units within the same private IPC namespace by using
the <i>JoinsNamespaceOf=</i> directive, see
<b>systemd.unit</b>(5) for details.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that IPC namespacing does not have an effect on
<b>AF_UNIX</b> sockets, which are the most common form of
IPC used on Linux. Instead, <b>AF_UNIX</b> sockets in the
file system are subject to mount namespacing, and those in
the abstract namespace are subject to network namespacing.
IPC namespacing only has an effect on SysV IPC (which is
mostly legacy) as well as POSIX message queues (for which
<b>AF_UNIX</b>/<b>SOCK_SEQPACKET</b> sockets are typically a
better replacement). IPC namespacing also has no effect on
POSIX shared memory (which is subject to mount namespacing)
either. See <b>ipc_namespaces</b>(7) for the
details.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if IPC namespaces are not available), and the
unit should be written in a way that does not solely rely on
this setting for security.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>IPCNamespacePath=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
absolute file system path refererring to a Linux IPC
namespace pseudo-file (i.e. a file like /proc/$PID/ns/ipc or
a bind mount or symlink to one). When set the invoked
processes are added to the network namespace referenced by
that path. The path has to point to a valid namespace file
at the moment the processes are forked off. If this option
is used <i>PrivateIPC=</i> has no effect. If this option is
used together with <i>JoinsNamespaceOf=</i> then it only has
an effect if this unit is started before any of the listed
units that have <i>PrivateIPC=</i> or
<i>IPCNamespacePath=</i> configured, as otherwise the
network namespace of those units is reused.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateUsers=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, sets up a new user namespace for
the executed processes and configures a minimal user and
group mapping, that maps the &quot;root&quot; user and group
as well as the unit's own user and group to themselves and
everything else to the &quot;nobody&quot; user and group.
This is useful to securely detach the user and group
databases used by the unit from the rest of the system, and
thus to create an effective sandbox environment. All files,
directories, processes, IPC objects and other resources
owned by users/groups not equaling &quot;root&quot; or the
unit's own will stay visible from within the unit but appear
owned by the &quot;nobody&quot; user and group. If this mode
is enabled, all unit processes are run without privileges in
the host user namespace (regardless if the unit's own
user/group is &quot;root&quot; or not). Specifically this
means that the process will have zero process capabilities
on the host's user namespace, but full capabilities within
the service's user namespace. Settings such as
<i>CapabilityBoundingSet=</i> will affect only the latter,
and there's no way to acquire additional capabilities in the
host's user namespace. Defaults to off.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
this setting is set up by a per-user instance of the service
manager, the mapping of the &quot;root&quot; user and group
to itself is omitted (unless the user manager is root).
Additionally, in the per-user instance manager case, the
user namespace will be set up before most other namespaces.
This means that combining <i>PrivateUsers=</i><b>true</b>
with other namespaces will enable use of features not
normally supported by the per-user instances of the service
manager.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
setting is particularly useful in conjunction with
<i>RootDirectory=</i>/<i>RootImage=</i>, as the need to
synchronize the user and group databases in the root
directory and on the host is reduced, as the only users and
groups who need to be matched are &quot;root&quot;,
&quot;nobody&quot; and the unit's own user and
group.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if user namespaces are not available), and the
unit should be written in a way that does not solely rely on
this setting for security.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectHostname=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. When set, sets up a new UTS namespace for
the executed processes. In addition, changing hostname or
domainname is prevented. Defaults to off.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that the implementation of this setting might be impossible
(for example if UTS namespaces are not available), and the
unit should be written in a way that does not solely rely on
this setting for security.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that when this option is enabled for a service hostname
changes no longer propagate from the system into the
service, it is hence not suitable for services that need to
take notice of system hostname changes
dynamically.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
this setting is on, but the unit doesn't have the
<b>CAP_SYS_ADMIN</b> capability (e.g. services for which
<i>User=</i> is set), <i>NoNewPrivileges=yes</i> is
implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectClock=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If set, writes to the hardware clock or
system clock will be denied. It is recommended to turn this
on for most services that do not need modify the clock.
Defaults to off. Enabling this option removes
<b>CAP_SYS_TIME</b> and <b>CAP_WAKE_ALARM</b> from the
capability bounding set for this unit, installs a system
call filter to block calls that can set the clock, and
<i>DeviceAllow=char-rtc r</i> is implied. This ensures
/dev/rtc0, /dev/rtc1, etc. are made read-only to the
service. See <b>systemd.resource-control</b>(5) for the
details about <i>DeviceAllow=</i>. If this setting is on,
but the unit doesn't have the <b>CAP_SYS_ADMIN</b>
capability (e.g. services for which <i>User=</i> is set),
<i>NoNewPrivileges=yes</i> is implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectKernelTunables=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, kernel variables accessible
through /proc/sys/, /sys/, /proc/sysrq-trigger,
/proc/latency_stats, /proc/acpi, /proc/timer_stats, /proc/fs
and /proc/irq will be made read-only to all processes of the
unit. Usually, tunable kernel variables should be
initialized only at boot-time, for example with the
<b>sysctl.d</b>(5) mechanism. Few services need to write to
these at runtime; it is hence recommended to turn this on
for most services. For this setting the same restrictions
regarding mount propagation and privileges apply as for
<i>ReadOnlyPaths=</i> and related calls, see above. Defaults
to off. If this setting is on, but the unit doesn't have the
<b>CAP_SYS_ADMIN</b> capability (e.g. services for which
<i>User=</i> is set), <i>NoNewPrivileges=yes</i> is implied.
Note that this option does not prevent indirect changes to
kernel tunables effected by IPC calls to other processes.
However, <i>InaccessiblePaths=</i> may be used to make
relevant IPC file system objects inaccessible. If
<i>ProtectKernelTunables=</i> is set, <i>MountAPIVFS=yes</i>
is implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectKernelModules=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, explicit module loading will be
denied. This allows module load and unload operations to be
turned off on modular kernels. It is recommended to turn
this on for most services that do not need special file
systems or extra kernel modules to work. Defaults to off.
Enabling this option removes <b>CAP_SYS_MODULE</b> from the
capability bounding set for the unit, and installs a system
call filter to block module system calls, also
/usr/lib/modules is made inaccessible. For this setting the
same restrictions regarding mount propagation and privileges
apply as for <i>ReadOnlyPaths=</i> and related calls, see
above. Note that limited automatic module loading due to
user configuration or kernel mapping tables might still
happen as side effect of requested user operations, both
privileged and unprivileged. To disable module auto-load
feature please see <b>sysctl.d</b>(5)
<b>kernel.modules_disabled</b> mechanism and
/proc/sys/kernel/modules_disabled documentation. If this
setting is on, but the unit doesn't have the
<b>CAP_SYS_ADMIN</b> capability (e.g. services for which
<i>User=</i> is set), <i>NoNewPrivileges=yes</i> is
implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectKernelLogs=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, access to the kernel log ring
buffer will be denied. It is recommended to turn this on for
most services that do not need to read from or write to the
kernel log ring buffer. Enabling this option removes
<b>CAP_SYSLOG</b> from the capability bounding set for this
unit, and installs a system call filter to block the
<b>syslog</b>(2) system call (not to be confused with the
libc API <b>syslog</b>(3) for userspace logging). The kernel
exposes its log buffer to userspace via /dev/kmsg and
/proc/kmsg. If enabled, these are made inaccessible to all
the processes in the unit. If this setting is on, but the
unit doesn't have the <b>CAP_SYS_ADMIN</b> capability (e.g.
services for which <i>User=</i> is set),
<i>NoNewPrivileges=yes</i> is implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>ProtectControlGroups=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true, the Linux Control Groups
(<b>cgroups</b>(7)) hierarchies accessible through
/sys/fs/cgroup/ will be made read-only to all processes of
the unit. Except for container managers no services should
require write access to the control groups hierarchies; it
is hence recommended to turn this on for most services. For
this setting the same restrictions regarding mount
propagation and privileges apply as for
<i>ReadOnlyPaths=</i> and related calls, see above. Defaults
to off. If <i>ProtectControlGroups=</i> is set,
<i>MountAPIVFS=yes</i> is implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RestrictAddressFamilies=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Restricts
the set of socket address families accessible to the
processes of this unit. Takes &quot;none&quot;, or a
space-separated list of address family names to allow-list,
such as <b>AF_UNIX</b>, <b>AF_INET</b> or <b>AF_INET6</b>.
When &quot;none&quot; is specified, then all address
families will be denied. When prefixed with &quot;~&quot;
the listed address families will be applied as deny list,
otherwise as allow list. Note that this restricts access to
the <b>socket</b>(2) system call only. Sockets passed into
the process by other means (for example, by using socket
activation with socket units, see <b>systemd.socket</b>(5))
are unaffected. Also, sockets created with
<b>socketpair()</b> (which creates connected AF_UNIX sockets
only) are unaffected. Note that this option has no effect on
32-bit x86, s390, s390x, mips, mips-le, ppc, ppc-le, ppc64,
ppc64-le and is ignored (but works correctly on other ABIs,
including x86-64). Note that on systems supporting multiple
ABIs (such as x86/x86-64) it is recommended to turn off
alternative ABIs for services, so that they cannot be used
to circumvent the restrictions of this option. Specifically,
it is recommended to combine this option with
<i>SystemCallArchitectures=native</i> or similar. If running
in user mode, or in system mode, but without the
<b>CAP_SYS_ADMIN</b> capability (e.g. setting <i>User=</i>),
<i>NoNewPrivileges=yes</i> is implied. By default, no
restrictions apply, all address families are accessible to
processes. If assigned the empty string, any previous
address family restriction changes are undone. This setting
does not affect commands prefixed with
&quot;+&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Use
this option to limit exposure of processes to remote access,
in particular via exotic and sensitive network protocols,
such as <b>AF_PACKET</b>. Note that in most cases, the local
<b>AF_UNIX</b> address family should be included in the
configured allow list as it is frequently used for local
communication, including for <b>syslog</b>(2)
logging.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RestrictNamespaces=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Restricts
access to Linux namespace functionality for the processes of
this unit. For details about Linux namespaces, see
<b>namespaces</b>(7). Either takes a boolean argument, or a
space-separated list of namespace type identifiers. If false
(the default), no restrictions on namespace creation and
switching are made. If true, access to any kind of
namespacing is prohibited. Otherwise, a space-separated list
of namespace type identifiers must be specified, consisting
of any combination of: <b>cgroup</b>, <b>ipc</b>,
<b>net</b>, <b>mnt</b>, <b>pid</b>, <b>user</b> and
<b>uts</b>. Any namespace type listed is made accessible to
the unit's processes, access to namespace types not listed
is prohibited (allow-listing). By prepending the list with a
single tilde character (&quot;~&quot;) the effect may be
inverted: only the listed namespace types will be made
inaccessible, all unlisted ones are permitted
(deny-listing). If the empty string is assigned, the default
namespace restrictions are applied, which is equivalent to
false. This option may appear more than once, in which case
the namespace types are merged by <b>OR</b>, or by
<b>AND</b> if the lines are prefixed with &quot;~&quot; (see
examples below). Internally, this setting limits access to
the <b>unshare</b>(2), <b>clone</b>(2) and <b>setns</b>(2)
system calls, taking the specified flags parameters into
account. Note that &mdash; if this option is used &mdash; in
addition to restricting creation and switching of the
specified types of namespaces (or all of them, if true)
access to the <b>setns()</b> system call with a zero flags
parameter is prohibited. This setting is only supported on
x86, x86-64, mips, mips-le, mips64, mips64-le, mips64-n32,
mips64-le-n32, ppc64, ppc64-le, s390 and s390x, and enforces
no restrictions on other architectures. If running in user
mode, or in system mode, but without the
<b>CAP_SYS_ADMIN</b> capability (e.g. setting <i>User=</i>),
<i>NoNewPrivileges=yes</i> is implied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:
if a unit has the following,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">RestrictNamespaces=cgroup
ipc <br>
RestrictNamespaces=cgroup net</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then
<b>cgroup</b>, <b>ipc</b>, and <b>net</b> are set. If the
second line is prefixed with &quot;~&quot;, e.g.,</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">RestrictNamespaces=cgroup
ipc <br>
RestrictNamespaces=~cgroup net</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">then,
only <b>ipc</b> is set.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LockPersonality=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If set, locks down the
<b>personality</b>(2) system call so that the kernel
execution domain may not be changed from the default or the
personality selected with <i>Personality=</i> directive.
This may be useful to improve security, because odd
personality emulations may be poorly tested and source of
vulnerabilities. If running in user mode, or in system mode,
but without the <b>CAP_SYS_ADMIN</b> capability (e.g.
setting <i>User=</i>), <i>NoNewPrivileges=yes</i> is
implied.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MemoryDenyWriteExecute=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If set, attempts to create memory mappings
that are writable and executable at the same time, or to
change existing memory mappings to become executable, or
mapping shared memory segments as executable are prohibited.
Specifically, a system call filter is added that rejects
<b>mmap</b>(2) system calls with both <b>PROT_EXEC</b> and
<b>PROT_WRITE</b> set, <b>mprotect</b>(2) or
<b>pkey_mprotect</b>(2) system calls with <b>PROT_EXEC</b>
set and <b>shmat</b>(2) system calls with <b>SHM_EXEC</b>
set. Note that this option is incompatible with programs and
libraries that generate program code dynamically at runtime,
including JIT execution engines, executable stacks, and code
&quot;trampoline&quot; feature of various C compilers. This
option improves service security, as it makes harder for
software exploits to change running code dynamically.
However, the protection can be circumvented, if the service
can write to a filesystem, which is not mounted with
<b>noexec</b> (such as /dev/shm), or it can use
<b>memfd_create()</b>. This can be prevented by making such
file systems inaccessible to the service (e.g.
<i>InaccessiblePaths=/dev/shm</i>) and installing further
system call filters (<i>SystemCallFilter=~memfd_create</i>).
Note that this feature is fully available on x86-64, and
partially on x86. Specifically, the <b>shmat()</b>
protection is not available on x86. Note that on systems
supporting multiple ABIs (such as x86/x86-64) it is
recommended to turn off alternative ABIs for services, so
that they cannot be used to circumvent the restrictions of
this option. Specifically, it is recommended to combine this
option with <i>SystemCallArchitectures=native</i> or
similar. If running in user mode, or in system mode, but
without the <b>CAP_SYS_ADMIN</b> capability (e.g. setting
<i>User=</i>), <i>NoNewPrivileges=yes</i> is
implied.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RestrictRealtime=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If set, any attempts to enable realtime
scheduling in a process of the unit are refused. This
restricts access to realtime task scheduling policies such
as <b>SCHED_FIFO</b>, <b>SCHED_RR</b> or
<b>SCHED_DEADLINE</b>. See <b>sched</b>(7) for details about
these scheduling policies. If running in user mode, or in
system mode, but without the <b>CAP_SYS_ADMIN</b> capability
(e.g. setting <i>User=</i>), <i>NoNewPrivileges=yes</i> is
implied. Realtime scheduling policies may be used to
monopolize CPU time for longer periods of time, and may
hence be used to lock up or otherwise trigger
Denial-of-Service situations on the system. It is hence
recommended to restrict access to realtime scheduling to the
few programs that actually require them. Defaults to
off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RestrictSUIDSGID=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If set, any attempts to set the
set-user-ID (SUID) or set-group-ID (SGID) bits on files or
directories will be denied (for details on these bits see
<b>inode</b>(7)). If running in user mode, or in system
mode, but without the <b>CAP_SYS_ADMIN</b> capability (e.g.
setting <i>User=</i>), <i>NoNewPrivileges=yes</i> is
implied. As the SUID/SGID bits are mechanisms to elevate
privileges, and allows users to acquire the identity of
other users, it is recommended to restrict creation of
SUID/SGID files to the few programs that actually require
them. Note that this restricts marking of any type of file
system object with these bits, including both regular files
and directories (where the SGID is a different meaning than
for files, see documentation). This option is implied if
<i>DynamicUser=</i> is enabled. Defaults to off.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>RemoveIPC=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean parameter. If set, all System V and POSIX IPC
objects owned by the user and group the processes of this
unit are run as are removed when the unit is stopped. This
setting only has an effect if at least one of <i>User=</i>,
<i>Group=</i> and <i>DynamicUser=</i> are used. It has no
effect on IPC objects owned by the root user. Specifically,
this removes System V semaphores, as well as System V and
POSIX shared memory segments and message queues. If multiple
units use the same user or group the IPC objects are removed
when the last of these units is stopped. This setting is
implied if <i>DynamicUser=</i> is set.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PrivateMounts=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean parameter. If set, the processes of this unit will
be run in their own private file system (mount) namespace
with all mount propagation from the processes towards the
host's main file system namespace turned off. This means any
file system mount points established or removed by the
unit's processes will be private to them and not be visible
to the host. However, file system mount points established
or removed on the host will be propagated to the unit's
processes. See <b>mount_namespaces</b>(7) for details on
file system namespaces. Defaults to off.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
turned on, this executes three operations for each invoked
process: a new <b>CLONE_NEWNS</b> namespace is created,
after which all existing mounts are remounted to
<b>MS_SLAVE</b> to disable propagation from the unit's
processes to the host (but leaving propagation in the
opposite direction in effect). Finally, the mounts are
remounted again to the propagation mode configured with
<i>MountFlags=</i>, see below.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">File
system namespaces are set up individually for each process
forked off by the service manager. Mounts established in the
namespace of the process created by <i>ExecStartPre=</i>
will hence be cleaned up automatically as soon as that
process exits and will not be available to subsequent
processes forked off for <i>ExecStart=</i> (and similar
applies to the various other commands configured for units).
Similarly, <i>JoinsNamespaceOf=</i> does not permit sharing
kernel mount namespaces between units, it only enables
sharing of the /tmp/ and /var/tmp/ directories.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Other
file system namespace unit settings &mdash;
<i>PrivateMounts=</i>, <i>PrivateTmp=</i>,
<i>PrivateDevices=</i>, <i>ProtectSystem=</i>,
<i>ProtectHome=</i>, <i>ReadOnlyPaths=</i>,
<i>InaccessiblePaths=</i>, <i>ReadWritePaths=</i>, ...
&mdash; also enable file system namespacing in a fashion
equivalent to this option. Hence it is primarily useful to
explicitly request this behaviour if none of the other
settings are used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>MountFlags=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
mount propagation setting: <b>shared</b>, <b>slave</b> or
<b>private</b>, which controls whether file system mount
points in the file system namespaces set up for this unit's
processes will receive or propagate mounts and unmounts from
other file system namespaces. See <b>mount</b>(2) for
details on mount propagation, and the three propagation
flags in particular.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
setting only controls the <i>final</i> propagation setting
in effect on all mount points of the file system namespace
created for each process of this unit. Other file system
namespacing unit settings (see the discussion in
<i>PrivateMounts=</i> above) will implicitly disable mount
and unmount propagation from the unit's processes towards
the host by changing the propagation setting of all mount
points in the unit's file system namespace to <b>slave</b>
first. Setting this option to <b>shared</b> does not
reestablish propagation in that case.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
not set &ndash; but file system namespaces are enabled
through another file system namespace unit setting &ndash;
<b>shared</b> mount propagation is used, but &mdash; as
mentioned &mdash; as <b>slave</b> is applied first,
propagation from the unit's processes to the host is still
turned off.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is not recommended to use <b>private</b> mount propagation
for units, as this means temporary mounts (such as removable
media) of the host will stay mounted and thus indefinitely
busy in forked off processes, as unmount propagation events
won't be received by the file system namespace of the
unit.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Usually,
it is best to leave this setting unmodified, and use higher
level file system namespacing options instead, in particular
<i>PrivateMounts=</i>, see above.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>

<h2>SYSTEM CALL FILTERING
<a name="SYSTEM CALL FILTERING"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SystemCallFilter=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
space-separated list of system call names. If this setting
is used, all system calls executed by the unit processes
except for the listed ones will result in immediate process
termination with the <b>SIGSYS</b> signal (allow-listing).
(See <i>SystemCallErrorNumber=</i> below for changing the
default action). If the first character of the list is
&quot;~&quot;, the effect is inverted: only the listed
system calls will result in immediate process termination
(deny-listing). Deny-listed system calls and system call
groups may optionally be suffixed with a colon
(&quot;:&quot;) and &quot;errno&quot; error number (between
0 and 4095) or errno name such as <b>EPERM</b>,
<b>EACCES</b> or <b>EUCLEAN</b> (see <b>errno</b>(3) for a
full list). This value will be returned when a deny-listed
system call is triggered, instead of terminating the
processes immediately. Special setting &quot;kill&quot; can
be used to explicitly specify killing. This value takes
precedence over the one given in
<i>SystemCallErrorNumber=</i>, see below. If running in user
mode, or in system mode, but without the
<b>CAP_SYS_ADMIN</b> capability (e.g. setting <i>User=</i>),
<i>NoNewPrivileges=yes</i> is implied. This feature makes
use of the Secure Computing Mode 2 interfaces of the kernel
('seccomp filtering') and is useful for enforcing a minimal
sandboxing environment. Note that the <b>execve()</b>,
<b>exit()</b>, <b>exit_group()</b>, <b>getrlimit()</b>,
<b>rt_sigreturn()</b>, <b>sigreturn()</b> system calls and
the system calls for querying time and sleeping are
implicitly allow-listed and do not need to be listed
explicitly. This option may be specified more than once, in
which case the filter masks are merged. If the empty string
is assigned, the filter is reset, all prior assignments will
have no effect. This does not affect commands prefixed with
&quot;+&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that on systems supporting multiple ABIs (such as
x86/x86-64) it is recommended to turn off alternative ABIs
for services, so that they cannot be used to circumvent the
restrictions of this option. Specifically, it is recommended
to combine this option with
<i>SystemCallArchitectures=native</i> or similar.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that strict system call filters may impact execution and
error handling code paths of the service invocation.
Specifically, access to the <b>execve()</b> system call is
required for the execution of the service binary &mdash; if
it is blocked service invocation will necessarily fail.
Also, if execution of the service binary fails for some
reason (for example: missing service executable), the error
handling logic might require access to an additional set of
system calls in order to process and log this failure
correctly. It might be necessary to temporarily disable
system call filters in order to simplify debugging of such
failures.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
you specify both types of this option (i.e. allow-listing
and deny-listing), the first encountered will take
precedence and will dictate the default action (termination
or approval of a system call). Then the next occurrences of
this option will add or delete the listed system calls from
the set of the filtered system calls, depending of its type
and the default action. (For example, if you have started
with an allow list rule for <b>read()</b> and
<b>write()</b>, and right after it add a deny list rule for
<b>write()</b>, then <b>write()</b> will be removed from the
set.)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">As
the number of possible system calls is large, predefined
sets of system calls are provided. A set starts with
&quot;@&quot; character, followed by name of the
set.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;3.&nbsp;Currently
predefined system call sets</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495763.png" alt="Image grohtml-3495763.png"></b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note,
that as new system calls are added to the kernel, additional
system calls might be added to the groups above. Contents of
the sets may also change between systemd versions. In
addition, the list of system calls depends on the kernel
version and architecture for which systemd was compiled. Use
<b>systemd-analyze&nbsp;syscall-filter</b> to list the
actual list of system calls in each filter.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Generally,
allow-listing system calls (rather than deny-listing) is the
safer mode of operation. It is recommended to enforce system
call allow lists for all long-running system services.
Specifically, the following lines are a relatively safe
basic choice for the majority of system services:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">[Service]
<br>
SystemCallFilter=@system-service <br>
SystemCallErrorNumber=EPERM</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that various kernel system calls are defined redundantly:
there are multiple system calls for executing the same
operation. For example, the <b>pidfd_send_signal()</b>
system call may be used to execute operations similar to
what can be done with the older <b>kill()</b> system call,
hence blocking the latter without the former only provides
weak protection. Since new system calls are added regularly
to the kernel as development progresses, keeping system call
deny lists comprehensive requires constant work. It is thus
recommended to use allow-listing instead, which offers the
benefit that new system calls are by default implicitly
blocked until the allow list is updated.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Also
note that a number of system calls are required to be
accessible for the dynamic linker to work. The dynamic
linker is required for running most regular programs
(specifically: all dynamic ELF binaries, which is how most
distributions build packaged programs). This means that
blocking these system calls (which include <b>open()</b>,
<b>openat()</b> or <b>mmap()</b>) will make most programs
typically shipped with generic distributions
unusable.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">It
is recommended to combine the file system namespacing
related options with <i>SystemCallFilter=~@mount</i>, in
order to prohibit the unit's processes to undo the mappings.
Specifically these are the options <i>PrivateTmp=</i>,
<i>PrivateDevices=</i>, <i>ProtectSystem=</i>,
<i>ProtectHome=</i>, <i>ProtectKernelTunables=</i>,
<i>ProtectControlGroups=</i>, <i>ProtectKernelLogs=</i>,
<i>ProtectClock=</i>, <i>ReadOnlyPaths=</i>,
<i>InaccessiblePaths=</i> and
<i>ReadWritePaths=</i>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SystemCallErrorNumber=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes an
&quot;errno&quot; error number (between 1 and 4095) or errno
name such as <b>EPERM</b>, <b>EACCES</b> or <b>EUCLEAN</b>,
to return when the system call filter configured with
<i>SystemCallFilter=</i> is triggered, instead of
terminating the process immediately. See <b>errno</b>(3) for
a full list of error codes. When this setting is not used,
or when the empty string or the special setting
&quot;kill&quot; is assigned, the process will be terminated
immediately when the filter is triggered.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SystemCallArchitectures=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
space-separated list of architecture identifiers to include
in the system call filter. The known architecture
identifiers are the same as for
<i>ConditionArchitecture=</i> described in
<b>systemd.unit</b>(5), as well as <b>x32</b>,
<b>mips64-n32</b>, <b>mips64-le-n32</b>, and the special
identifier <b>native</b>. The special identifier
<b>native</b> implicitly maps to the native architecture of
the system (or more precisely: to the architecture the
system manager is compiled for). If running in user mode, or
in system mode, but without the <b>CAP_SYS_ADMIN</b>
capability (e.g. setting <i>User=</i>),
<i>NoNewPrivileges=yes</i> is implied. By default, this
option is set to the empty list, i.e. no filtering is
applied.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
this setting is used, processes of this unit will only be
permitted to call native system calls, and system calls of
the specified architectures. For the purposes of this
option, the x32 architecture is treated as including x86-64
system calls. However, this setting still fulfills its
purpose, as explained below, on x32.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">System
call filtering is not equally effective on all
architectures. For example, on x86 filtering of network
socket-related calls is not possible, due to ABI limitations
&mdash; a limitation that x86-64 does not have, however. On
systems supporting multiple ABIs at the same time &mdash;
such as x86/x86-64 &mdash; it is hence recommended to limit
the set of permitted system call architectures so that
secondary ABIs may not be used to circumvent the
restrictions applied to the native ABI of the system. In
particular, setting <i>SystemCallArchitectures=native</i> is
a good choice for disabling non-native ABIs.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">System
call architectures may also be restricted system-wide via
the <i>SystemCallArchitectures=</i> option in the global
configuration. See <b>systemd-system.conf</b>(5) for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SystemCallLog=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
space-separated list of system call names. If this setting
is used, all system calls executed by the unit processes for
the listed ones will be logged. If the first character of
the list is &quot;~&quot;, the effect is inverted: all
system calls except the listed system calls will be logged.
If running in user mode, or in system mode, but without the
<b>CAP_SYS_ADMIN</b> capability (e.g. setting <i>User=</i>),
<i>NoNewPrivileges=yes</i> is implied. This feature makes
use of the Secure Computing Mode 2 interfaces of the kernel
('seccomp filtering') and is useful for auditing or setting
up a minimal sandboxing environment. This option may be
specified more than once, in which case the filter masks are
merged. If the empty string is assigned, the filter is
reset, all prior assignments will have no effect. This does
not affect commands prefixed with &quot;+&quot;.</font></p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>Environment=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets
environment variables for executed processes. Each line is
unquoted using the rules described in &quot;Quoting&quot;
section in <b>systemd.syntax</b>(7) and becomes a list of
variable assignments. If you need to assign a value
containing spaces or the equals sign to a variable, put
quotes around the whole assignment. Variable expansion is
not performed inside the strings and the &quot;$&quot;
character has no special meaning. Specifier expansion is
performed, see the &quot;Specifiers&quot; section in
<b>systemd.unit</b>(5).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option may be specified more than once, in which case all
listed variables will be set. If the same variable is listed
twice, the later setting will override the earlier setting.
If the empty string is assigned to this option, the list of
environment variables is reset, all prior assignments have
no effect.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
names of the variables can contain ASCII letters, digits,
and the underscore character. Variable names cannot be empty
or start with a digit. In variable values, most characters
are allowed, but non-printable characters are currently
rejected.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">Environment=&quot;VAR1=word1
word2&quot; VAR2=word3 &quot;VAR3=$word 5 6&quot;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">gives
three variables &quot;VAR1&quot;, &quot;VAR2&quot;,
&quot;VAR3&quot; with the values &quot;word1 word2&quot;,
&quot;word3&quot;, &quot;$word 5 6&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">See
<b>environ</b>(7) for details about environment
variables.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that environment variables are not suitable for passing
secrets (such as passwords, key material, ...) to service
processes. Environment variables set for a unit are exposed
to unprivileged clients via D-Bus IPC, and generally not
understood as being data that requires protection. Moreover,
environment variables are propagated down the process tree,
including across security boundaries (such as setuid/setgid
executables), and hence might leak to processes that should
not have access to the secret data. Use
<i>LoadCredential=</i> (see below) to pass data to unit
processes securely.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>EnvironmentFile=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Similar
to <i>Environment=</i> but reads the environment variables
from a text file. The text file should contain
new-line-separated variable assignments. Empty lines, lines
without an &quot;=&quot; separator, or lines starting with ;
or # will be ignored, which may be used for commenting. A
line ending with a backslash will be concatenated with the
following one, allowing multiline variable definitions. The
parser strips leading and trailing whitespace from the
values of assignments, unless you use double quotes
(&quot;).</font></p>


<p style="margin-left:17%; margin-top: 1em"><b><font color="#0000FF">C
escapes</font></b>
<small><font color="#000000">[7]</font></small>
<font color="#000000">are supported, but not</font>
<b><font color="#0000FF">most control characters</font></b>
<small><font color="#000000">[8]</font></small>
<font color="#000000">. &quot;\t&quot; and &quot;\n&quot;
can be used to insert tabs and newlines within
<i>EnvironmentFile=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
argument passed should be an absolute filename or wildcard
expression, optionally prefixed with &quot;-&quot;, which
indicates that if the file does not exist, it will not be
read and no error or warning message is logged. This option
may be specified more than once in which case all specified
files are read. If the empty string is assigned to this
option, the list of file to read is reset, all prior
assignments have no effect.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
files listed with this directive will be read shortly before
the process is executed (more specifically, after all
processes from a previous unit state terminated. This means
you can generate these files in one unit state, and read it
with this option in the next. The files are read from the
file system of the service manager, before any file system
changes like bind mounts take place).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Settings
from these files override settings made with
<i>Environment=</i>. If the same variable is set twice from
these files, the files will be read in the order they are
specified and the later setting will override the earlier
setting.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>PassEnvironment=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Pass
environment variables set for the system service manager to
executed processes. Takes a space-separated list of variable
names. This option may be specified more than once, in which
case all listed variables will be passed. If the empty
string is assigned to this option, the list of environment
variables to pass is reset, all prior assignments have no
effect. Variables specified that are not set for the system
manager will not be passed and will be silently ignored.
Note that this option is only relevant for the system
service manager, as system services by default do not
automatically inherit any environment variables set for the
service manager itself. However, in case of the user service
manager all environment variables are passed to the executed
processes anyway, hence this option is without effect for
the user service manager.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Variables
set for invoked processes due to this setting are subject to
being overridden by those configured with
<i>Environment=</i> or <i>EnvironmentFile=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><b><font color="#0000FF">C
escapes</font></b>
<small><font color="#000000">[7]</font></small>
<font color="#000000">are supported, but not</font>
<b><font color="#0000FF">most control characters</font></b>
<small><font color="#000000">[8]</font></small>
<font color="#000000">. &quot;\t&quot; and &quot;\n&quot;
can be used to insert tabs and newlines within
<i>EnvironmentFile=</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Example:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">PassEnvironment=VAR1
VAR2 VAR3</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">passes
three variables &quot;VAR1&quot;, &quot;VAR2&quot;,
&quot;VAR3&quot; with the values set for those variables in
PID1.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">See
<b>environ</b>(7) for details about environment
variables.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>UnsetEnvironment=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Explicitly
unset environment variable assignments that would normally
be passed from the service manager to invoked processes of
this unit. Takes a space-separated list of variable names or
variable assignments. This option may be specified more than
once, in which case all listed variables/assignments will be
unset. If the empty string is assigned to this option, the
list of environment variables/assignments to unset is reset.
If a variable assignment is specified (that is: a variable
name, followed by &quot;=&quot;, followed by its value),
then any environment variable matching this precise
assignment is removed. If a variable name is specified (that
is a variable name without any following &quot;=&quot; or
value), then any assignment matching the variable name,
regardless of its value is removed. Note that the effect of
<i>UnsetEnvironment=</i> is applied as final step when the
environment list passed to executed processes is compiled.
That means it may undo assignments from any configuration
source, including assignments made through
<i>Environment=</i> or <i>EnvironmentFile=</i>, inherited
from the system manager's global set of environment
variables, inherited via <i>PassEnvironment=</i>, set by the
service manager itself (such as <i>$NOTIFY_SOCKET</i> and
such), or set by a PAM module (in case <i>PAMName=</i> is
used).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">See
&quot;Environment Variables in Spawned Processes&quot; below
for a description of how those settings combine to form the
inherited environment. See <b>environ</b>(7) for general
information about environment variables.</font></p>

<h2>LOGGING AND STANDARD INPUT/OUTPUT
<a name="LOGGING AND STANDARD INPUT/OUTPUT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>StandardInput=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
where file descriptor 0 (STDIN) of the executed processes is
connected to. Takes one of <b>null</b>, <b>tty</b>,
<b>tty-force</b>, <b>tty-fail</b>, <b>data</b>,
<b>file:</b><i>path</i>, <b>socket</b> or
<b>fd:</b><i>name</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
<b>null</b> is selected, standard input will be connected to
/dev/null, i.e. all read attempts by the process will result
in immediate EOF.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
<b>tty</b> is selected, standard input is connected to a TTY
(as configured by <i>TTYPath=</i>, see below) and the
executed process becomes the controlling process of the
terminal. If the terminal is already being controlled by
another process, the executed process waits until the
current controlling process releases the
terminal.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>tty-force</b>
is similar to <b>tty</b>, but the executed process is
forcefully and immediately made the controlling process of
the terminal, potentially removing previous controlling
processes from the terminal.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>tty-fail</b>
is similar to <b>tty</b>, but if the terminal already has a
controlling process start-up of the executed process
fails.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>data</b> option may be used to configure arbitrary
textual or binary data to pass via standard input to the
executed process. The data to pass is configured via
<i>StandardInputText=</i>/<i>StandardInputData=</i> (see
below). Note that the actual file descriptor type passed
(memory file, regular file, UNIX pipe, ...) might depend on
the kernel and available privileges. In any case, the file
descriptor is read-only, and when read returns the specified
data followed by EOF.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>file:</b><i>path</i> option may be used to connect a
specific file system object to standard input. An absolute
path following the &quot;:&quot; character is expected,
which may refer to a regular file, a FIFO or special file.
If an <b>AF_UNIX</b> socket in the file system is specified,
a stream socket is connected to it. The latter is useful for
connecting standard input of processes to arbitrary system
services.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>socket</b> option is valid in socket-activated services
only, and requires the relevant socket unit file (see
<b>systemd.socket</b>(5) for details) to have
<i>Accept=yes</i> set, or to specify a single socket only.
If this option is set, standard input will be connected to
the socket the service was activated from, which is
primarily useful for compatibility with daemons designed for
use with the traditional <b>inetd</b>(8) socket activation
daemon.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>fd:</b><i>name</i> option connects standard input to a
specific, named file descriptor provided by a socket unit.
The name may be specified as part of this option, following
a &quot;:&quot; character (e.g. &quot;fd:foobar&quot;). If
no name is specified, the name &quot;stdin&quot; is implied
(i.e. &quot;fd&quot; is equivalent to &quot;fd:stdin&quot;).
At least one socket unit defining the specified name must be
provided via the <i>Sockets=</i> option, and the file
descriptor name may differ from the name of its containing
socket unit. If multiple matches are found, the first one
will be used. See <i>FileDescriptorName=</i> in
<b>systemd.socket</b>(5) for more details about named file
descriptors and their ordering.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
setting defaults to <b>null</b>, unless
<i>StandardInputText=</i>/<i>StandardInputData=</i> are set,
in which case it defaults to <b>data</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>StandardOutput=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
where file descriptor 1 (stdout) of the executed processes
is connected to. Takes one of <b>inherit</b>, <b>null</b>,
<b>tty</b>, <b>journal</b>, <b>kmsg</b>,
<b>journal+console</b>, <b>kmsg+console</b>,
<b>file:</b><i>path</i>, <b>append:</b><i>path</i>,
<b>truncate:</b><i>path</i>, <b>socket</b> or
<b>fd:</b><i>name</i>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>inherit</b>
duplicates the file descriptor of standard input for
standard output.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>null</b>
connects standard output to /dev/null, i.e. everything
written to it will be lost.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>tty</b>
connects standard output to a tty (as configured via
<i>TTYPath=</i>, see below). If the TTY is used for output
only, the executed process will not become the controlling
process of the terminal, and will not fail or wait for other
processes to release the terminal.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>journal</b>
connects standard output with the journal, which is
accessible via <b>journalctl</b>(1). Note that everything
that is written to kmsg (see below) is implicitly stored in
the journal as well, the specific option listed below is
hence a superset of this one. (Also note that any external,
additional syslog daemons receive their log data from the
journal, too, hence this is the option to use when logging
shall be processed with such a daemon.)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>kmsg</b>
connects standard output with the kernel log buffer which is
accessible via <b>dmesg</b>(1), in addition to the journal.
The journal daemon might be configured to send all logs to
kmsg anyway, in which case this option is no different from
<b>journal</b>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>journal+console</b>
and <b>kmsg+console</b> work in a similar way as the two
options above but copy the output to the system console as
well.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>file:</b><i>path</i> option may be used to connect a
specific file system object to standard output. The
semantics are similar to the same option of
<i>StandardInput=</i>, see above. If <i>path</i> refers to a
regular file on the filesystem, it is opened (created if it
doesn't exist yet) for writing at the beginning of the file,
but without truncating it. If standard input and output are
directed to the same file path, it is opened only once, for
reading as well as writing and duplicated. This is
particularly useful when the specified path refers to an
<b>AF_UNIX</b> socket in the file system, as in that case
only a single stream connection is created for both input
and output.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>append:</b><i>path</i>
is similar to <b>file:</b><i>path</i> above, but it opens
the file in append mode.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>truncate:</b><i>path</i>
is similar to <b>file:</b><i>path</i> above, but it
truncates the file when opening it. For units with multiple
command lines, e.g. <i>Type=oneshot</i> services with
multiple <i>ExecStart=</i>, or services with
<i>ExecCondition=</i>, <i>ExecStartPre=</i> or
<i>ExecStartPost=</i>, the output file is reopened and
therefore re-truncated for each command line. If the output
file is truncated while another process still has the file
open, e.g. by an <i>ExecReload=</i> running concurrently
with an <i>ExecStart=</i>, and the other process continues
writing to the file without adjusting its offset, then the
space between the file pointers of the two processes may be
filled with <b>NUL</b> bytes, producing a sparse file. Thus,
<b>truncate:</b><i>path</i> is typically only useful for
units where only one process runs at a time, such as
services with a single <i>ExecStart=</i> and no
<i>ExecStartPost=</i>, <i>ExecReload=</i>, <i>ExecStop=</i>
or similar.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>socket</b>
connects standard output to a socket acquired via socket
activation. The semantics are similar to the same option of
<i>StandardInput=</i>, see above.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>fd:</b><i>name</i> option connects standard output to a
specific, named file descriptor provided by a socket unit. A
name may be specified as part of this option, following a
&quot;:&quot; character (e.g. &quot;fd:foobar&quot;). If no
name is specified, the name &quot;stdout&quot; is implied
(i.e. &quot;fd&quot; is equivalent to
&quot;fd:stdout&quot;). At least one socket unit defining
the specified name must be provided via the <i>Sockets=</i>
option, and the file descriptor name may differ from the
name of its containing socket unit. If multiple matches are
found, the first one will be used. See
<i>FileDescriptorName=</i> in <b>systemd.socket</b>(5) for
more details about named descriptors and their
ordering.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
the standard output (or error output, see below) of a unit
is connected to the journal or the kernel log buffer, the
unit will implicitly gain a dependency of type <i>After=</i>
on systemd-journald.socket (also see the &quot;Implicit
Dependencies&quot; section above). Also note that in this
case stdout (or stderr, see below) will be an <b>AF_UNIX</b>
stream socket, and not a pipe or FIFO that can be re-opened.
This means when executing shell scripts the construct
<b>echo &quot;hello&quot; &gt; /dev/stderr</b> for writing
text to stderr will not work. To mitigate this use the
construct <b>echo &quot;hello&quot; &gt;&amp;2</b> instead,
which is mostly equivalent and avoids this
pitfall.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
setting defaults to the value set with
<i>DefaultStandardOutput=</i> in
<b>systemd-system.conf</b>(5), which defaults to
<b>journal</b>. Note that setting this parameter might
result in additional dependencies to be added to the unit
(see above).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>StandardError=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
where file descriptor 2 (stderr) of the executed processes
is connected to. The available options are identical to
those of <i>StandardOutput=</i>, with some exceptions: if
set to <b>inherit</b> the file descriptor used for standard
output is duplicated for standard error, while
<b>fd:</b><i>name</i> will use a default file descriptor
name of &quot;stderr&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
setting defaults to the value set with
<i>DefaultStandardError=</i> in
<b>systemd-system.conf</b>(5), which defaults to
<b>inherit</b>. Note that setting this parameter might
result in additional dependencies to be added to the unit
(see above).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>StandardInputText=</i>,
<i>StandardInputData=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
arbitrary textual or binary data to pass via file descriptor
0 (STDIN) to the executed processes. These settings have no
effect unless <i>StandardInput=</i> is set to <b>data</b>
(which is the default if <i>StandardInput=</i> is not set
otherwise, but
<i>StandardInputText=</i>/<i>StandardInputData=</i> is). Use
this option to embed process input data directly in the unit
file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><i>StandardInputText=</i>
accepts arbitrary textual data. C-style escapes for special
characters as well as the usual &quot;%&quot;-specifiers are
resolved. Each time this setting is used the specified text
is appended to the per-unit data buffer, followed by a
newline character (thus every use appends a new line to the
end of the buffer). Note that leading and trailing
whitespace of lines configured with this option is removed.
If an empty line is specified the buffer is cleared (hence,
in order to insert an empty line, add an additional
&quot;\n&quot; to the end or beginning of a
line).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><i>StandardInputData=</i>
accepts arbitrary binary data, encoded in</font>
<b><font color="#0000FF">Base64</font></b>
<small><font color="#000000">[9]</font></small>
<font color="#000000">. No escape sequences or specifiers
are resolved. Any whitespace in the encoded version is
ignored during decoding.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that <i>StandardInputText=</i> and <i>StandardInputData=</i>
operate on the same data buffer, and may be mixed in order
to configure both binary and textual data for the same input
stream. The textual or binary data is joined strictly in the
order the settings appear in the unit file. Assigning an
empty string to either will reset the data
buffer.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
keep in mind that in order to maintain readability long unit
file settings may be split into multiple lines, by suffixing
each line (except for the last) with a &quot;\&quot;
character (see <b>systemd.unit</b>(5) for details). This is
particularly useful for large data configured with these two
options. Example:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">...
<br>
StandardInput=data <br>

StandardInputData=SWNrIHNpdHplIGRhIHVuJyBlc3NlIEtsb3BzLAp1ZmYgZWVtYWwga2xvcHAncy4KSWNrIGtpZWtl
\ <br>

LCBzdGF1bmUsIHd1bmRyZSBtaXIsCnVmZiBlZW1hbCBqZWh0IHNlIHVmZiBkaWUgVMO8ci4KTmFu
\ <br>

dSwgZGVuayBpY2ssIGljayBkZW5rIG5hbnUhCkpldHogaXNzZSB1ZmYsIGVyc2NodCB3YXIgc2Ug
\ <br>

enUhCkljayBqZWhlIHJhdXMgdW5kIGJsaWNrZSDigJQKdW5kIHdlciBzdGVodCBkcmF1w59lbj8g
\ <br>
SWNrZSEK <br>
...</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LogLevelMax=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
filtering by log level of log messages generated by this
unit. Takes a <b>syslog</b> log level, one of <b>emerg</b>
(lowest log level, only highest priority messages),
<b>alert</b>, <b>crit</b>, <b>err</b>, <b>warning</b>,
<b>notice</b>, <b>info</b>, <b>debug</b> (highest log level,
also lowest priority messages). See <b>syslog</b>(3) for
details. By default no filtering is applied (i.e. the
default maximum log level is <b>debug</b>). Use this option
to configure the logging system to drop log messages of a
specific service above the specified level. For example, set
<i>LogLevelMax=</i><b>info</b> in order to turn off debug
logging of a particularly chatty unit. Note that the
configured level is applied to any log messages written by
any of the processes belonging to this unit, as well as any
log messages written by the system manager process (PID 1)
in reference to this unit, sent via any supported logging
protocol. The filtering is applied early in the logging
pipeline, before any kind of further processing is done.
Moreover, messages which pass through this filter
successfully might still be dropped by filters applied at a
later stage in the logging subsystem. For example,
<i>MaxLevelStore=</i> configured in <b>journald.conf</b>(5)
might prohibit messages of higher log levels to be stored on
disk, even though the per-unit <i>LogLevelMax=</i> permitted
it to be processed.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LogExtraFields=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
additional log metadata fields to include in all log records
generated by processes associated with this unit. This
setting takes one or more journal field assignments in the
format &quot;FIELD=VALUE&quot; separated by whitespace. See
<b>systemd.journal-fields</b>(7) for details on the journal
field concept. Even though the underlying journal
implementation permits binary field values, this setting
accepts only valid UTF-8 values. To include space characters
in a journal field value, enclose the assignment in double
quotes (&quot;). The usual specifiers are expanded in all
assignments (see below). Note that this setting is not only
useful for attaching additional metadata to log records of a
unit, but given that all fields and values are indexed may
also be used to implement cross-unit log record matching.
Assign an empty string to reset the list.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LogRateLimitIntervalSec=</i>,
<i>LogRateLimitBurst=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
the rate limiting that is applied to messages generated by
this unit. If, in the time interval defined by
<i>LogRateLimitIntervalSec=</i>, more messages than
specified in <i>LogRateLimitBurst=</i> are logged by a
service, all further messages within the interval are
dropped until the interval is over. A message about the
number of dropped messages is generated. The time
specification for <i>LogRateLimitIntervalSec=</i> may be
specified in the following units: &quot;s&quot;,
&quot;min&quot;, &quot;h&quot;, &quot;ms&quot;,
&quot;us&quot; (see <b>systemd.time</b>(7) for details). The
default settings are set by <i>RateLimitIntervalSec=</i> and
<i>RateLimitBurst=</i> configured in
<b>journald.conf</b>(5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LogNamespace=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Run the
unit's processes in the specified journal namespace. Expects
a short user-defined string identifying the namespace. If
not used the processes of the service are run in the default
journal namespace, i.e. their log stream is collected and
processed by systemd-journald.service. If this option is
used any log data generated by processes of this unit
(regardless if via the <b>syslog()</b>, journal native
logging or stdout/stderr logging) is collected and processed
by an instance of the systemd-journald@.service template
unit, which manages the specified namespace. The log data is
stored in a data store independent from the default log
namespace's data store. See
<b>systemd-journald.service</b>(8) for details about journal
namespaces.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Internally,
journal namespaces are implemented through Linux mount
namespacing and over-mounting the directory that contains
the relevant <b>AF_UNIX</b> sockets used for logging in the
unit's mount namespace. Since mount namespaces are used this
setting disconnects propagation of mounts from the unit's
processes to the host, similar to how <i>ReadOnlyPaths=</i>
and similar settings (see above) work. Journal namespaces
may hence not be used for services that need to establish
mount points on the host.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
this option is used the unit will automatically gain
ordering and requirement dependencies on the two socket
units associated with the systemd-journald@.service instance
so that they are automatically established prior to the unit
starting up. Note that when this option is used log output
of this service does not appear in the regular
<b>journalctl</b>(1) output, unless the <b>--namespace=</b>
option is used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option is only available for system services and is not
supported for services running in per-user instances of the
service manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SyslogIdentifier=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
process name (&quot;<b>syslog</b> tag&quot;) to prefix log
lines sent to the logging system or the kernel log buffer
with. If not set, defaults to the process name of the
executed process. This option is only useful when
<i>StandardOutput=</i> or <i>StandardError=</i> are set to
<b>journal</b> or <b>kmsg</b> (or to the same settings in
combination with <b>+console</b>) and only applies to log
messages written to stdout or stderr.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SyslogFacility=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
<b>syslog</b> facility identifier to use when logging. One
of <b>kern</b>, <b>user</b>, <b>mail</b>, <b>daemon</b>,
<b>auth</b>, <b>syslog</b>, <b>lpr</b>, <b>news</b>,
<b>uucp</b>, <b>cron</b>, <b>authpriv</b>, <b>ftp</b>,
<b>local0</b>, <b>local1</b>, <b>local2</b>, <b>local3</b>,
<b>local4</b>, <b>local5</b>, <b>local6</b> or
<b>local7</b>. See <b>syslog</b>(3) for details. This option
is only useful when <i>StandardOutput=</i> or
<i>StandardError=</i> are set to <b>journal</b> or
<b>kmsg</b> (or to the same settings in combination with
<b>+console</b>), and only applies to log messages written
to stdout or stderr. Defaults to <b>daemon</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SyslogLevel=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
default <b>syslog</b> log level to use when logging to the
logging system or the kernel log buffer. One of
<b>emerg</b>, <b>alert</b>, <b>crit</b>, <b>err</b>,
<b>warning</b>, <b>notice</b>, <b>info</b>, <b>debug</b>.
See <b>syslog</b>(3) for details. This option is only useful
when <i>StandardOutput=</i> or <i>StandardError=</i> are set
to <b>journal</b> or <b>kmsg</b> (or to the same settings in
combination with <b>+console</b>), and only applies to log
messages written to stdout or stderr. Note that individual
lines output by executed processes may be prefixed with a
different log level which can be used to override the
default log level specified here. The interpretation of
these prefixes may be disabled with
<i>SyslogLevelPrefix=</i>, see below. For details, see
<b>sd-daemon</b>(3). Defaults to <b>info</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SyslogLevelPrefix=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
boolean argument. If true and <i>StandardOutput=</i> or
<i>StandardError=</i> are set to <b>journal</b> or
<b>kmsg</b> (or to the same settings in combination with
<b>+console</b>), log lines written by the executed process
that are prefixed with a log level will be processed with
this log level set but the prefix removed. If set to false,
the interpretation of these prefixes is disabled and the
logged lines are passed on as-is. This only applies to log
messages written to stdout or stderr. For details about this
prefixing see <b>sd-daemon</b>(3). Defaults to
true.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TTYPath=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
terminal device node to use if standard input, output, or
error are connected to a TTY (see above). Defaults to
/dev/console.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TTYReset=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Reset the
terminal device specified with <i>TTYPath=</i> before and
after execution. Defaults to &quot;no&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TTYVHangup=</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Disconnect
all clients which have opened the terminal device specified
with <i>TTYPath=</i> before and after execution. Defaults to
&quot;no&quot;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>TTYVTDisallocate=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">If the
terminal device specified with <i>TTYPath=</i> is a virtual
console terminal, try to deallocate the TTY before and after
execution. This ensures that the screen and scrollback
buffer is cleared. Defaults to &quot;no&quot;.</font></p>

<h2>CREDENTIALS
<a name="CREDENTIALS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>LoadCredential=ID</i>[:<i>PATH</i>]</font></p>

<p style="margin-left:17%;"><font color="#000000">Pass a
credential to the unit. Credentials are limited-size binary
or textual objects that may be passed to unit processes.
They are primarily used for passing cryptographic keys (both
public and private) or certificates, user account
information or identity information from host to services.
The data is accessible from the unit's processes via the
file system, at a read-only location that (if possible and
permitted) is backed by non-swappable memory. The data is
only accessible to the user associated with the unit, via
the <i>User=</i>/<i>DynamicUser=</i> settings (as well as
the superuser). When available, the location of credentials
is exported as the <i>$CREDENTIALS_DIRECTORY</i> environment
variable to the unit's processes.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<i>LoadCredential=</i> setting takes a textual ID to use as
name for a credential plus a file system path, separated by
a colon. The ID must be a short ASCII string suitable as
filename in the filesystem, and may be chosen freely by the
user. If the specified path is absolute it is opened as
regular file and the credential data is read from it. If the
absolute path refers to an <b>AF_UNIX</b> stream socket in
the file system a connection is made to it (only once at
unit start-up) and the credential data read from the
connection, providing an easy IPC integration point for
dynamically providing credentials from other services. If
the specified path is not absolute and itself qualifies as
valid credential identifier it is understood to refer to a
credential that the service manager itself received via the
<i>$CREDENTIALS_DIRECTORY</i> environment variable, which
may be used to propagate credentials from an invoking
environment (e.g. a container manager that invoked the
service manager) into a service. The contents of the
file/socket may be arbitrary binary or textual data,
including newline characters and <b>NUL</b> bytes. If the
file system path is omitted it is chosen identical to the
credential name, i.e. this is a terse way do declare
credentials to inherit from the service manager into a
service. This option may be used multiple times, each time
defining an additional credential to pass to the
unit.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
credential files/IPC sockets must be accessible to the
service manager, but don't have to be directly accessible to
the unit's processes: the credential data is read and copied
into separate, read-only copies for the unit that are
accessible to appropriately privileged processes. This is
particularly useful in combination with <i>DynamicUser=</i>
as this way privileged data can be made available to
processes running under a dynamic UID (i.e. not a previously
known one) without having to open up access to all
users.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">In
order to reference the path a credential may be read from
within a <i>ExecStart=</i> command line use
&quot;${CREDENTIALS_DIRECTORY}/mycred&quot;, e.g.
&quot;ExecStart=cat
${CREDENTIALS_DIRECTORY}/mycred&quot;.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Currently,
an accumulated credential size limit of 1 MB per unit is
enforced.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
referencing an <b>AF_UNIX</b> stream socket to connect to,
the connection will originate from an abstract namespace
socket, that includes information about the unit and the
credential ID in its socket name. Use <b>getpeername</b>(2)
to query this information. The returned socket name is
formatted as <b>NUL</b> <i>RANDOM</i> &quot;/unit/&quot;
<i>UNIT</i> &quot;/&quot; <i>ID</i>, i.e. a <b>NUL</b> byte
(as required for abstract namespace socket names), followed
by a random string (consisting of alphadecimal characters),
followed by the literal string &quot;/unit/&quot;, followed
by the requesting unit name, followed by the literal
character &quot;/&quot;, followed by the textual credential
ID requested. Example:
&quot;\0adf9d86b6eda275e/unit/foobar.service/credx&quot; in
case the credential &quot;credx&quot; is requested for a
unit &quot;foobar.service&quot;. This functionality is
useful for using a single listening socket to serve
credentials to multiple consumers.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>SetCredential=ID</i>:<i>VALUE</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
<i>SetCredential=</i> setting is similar to
<i>LoadCredential=</i> but accepts a literal value to use as
data for the credential, instead of a file system path to
read the data from. Do not use this option for data that is
supposed to be secret, as it is accessible to unprivileged
processes via IPC. It's only safe to use this for user IDs,
public key material and similar non-sensitive data. For
everything else use <i>LoadCredential=</i>. In order to
embed binary data into the credential data use C-style
escaping (i.e. &quot;\n&quot; to embed a newline, or
&quot;\x00&quot; to embed a <b>NUL</b> byte).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
a credential of the same ID is listed in both
<i>LoadCredential=</i> and <i>SetCredential=</i>, the latter
will act as default if the former cannot be retrieved. In
this case not being able to retrieve the credential from the
path specified in <i>LoadCredential=</i> is not considered
fatal.</font></p>

<h2>SYSTEM V COMPATIBILITY
<a name="SYSTEM V COMPATIBILITY"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>UtmpIdentifier=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
four character identifier string for an <b>utmp</b>(5) and
wtmp entry for this service. This should only be set for
services such as <b>getty</b> implementations (such as
<b>agetty</b>(8)) where utmp/wtmp entries must be created
and cleared before and after execution, or for services that
shall be executed as if they were run by a <b>getty</b>
process (see below). If the configured string is longer than
four characters, it is truncated and the terminal four
characters are used. This setting interprets %I style string
replacements. This setting is unset by default, i.e. no
utmp/wtmp entries are created or cleaned up for this
service.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>UtmpMode=</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Takes one
of &quot;init&quot;, &quot;login&quot; or &quot;user&quot;.
If <i>UtmpIdentifier=</i> is set, controls which type of
<b>utmp</b>(5)/wtmp entries for this service are generated.
This setting has no effect unless <i>UtmpIdentifier=</i> is
set too. If &quot;init&quot; is set, only an
<b>INIT_PROCESS</b> entry is generated and the invoked
process must implement a <b>getty</b>-compatible utmp/wtmp
logic. If &quot;login&quot; is set, first an
<b>INIT_PROCESS</b> entry, followed by a
<b>LOGIN_PROCESS</b> entry is generated. In this case, the
invoked process must implement a <b>login</b>(1)-compatible
utmp/wtmp logic. If &quot;user&quot; is set, first an
<b>INIT_PROCESS</b> entry, then a <b>LOGIN_PROCESS</b> entry
and finally a <b>USER_PROCESS</b> entry is generated. In
this case, the invoked process may be any process that is
suitable to be run as session leader. Defaults to
&quot;init&quot;.</font></p>

<h2>ENVIRONMENT VARIABLES IN SPAWNED PROCESSES
<a name="ENVIRONMENT VARIABLES IN SPAWNED PROCESSES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Processes
started by the service manager are executed with an
environment variable block assembled from multiple sources.
Processes started by the system service manager generally do
not inherit environment variables set for the service
manager itself (but this may be altered via
<i>PassEnvironment=</i>), but processes started by the user
service manager instances generally do inherit all
environment variables set for the service manager
itself.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
each invoked process the list of environment variables set
is compiled from the following sources:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables globally configured for the service manager, using
the <i>DefaultEnvironment=</i> setting in
<b>systemd-system.conf</b>(5), the kernel command line
option <i>systemd.setenv=</i> understood by
<b>systemd</b>(1), or via <b>systemctl</b>(1)
<b>set-environment</b> verb.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables defined by the service manager itself (see the
list below).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables set in the service manager's own environment
variable block (subject to <i>PassEnvironment=</i> for the
system service manager).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables set via <i>Environment=</i> in the unit
file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables read from files specified via
<i>EnvironmentFile=</i> in the unit file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
Variables set by any PAM modules in case <i>PAMName=</i> is
in effect, cf.&nbsp;<b>pam_env</b>(8).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">If
the same environment variable is set by multiple of these
sources, the later source &mdash; according to the order of
the list above &mdash; wins. Note that as the final step all
variables listed in <i>UnsetEnvironment=</i> are removed
from the compiled environment variable list, immediately
before it is passed to the executed process.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
general philosophy is to expose a small curated list of
environment variables to processes. Services started by the
system manager (PID 1) will be started, without additional
service-specific configuration, with just a few environment
variables. The user manager inherits environment variables
as any other system service, but in addition may receive
additional environment variables from PAM, and, typically,
additional imported variables when the user starts a
graphical session. It is recommended to keep the environment
blocks in both the system and user managers managers lean.
Importing all variables inherited by the graphical session
or by one of the user shells is strongly
discouraged.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Hint:
<b>systemd-run -P env</b> and <b>systemd-run --user -P
env</b> print the effective system and user service
environment blocks.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Environment
Variables Set or Propagated by the Service Manager</b> <br>
The following environment variables are propagated by the
service manager or generated internally for each invoked
process:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$PATH</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Colon-separated
list of directories to use when launching executables.
<b>systemd</b> uses a fixed value of
&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin&quot;
in the system manager. When compiled for systems with
&quot;unmerged /usr/&quot; (/bin is not a symlink to
/usr/bin), &quot;:/sbin:/bin&quot; is appended. In case of
the user manager, a different path may be configured by the
distribution. It is recommended to not rely on the order of
entries, and have only one program with a given name in
<i>$PATH</i>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$LANG</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Locale.
Can be set in <b>locale.conf</b>(5) or on the kernel command
line (see <b>systemd</b>(1) and
<b>kernel-command-line</b>(7)).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$USER</i>,
<i>$LOGNAME</i>, <i>$HOME</i>, <i>$SHELL</i></font></p>

<p style="margin-left:17%;"><font color="#000000">User name
(twice), home directory, and the login shell. The variables
are set for the units that have <i>User=</i> set, which
includes user <b>systemd</b> instances. See
<b>passwd</b>(5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$INVOCATION_ID</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Contains
a randomized, unique 128bit ID identifying each runtime
cycle of the unit, formatted as 32 character hexadecimal
string. A new ID is assigned each time the unit changes from
an inactive state into an activating or active state, and
may be used to identify this specific runtime cycle, in
particular in data stored offline, such as the journal. The
same ID is passed to all processes run as part of the
unit.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$XDG_RUNTIME_DIR</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
directory to use for runtime objects (such as IPC objects)
and volatile state. Set for all services run by the user
<b>systemd</b> instance, as well as any system services that
use <i>PAMName=</i> with a PAM stack that includes
<b>pam_systemd</b>. See below and <b>pam_systemd</b>(8) for
more information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$RUNTIME_DIRECTORY</i>,
<i>$STATE_DIRECTORY</i>, <i>$CACHE_DIRECTORY</i>,
<i>$LOGS_DIRECTORY</i>,
<i>$CONFIGURATION_DIRECTORY</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Absolute
paths to the directories defined with
<i>RuntimeDirectory=</i>, <i>StateDirectory=</i>,
<i>CacheDirectory=</i>, <i>LogsDirectory=</i>, and
<i>ConfigurationDirectory=</i> when those settings are
used.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$CREDENTIALS_DIRECTORY</i></font></p>

<p style="margin-left:17%;"><font color="#000000">An
absolute path to the per-unit directory with credentials
configured via <i>LoadCredential=</i>/<i>SetCredential=</i>.
The directory is marked read-only and is placed in
unswappable memory (if supported and permitted), and is only
accessible to the UID associated with the unit via
<i>User=</i> or <i>DynamicUser=</i> (and the
superuser).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$MAINPID</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The PID
of the unit's main process if it is known. This is only set
for control processes as invoked by <i>ExecReload=</i> and
similar.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$MANAGERPID</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The PID
of the user <b>systemd</b> instance, set for processes
spawned by it.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$LISTEN_FDS</i>,
<i>$LISTEN_PID</i>, <i>$LISTEN_FDNAMES</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Information
about file descriptors passed to a service for socket
activation. See <b>sd_listen_fds</b>(3).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$NOTIFY_SOCKET</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The
socket <b>sd_notify()</b> talks to. See
<b>sd_notify</b>(3).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$WATCHDOG_PID</i>,
<i>$WATCHDOG_USEC</i></font></p>


<p style="margin-left:17%;"><font color="#000000">Information
about watchdog keep-alive notifications. See
<b>sd_watchdog_enabled</b>(3).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$SYSTEMD_EXEC_PID</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The PID
of the unit process (e.g. process invoked by
<i>ExecStart=</i>). The child process can use this
information to determine whether the process is directly
invoked by the service manager or indirectly as a child of
another process by comparing this value with the current PID
(as similar to the scheme used in <b>sd_listen_fds</b>(3)
with <i>$LISTEN_PID</i> and <i>$LISTEN_FDS</i>).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$TERM</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Terminal
type, set only for units connected to a terminal
(<i>StandardInput=tty</i>, <i>StandardOutput=tty</i>, or
<i>StandardError=tty</i>). See <b>termcap</b>(5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$LOG_NAMESPACE</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Contains
the name of the selected logging namespace when the
<i>LogNamespace=</i> service setting is used.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$JOURNAL_STREAM</i></font></p>

<p style="margin-left:17%;"><font color="#000000">If the
standard output or standard error output of the executed
processes are connected to the journal (for example, by
setting <i>StandardError=journal</i>) <i>$JOURNAL_STREAM</i>
contains the device and inode numbers of the connection file
descriptor, formatted in decimal, separated by a colon
(&quot;:&quot;). This permits invoked processes to safely
detect whether their standard output or standard error
output are connected to the journal. The device and inode
numbers of the file descriptors should be compared with the
values set in the environment variable to determine whether
the process output is still connected to the journal. Note
that it is generally not sufficient to only check whether
<i>$JOURNAL_STREAM</i> is set at all as services might
invoke external processes replacing their standard output or
standard error output, without unsetting the environment
variable.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
both standard output and standard error of the executed
processes are connected to the journal via a stream socket,
this environment variable will contain information about the
standard error stream, as that's usually the preferred
destination for log data. (Note that typically the same
stream is used for both standard output and standard error,
hence very likely the environment variable contains device
and inode information matching both stream file
descriptors.)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
environment variable is primarily useful to allow services
to optionally upgrade their used log protocol to the native
journal protocol (using <b>sd_journal_print</b>(3) and other
functions) if their standard output or standard error output
is connected to the journal anyway, thus enabling delivery
of structured metadata along with logged
messages.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$SERVICE_RESULT</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Only
defined for the service unit type, this environment variable
is passed to all <i>ExecStop=</i> and <i>ExecStopPost=</i>
processes, and encodes the service &quot;result&quot;.
Currently, the following values are defined:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;4.&nbsp;Defined</b>
<i>$SERVICE_RESULT</i> values</font></p>


<p align="center"><font color="#000000"><img src="grohtml-3495764.png" alt="Image grohtml-3495764.png"></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
environment variable is useful to monitor failure or
successful termination of a service. Even though this
variable is available in both <i>ExecStop=</i> and
<i>ExecStopPost=</i>, it is usually a better choice to place
monitoring tools in the latter, as the former is only
invoked for services that managed to start up correctly, and
the latter covers both services that failed during their
start-up and those which failed during their
runtime.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$EXIT_CODE</i>,
<i>$EXIT_STATUS</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Only
defined for the service unit type, these environment
variables are passed to all <i>ExecStop=</i>,
<i>ExecStopPost=</i> processes and contain exit status/code
information of the main process of the service. For the
precise definition of the exit code and status, see
<b>wait</b>(2). <i>$EXIT_CODE</i> is one of
&quot;exited&quot;, &quot;killed&quot;, &quot;dumped&quot;.
<i>$EXIT_STATUS</i> contains the numeric exit code formatted
as string if <i>$EXIT_CODE</i> is &quot;exited&quot;, and
the signal name in all other cases. Note that these
environment variables are only set if the service manager
succeeded to start and identify the main process of the
service.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;5.&nbsp;Summary
of possible service result variable values</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495765.png" alt="Image grohtml-3495765.png"></b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><i>$PIDFILE</i></font></p>

<p style="margin-left:17%;"><font color="#000000">The path
to the configured PID file, in case the process is forked
off on behalf of a service that uses the <i>PIDFile=</i>
setting, see <b>systemd.service</b>(5) for details. Service
code may use this environment variable to automatically
generate a PID file at the location configured in the unit
file. This field is set to an absolute path in the file
system.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
system services, when <i>PAMName=</i> is enabled and
<b>pam_systemd</b> is part of the selected PAM stack,
additional environment variables defined by systemd may be
set for services. Specifically, these are <i>$XDG_SEAT</i>,
<i>$XDG_VTNR</i>, see <b>pam_systemd</b>(8) for
details.</font></p>

<h2>PROCESS EXIT CODES
<a name="PROCESS EXIT CODES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">When
invoking a unit process the service manager possibly fails
to apply the execution parameters configured with the
settings above. In that case the already created service
process will exit with a non-zero exit code before the
configured command line is executed. (Or in other words, the
child process possibly exits with these error codes, after
having been created by the <b>fork</b>(2) system call, but
before the matching <b>execve</b>(2) system call is called.)
Specifically, exit codes defined by the C library, by the
LSB specification and by the systemd service manager itself
are used.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following basic service exit codes are defined by the C
library.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;6.&nbsp;Basic
C library exit codes</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495766.png" alt="Image grohtml-3495766.png"></b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following service exit codes are defined by the</font>
<b><font color="#0000FF">LSB specification</font></b>
<small><font color="#000000">[10]</font></small>
<font color="#000000">.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;7.&nbsp;LSB
service exit codes</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495767.png" alt="Image grohtml-3495767.png"></b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
LSB specification suggests that error codes 200 and above
are reserved for implementations. Some of them are used by
the service manager to indicate problems during process
invocation:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;8.&nbsp;systemd-specific
exit codes</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495768.png" alt="Image grohtml-3495768.png"></b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Finally,
the BSD operating systems define a set of exit codes,
typically defined on Linux systems too:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Table&nbsp;9.&nbsp;BSD
exit codes</b></font></p>


<p align="center"><font color="#000000"><b><img src="grohtml-3495769.png" alt="Image grohtml-3495769.png"></b></font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>systemd</b>(1),
<b>systemctl</b>(1), <b>systemd-analyze</b>(1),
<b>journalctl</b>(1), <b>systemd-system.conf</b>(5),
<b>systemd.unit</b>(5), <b>systemd.service</b>(5),
<b>systemd.socket</b>(5), <b>systemd.swap</b>(5),
<b>systemd.mount</b>(5), <b>systemd.kill</b>(5),
<b>systemd.resource-control</b>(5), <b>systemd.time</b>(7),
<b>systemd.directives</b>(7), <b>tmpfiles.d</b>(5),
<b>exec</b>(3), <b>fork</b>(2)</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="57%">



<p style="margin-top: 1em"><font color="#000000">Discoverable
Partitions Specification</font></p></td>
<td width="26%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://systemd.io/DISCOVERABLE_PARTITIONS</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">2.</font></p> </td>
<td width="2%"></td>
<td width="31%">


<p style="margin-top: 1em"><font color="#000000">The /proc
Filesystem</font></p> </td>
<td width="52%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://www.kernel.org/doc/html/latest/filesystems/proc.html#mount-options</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">3.</font></p> </td>
<td width="2%"></td>
<td width="34%">



<p style="margin-top: 1em"><font color="#000000">User/Group
Name Syntax</font></p></td>
<td width="49%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://systemd.io/USER_NAMES</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">4.</font></p> </td>
<td width="2%"></td>
<td width="34%">


<p style="margin-top: 1em"><font color="#000000">No New
Privileges Flag</font></p></td>
<td width="49%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://www.kernel.org/doc/html/latest/userspace-api/no_new_privs.html</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">5.</font></p> </td>
<td width="2%"></td>
<td width="25%">


<p style="margin-top: 1em"><font color="#000000">JSON User
Record</font></p> </td>
<td width="58%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://systemd.io/USER_RECORD</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">6.</font></p> </td>
<td width="2%"></td>
<td width="12%">



<p style="margin-top: 1em"><font color="#000000">proc.txt</font></p> </td>
<td width="71%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://www.kernel.org/doc/Documentation/filesystems/proc.txt</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">7.</font></p> </td>
<td width="2%"></td>
<td width="14%">


<p style="margin-top: 1em"><font color="#000000">C
escapes</font></p> </td>
<td width="69%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://en.wikipedia.org/wiki/Escape_sequences_in_C#Table_of_escape_sequences</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">8.</font></p> </td>
<td width="2%"></td>
<td width="35%">


<p style="margin-top: 1em"><font color="#000000">most
control characters</font></p></td>
<td width="48%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://en.wikipedia.org/wiki/Control_character#In_ASCII</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">9.</font></p> </td>
<td width="2%"></td>
<td width="9%">



<p style="margin-top: 1em"><font color="#000000">Base64</font></p> </td>
<td width="74%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://tools.ietf.org/html/rfc2045#section-6.8</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">



<p style="margin-top: 1em"><font color="#000000">10.</font></p> </td>
<td width="2%"></td>
<td width="26%">


<p style="margin-top: 1em"><font color="#000000">LSB
specification</font></p> </td>
<td width="57%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://refspecs.linuxbase.org/LSB_5.0.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html</font></p>
<hr>
</body>
</html>
