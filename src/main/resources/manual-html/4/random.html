<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:38:39 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>RANDOM</title>

</head>
<body>

<h1 align="center">RANDOM</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#FILES">FILES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COLOPHON">COLOPHON</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">random, urandom
- kernel random number source devices</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">#include
&lt;linux/random.h&gt;</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
ioctl(</b><i>fd</i><b>, RND</b><i>request</i><b>,</b>
<i>param</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The character
special files <i>/dev/random</i> and <i>/dev/urandom</i>
(present since Linux 1.3.30) provide an interface to the
kernel&rsquo;s random number generator. The file
<i>/dev/random</i> has major device number 1 and minor
device number 8. The file <i>/dev/urandom</i> has major
device number 1 and minor device number 9.</p>

<p style="margin-left:11%; margin-top: 1em">The random
number generator gathers environmental noise from device
drivers and other sources into an entropy pool. The
generator also keeps an estimate of the number of bits of
noise in the entropy pool. From this entropy pool, random
numbers are created.</p>

<p style="margin-left:11%; margin-top: 1em">Linux 3.17 and
later provides the simpler and safer <a href="https://man.page/2/getrandom">getrandom(2)</a>
interface which requires no special files; see the
<a href="https://man.page/2/getrandom">getrandom(2)</a> manual page for details.</p>

<p style="margin-left:11%; margin-top: 1em">When read, the
<i>/dev/urandom</i> device returns random bytes using a
pseudorandom number generator seeded from the entropy pool.
Reads from this device do not block (i.e., the CPU is not
yielded), but can incur an appreciable delay when requesting
large amounts of data.</p>

<p style="margin-left:11%; margin-top: 1em">When read
during early boot time, <i>/dev/urandom</i> may return data
prior to the entropy pool being initialized. If this is of
concern in your application, use <a href="https://man.page/2/getrandom">getrandom(2)</a> or
<i>/dev/random</i> instead.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>/dev/random</i> device is a legacy interface which dates
back to a time where the cryptographic primitives used in
the implementation of <i>/dev/urandom</i> were not widely
trusted. It will return random bytes only within the
estimated number of bits of fresh noise in the entropy pool,
blocking if necessary. <i>/dev/random</i> is suitable for
applications that need high quality randomness, and can
afford indeterminate delays.</p>

<p style="margin-left:11%; margin-top: 1em">When the
entropy pool is empty, reads from <i>/dev/random</i> will
block until additional environmental noise is gathered. If
<a href="https://man.page/2/open">open(2)</a> is called for <i>/dev/random</i> with the
<b>O_NONBLOCK</b> flag, a subsequent <a href="https://man.page/2/read">read(2)</a> will not
block if the requested number of bytes is not available.
Instead, the available bytes are returned. If no byte is
available, <a href="https://man.page/2/read">read(2)</a> will return -1 and <i>errno</i>
will be set to <b>EAGAIN</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>O_NONBLOCK</b> flag has no effect when opening
<i>/dev/urandom</i>. When calling <a href="https://man.page/2/read">read(2)</a> for the
device <i>/dev/urandom</i>, reads of up to 256 bytes will
return as many bytes as are requested and will not be
interrupted by a signal handler. Reads with a buffer over
this limit may return less than the requested number of
bytes or fail with the error <b>EINTR</b>, if interrupted by
a signal handler.</p>

<p style="margin-left:11%; margin-top: 1em">Since Linux
3.16, a <a href="https://man.page/2/read">read(2)</a> from <i>/dev/urandom</i> will return
at most 32&nbsp;MB. A <a href="https://man.page/2/read">read(2)</a> from <i>/dev/random</i>
will return at most 512 bytes (340 bytes on Linux kernels
before version 2.6.12).</p>

<p style="margin-left:11%; margin-top: 1em">Writing to
<i>/dev/random</i> or <i>/dev/urandom</i> will update the
entropy pool with the data written, but this will not result
in a higher entropy count. This means that it will impact
the contents read from both files, but it will not make
reads from <i>/dev/random</i> faster.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Usage</b>
<br>
The <i>/dev/random</i> interface is considered a legacy
interface, and <i>/dev/urandom</i> is preferred and
sufficient in all use cases, with the exception of
applications which require randomness during early boot
time; for these applications, <a href="https://man.page/2/getrandom">getrandom(2)</a> must be
used instead, because it will block until the entropy pool
is initialized.</p>

<p style="margin-left:11%; margin-top: 1em">If a seed file
is saved across reboots as recommended below, the output is
cryptographically secure against attackers without local
root access as soon as it is reloaded in the boot sequence,
and perfectly adequate for network encryption session keys.
(All major Linux distributions have saved the seed file
across reboots since 2000 at least.) Since reads from
<i>/dev/random</i> may block, users will usually want to
open it in nonblocking mode (or perform a read with
timeout), and provide some sort of user notification if the
desired entropy is not immediately available.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Configuration</b>
<br>
If your system does not have <i>/dev/random</i> and
<i>/dev/urandom</i> created already, they can be created
with the following commands:</p>

<p style="margin-left:17%; margin-top: 1em">mknod -m 666
/dev/random c 1 8 <br>
mknod -m 666 /dev/urandom c 1 9 <br>
chown root:root /dev/random /dev/urandom</p>

<p style="margin-left:11%; margin-top: 1em">When a Linux
system starts up without much operator interaction, the
entropy pool may be in a fairly predictable state. This
reduces the actual amount of noise in the entropy pool below
the estimate. In order to counteract this effect, it helps
to carry entropy pool information across shut-downs and
start-ups. To do this, add the lines to an appropriate
script which is run during the Linux system start-up
sequence:</p>

<p style="margin-left:17%; margin-top: 1em">echo
&quot;Initializing random number generator...&quot; <br>
random_seed=/var/run/random-seed <br>
# Carry a random seed from start-up to start-up <br>
# Load and then save the whole entropy pool <br>
if [ -f $random_seed ]; then <br>
cat $random_seed &gt;/dev/urandom <br>
else <br>
touch $random_seed <br>
fi <br>
chmod 600 $random_seed <br>
poolfile=/proc/sys/kernel/random/poolsize <br>
[ -r $poolfile ] &amp;&amp; bits=$(cat $poolfile) ||
bits=4096 <br>
bytes=$(expr $bits / 8) <br>
dd if=/dev/urandom of=$random_seed count=1 bs=$bytes</p>

<p style="margin-left:11%; margin-top: 1em">Also, add the
following lines in an appropriate script which is run during
the Linux system shutdown:</p>

<p style="margin-left:17%; margin-top: 1em"># Carry a
random seed from shut-down to start-up <br>
# Save the whole entropy pool <br>
echo &quot;Saving random seed...&quot; <br>
random_seed=/var/run/random-seed <br>
touch $random_seed <br>
chmod 600 $random_seed <br>
poolfile=/proc/sys/kernel/random/poolsize <br>
[ -r $poolfile ] &amp;&amp; bits=$(cat $poolfile) ||
bits=4096 <br>
bytes=$(expr $bits / 8) <br>
dd if=/dev/urandom of=$random_seed count=1 bs=$bytes</p>

<p style="margin-left:11%; margin-top: 1em">In the above
examples, we assume Linux 2.6.0 or later, where
<i>/proc/sys/kernel/random/poolsize</i> returns the size of
the entropy pool in bits (see below).</p>

<p style="margin-left:11%; margin-top: 1em"><b>/proc
interfaces</b> <br>
The files in the directory <i>/proc/sys/kernel/random</i>
(present since 2.3.16) provide additional information about
the <i>/dev/random</i> device: <i><br>
entropy_avail</i></p>

<p style="margin-left:22%;">This read-only file gives the
available entropy, in bits. This will be a number in the
range 0 to 4096.</p>

<p style="margin-left:11%;"><i>poolsize</i></p>

<p style="margin-left:22%;">This file gives the size of the
entropy pool. The semantics of this file vary across kernel
versions: <br>
Linux 2.4:</p>

<p style="margin-left:32%;">This file gives the size of the
entropy pool in <i>bytes</i>. Normally, this file will have
the value 512, but it is writable, and can be changed to any
value for which an algorithm is available. The choices are
32, 64, 128, 256, 512, 1024, or 2048.</p>

<p style="margin-left:22%;">Linux 2.6 and later:</p>

<p style="margin-left:32%;">This file is read-only, and
gives the size of the entropy pool in <i>bits</i>. It
contains the value 4096.</p>


<p style="margin-left:11%;"><i>read_wakeup_threshold</i></p>

<p style="margin-left:22%;">This file contains the number
of bits of entropy required for waking up processes that
sleep waiting for entropy from <i>/dev/random</i>. The
default is 64.</p>


<p style="margin-left:11%;"><i>write_wakeup_threshold</i></p>

<p style="margin-left:22%;">This file contains the number
of bits of entropy below which we wake up processes that do
a <a href="https://man.page/2/select">select(2)</a> or <a href="https://man.page/2/poll">poll(2)</a> for write access to
<i>/dev/random</i>. These values can be changed by writing
to the files.</p>

<p style="margin-left:11%;"><i>uuid</i> and
<i>boot_id</i></p>

<p style="margin-left:22%;">These read-only files contain
random strings like 6fd5a44b-35f4-4ad4-a9b9-6b9be13e1fe9.
The former is generated afresh for each read, the latter was
generated once.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ioctl(2)
interface</b> <br>
The following <a href="https://man.page/2/ioctl">ioctl(2)</a> requests are defined on file
descriptors connected to either <i>/dev/random</i> or
<i>/dev/urandom</i>. All requests performed will interact
with the input entropy pool impacting both
<i>/dev/random</i> and <i>/dev/urandom</i>. The
<b>CAP_SYS_ADMIN</b> capability is required for all requests
except <b>RNDGETENTCNT</b>. <b><br>
RNDGETENTCNT</b></p>

<p style="margin-left:22%;">Retrieve the entropy count of
the input pool, the contents will be the same as the
<i>entropy_avail</i> file under proc. The result will be
stored in the int pointed to by the argument.</p>

<p style="margin-left:11%;"><b>RNDADDTOENTCNT</b></p>

<p style="margin-left:22%;">Increment or decrement the
entropy count of the input pool by the value pointed to by
the argument.</p>

<p style="margin-left:11%;"><b>RNDGETPOOL</b></p>

<p style="margin-left:22%;">Removed in Linux 2.6.9.</p>

<p style="margin-left:11%;"><b>RNDADDENTROPY</b></p>

<p style="margin-left:22%;">Add some additional entropy to
the input pool, incrementing the entropy count. This differs
from writing to <i>/dev/random</i> or <i>/dev/urandom</i>,
which only adds some data but does not increment the entropy
count. The following structure is used:</p>

<p style="margin-left:28%; margin-top: 1em">struct
rand_pool_info { <br>
int entropy_count; <br>
int buf_size; <br>
__u32 buf[0]; <br>
};</p>

<p style="margin-left:22%; margin-top: 1em">Here
<i>entropy_count</i> is the value added to (or subtracted
from) the entropy count, and <i>buf</i> is the buffer of
size <i>buf_size</i> which gets added to the entropy
pool.</p>

<p style="margin-left:11%;"><b>RNDZAPENTCNT</b>,
<b>RNDCLEARPOOL</b></p>

<p style="margin-left:22%;">Zero the entropy count of all
pools and add some system data (such as wall clock) to the
pools.</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>/dev/random
<br>
/dev/urandom</i></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For an overview
and comparison of the various interfaces that can be used to
obtain randomness, see <a href="https://man.page/7/random">random(7)</a>.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">During early
boot time, reads from <i>/dev/urandom</i> may return data
prior to the entropy pool being initialized.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/1/mknod">mknod(1)</a>,
<a href="https://man.page/2/getrandom">getrandom(2)</a>, <a href="https://man.page/7/random">random(7)</a></p>

<p style="margin-left:11%; margin-top: 1em">RFC&nbsp;1750,
&quot;Randomness Recommendations for Security&quot;</p>

<h2>COLOPHON
<a name="COLOPHON"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This page is
part of release 5.10 of the Linux <i>man-pages</i> project.
A description of the project, information about reporting
bugs, and the latest version of this page, can be found at
https://www.kernel.org/doc/man-pages/.</p>
<hr>
</body>
</html>
