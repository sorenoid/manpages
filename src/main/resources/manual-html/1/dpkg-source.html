<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon Nov  7 04:39:14 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>dpkg-source</title>

</head>
<body>

<h1 align="center">dpkg-source</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMANDS">COMMANDS</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#SOURCE PACKAGE FORMATS">SOURCE PACKAGE FORMATS</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#FILES">FILES</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">dpkg-source -
Debian source package (.dsc) manipulation tool</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>dpkg-source</b>
[<i>option</i>...] <i>command</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>dpkg-source</b></i>
packs and unpacks Debian source archives.</p>

<p style="margin-left:11%; margin-top: 1em">None of these
commands allow multiple options to be combined into one, and
they do not allow the value for an option to be specified in
a separate argument.</p>

<h2>COMMANDS
<a name="COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>-x</b>,
<b>--extract</b> <i>filename</i>.dsc
[<i>output-directory</i>]</p>

<p style="margin-left:17%;">Extract a source package
(<b>--extract</b> since dpkg 1.17.14). One non-option
argument must be supplied, the name of the Debian source
control file (<b>.dsc</b>). An optional second non-option
argument may be supplied to specify the directory to extract
the source package to, this must not exist. If no output
directory is specified, the source package is extracted into
a directory named <i>source</i>-<i>version</i> under the
current working directory.</p>


<p style="margin-left:17%; margin-top: 1em"><b>dpkg-source</b>
will read the names of the other file(s) making up the
source package from the control file; they are assumed to be
in the same directory as the <b>.dsc</b>.</p>

<p style="margin-left:17%; margin-top: 1em">The files in
the extracted package will have their permissions and
ownerships set to those which would have been expected if
the files and directories had simply been created -
directories and executable files will be 0777 and plain
files will be 0666, both modified by the extractors&rsquo;
umask; if the parent directory is setgid then the extracted
directories will be too, and all the files and directories
will inherit its group ownership.</p>

<p style="margin-left:17%; margin-top: 1em">If the source
package uses a non-standard format (currently this means all
formats except &ldquo;1.0&rdquo;), its name will be stored
in <b>debian/source/format</b> so that the following builds
of the source package use the same format by default.</p>

<p style="margin-left:11%;"><b>-b</b>, <b>--build</b>
<i>directory</i> [<i>format-specific-parameters</i>]</p>

<p style="margin-left:17%;">Build a source package
(<b>--build</b> since dpkg 1.17.14). The first non-option
argument is taken as the name of the directory containing
the debianized source tree (i.e. with a debian sub-directory
and maybe changes to the original files). Depending on the
source package format used to build the package, additional
parameters might be accepted.</p>


<p style="margin-left:17%; margin-top: 1em"><b>dpkg-source</b>
will build the source package with the first format found in
this ordered list: the format indicated with the
<i>--format</i> command line option, the format indicated in
<b>debian/source/format</b>, &ldquo;1.0&rdquo;. The fallback
to &ldquo;1.0&rdquo; is deprecated and will be removed at
some point in the future, you should always document the
desired source format in <b>debian/source/format</b>. See
section <b><small>SOURCE PACKAGE FORMATS</small></b> for an
extensive description of the various source package
formats.</p>

<p style="margin-left:11%;"><b>--print-format</b>
<i>directory</i></p>

<p style="margin-left:17%;">Print the source format that
would be used to build the source package if <b>dpkg-source
--build</b> <i>directory</i> was called (in the same
conditions and with the same parameters; since dpkg
1.15.5).</p>

<p style="margin-left:11%;"><b>--before-build</b>
<i>directory</i></p>

<p style="margin-left:17%;">Run the corresponding hook of
the source package format (since dpkg 1.15.8). This hook is
called before any build of the package
(<b>dpkg-buildpackage</b> calls it very early even before
<b>debian/rules clean</b>). This command is idempotent and
can be called multiple times. Not all source formats
implement something in this hook, and those that do usually
prepare the source tree for the build for example by
ensuring that the Debian patches are applied.</p>

<p style="margin-left:11%;"><b>--after-build</b>
<i>directory</i></p>

<p style="margin-left:17%;">Run the corresponding hook of
the source package format (since dpkg 1.15.8). This hook is
called after any build of the package
(<b>dpkg-buildpackage</b> calls it last). This command is
idempotent and can be called multiple times. Not all source
formats implement something in this hook, and those that do
usually use it to undo what <b>--before-build</b> has
done.</p>

<p style="margin-left:11%;"><b>--commit</b>
[<i>directory</i>] ...</p>

<p style="margin-left:17%;">Record changes in the source
tree unpacked in <i>directory</i> (since dpkg 1.16.1). This
command can take supplementary parameters depending on the
source format. It will error out for formats where this
operation doesn&rsquo;t mean anything.</p>

<p style="margin-left:11%;"><b>-?</b>, <b>--help</b></p>

<p style="margin-left:17%;">Show the usage message and
exit. The format specific build and extract options can be
shown by using the <b>--format</b> option.</p>

<p style="margin-left:11%;"><b>--version</b></p>

<p style="margin-left:17%;">Show the version and exit.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Generic
build options <br>
-c</b><i>control-file</i></p>

<p style="margin-left:17%;">Specifies the main source
control file to read information from. The default is
<b>debian/control</b>. If given with relative pathname this
is interpreted starting at the source tree&rsquo;s top level
directory.</p>


<p style="margin-left:11%;"><b>-l</b><i>changelog-file</i></p>

<p style="margin-left:17%;">Specifies the changelog file to
read information from. The default is
<b>debian/changelog</b>. If given with relative pathname
this is interpreted starting at the source tree&rsquo;s top
level directory.</p>


<p style="margin-left:11%;"><b>-F</b><i>changelog-format</i></p>

<p style="margin-left:17%;">Specifies the format of the
changelog. See <a href="https://man.page/1/dpkg-parsechangelog">dpkg-parsechangelog(1)</a> for information
about alternative formats.</p>


<p style="margin-left:11%;"><b>--format=</b><i>value</i></p>

<p style="margin-left:17%;">Use the given format for
building the source package (since dpkg 1.14.17). It does
override any format given in
<b>debian/source/format</b>.</p>


<p style="margin-left:11%;"><b>-V</b><i>name</i><b>=</b><i>value</i></p>

<p style="margin-left:17%;">Set an output substitution
variable. See <a href="https://man.page/5/deb-substvars">deb-substvars(5)</a> for a discussion of
output substitution.</p>


<p style="margin-left:11%;"><b>-T</b><i>substvars-file</i></p>

<p style="margin-left:17%;">Read substitution variables in
<i>substvars-file</i>; the default is to not read any file.
This option can be used multiple times to read substitution
variables from multiple files (since dpkg 1.15.6).</p>


<p style="margin-left:11%;"><b>-D</b><i>field</i><b>=</b><i>value</i></p>

<p style="margin-left:17%;">Override or add an output
control file field.</p>

<p style="margin-left:11%;"><b>-U</b><i>field</i></p>

<p style="margin-left:17%;">Remove an output control file
field.</p>

<p style="margin-left:11%;"><b>-Z</b><i>compression</i>,
<b>--compression</b>=<i>compression</i></p>

<p style="margin-left:17%;">Specify the compression to use
for created tarballs and diff files (<b>--compression</b>
since dpkg 1.15.5). Note that this option will not cause
existing tarballs to be recompressed, it only affects new
files. Supported values are: <i>gzip</i>, <i>bzip2</i>,
<i>lzma</i> and <i>xz</i>. The default is <i>xz</i> for
formats 2.0 and newer, and <i>gzip</i> for format 1.0.
<i>xz</i> is only supported since dpkg 1.15.5.</p>

<p style="margin-left:11%;"><b>-z</b><i>level</i>,
<b>--compression-level</b>=<i>level</i></p>

<p style="margin-left:17%;">Compression level to use
(<b>--compression-level</b> since dpkg 1.15.5). As with
<b>-Z</b> it only affects newly created files. Supported
values are: <i>1</i> to <i>9</i>, <i>best</i>, and
<i>fast</i>. The default is <i>9</i> for gzip and bzip2,
<i>6</i> for xz and lzma.</p>

<p style="margin-left:11%;"><b>-i</b>[<i>regex</i>],
<b>--diff-ignore</b>[=<i>regex</i>]</p>

<p style="margin-left:17%;">You may specify a perl regular
expression to match files you want filtered out of the list
of files for the diff (<b>--diff-ignore</b> since dpkg
1.15.6). (This list is generated by a find command.) (If the
source package is being built as a version 3 source package
using a <small>VCS,</small> this can be used to ignore
uncommitted changes on specific files. Using -i.* will
ignore all of them.)</p>

<p style="margin-left:17%; margin-top: 1em">The <b>-i</b>
option by itself enables this setting with a default regex
(preserving any modification to the default regex done by a
previous use of <b>--extend-diff-ignore</b>) that will
filter out control files and directories of the most common
revision control systems, backup and swap files and Libtool
build output directories. There can only be one active
regex, of multiple <b>-i</b> options only the last one will
take effect.</p>

<p style="margin-left:17%; margin-top: 1em">This is very
helpful in cutting out extraneous files that get included in
the diff, e.g. if you maintain your source in a revision
control system and want to use a checkout to build a source
package without including the additional files and
directories that it will usually contain (e.g.
<small>CVS/,</small> .cvsignore, .svn/). The default regex
is already very exhaustive, but if you need to replace it,
please note that by default it can match any part of a path,
so if you want to match the begin of a filename or only full
filenames, you will need to provide the necessary anchors
(e.g. &rsquo;(^|/)&rsquo;, &rsquo;($|/)&rsquo;)
yourself.</p>


<p style="margin-left:11%;"><b>--extend-diff-ignore</b>=<i>regex</i></p>

<p style="margin-left:17%;">The perl regular expression
specified will extend the default value used by
<b>--diff-ignore</b> and its current value, if set (since
dpkg 1.15.6). It does this by concatenating
&ldquo;<b>|</b><i>regex</i>&rdquo; to the existing value.
This option is convenient to use in
<b>debian/source/options</b> to exclude some auto-generated
files from the automatic patch generation.</p>


<p style="margin-left:11%;"><b>-I</b>[<i>file-pattern</i>],
<b>--tar-ignore</b>[=<i>file-pattern</i>]</p>

<p style="margin-left:17%;">If this option is specified,
the pattern will be passed to <a href="https://man.page/1/tar">tar(1)</a>&rsquo;s
<b>--exclude</b> option when it is called to generate a
.orig.tar or .tar file (<b>--tar-ignore</b> since dpkg
1.15.6). For example, <b>-I</b> <small>CVS</small> will make
tar skip over <small>CVS</small> directories when generating
a .tar.gz file. The option may be repeated multiple times to
list multiple patterns to exclude.</p>

<p style="margin-left:17%; margin-top: 1em"><b>-I</b> by
itself adds default <b>--exclude</b> options that will
filter out control files and directories of the most common
revision control systems, backup and swap files and Libtool
build output directories.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note:</b>
While they have similar purposes, <b>-i</b> and <b>-I</b>
have very different syntax and semantics. <b>-i</b> can only
be specified once and takes a perl compatible regular
expression which is matched against the full relative path
of each file. <b>-I</b> can specified multiple times and
takes a filename pattern with shell wildcards. The pattern
is applied to the full relative path but also to each part
of the path individually. The exact semantic of tar&rsquo;s
<b>--exclude</b> option is somewhat complicated, see
&lt;https://www.gnu.org/software/tar/manual/tar.html#wildcards&gt;
for a full documentation.</p>

<p style="margin-left:11%; margin-top: 1em">The default
regex and patterns for both options can be seen in the
output of the <b>--help</b> command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Generic
extract options <br>
--no-copy</b></p>

<p style="margin-left:17%;">Do not copy original tarballs
near the extracted source package (since dpkg 1.14.17).</p>

<p style="margin-left:11%;"><b>--no-check</b></p>

<p style="margin-left:17%;">Do not check signatures and
checksums before unpacking (since dpkg 1.14.17).</p>

<p style="margin-left:11%;"><b>--no-overwrite-dir</b></p>

<p style="margin-left:17%;">Do not overwrite the extraction
directory if it already exists (since dpkg 1.18.8).</p>


<p style="margin-left:11%;"><b>--require-valid-signature</b></p>

<p style="margin-left:17%;">Refuse to unpack the source
package if it doesn&rsquo;t contain an OpenPGP signature
that can be verified (since dpkg 1.15.0) either with the
user&rsquo;s <i>trustedkeys.gpg</i> keyring, one of the
vendor-specific keyrings, or one of the official Debian
keyrings (<i>/usr/share/keyrings/debian-keyring.gpg</i>,
<i>/usr/share/keyrings/debian-nonupload.gpg</i> and
<i>/usr/share/keyrings/debian-maintainers.gpg</i>).</p>


<p style="margin-left:11%;"><b>--require-strong-checksums</b></p>

<p style="margin-left:17%;">Refuse to unpack the source
package if it does not contain any strong checksums (since
dpkg 1.18.7). Currently the only known checksum considered
strong is <b><small>SHA-256</small></b> .</p>


<p style="margin-left:11%;"><b>--ignore-bad-version</b></p>

<p style="margin-left:17%;">Turns the bad source package
version check into a non-fatal warning (since dpkg 1.17.7).
This option should only be necessary when extracting ancient
source packages with broken versions, just for backwards
compatibility.</p>

<h2>SOURCE PACKAGE FORMATS
<a name="SOURCE PACKAGE FORMATS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If you
don&rsquo;t know what source format to use, you should
probably pick either &ldquo;3.0 (quilt)&rdquo; or &ldquo;3.0
(native)&rdquo;. See
&lt;https://wiki.debian.org/Projects/DebSrc3.0&gt; for
information on the deployment of those formats within
Debian.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format:
1.0</b> <br>
A source package in this format consists either of a
<b>.orig.tar.gz</b> associated to a <b>.diff.gz</b> or a
single <b>.tar.gz</b> (in that case the package is said to
be <i>native</i>). Optionally the original tarball might be
accompanied by a detached upstream signature
<b>.orig.tar.gz.asc</b>, extraction supported since dpkg
1.18.5.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Extracting</b></p>

<p style="margin-left:11%; margin-top: 1em">Extracting a
native package is a simple extraction of the single tarball
in the target directory. Extracting a non-native package is
done by first unpacking the <b>.orig.tar.gz</b> and then
applying the patch contained in the <b>.diff.gz</b> file.
The timestamp of all patched files is reset to the
extraction time of the source package (this avoids timestamp
skews leading to problems when autogenerated files are
patched). The diff can create new files (the whole debian
directory is created that way) but cannot remove files
(empty files will be left over) and cannot create or change
symlinks.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Building</b></p>

<p style="margin-left:11%; margin-top: 1em">Building a
native package is just creating a single tarball with the
source directory. Building a non-native package involves
extracting the original tarball in a separate
&ldquo;.orig&rdquo; directory and regenerating the
<b>.diff.gz</b> by comparing the source package
<i>directory</i> with the .orig directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Build
options (with --build):</b></p>

<p style="margin-left:11%; margin-top: 1em">If a second
non-option argument is supplied it should be the name of the
original source directory or tarfile or the empty string if
the package is a Debian-specific one and so has no
debianization diffs. If no second argument is supplied then
<b>dpkg-source</b> will look for the original source tarfile
<i>package</i><b>_</b><i>upstream-version</i><b>.orig.tar.gz</b>
or the original source directory
<i>directory</i><b>.orig</b> depending on the <b>-sX</b>
arguments.</p>

<p style="margin-left:11%; margin-top: 1em"><b>-sa</b>,
<b>-sp</b>, <b>-sk</b>, <b>-su</b> and <b>-sr</b> will not
overwrite existing tarfiles or directories. If this is
desired then <b>-sA</b>, <b>-sP</b>, <b>-sK</b>, <b>-sU</b>
and <b>-sR</b> should be used instead.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sk</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Specifies to expect the original source as a tarfile, by
default
<i>package</i><b>_</b><i>upstream-version</i><b>.orig.tar.</b><i>extension</i>.
It will leave this original source in place as a tarfile, or
copy it to the current directory if it isn&rsquo;t already
there. The tarball will be unpacked into
<i>directory</i><b>.orig</b> for the generation of the
diff.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sp</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Like <b>-sk</b> but will remove the directory again
afterwards.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-su</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Specifies that the original source is expected as a
directory, by default
<i>package</i><b>-</b><i>upstream-version</i><b>.orig</b>
and <b>dpkg-source</b> will create a new original source
archive from it.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sr</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Like <b>-su</b> but will remove that directory after it
has been used.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-ss</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Specifies that the original source is available both as
a directory and as a tarfile. <b>dpkg-source</b> will use
the directory to create the diff, but the tarfile to create
the <b>.dsc</b>. This option must be used with care - if the
directory and tarfile do not match a bad source archive will
be generated.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sn</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Specifies to not look for any original source, and to
not generate a diff. The second argument, if supplied, must
be the empty string. This is used for Debian-specific
packages which do not have a separate upstream source and
therefore have no debianization diffs.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-sa</b> or <b>-sA</b></p>

<p style="margin-left:17%;">Specifies to look for the
original source archive as a tarfile or as a directory - the
second argument, if any, may be either, or the empty string
(this is equivalent to using <b>-sn</b>). If a tarfile is
found it will unpack it to create the diff and remove it
afterwards (this is equivalent to <b>-sp</b>); if a
directory is found it will pack it to create the original
source and remove it afterwards (this is equivalent to
<b>-sr</b>); if neither is found it will assume that the
package has no debianization diffs, only a straightforward
source archive (this is equivalent to <b>-sn</b>). If both
are found then <b>dpkg-source</b> will ignore the directory,
overwriting it, if <b>-sA</b> was specified (this is
equivalent to <b>-sP</b>) or raise an error if <b>-sa</b>
was specified. <b>-sa</b> is the default.</p>


<p style="margin-left:11%;"><b>--abort-on-upstream-changes</b></p>

<p style="margin-left:17%;">The process fails if the
generated diff contains changes to files outside of the
debian sub-directory (since dpkg 1.15.8). This option is not
allowed in <b>debian/source/options</b> but can be used in
<b>debian/source/local-options</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Extract
options (with --extract):</b></p>

<p style="margin-left:11%; margin-top: 1em">In all cases
any existing original source tree will be removed.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sp</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Used when extracting then the original source (if any)
will be left as a tarfile. If it is not already located in
the current directory or if an existing but different file
is there it will be copied there. (<b>This is the
default</b>).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-su</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Unpacks the original source tree.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sn</b></p></td>
<td width="2%"></td>
<td width="83%">


<p>Ensures that the original source is neither copied to
the current directory nor unpacked. Any original source tree
that was in the current directory is still removed.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">All the
<b>-s</b><i>X</i> options are mutually exclusive. If you
specify more than one only the last one will be used.
<b><br>
--skip-debianization</b></p>

<p style="margin-left:17%;">Skips application of the debian
diff on top of the upstream sources (since dpkg 1.15.1).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format:
2.0</b> <br>
Extraction supported since dpkg 1.13.9, building supported
since dpkg 1.14.8. Also known as wig&amp;pen. This format is
not recommended for wide-spread usage, the format &ldquo;3.0
(quilt)&rdquo; replaces it. Wig&amp;pen was the first
specification of a new-generation source package format.</p>

<p style="margin-left:11%; margin-top: 1em">The behaviour
of this format is the same as the &ldquo;3.0 (quilt)&rdquo;
format except that it doesn&rsquo;t use an explicit list of
patches. All files in <b>debian/patches/</b> matching the
perl regular expression <b>[\w-]+</b> must be valid patches:
they are applied at extraction time.</p>

<p style="margin-left:11%; margin-top: 1em">When building a
new source package, any change to the upstream source is
stored in a patch named <b>zz_debian-diff-auto</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format: 3.0
(native)</b> <br>
Supported since dpkg 1.14.17. This format is an extension of
the native package format as defined in the 1.0 format. It
supports all compression methods and will ignore by default
any <small>VCS</small> specific files and directories as
well as many temporary files (see default value associated
to <b>-I</b> option in the <b>--help</b> output).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format: 3.0
(quilt)</b> <br>
Supported since dpkg 1.14.17. A source package in this
format contains at least an original tarball
(<b>.orig.tar.</b><i>ext</i> where <i>ext</i> can be
<b>gz</b>, <b>bz2</b>, <b>lzma</b> and <b>xz</b>) and a
debian tarball (<b>.debian.tar.</b><i>ext</i>). It can also
contain additional original tarballs
(<b>.orig-</b><i>component</i><b>.tar.</b><i>ext</i>).
<i>component</i> can only contain alphanumeric
(&rsquo;a-zA-Z0-9&rsquo;) characters and hyphens
(&rsquo;-&rsquo;). Optionally each original tarball can be
accompanied by a detached upstream signature
(<b>.orig.tar.</b><i>ext</i><b>.asc</b> and
<b>.orig-</b><i>component</i><b>.tar.</b><i>ext</i><b>.asc</b>),
extraction supported since dpkg 1.17.20, building supported
since dpkg 1.18.5.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Extracting</b></p>

<p style="margin-left:11%; margin-top: 1em">The main
original tarball is extracted first, then all additional
original tarballs are extracted in subdirectories named
after the <i>component</i> part of their filename (any
pre-existing directory is replaced). The debian tarball is
extracted on top of the source directory after prior removal
of any pre-existing <b>debian</b> directory. Note that the
debian tarball must contain a <b>debian</b> sub-directory
but it can also contain binary files outside of that
directory (see <b>--include-binaries</b> option).</p>

<p style="margin-left:11%; margin-top: 1em">All patches
listed in <b>debian/patches/</b><i>vendor</i><b>.series</b>
or <b>debian/patches/series</b> are then applied, where
<i>vendor</i> will be the lowercase name of the current
vendor, or <b>debian</b> if there is no vendor defined. If
the former file is used and the latter one doesn&rsquo;t
exist (or is a symlink), then the latter is replaced with a
symlink to the former. This is meant to simplify usage of
<b>quilt</b> to manage the set of patches. Vendor-specific
series files are intended to make it possible to serialize
multiple development branches based on the vendor, in a
declarative way, in preference to open-coding this handling
in <b>debian/rules</b>. This is particularly useful when the
source would need to be patched conditionally because the
affected files do not have built-in conditional occlusion
support. Note however that while <b>dpkg-source</b> parses
correctly series files with explicit options used for patch
application (stored on each line after the patch filename
and one or more spaces), it does ignore those options and
always expects patches that can be applied with the
<b>-p1</b> option of <b>patch</b>. It will thus emit a
warning when it encounters such options, and the build is
likely to fail.</p>

<p style="margin-left:11%; margin-top: 1em">Note that
<a href="https://man.page/1/lintian">lintian(1)</a> will emit unconditional warnings when
using vendor series due to a controversial Debian specific
ruling, which should not affect any external usage; to
silence these, the dpkg lintian profile can be used by
passing &laquo;<b>--profile dpkg</b>&raquo; to
<a href="https://man.page/1/lintian">lintian(1)</a>.</p>

<p style="margin-left:11%; margin-top: 1em">The timestamp
of all patched files is reset to the extraction time of the
source package (this avoids timestamp skews leading to
problems when autogenerated files are patched).</p>

<p style="margin-left:11%; margin-top: 1em">Contrary to
<b>quilt</b>&rsquo;s default behaviour, patches are expected
to apply without any fuzz. When that is not the case, you
should refresh such patches with <b>quilt</b>, or
<b>dpkg-source</b> will error out while trying to apply
them.</p>

<p style="margin-left:11%; margin-top: 1em">Similarly to
<b>quilt</b>&rsquo;s default behaviour, the patches can
remove files too.</p>

<p style="margin-left:11%; margin-top: 1em">The file
<b>.pc/applied-patches</b> is created if some patches have
been applied during the extraction.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Building</b></p>

<p style="margin-left:11%; margin-top: 1em">All original
tarballs found in the current directory are extracted in a
temporary directory by following the same logic as for the
unpack, the debian directory is copied over in the temporary
directory, and all patches except the automatic patch
(<b>debian-changes-</b><i>version</i> or
<b>debian-changes</b>, depending on
<b>--single-debian-patch</b>) are applied. The temporary
directory is compared to the source package directory. When
the diff is non-empty, the build fails unless
<b>--single-debian-patch</b> or <b>--auto-commit</b> has
been used, in which case the diff is stored in the automatic
patch. If the automatic patch is created/deleted, it&rsquo;s
added/removed from the series file and from the <b>quilt</b>
metadata.</p>

<p style="margin-left:11%; margin-top: 1em">Any change on a
binary file is not representable in a diff and will thus
lead to a failure unless the maintainer deliberately decided
to include that modified binary file in the debian tarball
(by listing it in <b>debian/source/include-binaries</b>).
The build will also fail if it finds binary files in the
debian sub-directory unless they have been allowed through
<b>debian/source/include-binaries</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The updated
debian directory and the list of modified binaries is then
used to generate the debian tarball.</p>

<p style="margin-left:11%; margin-top: 1em">The
automatically generated diff doesn&rsquo;t include changes
on <small>VCS</small> specific files as well as many
temporary files (see default value associated to <b>-i</b>
option in the <b>--help</b> output). In particular, the
<b>.pc</b> directory used by <b>quilt</b> is ignored during
generation of the automatic patch.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note:
dpkg-source --before-build</b> (and <b>--build</b>) will
ensure that all patches listed in the series file are
applied so that a package build always has all patches
applied. It does this by finding unapplied patches (they are
listed in the <b>series</b> file but not in
<b>.pc/applied-patches</b>), and if the first patch in that
set can be applied without errors, it will apply them all.
The option <b>--no-preparation</b> can be used to disable
this behavior.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Recording
changes <br>
--commit</b> [<i>directory</i>] [<i>patch-name</i>]
[<i>patch-file</i>]</p>

<p style="margin-left:17%;">Generates a patch corresponding
to the local changes that are not managed by the
<b>quilt</b> patch system and integrates it in the patch
system under the name <i>patch-name</i>. If the name is
missing, it will be asked interactively. If
<i>patch-file</i> is given, it is used as the patch
corresponding to the local changes to integrate. Once
integrated, an editor is launched so that you can edit the
meta-information in the patch header.</p>

<p style="margin-left:17%; margin-top: 1em">Passing
<i>patch-file</i> is mainly useful after a build failure
that pre-generated this file, and on this ground the given
file is removed after integration. Note also that the
changes contained in the patch file must already be applied
on the tree and that the files modified by the patch must
not have supplementary unrecorded changes.</p>

<p style="margin-left:17%; margin-top: 1em">If the patch
generation detects modified binary files, they will be
automatically added to <b>debian/source/include-binaries</b>
so that they end up in the debian tarball (exactly like
<b>dpkg-source --include-binaries --build</b> would do).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Build
options <br>
--allow-version-of-quilt-db=</b><i>version</i></p>

<p style="margin-left:17%;">Allow <b>dpkg-source</b> to
build the source package if the version of the <b>quilt</b>
metadata is the one specified, even if <b>dpkg-source</b>
doesn&rsquo;t know about it (since dpkg 1.15.5.4).
Effectively this says that the given version of the
<b>quilt</b> metadata is compatible with the version 2 that
<b>dpkg-source</b> currently supports. The version of the
<b>quilt</b> metadata is stored in <b>.pc/.version</b>.</p>

<p style="margin-left:11%;"><b>--include-removal</b></p>

<p style="margin-left:17%;">Do not ignore removed files and
include them in the automatically generated patch.</p>

<p style="margin-left:11%;"><b>--include-timestamp</b></p>

<p style="margin-left:17%;">Include timestamp in the
automatically generated patch.</p>

<p style="margin-left:11%;"><b>--include-binaries</b></p>

<p style="margin-left:17%;">Add all modified binaries in
the debian tarball. Also add them to
<b>debian/source/include-binaries</b>: they will be added by
default in subsequent builds and this option is thus no more
needed.</p>

<p style="margin-left:11%;"><b>--no-preparation</b></p>

<p style="margin-left:17%;">Do not try to prepare the build
tree by applying patches which are apparently unapplied
(since dpkg 1.14.18).</p>


<p style="margin-left:11%;"><b>--single-debian-patch</b></p>

<p style="margin-left:17%;">Use
<b>debian/patches/debian-changes</b> instead of
<b>debian/patches/debian-changes-</b><i>version</i> for the
name of the automatic patch generated during build (since
dpkg 1.15.5.4). This option is particularly useful when the
package is maintained in a <small>VCS</small> and a patch
set can&rsquo;t reliably be generated. Instead the current
diff with upstream should be stored in a single patch. The
option would be put in <b>debian/source/local-options</b>
and would be accompanied by a
<b>debian/source/local-patch-header</b> file explaining how
the Debian changes can be best reviewed, for example in the
<small>VCS</small> that is used.</p>

<p style="margin-left:11%;"><b>--create-empty-orig</b></p>

<p style="margin-left:17%;">Automatically create the main
original tarball as empty if it&rsquo;s missing and if there
are supplementary original tarballs (since dpkg 1.15.6).
This option is meant to be used when the source package is
just a bundle of multiple upstream software and where
there&rsquo;s no &ldquo;main&rdquo; software.</p>

<p style="margin-left:11%;"><b>--no-unapply-patches,
--unapply-patches</b></p>

<p style="margin-left:17%;">By default, <b>dpkg-source</b>
will automatically unapply the patches in the
<b>--after-build</b> hook if it did apply them during
<b>--before-build</b> (<b>--unapply-patches</b> since dpkg
1.15.8, <b>--no-unapply-patches</b> since dpkg 1.16.5).
Those options allow you to forcefully disable or enable the
patch unapplication process. Those options are only allowed
in <b>debian/source/local-options</b> so that all generated
source packages have the same behavior by default.</p>


<p style="margin-left:11%;"><b>--abort-on-upstream-changes</b></p>

<p style="margin-left:17%;">The process fails if an
automatic patch has been generated (since dpkg 1.15.8). This
option can be used to ensure that all changes were properly
recorded in separate <b>quilt</b> patches prior to the
source package build. This option is not allowed in
<b>debian/source/options</b> but can be used in
<b>debian/source/local-options</b>.</p>

<p style="margin-left:11%;"><b>--auto-commit</b></p>

<p style="margin-left:17%;">The process doesn&rsquo;t fail
if an automatic patch has been generated, instead it&rsquo;s
immediately recorded in the <b>quilt</b> series.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Extract
options <br>
--skip-debianization</b></p>

<p style="margin-left:17%;">Skips extraction of the debian
tarball on top of the upstream sources (since dpkg
1.15.1).</p>

<p style="margin-left:11%;"><b>--skip-patches</b></p>

<p style="margin-left:17%;">Do not apply patches at the end
of the extraction (since dpkg 1.14.18).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format: 3.0
(custom)</b> <br>
Supported since dpkg 1.14.17. This format is special. It
doesn&rsquo;t represent a real source package format but can
be used to create source packages with arbitrary files.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Build
options</b></p>

<p style="margin-left:11%; margin-top: 1em">All non-option
arguments are taken as files to integrate in the generated
source package. They must exist and are preferably in the
current directory. At least one file must be given. <b><br>
--target-format=</b><i>value</i></p>

<p style="margin-left:17%;"><b>Required</b>. Defines the
real format of the generated source package. The generated
.dsc file will contain this value in its <b>Format</b> field
and not &ldquo;3.0 (custom)&rdquo;.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format: 3.0
(git)</b> <br>
Supported since dpkg 1.14.17. This format is
experimental.</p>

<p style="margin-left:11%; margin-top: 1em">A source
package in this format consists of a single bundle of a git
repository <b>.git</b> to hold the source of a package.
There may also be a <b>.gitshallow</b> file listing
revisions for a shallow git clone.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Extracting</b></p>

<p style="margin-left:11%; margin-top: 1em">The bundle is
cloned as a git repository to the target directory. If there
is a gitshallow file, it is installed as <i>.git/shallow</i>
inside the cloned git repository.</p>

<p style="margin-left:11%; margin-top: 1em">Note that by
default the new repository will have the same branch checked
out that was checked out in the original source. (Typically
&ldquo;master&rdquo;, but it could be anything.) Any other
branches will be available under <i>remotes/origin/</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Building</b></p>

<p style="margin-left:11%; margin-top: 1em">Before going
any further, some checks are done to ensure that we
don&rsquo;t have any non-ignored uncommitted changes.</p>


<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/1/git-bundle">git-bundle(1)</a>
is used to generate a bundle of the git repository. By
default, all branches and tags in the repository are
included in the bundle.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Build
options <br>
--git-ref=</b><i>ref</i></p>

<p style="margin-left:17%;">Allows specifying a git ref to
include in the git bundle. Use disables the default behavior
of including all branches and tags. May be specified
multiple times. The <i>ref</i> can be the name of a branch
or tag to include. It may also be any parameter that can be
passed to <a href="https://man.page/1/git-rev-list">git-rev-list(1)</a>. For example, to include
only the master branch, use <b>--git-ref=</b>master. To
include all tags and branches, except for the private
branch, use <b>--git-ref=</b>--all
<b>--git-ref=</b>^private</p>


<p style="margin-left:11%;"><b>--git-depth=</b><i>number</i></p>

<p style="margin-left:17%;">Creates a shallow clone with a
history truncated to the specified number of revisions.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Format: 3.0
(bzr)</b> <br>
Supported since dpkg 1.14.17. This format is experimental.
It generates a single tarball containing the bzr
repository.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Extracting</b></p>

<p style="margin-left:11%; margin-top: 1em">The tarball is
unpacked and then bzr is used to checkout the current
branch.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Building</b></p>

<p style="margin-left:11%; margin-top: 1em">Before going
any further, some checks are done to ensure that we
don&rsquo;t have any non-ignored uncommitted changes.</p>

<p style="margin-left:11%; margin-top: 1em">Then the
<small>VCS</small> specific part of the source directory is
copied over to a temporary directory. Before this temporary
directory is packed in a tarball, various cleanup are done
to save space.</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>no source
format specified in debian/source/format</b> <br>
The file <b>debian/source/format</b> should always exist and
indicate the desired source format. For backwards
compatibility, format &ldquo;1.0&rdquo; is assumed when the
file doesn&rsquo;t exist but you should not rely on this: at
some point in the future <b>dpkg-source</b> will be modified
to fail when that file doesn&rsquo;t exist.</p>

<p style="margin-left:11%; margin-top: 1em">The rationale
is that format &ldquo;1.0&rdquo; is no longer the
recommended format, you should usually pick one of the newer
formats (&ldquo;3.0 (quilt)&rdquo;, &ldquo;3.0
(native)&rdquo;) but <b>dpkg-source</b> will not do this
automatically for you. If you want to continue using the old
format, you should be explicit about it and put
&ldquo;1.0&rdquo; in <b>debian/source/format</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>the diff
modifies the following upstream files</b> <br>
When using source format &ldquo;1.0&rdquo; it is usually a
bad idea to modify upstream files directly as the changes
end up hidden and mostly undocumented in the .diff.gz file.
Instead you should store your changes as patches in the
debian directory and apply them at build-time. To avoid this
complexity you can also use the format &ldquo;3.0
(quilt)&rdquo; that offers this natively.</p>

<p style="margin-left:11%; margin-top: 1em"><b>cannot
represent change to</b> <i>file</i> <br>
Changes to upstream sources are usually stored with patch
files, but not all changes can be represented with patches:
they can only alter the content of plain text files. If you
try replacing a file with something of a different type (for
example replacing a plain file with a symlink or a
directory), you will get this error message.</p>

<p style="margin-left:11%; margin-top: 1em"><b>newly
created empty file</b> <i>file</i> <b>will not be
represented in diff</b> <br>
Empty files can&rsquo;t be created with patch files. Thus
this change is not recorded in the source package and you
are warned about it.</p>

<p style="margin-left:11%; margin-top: 1em"><b>executable
mode</b> <i>perms</i> <b>of</b> <i>file</i> <b>will not be
represented in diff</b> <br>
Patch files do not record permissions of files and thus
executable permissions are not stored in the source package.
This warning reminds you of that fact.</p>

<p style="margin-left:11%; margin-top: 1em"><b>special
mode</b> <i>perms</i> <b>of</b> <i>file</i> <b>will not be
represented in diff</b> <br>
Patch files do not record permissions of files and thus
modified permissions are not stored in the source package.
This warning reminds you of that fact.</p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b><small>DPKG_COLORS</small></b></p>

<p style="margin-left:17%;">Sets the color mode (since dpkg
1.18.5). The currently accepted values are: <b>auto</b>
(default), <b>always</b> and <b>never</b>.</p>


<p style="margin-left:11%;"><b><small>DPKG_NLS</small></b></p>

<p style="margin-left:17%;">If set, it will be used to
decide whether to activate Native Language Support, also
known as internationalization (or i18n) support (since dpkg
1.19.0). The accepted values are: <b>0</b> and <b>1</b>
(default).</p>


<p style="margin-left:11%;"><b><small>SOURCE_DATE_EPOCH</small></b></p>

<p style="margin-left:17%;">If set, it will be used as the
timestamp (as seconds since the epoch) to clamp the mtime in
the <a href="https://man.page/5/tar">tar(5)</a> file entries.</p>

<p style="margin-left:11%;"><b><small>VISUAL <br>
EDITOR</small></b></p>

<p style="margin-left:17%;">Used by the &ldquo;2.0&rdquo;
and &ldquo;3.0 (quilt)&rdquo; source format modules.</p>

<p style="margin-left:11%;"><b><small>GIT_DIR <br>
GIT_INDEX_FILE <br>
GIT_OBJECT_DIRECTORY <br>
GIT_ALTERNATE_OBJECT_DIRECTORIES <br>
GIT_WORK_TREE</small></b></p>

<p style="margin-left:17%;">Used by the &ldquo;3.0
(git)&rdquo; source format modules.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>debian/source/format</b>
<br>
This file contains on a single line the format that should
be used to build the source package (possible formats are
described above). No leading or trailing spaces are
allowed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>debian/source/include-binaries</b>
<br>
This file contains a list of pathnames of binary files (one
per line) relative to the source root directory that should
be included in the debian tarball. Leading and trailing
spaces are stripped. Lines starting with
&rsquo;<b>#</b>&rsquo; are comments and are skipped. Empty
lines are ignored.</p>


<p style="margin-left:11%; margin-top: 1em"><b>debian/source/options</b>
<br>
This file contains a list of long options that should be
automatically prepended to the set of command line options
of a <b>dpkg-source --build</b> or <b>dpkg-source
--print-format</b> call. Options like <b>--compression</b>
and <b>--compression-level</b> are well suited for this
file.</p>

<p style="margin-left:11%; margin-top: 1em">Each option
should be put on a separate line. Empty lines and lines
starting with &rsquo;<b>#</b>&rsquo; are ignored. The
leading &rsquo;<b>--</b>&rsquo; should be stripped and short
options are not allowed. Optional spaces are allowed around
the &rsquo;<b>=</b>&rsquo; symbol and optional quotes are
allowed around the value. Here&rsquo;s an example of such a
file:</p>

<p style="margin-left:11%; margin-top: 1em"># let
dpkg-source create a debian.tar.bz2 with maximal compression
<br>
compression = &quot;bzip2&quot; <br>
compression-level = 9 <br>
# use debian/patches/debian-changes as automatic patch <br>
single-debian-patch <br>
# ignore changes on config.{sub,guess} <br>
extend-diff-ignore =
&quot;(^|/)(config.sub|config.guess)$&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note:
format</b> options are not accepted in this file, you should
use <b>debian/source/format</b> instead.</p>


<p style="margin-left:11%; margin-top: 1em"><b>debian/source/local-options</b>
<br>
Exactly like <b>debian/source/options</b> except that the
file is not included in the generated source package. It can
be useful to store a preference tied to the maintainer or to
the <small>VCS</small> repository where the source package
is maintained.</p>


<p style="margin-left:11%; margin-top: 1em"><b>debian/source/local-patch-header
<br>
debian/source/patch-header</b> <br>
Free form text that is put on top of the automatic patch
generated in formats &ldquo;2.0&rdquo; or &ldquo;3.0
(quilt)&rdquo;. <b>local-patch-header</b> is not included in
the generated source package while <b>patch-header</b>
is.</p>


<p style="margin-left:11%; margin-top: 1em"><b>debian/patches/</b><i>vendor</i><b>.series
<br>
debian/patches/series</b> <br>
This file lists all patches that have to be applied (in the
given order) on top of the upstream source package. Leading
and trailing spaces are stripped. The <i>vendor</i> will be
the lowercase name of the current vendor, or <b>debian</b>
if there is no vendor defined. If the vendor-specific series
file does not exist, the vendor-less series file will be
used. Lines starting with &rsquo;<b>#</b>&rsquo; are
comments and are skipped. Empty lines are ignored. Remaining
lines start with a patch filename (relative to the
<b>debian/patches/</b> directory) up to the first space
character or the end of line. Optional <b>quilt</b> options
can follow up to the end of line or the first
&rsquo;<b>#</b>&rsquo; preceded by one or more spaces (which
marks the start of a comment up to the end of line).</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The point at
which field overriding occurs compared to certain standard
output field settings is rather confused.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/5/deb-src-control">deb-src-control(5)</a>,
<a href="https://man.page/5/deb-changelog">deb-changelog(5)</a>, <a href="https://man.page/5/dsc">dsc(5)</a>.</p>
<hr>
</body>
</html>
