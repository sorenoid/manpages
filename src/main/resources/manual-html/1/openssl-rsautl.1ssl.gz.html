<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon Nov  7 04:40:20 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>OPENSSL-RSAUTL</title>

</head>
<body>

<h1 align="center">OPENSSL-RSAUTL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">openssl-rsautl
- RSA command</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>openssl
rsautl</b> [<b>-help</b>] [<b>-in</b> <i>file</i>]
[<b>-passin</b> <i>arg</i>] [<b>-rev</b>] [<b>-out</b>
<i>file</i>] [<b>-inkey</b> <i>filename</i>|<i>uri</i>]
[<b>-keyform <small>DER</small></b> |
<b><small>PEM</small></b> |<b>P12</b>|
<b><small>ENGINE</small></b> ] [<b>-pubin</b>]
[<b>-certin</b>] [<b>-sign</b>] [<b>-verify</b>]
[<b>-encrypt</b>] [<b>-decrypt</b>] [<b>-pkcs</b>]
[<b>-x931</b>] [<b>-oaep</b>] [<b>-raw</b>]
[<b>-hexdump</b>] [<b>-asn1parse</b>] [<b>-engine</b>
<i>id</i>] [<b>-rand</b> <i>files</i>] [<b>-writerand</b>
<i>file</i>] [<b>-provider</b> <i>name</i>]
[<b>-provider-path</b> <i>path</i>] [<b>-propquery</b>
<i>propq</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This command
has been deprecated. The <b>openssl-pkeyutl</b>(1) command
should be used instead.</p>

<p style="margin-left:11%; margin-top: 1em">This command
can be used to sign, verify, encrypt and decrypt data using
the <small>RSA</small> algorithm.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>-help</b></p>

<p style="margin-left:17%;">Print out a usage message.</p>

<p style="margin-left:11%;"><b>-in</b> <i>filename</i></p>

<p style="margin-left:17%;">This specifies the input
filename to read data from or standard input if this option
is not specified.</p>

<p style="margin-left:11%;"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The passphrase used in the
output file. See see
<b>openssl-passphrase-options</b>(1).</p>

<p style="margin-left:11%;"><b>-rev</b></p>

<p style="margin-left:17%;">Reverse the order of the
input.</p>

<p style="margin-left:11%;"><b>-out</b> <i>filename</i></p>

<p style="margin-left:17%;">Specifies the output filename
to write to or standard output by default.</p>

<p style="margin-left:11%;"><b>-inkey</b>
<i>filename</i>|<i>uri</i></p>

<p style="margin-left:17%;">The input key, by default it
should be an <small>RSA</small> private key.</p>

<p style="margin-left:11%;"><b>-keyform
<small>DER</small></b> | <b><small>PEM</small></b>
|<b>P12</b>| <b><small>ENGINE</small></b></p>

<p style="margin-left:17%;">The key format; unspecified by
default. See <b>openssl-format-options</b>(1) for
details.</p>

<p style="margin-left:11%;"><b>-pubin</b></p>

<p style="margin-left:17%;">The input file is an
<small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>-certin</b></p>

<p style="margin-left:17%;">The input is a certificate
containing an <small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>-sign</b></p>

<p style="margin-left:17%;">Sign the input data and output
the signed result. This requires an <small>RSA</small>
private key.</p>

<p style="margin-left:11%;"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the input data and
output the recovered data.</p>

<p style="margin-left:11%;"><b>-encrypt</b></p>

<p style="margin-left:17%;">Encrypt the input data using an
<small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>-decrypt</b></p>

<p style="margin-left:17%;">Decrypt the input data using an
<small>RSA</small> private key.</p>

<p style="margin-left:11%;"><b>-pkcs</b>, <b>-oaep</b>,
<b>-x931 -raw</b></p>

<p style="margin-left:17%;">The padding to use: PKCS#1 v1.5
(the default), PKCS#1 <small>OAEP, ANSI X9.31,</small> or no
padding, respectively. For signatures, only <b>-pkcs</b> and
<b>-raw</b> can be used.</p>

<p style="margin-left:11%;"><b>-hexdump</b></p>

<p style="margin-left:17%;">Hex dump the output data.</p>

<p style="margin-left:11%;"><b>-asn1parse</b></p>

<p style="margin-left:17%;">Parse the <small>ASN.1</small>
output data, this is useful when combined with the
<b>-verify</b> option.</p>

<p style="margin-left:11%;"><b>-engine</b> <i>id</i></p>

<p style="margin-left:17%;">See &quot;Engine Options&quot;
in <b>openssl</b>(1). This option is deprecated.</p>

<p style="margin-left:11%;"><b>-rand</b> <i>files</i>,
<b>-writerand</b> <i>file</i></p>

<p style="margin-left:17%;">See &quot;Random State
Options&quot; in <b>openssl</b>(1) for details.</p>

<p style="margin-left:11%;"><b>-provider</b> <i>name</i>
<b><br>
-provider-path</b> <i>path</i> <b><br>
-propquery</b> <i>propq</i></p>

<p style="margin-left:17%;">See &quot;Provider
Options&quot; in <b>openssl</b>(1), <b>provider</b>(7), and
<b>property</b>(7).</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Since this
command uses the <small>RSA</small> algorithm directly, it
can only be used to sign or verify small pieces of data.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Examples
equivalent to these can be found in the documentation for
the non-deprecated <b>openssl-pkeyutl</b>(1) command.</p>

<p style="margin-left:11%; margin-top: 1em">Sign some data
using a private key:</p>

<p style="margin-left:11%; margin-top: 1em">openssl rsautl
-sign -in file -inkey key.pem -out sig</p>

<p style="margin-left:11%; margin-top: 1em">Recover the
signed data</p>

<p style="margin-left:11%; margin-top: 1em">openssl rsautl
-verify -in sig -inkey key.pem</p>

<p style="margin-left:11%; margin-top: 1em">Examine the raw
signed data:</p>

<p style="margin-left:11%; margin-top: 1em">openssl rsautl
-verify -in sig -inkey key.pem -raw -hexdump <br>
0000 - 00 01 ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0010 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0020 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0030 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0040 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0050 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0060 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0070 - ff ff ff ff 00 68 65 6c-6c 6f 20 77 6f 72 6c 64
.....hello world</p>

<p style="margin-left:11%; margin-top: 1em">The PKCS#1
block formatting is evident from this. If this was done
using encrypt and decrypt the block would have been of type
2 (the second byte) and random padding data visible instead
of the 0xff bytes.</p>

<p style="margin-left:11%; margin-top: 1em">It is possible
to analyse the signature of certificates using this command
in conjunction with <b>openssl-asn1parse</b>(1). Consider
the self signed example in <i>certs/pca-cert.pem</i>.
Running <b>openssl-asn1parse</b>(1) as follows yields:</p>

<p style="margin-left:11%; margin-top: 1em">openssl
asn1parse -in pca-cert.pem <br>
0:d=0 hl=4 l= 742 cons: SEQUENCE <br>
4:d=1 hl=4 l= 591 cons: SEQUENCE <br>
8:d=2 hl=2 l= 3 cons: cont [ 0 ] <br>
10:d=3 hl=2 l= 1 prim: INTEGER :02 <br>
13:d=2 hl=2 l= 1 prim: INTEGER :00 <br>
16:d=2 hl=2 l= 13 cons: SEQUENCE <br>
18:d=3 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>
29:d=3 hl=2 l= 0 prim: NULL <br>
31:d=2 hl=2 l= 92 cons: SEQUENCE <br>
33:d=3 hl=2 l= 11 cons: SET <br>
35:d=4 hl=2 l= 9 cons: SEQUENCE <br>
37:d=5 hl=2 l= 3 prim: OBJECT :countryName <br>
42:d=5 hl=2 l= 2 prim: PRINTABLESTRING :AU <br>
.... <br>
599:d=1 hl=2 l= 13 cons: SEQUENCE <br>
601:d=2 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>
612:d=2 hl=2 l= 0 prim: NULL <br>
614:d=1 hl=3 l= 129 prim: BIT STRING</p>

<p style="margin-left:11%; margin-top: 1em">The final
<small>BIT STRING</small> contains the actual signature. It
can be extracted with:</p>

<p style="margin-left:11%; margin-top: 1em">openssl
asn1parse -in pca-cert.pem -out sig -noout -strparse 614</p>

<p style="margin-left:11%; margin-top: 1em">The certificate
public key can be extracted with:</p>

<p style="margin-left:11%; margin-top: 1em">openssl x509
-in test/testx509.pem -pubkey -noout &gt;pubkey.pem</p>

<p style="margin-left:11%; margin-top: 1em">The signature
can be analysed with:</p>

<p style="margin-left:11%; margin-top: 1em">openssl rsautl
-in sig -verify -asn1parse -inkey pubkey.pem -pubin <br>
0:d=0 hl=2 l= 32 cons: SEQUENCE <br>
2:d=1 hl=2 l= 12 cons: SEQUENCE <br>
4:d=2 hl=2 l= 8 prim: OBJECT :md5 <br>
14:d=2 hl=2 l= 0 prim: NULL <br>
16:d=1 hl=2 l= 16 prim: OCTET STRING <br>
0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5
.F...Js.7...H%..</p>

<p style="margin-left:11%; margin-top: 1em">This is the
parsed version of an <small>ASN1</small> DigestInfo
structure. It can be seen that the digest used was md5. The
actual part of the certificate that was signed can be
extracted with:</p>

<p style="margin-left:11%; margin-top: 1em">openssl
asn1parse -in pca-cert.pem -out tbs -noout -strparse 4</p>

<p style="margin-left:11%; margin-top: 1em">and its digest
computed with:</p>

<p style="margin-left:11%; margin-top: 1em">openssl md5 -c
tbs <br>
MD5(tbs)=
f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5</p>

<p style="margin-left:11%; margin-top: 1em">which it can be
seen agrees with the recovered value above.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>openssl</b>(1),
<b>openssl-pkeyutl</b>(1), <b>openssl-dgst</b>(1),
<b>openssl-rsa</b>(1), <b>openssl-genrsa</b>(1)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This command
was deprecated in OpenSSL 3.0.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>-engine</b> option was deprecated in OpenSSL 3.0.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
2000-2021 The OpenSSL Project Authors. All Rights
Reserved.</p>

<p style="margin-left:11%; margin-top: 1em">Licensed under
the Apache License 2.0 (the &quot;License&quot;). You may
not use this file except in compliance with the License. You
can obtain a copy in the file <small>LICENSE</small> in the
source distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr>
</body>
</html>
