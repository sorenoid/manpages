<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon Nov  7 04:40:08 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>dpkg-shlibdeps</title>

</head>
<body>

<h1 align="center">dpkg-shlibdeps</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">dpkg-shlibdeps
- generate shared library substvar dependencies</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>dpkg-shlibdeps</b>
[<i>option</i>...] [<b>-e</b>] <i>executable</i>
[<i>option</i>...]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>dpkg-shlibdeps</b>
calculates shared library dependencies for executables named
in its arguments. The dependencies are added to the
substitution variables file <b>debian/substvars</b> as
variable names <b>shlibs:</b><i>dependency-field</i> where
<i>dependency-field</i> is a dependency field name. Any
other variables starting with <b>shlibs:</b> are removed
from the file.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dpkg-shlibdeps</b>
has two possible sources of information to generate
dependency information. Either <i>symbols</i> files or
<i>shlibs</i> files. For each binary that
<b>dpkg-shlibdeps</b> analyzes, it finds out the list of
libraries that it&rsquo;s linked with. Then, for each
library, it looks up either the <i>symbols</i> file, or the
<i>shlibs</i> file (if the former doesn&rsquo;t exist or if
debian/shlibs.local contains the relevant dependency). Both
files are supposed to be provided by the library package and
should thus be available as
/var/lib/dpkg/info/<i>package</i>.<i>symbols</i> or
/var/lib/dpkg/info/<i>package</i>.<i>shlibs</i>. The package
name is identified in two steps: find the library file on
the system (looking in the same directories that
<b>ld.so</b> would use), then use <b>dpkg -S</b>
<i>library-file</i> to lookup the package providing the
library.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Symbols
files</b> <br>
Symbols files contain finer-grained dependency information
by providing the minimum dependency for each symbol that the
library exports. The script tries to find a symbols file
associated to a library package in the following places
(first match is used): <br>
debian/*/DEBIAN/symbols</p>

<p style="margin-left:17%;">Shared library information
generated by the current build process that also invoked
<b>dpkg-shlibdeps</b>. They are generated by
<a href="https://man.page/1/dpkg-gensymbols">dpkg-gensymbols(1)</a>. They are only used if the library
is found in a package&rsquo;s build tree. The symbols file
in that build tree takes precedence over symbols files from
other binary packages.</p>


<p style="margin-left:11%;">/etc/dpkg/symbols/<i>package</i>.symbols.<i>arch</i>
<br>
/etc/dpkg/symbols/<i>package</i>.symbols</p>

<p style="margin-left:17%;">Per-system overriding shared
library dependency information. <i>arch</i> is the
architecture of the current system (obtained by
<b>dpkg-architecture -qDEB_HOST_ARCH</b>).</p>

<p style="margin-left:11%;">Output from
&ldquo;<b>dpkg-query --control-path</b> <i>package</i>
symbols&rdquo;</p>

<p style="margin-left:17%;">Package-provided shared library
dependency information. Unless overridden by
<b>--admindir</b>, those files are located in
/var/lib/dpkg.</p>

<p style="margin-left:11%; margin-top: 1em">While scanning
the symbols used by all binaries, <b>dpkg-shlibdeps</b>
remembers the (biggest) minimal version needed for each
library. At the end of the process, it is able to write out
the minimal dependency for every library used (provided that
the information of the <i>symbols</i> files are
accurate).</p>

<p style="margin-left:11%; margin-top: 1em">As a safe-guard
measure, a symbols file can provide a
<b>Build-Depends-Package</b> meta-information field and
<b>dpkg-shlibdeps</b> will extract the minimal version
required by the corresponding package in the
<b>Build-Depends</b> field and use this version if
it&rsquo;s higher than the minimal version computed by
scanning symbols.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Shlibs
files</b> <br>
Shlibs files associate directly a library to a dependency
(without looking at the symbols). It&rsquo;s thus often
stronger than really needed but very safe and easy to
handle.</p>

<p style="margin-left:11%; margin-top: 1em">The
dependencies for a library are looked up in several places.
The first file providing information for the library of
interest is used: <br>
debian/shlibs.local</p>

<p style="margin-left:17%;">Package-local overriding shared
library dependency information.</p>

<p style="margin-left:11%;">/etc/dpkg/shlibs.override</p>

<p style="margin-left:17%;">Per-system overriding shared
library dependency information.</p>

<p style="margin-left:11%;">debian/*/DEBIAN/shlibs</p>

<p style="margin-left:17%;">Shared library information
generated by the current build process that also invoked
<b>dpkg-shlibdeps</b>. They are only used if the library is
found in a package&rsquo;s build tree. The shlibs file in
that build tree takes precedence over shlibs files from
other binary packages.</p>

<p style="margin-left:11%;">Output from
&ldquo;<b>dpkg-query --control-path</b> <i>package</i>
shlibs&rdquo;</p>

<p style="margin-left:17%;">Package-provided shared library
dependency information. Unless overridden by
<b>--admindir</b>, those files are located in
/var/lib/dpkg.</p>

<p style="margin-left:11%;">/etc/dpkg/shlibs.default</p>

<p style="margin-left:17%;">Per-system default shared
library dependency information.</p>

<p style="margin-left:11%; margin-top: 1em">The extracted
dependencies are then directly used (except if they are
filtered out because they have been identified as duplicate,
or as weaker than another dependency).</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>dpkg-shlibdeps</b>
interprets non-option arguments as executable names, just as
if they&rsquo;d been supplied as <b>-e</b><i>executable</i>.
<b><br>
-e</b><i>executable</i></p>

<p style="margin-left:17%;">Include dependencies
appropriate for the shared libraries required by
<i>executable</i>. This option can be used multiple
times.</p>

<p style="margin-left:11%;"><b>-l</b><i>directory</i></p>

<p style="margin-left:17%;">Prepend <i>directory</i> to the
list of directories to search for private shared libraries
(since dpkg 1.17.0). This option can be used multiple
times.</p>

<p style="margin-left:17%; margin-top: 1em"><b>Note:</b>
Use this option instead of setting
<b><small>LD_LIBRARY_PATH</small></b> , as that environment
variable is used to control the run-time linker and abusing
it to set the shared library paths at build-time can be
problematic when cross-compiling for example.</p>


<p style="margin-left:11%;"><b>-d</b><i>dependency-field</i></p>

<p style="margin-left:17%;">Add dependencies to be added to
the control file dependency field <i>dependency-field</i>.
(The dependencies for this field are placed in the variable
<b>shlibs:</b><i>dependency-field</i>.)</p>

<p style="margin-left:17%; margin-top: 1em">The
<b>-d</b><i>dependency-field</i> option takes effect for all
executables after the option, until the next
<b>-d</b><i>dependency-field</i>. The default
<i>dependency-field</i> is <b>Depends</b>.</p>

<p style="margin-left:17%; margin-top: 1em">If the same
dependency entry (or set of alternatives) appears in more
than one of the recognized dependency field names
<b>Pre-Depends</b>, <b>Depends</b>, <b>Recommends</b>,
<b>Enhances</b> or <b>Suggests</b> then
<b>dpkg-shlibdeps</b> will automatically remove the
dependency from all fields except the one representing the
most important dependencies.</p>


<p style="margin-left:11%;"><b>-p</b><i>varname-prefix</i></p>

<p style="margin-left:17%;">Start substitution variables
with <i>varname-prefix</i><b>:</b> instead of
<b>shlibs:</b>. Likewise, any existing substitution
variables starting with <i>varname-prefix</i><b>:</b>
(rather than <b>shlibs:</b>) are removed from the
substitution variables file.</p>

<p style="margin-left:11%;"><b>-O</b>[<i>filename</i>]</p>

<p style="margin-left:17%;">Print substitution variable
settings to standard output (or <i>filename</i> if
specified, since dpkg 1.17.2), rather than being added to
the substitution variables file (<b>debian/substvars</b> by
default).</p>

<p style="margin-left:11%;"><b>-t</b><i>type</i></p>

<p style="margin-left:17%;">Prefer shared library
dependency information tagged for the given package type. If
no tagged information is available, falls back to untagged
information. The default package type is <b>deb</b>. Shared
library dependency information is tagged for a given type by
prefixing it with the name of the type, a colon, and
whitespace.</p>


<p style="margin-left:11%;"><b>-L</b><i>local-shlibs-file</i></p>

<p style="margin-left:17%;">Read overriding shared library
dependency information from <i>local-shlibs-file</i> instead
of <b>debian/shlibs.local</b>.</p>


<p style="margin-left:11%;"><b>-T</b><i>substvars-file</i></p>

<p style="margin-left:17%;">Write substitution variables in
<i>substvars-file</i>; the default is
<b>debian/substvars</b>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-v</b></p></td>
<td width="3%"></td>
<td width="83%">


<p>Enable verbose mode (since dpkg 1.14.8). Numerous
messages are displayed to explain what <b>dpkg-shlibdeps</b>
does.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>-x</b><i>package</i></p>

<p style="margin-left:17%;">Exclude the package from the
generated dependencies (since dpkg 1.14.8). This is useful
to avoid self-dependencies for packages which provide
<small>ELF</small> binaries (executables or library plugins)
using a library contained in the same package. This option
can be used multiple times to exclude several packages.</p>


<p style="margin-left:11%;"><b>-S</b><i>package-build-dir</i></p>

<p style="margin-left:17%;">Look into
<i>package-build-dir</i> first when trying to find a library
(since dpkg 1.14.15). This is useful when the source package
builds multiple flavors of the same library and you want to
ensure that you get the dependency from a given binary
package. You can use this option multiple times: directories
will be tried in the same order before directories of other
binary packages.</p>


<p style="margin-left:11%;"><b>-I</b><i>package-build-dir</i></p>

<p style="margin-left:17%;">Ignore <i>package-build-dir</i>
when looking for shlibs, symbols, and shared library files
(since dpkg 1.18.5). You can use this option multiple
times.</p>


<p style="margin-left:11%;"><b>--ignore-missing-info</b></p>

<p style="margin-left:17%;">Do not fail if dependency
information can&rsquo;t be found for a shared library (since
dpkg 1.14.8). Usage of this option is discouraged, all
libraries should provide dependency information (either with
shlibs files, or with symbols files) even if they are not
yet used by other packages.</p>


<p style="margin-left:11%;"><b>--warnings=</b><i>value</i></p>

<p style="margin-left:17%;"><i>value</i> is a bit field
defining the set of warnings that can be emitted by
<b>dpkg-shlibdeps</b> (since dpkg 1.14.17). Bit 0 (value=1)
enables the warning &ldquo;symbol <i>sym</i> used by
<i>binary</i> found in none of the libraries&rdquo;, bit 1
(value=2) enables the warning &ldquo;package could avoid a
useless dependency&rdquo; and bit 2 (value=4) enables the
warning &ldquo;<i>binary</i> should not be linked against
<i>library</i>&rdquo;. The default <i>value</i> is 3: the
first two warnings are active by default, the last one is
not. Set <i>value</i> to 7 if you want all warnings to be
active.</p>


<p style="margin-left:11%;"><b>--admindir=</b><i>dir</i></p>

<p style="margin-left:17%;">Change the location of the
<b>dpkg</b> database (since dpkg 1.14.0). The default
location is <i>/var/lib/dpkg</i>.</p>

<p style="margin-left:11%;"><b>-?</b>, <b>--help</b></p>

<p style="margin-left:17%;">Show the usage message and
exit.</p>

<p style="margin-left:11%;"><b>--version</b></p>

<p style="margin-left:17%;">Show the version and exit.</p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b><small>DPKG_COLORS</small></b></p>

<p style="margin-left:17%;">Sets the color mode (since dpkg
1.18.5). The currently accepted values are: <b>auto</b>
(default), <b>always</b> and <b>never</b>.</p>


<p style="margin-left:11%;"><b><small>DPKG_NLS</small></b></p>

<p style="margin-left:17%;">If set, it will be used to
decide whether to activate Native Language Support, also
known as internationalization (or i18n) support (since dpkg
1.19.0). The accepted values are: <b>0</b> and <b>1</b>
(default).</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Warnings</b>
<br>
Since <b>dpkg-shlibdeps</b> analyzes the set of symbols used
by each binary of the generated package, it is able to emit
warnings in several cases. They inform you of things that
can be improved in the package. In most cases, those
improvements concern the upstream sources directly. By order
of decreasing importance, here are the various warnings that
you can encounter: <b><br>
symbol</b> <i>sym</i> <b>used by</b> <i>binary</i> <b>found
in none of the libraries.</b></p>

<p style="margin-left:17%;">The indicated symbol has not
been found in the libraries linked with the binary. The
<i>binary</i> is most likely a library and it needs to be
linked with an additional library during the build process
(option <b>-l</b><i>library</i> of the linker).</p>

<p style="margin-left:11%;"><i>binary</i> <b>contains an
unresolvable reference to symbol</b> <i>sym</i><b>:
it&rsquo;s probably <br>
a plugin</b></p>

<p style="margin-left:17%;">The indicated symbol has not
been found in the libraries linked with the binary. The
<i>binary</i> is most likely a plugin and the symbol is
probably provided by the program that loads this plugin. In
theory a plugin doesn&rsquo;t have any <small>SONAME</small>
but this binary does have one and as such it could not be
clearly identified as such. However the fact that the binary
is stored in a non-public directory is a strong indication
that&rsquo;s it&rsquo;s not a normal shared library. If the
binary is really a plugin, then disregard this warning. But
there&rsquo;s always the possibility that it&rsquo;s a real
library and that programs linking to it are using an
<small>RPATH</small> so that the dynamic loader finds it. In
that case, the library is broken and needs to be fixed.</p>

<p style="margin-left:11%;"><b>package could avoid a
useless dependency if</b> <i>binary</i> <b>was not linked
<br>
against</b> <i>library</i> <b>(it uses none of the
library&rsquo;s symbols)</b></p>

<p style="margin-left:17%;">None of the <i>binaries</i>
that are linked with <i>library</i> use any of the symbols
provided by the library. By fixing all the binaries, you
would avoid the dependency associated to this library
(unless the same dependency is also generated by another
library that is really used).</p>

<p style="margin-left:11%;"><b>package could avoid a
useless dependency if</b> <i>binaries</i> <b>were not linked
<br>
against</b> <i>library</i> <b>(they use none of the
library&rsquo;s symbols)</b></p>

<p style="margin-left:17%;">Exactly the same as the above
warning, but for multiple binaries.</p>

<p style="margin-left:11%;"><i>binary</i> <b>should not be
linked against</b> <i>library</i> <b>(it uses none of the
<br>
library&rsquo;s symbols)</b></p>

<p style="margin-left:17%;">The <i>binary</i> is linked to
a library that it doesn&rsquo;t need. It&rsquo;s not a
problem but some small performance improvements in binary
load time can be obtained by not linking this library to
this binary. This warning checks the same information as the
previous one but does it for each binary instead of doing
the check globally on all binaries analyzed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Errors <br>
dpkg-shlibdeps</b> will fail if it can&rsquo;t find a public
library used by a binary or if this library has no
associated dependency information (either shlibs file or
symbols file). A public library has a <small>SONAME</small>
and is versioned (libsomething.so.<i>X</i>). A private
library (like a plugin) should not have a
<small>SONAME</small> and doesn&rsquo;t need to be
versioned. <b><br>
couldn&rsquo;t find library</b> <i>library-soname</i>
<b>needed by</b> <i>binary</i> <b>(its <small>RPATH</small>
is <br>
&rsquo;</b><i>rpath</i><b>&rsquo;)</b></p>

<p style="margin-left:17%;">The <i>binary</i> uses a
library called <i>library-soname</i> but
<b>dpkg-shlibdeps</b> has been unable to find the library.
<b>dpkg-shlibdeps</b> creates a list of directories to check
as following: directories listed in the <small>RPATH</small>
of the binary, directories added by the <b>-l</b> option,
directories listed in the
<b><small>LD_LIBRARY_PATH</small></b> environment variable,
cross multiarch directories (ex. /lib/arm64-linux-gnu,
/usr/lib/arm64-linux-gnu), standard public directories
(/lib, /usr/lib), directories listed in /etc/ld.so.conf, and
obsolete multilib directories (/lib32, /usr/lib32, /lib64,
/usr/lib64). Then it checks those directories in the
package&rsquo;s build tree of the binary being analyzed, in
the packages&rsquo; build trees indicated with the <b>-S</b>
command-line option, in other packages&rsquo; build trees
that contains a DEBIAN/shlibs or DEBIAN/symbols file and
finally in the root directory. If the library is not found
in any of those directories, then you get this error.</p>

<p style="margin-left:17%; margin-top: 1em">If the library
not found is in a private directory of the same package,
then you want to add the directory with <b>-l</b>. If
it&rsquo;s in another binary package being built, you want
to make sure that the shlibs/symbols file of this package is
already created and that <b>-l</b> contains the appropriate
directory if it also is in a private directory.</p>

<p style="margin-left:11%;"><b>no dependency information
found for</b> <i>library-file</i> <b>(used by</b>
<i>binary</i><b>).</b></p>

<p style="margin-left:17%;">The library needed by
<i>binary</i> has been found by <b>dpkg-shlibdeps</b> in
<i>library-file</i> but <b>dpkg-shlibdeps</b> has been
unable to find any dependency information for that library.
To find out the dependency, it has tried to map the library
to a Debian package with the help of <b>dpkg -S</b>
<i>library-file</i>. Then it checked the corresponding
shlibs and symbols files in /var/lib/dpkg/info/, and in the
various package&rsquo;s build trees (debian/*/DEBIAN/).</p>

<p style="margin-left:17%; margin-top: 1em">This failure
can be caused by a bad or missing shlibs or symbols file in
the package of the library. It might also happen if the
library is built within the same source package and if the
shlibs files has not yet been created (in which case you
must fix debian/rules to create the shlibs before calling
<b>dpkg-shlibdeps</b>). Bad <small>RPATH</small> can also
lead to the library being found under a non-canonical name
(example: /usr/lib/openoffice.org/../lib/libssl.so.0.9.8
instead of /usr/lib/libssl.so.0.9.8) that&rsquo;s not
associated to any package, <b>dpkg-shlibdeps</b> tries to
work around this by trying to fallback on a canonical name
(using <a href="https://man.page/3/realpath">realpath(3)</a>) but it might not always work.
It&rsquo;s always best to clean up the <small>RPATH</small>
of the binary to avoid problems.</p>

<p style="margin-left:17%; margin-top: 1em">Calling
<b>dpkg-shlibdeps</b> in verbose mode (<b>-v</b>) will
provide much more information about where it tried to find
the dependency information. This might be useful if you
don&rsquo;t understand why it&rsquo;s giving you this
error.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><a href="https://man.page/5/deb-shlibs">deb-shlibs(5)</a>,
<a href="https://man.page/5/deb-symbols">deb-symbols(5)</a>, <a href="https://man.page/1/dpkg-gensymbols">dpkg-gensymbols(1)</a>.</p>
<hr>
</body>
</html>
