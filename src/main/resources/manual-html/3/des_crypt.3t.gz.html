<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Sat Nov 26 20:37:45 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>DES_CRYPT(3) BSD Library Functions Manual
DES_CRYPT(3)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>des_crypt</b>,
<b>ecb_crypt</b>, <b>cbc_crypt</b>, <b>des_setparity</b>
&mdash; fast DES encryption</p>

<p style="margin-top: 1em"><b>SYNOPSIS</b></p>

<p style="margin-left:6%;"><b>#include
&lt;rpc/des_crypt.h&gt;</b></p>

<p style="margin-left:6%; margin-top: 1em"><i>int</i></p>


<p style="margin-left:12%;"><b>ecb_crypt</b>(<i>char&nbsp;*key</i>,
<i>char&nbsp;*data</i>, <i>unsigned&nbsp;datalen</i>,
<i>unsigned&nbsp;mode</i>);</p>

<p style="margin-left:6%; margin-top: 1em"><i>int</i></p>


<p style="margin-left:12%;"><b>cbc_crypt</b>(<i>char&nbsp;*key</i>,
<i>char&nbsp;*data</i>, <i>unsigned&nbsp;datalen</i>,
<i>unsigned&nbsp;mode</i>, <i>char&nbsp;*ivec</i>);</p>

<p style="margin-left:6%; margin-top: 1em"><i>void</i></p>


<p style="margin-left:12%;"><b>des_setparity</b>(<i>char&nbsp;*key</i>);</p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;">The <b>ecb_crypt</b>() and
<b>cbc_crypt</b>() functions implement the NBS DES (Data
Encryption Standard). These routines are faster and more
general purpose than crypt(3). They also are able to utilize
DES hardware if it is available. The <b>ecb_crypt</b>()
function encrypts in ECB (Electronic Code Book) mode, which
encrypts blocks of data independently. The
<b>cbc_crypt</b>() function encrypts in CBC (Cipher Block
Chaining) mode, which chains together successive blocks. CBC
mode protects against insertions, deletions and
substitutions of blocks. Also, regularities in the clear
text will not appear in the cipher text.</p>

<p style="margin-left:6%; margin-top: 1em">Here is how to
use these routines. The first argument, <i>key</i>, is the
8-byte encryption key with parity. To set the key&rsquo;s
parity, which for DES is in the low bit of each byte, use
<b>des_setparity</b>(). The second argument, <i>data</i>,
contains the data to be encrypted or decrypted. The third
argument, <i>datalen</i>, is the length in bytes of
<i>data</i>, which must be a multiple of 8. The fourth
argument, <i>mode</i>, is formed by <i>OR</i>&rsquo;ing
together some things. For the encryption direction <i>OR</i>
in either DES_ENCRYPT or DES_DECRYPT. For software versus
hardware encryption, <i>OR</i> in either DES_HW or DES_SW.
If DES_HW is specified, and there is no hardware, then the
encryption is performed in software and the routine returns
DESERR_NOHWDEVICE. For <b>cbc_crypt</b>(), the <i>ivec</i>
argument is the 8-byte initialization vector for the
chaining. It is updated to the next initialization vector
upon return.</p>

<p style="margin-top: 1em"><b>ERRORS</b> <br>
[DESERR_NONE]</p>

<p style="margin-left:33%; margin-top: 1em">No error.</p>

<p>[DESERR_NOHWDEVICE]</p>

<p style="margin-left:33%; margin-top: 1em">Encryption
succeeded, but done in software instead of the requested
hardware.</p>

<p>[DESERR_HWERR]</p>

<p style="margin-left:33%; margin-top: 1em">An error
occurred in the hardware or driver.</p>

<p>[DESERR_BADPARAM]</p>

<p style="margin-left:33%; margin-top: 1em">Bad argument to
routine.</p>

<p style="margin-left:6%; margin-top: 1em">Given a result
status <i>stat</i>, the macro <b>DES_FAILED</b>(<i>stat</i>)
is false only for the first two statuses.</p>

<p style="margin-top: 1em"><b>AVAILABILITY</b></p>

<p style="margin-left:6%;">The <b>ecb_crypt</b>(),
<b>cbc_crypt</b>(), and <b>des_setparity</b>() functions are
part of libtirpc.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">crypt(3)</p>

<p style="margin-top: 1em"><b>RESTRICTIONS</b></p>

<p style="margin-left:6%;">These routines are not available
in RPCSRC 4.0. This information is provided to describe the
DES interface expected by Secure RPC.</p>

<p style="margin-left:6%; margin-top: 1em">BSD
October&nbsp;6, 1987 BSD</p>
<hr>
</body>
</html>
